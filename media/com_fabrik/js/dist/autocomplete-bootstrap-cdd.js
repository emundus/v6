/*! Fabrik */

define(["jquery","fab/autocomplete-bootstrap","fab/fabrik"],function(t,e,o){return new Class({Binds:[],Extends:e,search:function(t){var e,s,i=this.getInputElement().get("value");if(""===i&&(this.element.value=""),i!==this.searchText&&""!==i){var n=document.id(this.options.observerid);if("null"===typeOf(n))return void this.parent(t);this.options.formRef&&(n=o.getBlock(this.options.formRef).formElements[this.options.observerid]),e=n.get("value")+"."+i,this.positionMenu(),this.cache[e]?this.populateMenu(this.cache[e])&&this.openMenu():(this.ajax&&(this.closeMenu(),this.ajax.cancel()),this.ajax=new Request({url:this.options.url,data:{value:i,fabrik_cascade_ajax_update:1,v:n.get("value")},onRequest:function(){o.loader.start(this.getInputElement())}.bind(this),onCancel:function(){o.loader.stop(this.getInputElement())}.bind(this),onSuccess:function(t){o.loader.stop(this.getInputElement()),this.ajax=null,this.completeAjax(t)}.bind(this),onFailure:function(t){o.loader.stop(this.getInputElement()),this.ajax=null,fconsole("Fabrik autocomplete: Ajax failure: Code "+t.status+": "+t.statusText);var e=o.getBlock(this.options.formRef).formElements.get(this.element.id);s=Joomla.JText._("COM_FABRIK_AUTOCOMPLETE_AJAX_ERROR"),e.setErrorMessage(s,"fabrikError",!0)}.bind(this)}).send())}this.searchText=i}})});