/*! Fabrik */

define(["jquery"],function(e){return new Class({Binds:[],queue:{},initialize:function(){this.periodical=this.processQueue.periodical(500,this)},add:function(e){var t=e.options.url+Object.toQueryString(e.options.data)+Math.random();this.queue[t]||(this.queue[t]=e)},processQueue:function(){if(0!==Object.keys(this.queue).length){var u=!1;$H(this.queue).each(function(e,t){e.isSuccess()?(delete this.queue[t],u=!1):500===e.status&&(console.log("Fabrik Request Queue: 500 "+e.xhr.statusText),delete this.queue[t],u=!1)}.bind(this)),$H(this.queue).each(function(e,t){e.isRunning()||e.isSuccess()||u||(e.send(),u=!0)})}},empty:function(){return 0===Object.keys(this.queue).length}})});