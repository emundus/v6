(function(e){function s(s){for(var a,o,r=s[0],c=s[1],m=s[2],l=0,g=[];l<r.length;l++)o=r[l],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&g.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(s);while(g.length)g.shift()();return i.push.apply(i,m||[]),t()}function t(){for(var e,s=0;s<i.length;s++){for(var t=i[s],a=!0,r=1;r<t.length;r++){var c=t[r];0!==n[c]&&(a=!1)}a&&(i.splice(s--,1),e=o(o.s=t[0]))}return e}var a={},n={app:0},i=[];function o(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,s,t){o.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,s){if(1&s&&(e=o(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)o.d(t,a,function(s){return e[s]}.bind(null,a));return t},o.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(s,"a",s),s},o.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=s,r=r.slice();for(var m=0;m<r.length;m++)s(r[m]);var u=c;i.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"2d6c":function(e,s,t){"use strict";t("c7bc")},"56d7":function(e,s,t){"use strict";t.r(s);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("Messages",{attrs:{user:e.user,notifications:e.notifications},on:{removeNotifications:e.removeNotifications}}),t("div",[t("img",{staticClass:"em-messages-modal",staticStyle:{"max-width":"35px",cursor:"pointer"},attrs:{src:"/images/emundus/menus/email.png"},on:{click:e.openModal}}),e.notifications>0?t("p",{staticClass:"notifications__counter"},[e._v(e._s(e.counter))]):e._e()])],1)},i=[],o=(t("a9e3"),t("bc3a")),r=t.n(o),c=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__vue"},[t("span",{attrs:{id:"messages"}},[t("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"70%",scrollable:!0,delay:100,clickToClose:!0},on:{opened:e.getCampaignsByUser}},[t("div",{staticClass:"drag-window"},[t("div",{staticClass:"col-md-3 messages__campaigns-list"},e._l(e.campaigns,(function(s){return t("div",{staticClass:"messages__block",class:s.fnum==e.campaignSelected?"messages__active-campaign":"",on:{click:function(t){e.campaignSelected=s.fnum}}},[t("div",{staticClass:"messages__campaign-block"},[t("img",{staticClass:"messages__campaigns_folder-icon",attrs:{src:"/images/emundus/messenger/folder.svg"}}),t("span",{staticClass:"messages__campaigns_title"},[e._v(e._s(s.label))])])])})),0),t("div",{staticClass:"messages__list col-md-9"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.messages,(function(s){return t("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left"},[t("p",[t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(s.name))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user"},[e._v(e._s(s.message))])])])})),0),t("div",{staticClass:"messages__bottom-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),e.sendMessage(s))},input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/send.svg"},on:{click:e.sendMessage}})])])])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},m=[],u=(t("d400"),t("2dfa")),l=t.n(u),g=(t("bc4a"),t("be46"),t("8131")),d={name:"Messages",props:{user:Number,notifications:Object},components:{},data:function(){return{messages:[],campaigns:[],campaignSelected:0,message:"",loading:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE")}}},methods:{getCampaignsByUser:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getcampaignsbyuser"}).then((function(s){e.campaigns=s.data.data,e.campaignSelected=e.campaigns[0].fnum}))},getMessagesByFnum:function(){var e=this;this.loading=!0,l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getmessagesbyfnum",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return g.stringify(e)}}).then((function(s){e.messages=s.data.data,e.markAsRead(),e.scrollToBottom(),e.loading=!1}))},markAsRead:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=markasread",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return g.stringify(e)}}).then((function(s){e.$emit("removeNotifications",s.data.data)}))},sendMessage:function(){var e=this;""!==this.message&&l()({method:"post",url:"index.php?option=com_emundus_messenger&controller=messages&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:g.stringify({message:this.message,fnum:this.campaignSelected})}).then((function(s){e.message="",e.messages.push(s.data),e.scrollToBottom()}))},scrollToBottom:function(){setTimeout((function(){var e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight}),500)}},created:function(){},watch:{campaignSelected:function(){this.getMessagesByFnum()}}},p=d,f=t("2877"),_=Object(f["a"])(p,c,m,!1,null,null,null),h=_.exports,v=t("4328"),b={name:"Notifications",props:{user:Number,fnum:String},components:{Messages:h},data:function(){return{counter:0,notifications:{}}},methods:{openModal:function(){this.$modal.show("messages")},getNotifications:function(){var e=this;r()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getnotifications",params:{user:this.user},paramsSerializer:function(e){return v.stringify(e)}}).then((function(s){null!=s.data.data&&(e.counter=s.data.data.notifications,e.notifications=s.data.data)}))},removeNotifications:function(e){this.counter-=e}},created:function(){this.getNotifications()}},y=b,C=(t("2d6c"),Object(f["a"])(y,n,i,!1,null,null,null)),k=C.exports,x=t("1881"),w=t.n(x);a["a"].config.productionTip=!1,a["a"].config.devtools=!0,a["a"].use(w.a),document.getElementById("em-notifications")&&new a["a"]({el:"#em-notifications",render:function(e){return e(k,{props:{user:this.$el.attributes.user.value,fnum:this.$el.attributes.fnum.value}})}})},bc4a:function(e,s,t){},be46:function(e,s,t){},c7bc:function(e,s,t){}});
//# sourceMappingURL=app.js.map