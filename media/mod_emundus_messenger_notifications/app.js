(function(e){function s(s){for(var a,c,o=s[0],r=s[1],m=s[2],l=0,f=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(n,c)&&n[c]&&f.push(n[c][0]),n[c]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);d&&d(s);while(f.length)f.shift()();return i.push.apply(i,m||[]),t()}function t(){for(var e,s=0;s<i.length;s++){for(var t=i[s],a=!0,o=1;o<t.length;o++){var r=t[o];0!==n[r]&&(a=!1)}a&&(i.splice(s--,1),e=c(c.s=t[0]))}return e}var a={},n={app:0},i=[];function c(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.m=e,c.c=a,c.d=function(e,s,t){c.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,s){if(1&s&&(e=c(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)c.d(t,a,function(s){return e[s]}.bind(null,a));return t},c.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(s,"a",s),s},c.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=s,o=o.slice();for(var m=0;m<o.length;m++)s(o[m]);var d=r;i.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"07a3":function(e,s,t){var a={"./af":"71f7","./af.js":"71f7","./ar":"78398","./ar-dz":"dc15","./ar-dz.js":"dc15","./ar-kw":"e711","./ar-kw.js":"e711","./ar-ly":"f1f9","./ar-ly.js":"f1f9","./ar-ma":"eb51","./ar-ma.js":"eb51","./ar-sa":"1c9d","./ar-sa.js":"1c9d","./ar-tn":"2330","./ar-tn.js":"2330","./ar.js":"78398","./az":"94ba","./az.js":"94ba","./be":"2c84","./be.js":"2c84","./bg":"9d91","./bg.js":"9d91","./bm":"67ed","./bm.js":"67ed","./bn":"19b6","./bn-bd":"216d","./bn-bd.js":"216d","./bn.js":"19b6","./bo":"35be","./bo.js":"35be","./br":"16f8","./br.js":"16f8","./bs":"7f73","./bs.js":"7f73","./ca":"c75f","./ca.js":"c75f","./cs":"883b","./cs.js":"883b","./cv":"3dfd","./cv.js":"3dfd","./cy":"55ec","./cy.js":"55ec","./da":"f1fb","./da.js":"f1fb","./de":"18b2","./de-at":"9c6d","./de-at.js":"9c6d","./de-ch":"5da1","./de-ch.js":"5da1","./de.js":"18b2","./dv":"9844","./dv.js":"9844","./el":"f8f8","./el.js":"f8f8","./en-au":"c82b","./en-au.js":"c82b","./en-ca":"72b7","./en-ca.js":"72b7","./en-gb":"23a6","./en-gb.js":"23a6","./en-ie":"d6aa","./en-ie.js":"d6aa","./en-il":"0abf","./en-il.js":"0abf","./en-in":"837f","./en-in.js":"837f","./en-nz":"0608","./en-nz.js":"0608","./en-sg":"4652","./en-sg.js":"4652","./eo":"f2a4","./eo.js":"f2a4","./es":"73f3","./es-do":"c737","./es-do.js":"c737","./es-mx":"693a","./es-mx.js":"693a","./es-us":"3a46","./es-us.js":"3a46","./es.js":"73f3","./et":"20be","./et.js":"20be","./eu":"ff66","./eu.js":"ff66","./fa":"2b9c","./fa.js":"2b9c","./fi":"8f9e","./fi.js":"8f9e","./fil":"3f75","./fil.js":"3f75","./fo":"726d","./fo.js":"726d","./fr":"baa3","./fr-ca":"70f9","./fr-ca.js":"70f9","./fr-ch":"3785","./fr-ch.js":"3785","./fr.js":"baa3","./fy":"d70c","./fy.js":"d70c","./ga":"0912","./ga.js":"0912","./gd":"48f5","./gd.js":"48f5","./gl":"5b4c","./gl.js":"5b4c","./gom-deva":"b08c","./gom-deva.js":"b08c","./gom-latn":"30a8","./gom-latn.js":"30a8","./gu":"c39e","./gu.js":"c39e","./he":"6301","./he.js":"6301","./hi":"b249","./hi.js":"b249","./hr":"dbf1","./hr.js":"dbf1","./hu":"ee82","./hu.js":"ee82","./hy-am":"db88","./hy-am.js":"db88","./id":"b4f1","./id.js":"b4f1","./is":"1db2","./is.js":"1db2","./it":"b039","./it-ch":"8349","./it-ch.js":"8349","./it.js":"b039","./ja":"f5cd","./ja.js":"f5cd","./jv":"4bec","./jv.js":"4bec","./ka":"441a","./ka.js":"441a","./kk":"59ac","./kk.js":"59ac","./km":"426c","./km.js":"426c","./kn":"b026","./kn.js":"b026","./ko":"ecce","./ko.js":"ecce","./ku":"ff55","./ku.js":"ff55","./ky":"9447","./ky.js":"9447","./lb":"a71c","./lb.js":"a71c","./lo":"7b6e","./lo.js":"7b6e","./lt":"3151","./lt.js":"3151","./lv":"5aa7","./lv.js":"5aa7","./me":"692d","./me.js":"692d","./mi":"8592","./mi.js":"8592","./mk":"1741","./mk.js":"1741","./ml":"74be","./ml.js":"74be","./mn":"9763","./mn.js":"9763","./mr":"57cf","./mr.js":"57cf","./ms":"d435","./ms-my":"9b1e","./ms-my.js":"9b1e","./ms.js":"d435","./mt":"c65d","./mt.js":"c65d","./my":"7943","./my.js":"7943","./nb":"307b","./nb.js":"307b","./ne":"2169","./ne.js":"2169","./nl":"5ecf","./nl-be":"9bd7","./nl-be.js":"9bd7","./nl.js":"5ecf","./nn":"a0da","./nn.js":"a0da","./oc-lnc":"5802","./oc-lnc.js":"5802","./pa-in":"12e9","./pa-in.js":"12e9","./pl":"5f1f","./pl.js":"5f1f","./pt":"eb14","./pt-br":"576e","./pt-br.js":"576e","./pt.js":"eb14","./ro":"a8db","./ro.js":"a8db","./ru":"9a19","./ru.js":"9a19","./sd":"8fe3","./sd.js":"8fe3","./se":"6abe","./se.js":"6abe","./si":"8276","./si.js":"8276","./sk":"3ee4","./sk.js":"3ee4","./sl":"9e55","./sl.js":"9e55","./sq":"7e20","./sq.js":"7e20","./sr":"0616","./sr-cyrl":"43fd","./sr-cyrl.js":"43fd","./sr.js":"0616","./ss":"5b76","./ss.js":"5b76","./sv":"02e6","./sv.js":"02e6","./sw":"cf20","./sw.js":"cf20","./ta":"50dd","./ta.js":"50dd","./te":"0797","./te.js":"0797","./tet":"fce0","./tet.js":"fce0","./tg":"7fa1","./tg.js":"7fa1","./th":"072e","./th.js":"072e","./tk":"13d2","./tk.js":"13d2","./tl-ph":"a0bc","./tl-ph.js":"a0bc","./tlh":"e7f9","./tlh.js":"e7f9","./tr":"1b18","./tr.js":"1b18","./tzl":"40cc","./tzl.js":"40cc","./tzm":"8960","./tzm-latn":"f75d","./tzm-latn.js":"f75d","./tzm.js":"8960","./ug-cn":"9105","./ug-cn.js":"9105","./uk":"6a26","./uk.js":"6a26","./ur":"518a","./ur.js":"518a","./uz":"3e04","./uz-latn":"fb1a","./uz-latn.js":"fb1a","./uz.js":"3e04","./vi":"6893","./vi.js":"6893","./x-pseudo":"4c20","./x-pseudo.js":"4c20","./yo":"c98b","./yo.js":"c98b","./zh-cn":"f9cd","./zh-cn.js":"f9cd","./zh-hk":"20e4","./zh-hk.js":"20e4","./zh-mo":"7aed","./zh-mo.js":"7aed","./zh-tw":"1db5","./zh-tw.js":"1db5"};function n(e){var s=i(e);return t(s)}function i(e){if(!t.o(a,e)){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="07a3"},"2d6c":function(e,s,t){"use strict";t("c7bc")},"56d7":function(e,s,t){"use strict";t.r(s);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("Messages",{attrs:{user:e.user,fnum:e.fnum,notifications:e.notifications},on:{removeNotifications:e.removeNotifications}}),t("div",[t("img",{staticClass:"em-messages-modal",staticStyle:{"max-width":"35px",cursor:"pointer"},attrs:{src:"/images/emundus/menus/email.png"},on:{click:e.openModal}}),e.counter>0?t("p",{staticClass:"notifications__counter"},[e._v(e._s(e.counter))]):e._e()])],1)},i=[],c=(t("a9e3"),t("bc3a")),o=t.n(c),r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__vue"},[t("span",{attrs:{id:"messages"}},[t("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"70%",scrollable:!0,delay:100,clickToClose:!0},on:{closed:e.beforeClose,opened:e.getCampaignsByUser}},[t("div",{staticClass:"drag-window"},[t("div",{staticClass:"col-md-3 messages__campaigns-list"},e._l(e.campaigns,(function(s){return t("div",{staticClass:"messages__block",class:s.fnum==e.campaignSelected?"messages__active-campaign":"",on:{click:function(t){e.campaignSelected=s.fnum}}},[t("div",{staticClass:"messages__campaign-block"},[t("img",{staticClass:"messages__campaigns_folder-icon",attrs:{src:"/images/emundus/messenger/folder.svg"}}),t("span",{staticClass:"messages__campaigns_title"},[e._v(e._s(s.label))])])])})),0),t("div",{staticClass:"messages__list col-md-9"},[t("div",{staticClass:"message__header"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("i",{staticClass:"fas fa-times pointer",on:{click:function(s){return e.$modal.hide("messages")}}})]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.dates,(function(s){return t("div",[t("div",{staticClass:"messages__date-section"},[t("hr"),t("p",[e._v(e._s(e.moment(s.dates).format("DD/MM/YYYY")))]),t("hr")]),e._l(e.messages,(function(a){return s.messages.includes(a.message_id)?t("div",{staticClass:"messages__message-item",class:e.user==a.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==a.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(s){e.showDate!=a.message_id?e.showDate=a.message_id:e.showDate=0}}},[t("p",[t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(a.name))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==a.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user"},[e._v(e._s(a.message))]),t("p",[e.showDate==a.message_id?t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(a.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),0),t("div",{staticClass:"messages__bottom-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),e.sendMessage(s))},input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/send.svg"},on:{click:e.sendMessage}})])])])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},m=[],d=(t("d400"),t("58d3"),t("43e5"),t("c4e3"),t("2dfa")),l=t.n(d),f=t("610f"),u=t.n(f),g=t("7661"),j=t.n(g),b=(t("bc4a"),t("be46"),t("8131")),p={name:"Messages",props:{user:Number,fnum:String,notifications:Object},components:{InfiniteLoading:u.a},data:function(){return{dates:[],messages:[],campaigns:[],campaignSelected:0,message:"",loading:!1,interval:0,showDate:0,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE")}}},methods:{moment:function(e){return j()(e)},beforeClose:function(){clearInterval(this.interval)},getCampaignsByUser:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getcampaignsbyuser"}).then((function(s){e.campaigns=s.data.data,""!=e.fnum?e.campaignSelected=e.fnum:e.campaignSelected=e.campaigns[0].fnum}))},getMessagesByFnum:function(){var e=this,s=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=s,l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getmessagesbyfnum",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return b.stringify(e)}}).then((function(s){e.messages=s.data.data.messages,e.dates=s.data.data.dates,e.markAsRead(),e.scrollToBottom(),e.loading=!1}))},markAsRead:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=markasread",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return b.stringify(e)}}).then((function(s){e.$emit("removeNotifications",s.data.data)}))},sendMessage:function(){var e=this;""!==this.message&&l()({method:"post",url:"index.php?option=com_emundus_messenger&controller=messages&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:b.stringify({message:this.message,fnum:this.campaignSelected})}).then((function(s){e.message="";var t=s.data.date_time.split(" ")[0];e.dates.forEach((function(a,n){a.dates==t&&e.dates[n].messages.push(s.data.message_id)})),e.messages.push(s.data),e.scrollToBottom()}))},scrollToBottom:function(){setTimeout((function(){var e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight}),500)}},created:function(){var e=this;this.interval=setInterval((function(){e.getMessagesByFnum(!1)}),2e4)},watch:{campaignSelected:function(){this.getMessagesByFnum(!0)}}},_=p,h=t("2877"),v=Object(h["a"])(_,r,m,!1,null,null,null),y=v.exports,k=t("4328"),w={name:"Notifications",props:{user:Number,fnum:String},components:{Messages:y},data:function(){return{counter:0,notifications:{}}},methods:{openModal:function(){this.$modal.show("messages")},getNotifications:function(){var e=this;o()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getnotifications",params:{user:this.user},paramsSerializer:function(e){return k.stringify(e)}}).then((function(s){null!=s.data.data&&(e.counter=s.data.data.notifications,e.notifications=s.data.data)}))},removeNotifications:function(e){this.counter-=e}},created:function(){var e=this;this.getNotifications(),setInterval((function(){e.getNotifications()}),2e4)}},C=w,x=(t("2d6c"),Object(h["a"])(C,n,i,!1,null,null,null)),z=x.exports,S=t("1881"),M=t.n(S);a["a"].config.productionTip=!1,a["a"].config.devtools=!0,a["a"].use(M.a),document.getElementById("em-notifications")&&new a["a"]({el:"#em-notifications",render:function(e){return e(z,{props:{user:this.$el.attributes.user.value,fnum:this.$el.attributes.fnum.value}})}})},bc4a:function(e,s,t){},be46:function(e,s,t){},c7bc:function(e,s,t){}});
//# sourceMappingURL=app.js.map