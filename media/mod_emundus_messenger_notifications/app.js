(function(e){function s(s){for(var a,i,c=s[0],r=s[1],d=s[2],l=0,u=[];l<c.length;l++)i=c[l],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&u.push(n[i][0]),n[i]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);m&&m(s);while(u.length)u.shift()();return o.push.apply(o,d||[]),t()}function t(){for(var e,s=0;s<o.length;s++){for(var t=o[s],a=!0,c=1;c<t.length;c++){var r=t[c];0!==n[r]&&(a=!1)}a&&(o.splice(s--,1),e=i(i.s=t[0]))}return e}var a={},n={app:0},o=[];function i(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=a,i.d=function(e,s,t){i.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,s){if(1&s&&(e=i(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)i.d(t,a,function(s){return e[s]}.bind(null,a));return t},i.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(s,"a",s),s},i.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=s,c=c.slice();for(var d=0;d<c.length;d++)s(c[d]);var m=r;o.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},1:function(e,s){},"2d6c":function(e,s,t){"use strict";t("c7bc")},"56d7":function(e,s,t){"use strict";t.r(s);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("Messages",{attrs:{user:e.user,fnum:e.fnum,notifications:e.notifications},on:{removeNotifications:e.removeNotifications}}),t("div",[t("img",{staticClass:"em-messages-modal",staticStyle:{width:"30px",cursor:"pointer"},attrs:{src:"/images/emundus/messenger/messenger.svg"},on:{click:e.openModal}}),e.counter>0?t("p",{staticClass:"notifications__counter"},[e._v(e._s(e.counter))]):e._e()])],1)},o=[],i=(t("a9e3"),t("bc3a")),c=t.n(i),r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__vue"},[t("span",{attrs:{id:"messages"}},[t("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"70%",scrollable:!0,delay:100,clickToClose:!0},on:{closed:e.beforeClose,opened:e.getCampaignsByUser}},[t("AttachDocument",{attrs:{user:e.user,fnum:e.fnum,applicant:!0}}),t("div",{staticClass:"drag-window"},[t("div",{staticClass:"col-md-3 messages__campaigns-list"},e._l(e.campaigns,(function(s){return t("div",{staticClass:"messages__block",class:s.fnum==e.campaignSelected?"messages__active-campaign":"",on:{click:function(t){e.campaignSelected=s.fnum}}},[t("div",{staticClass:"messages__campaign-block"},[t("img",{staticClass:"messages__campaigns_folder-icon",attrs:{src:"/images/emundus/messenger/folder.svg"}}),t("span",{staticClass:"messages__campaigns_title"},[e._v(e._s(s.label))])])])})),0),t("div",{staticClass:"messages__list col-md-9"},[t("div",{staticClass:"message__header"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("i",{staticClass:"fas fa-times pointer",on:{click:function(s){return e.$modal.hide("messages")}}})]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.dates,(function(s){return t("div",[t("div",{staticClass:"messages__date-section"},[t("hr"),t("p",[e._v(e._s(e.moment(s.dates).format("DD/MM/YYYY")))]),t("hr")]),e._l(e.messages,(function(a){return s.messages.includes(a.message_id)?t("div",{staticClass:"messages__message-item",class:e.user==a.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==a.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(s){e.showDate!=a.message_id?e.showDate=a.message_id:e.showDate=0}}},[t("p",[t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(a.name))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==a.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user",domProps:{innerHTML:e._s(a.message)}}),t("p",[e.showDate==a.message_id?t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(a.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),0),t("div",{staticClass:"messages__bottom-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),e.sendMessage(s))},input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/send.svg"},on:{click:e.sendMessage}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/attached.svg"},on:{click:e.attachDocument}})])])])],1)],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},d=[],m=(t("d92d"),t("94bc"),t("3341"),t("f9ae"),t("8f3e")),l=t.n(m),u=t("03de"),f=t.n(u),g=t("b32d"),p=t.n(g),_=(t("bc4a"),t("be46"),function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__vue_attach_document"},[t("span",{attrs:{id:"attach_documents"}},[t("modal",{attrs:{name:"attach_documents",transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"30%",scrollable:!0,delay:100,clickToClose:!0},on:{closed:e.beforeClose}},[t("div",{staticClass:"messages__attach_content"},[e.applicant?e._e():t("ul",{staticClass:"messages__attach_actions_tabs"},[t("li",{staticClass:"messages__attach_action",class:1===e.action?"messages__attach_action__current":"",on:{click:function(s){e.action=1}}},[e._v(e._s(e.translations.sendDocument))]),t("li",{staticClass:"messages__attach_action",class:2===e.action?"messages__attach_action__current":"",on:{click:function(s){e.action=2}}},[e._v(e._s(e.translations.askDocument))])]),1===e.action?t("div",[e.applicant?t("label",[e._v(e._s(e.translations.sendDocument))]):e._e(),t("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[t("em",{staticClass:"fas fa-file-image"}),e._v(" "+e._s(e.translations.DropHere)+" ")])])],1):e._e(),2===e.action?t("div"):e._e(),t("button",{staticClass:"messages__button_send",attrs:{type:"button"},on:{click:function(s){return s.preventDefault(),e.sendMessage()}}},[e._v(" "+e._s(e.translations.send)+" ")])])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])}),b=[],h=(t("ad9c"),t("25d9")),j=t.n(h),v=t("82c5"),y=t.n(v),k=(t("8dff"),function(){return'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n'}),z={name:"AttachDocument",props:{user:Number,fnum:String,applicant:Boolean},components:{vueDropzone:j.a},data:function(){return{translations:{sendDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND_DOCUMENT"),askDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_ASK_DOCUMENT"),DropHere:Joomla.JText._("COM_EMUNDUS_MESSENGER_DROP_HERE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND")},dropzoneOptions:{url:"index.php?option=com_emundus_messenger&controller=messages&task=uploaddocument&fnum="+this.fnum,maxFilesize:10,maxFiles:1,autoProcessQueue:!1,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,previewTemplate:k()},types:[],message:"",loading:!1,action:1}},methods:{beforeClose:function(){},afterAdded:function(){document.getElementById("dropzone-message").style.display="none"},afterRemoved:function(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){"success"==e.status&&this.$emit("pushAttachmentMessage",JSON.parse(e.xhr.response).data)},catchError:function(e,s,t){y.a.fire({title:Joomla.JText._("COM_EMUNDUS_ONBOARD_ERROR"),text:s,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},thumbnail:function(e,s){var t,a,n,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),n=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),t=0,a=n.length;t<a;t++)o=n[t],o.alt=e.name,o.style.backgroundImage='url("'+s+'")';return setTimeout(function(s){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},getTypesByCampaign:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getdocumentsbycampaign"}).then((function(s){e.types=s.data.data}))},sendMessage:function(){this.$refs.dropzone.processQueue()}}},C=z,w=t("2877"),E=Object(w["a"])(C,_,b,!1,null,null,null),M=E.exports,S=t("8dff"),x={name:"Messages",props:{user:Number,fnum:String,notifications:Object},components:{InfiniteLoading:f.a,AttachDocument:M},data:function(){return{dates:[],messages:[],campaigns:[],campaignSelected:0,message:"",loading:!1,interval:0,showDate:0,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE")}}},methods:{moment:function(e){return p()(e)},beforeClose:function(){clearInterval(this.interval)},getCampaignsByUser:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getcampaignsbyuser"}).then((function(s){e.campaigns=s.data.data,""!=e.fnum?e.campaignSelected=e.fnum:e.campaignSelected=e.campaigns[0].fnum,e.getMessagesByFnum(!0),e.interval=setInterval((function(){e.getMessagesByFnum(!1,!1)}),2e4)}))},getMessagesByFnum:function(){var e=this,s=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading=s,l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getmessagesbyfnum",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return S.stringify(e)}}).then((function(s){e.messages=s.data.data.messages,e.dates=s.data.data.dates,e.markAsRead(),t&&e.scrollToBottom(),e.loading=!1}))},markAsRead:function(){var e=this;l()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=markasread",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return S.stringify(e)}}).then((function(s){e.$emit("removeNotifications",s.data.data)}))},sendMessage:function(e){var s=this;"undefined"!=typeof e&&e.stopImmediatePropagation(),""!==this.message&&l()({method:"post",url:"index.php?option=com_emundus_messenger&controller=messages&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:S.stringify({message:this.message,fnum:this.campaignSelected})}).then((function(e){s.message="";var t=e.data.date_time.split(" ")[0];s.dates.forEach((function(a,n){a.dates==t&&s.dates[n].messages.push(e.data.message_id)})),s.messages.push(e.data),s.scrollToBottom()}))},scrollToBottom:function(){setTimeout((function(){var e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight}),500)},attachDocument:function(){this.$modal.show("attach_documents")}},watch:{campaignSelected:function(){this.getMessagesByFnum(!0)}}},D=x,O=Object(w["a"])(D,r,d,!1,null,null,null),N=O.exports,T=t("4328"),B={name:"Notifications",props:{user:Number,fnum:String},components:{Messages:N},data:function(){return{counter:0,notifications:{}}},methods:{openModal:function(){this.$modal.show("messages")},getNotifications:function(){var e=this;c()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getnotifications",params:{user:this.user},paramsSerializer:function(e){return T.stringify(e)}}).then((function(s){null!=s.data.data&&(e.counter=s.data.data.notifications,e.notifications=s.data.data)}))},removeNotifications:function(e){this.counter-=e}},created:function(){var e=this;this.getNotifications(),setInterval((function(){e.getNotifications()}),2e4)}},U=B,R=(t("2d6c"),Object(w["a"])(U,n,o,!1,null,null,null)),J=R.exports,$=t("1881"),A=t.n($);a["a"].config.productionTip=!1,a["a"].config.devtools=!0,a["a"].use(A.a),document.getElementById("em-notifications")&&new a["a"]({el:"#em-notifications",render:function(e){return e(J,{props:{user:this.$el.attributes.user.value,fnum:this.$el.attributes.fnum.value}})}})},bc4a:function(e,s,t){},be46:function(e,s,t){},c7bc:function(e,s,t){},e11d:function(e,s,t){var a={"./af":"ed89","./af.js":"ed89","./ar":"f5e2","./ar-dz":"5140","./ar-dz.js":"5140","./ar-kw":"ab77","./ar-kw.js":"ab77","./ar-ly":"cfd6","./ar-ly.js":"cfd6","./ar-ma":"450e","./ar-ma.js":"450e","./ar-sa":"0eb7","./ar-sa.js":"0eb7","./ar-tn":"b115","./ar-tn.js":"b115","./ar.js":"f5e2","./az":"e70b","./az.js":"e70b","./be":"77c6","./be.js":"77c6","./bg":"cf5a","./bg.js":"cf5a","./bm":"1757","./bm.js":"1757","./bn":"c970","./bn-bd":"7b40","./bn-bd.js":"7b40","./bn.js":"c970","./bo":"96fb","./bo.js":"96fb","./br":"d4d1","./br.js":"d4d1","./bs":"0f60","./bs.js":"0f60","./ca":"d300","./ca.js":"d300","./cs":"2e9a","./cs.js":"2e9a","./cv":"30ff","./cv.js":"30ff","./cy":"07cc","./cy.js":"07cc","./da":"17fa","./da.js":"17fa","./de":"06d7","./de-at":"e62b","./de-at.js":"e62b","./de-ch":"d394","./de-ch.js":"d394","./de.js":"06d7","./dv":"cc7a","./dv.js":"cc7a","./el":"b792","./el.js":"b792","./en-au":"9d19","./en-au.js":"9d19","./en-ca":"144c","./en-ca.js":"144c","./en-gb":"5a95","./en-gb.js":"5a95","./en-ie":"b879","./en-ie.js":"b879","./en-il":"f996","./en-il.js":"f996","./en-in":"f987","./en-in.js":"f987","./en-nz":"a35b","./en-nz.js":"a35b","./en-sg":"7c39","./en-sg.js":"7c39","./eo":"2829","./eo.js":"2829","./es":"4e3f","./es-do":"ed07","./es-do.js":"ed07","./es-mx":"56fe","./es-mx.js":"56fe","./es-us":"0b17","./es-us.js":"0b17","./es.js":"4e3f","./et":"5aa8","./et.js":"5aa8","./eu":"d82a","./eu.js":"d82a","./fa":"a3a1","./fa.js":"a3a1","./fi":"b0ff","./fi.js":"b0ff","./fil":"3738","./fil.js":"3738","./fo":"dcd2","./fo.js":"dcd2","./fr":"17c5","./fr-ca":"dd83","./fr-ca.js":"dd83","./fr-ch":"06e4","./fr-ch.js":"06e4","./fr.js":"17c5","./fy":"cc78","./fy.js":"cc78","./ga":"ed36","./ga.js":"ed36","./gd":"c4d3","./gd.js":"c4d3","./gl":"63b0","./gl.js":"63b0","./gom-deva":"183d","./gom-deva.js":"183d","./gom-latn":"52a7","./gom-latn.js":"52a7","./gu":"dc55","./gu.js":"dc55","./he":"088c","./he.js":"088c","./hi":"ce9b","./hi.js":"ce9b","./hr":"b2d1","./hr.js":"b2d1","./hu":"8036","./hu.js":"8036","./hy-am":"1b1f","./hy-am.js":"1b1f","./id":"67db","./id.js":"67db","./is":"fe16","./is.js":"fe16","./it":"4819","./it-ch":"0bf6","./it-ch.js":"0bf6","./it.js":"4819","./ja":"8f0d","./ja.js":"8f0d","./jv":"f9f4","./jv.js":"f9f4","./ka":"edb6","./ka.js":"edb6","./kk":"af96","./kk.js":"af96","./km":"5614","./km.js":"5614","./kn":"9291","./kn.js":"9291","./ko":"e631","./ko.js":"e631","./ku":"29c3","./ku.js":"29c3","./ky":"d1dc","./ky.js":"d1dc","./lb":"029d","./lb.js":"029d","./lo":"9a85","./lo.js":"9a85","./lt":"08df","./lt.js":"08df","./lv":"57dc","./lv.js":"57dc","./me":"6a95","./me.js":"6a95","./mi":"743e","./mi.js":"743e","./mk":"0b1a","./mk.js":"0b1a","./ml":"35c7","./ml.js":"35c7","./mn":"97a3","./mn.js":"97a3","./mr":"fca2","./mr.js":"fca2","./ms":"a512","./ms-my":"3779","./ms-my.js":"3779","./ms.js":"a512","./mt":"28ed","./mt.js":"28ed","./my":"78cc","./my.js":"78cc","./nb":"0130","./nb.js":"0130","./ne":"8e22","./ne.js":"8e22","./nl":"e529","./nl-be":"57cf","./nl-be.js":"57cf","./nl.js":"e529","./nn":"8e34","./nn.js":"8e34","./oc-lnc":"0bd2","./oc-lnc.js":"0bd2","./pa-in":"ff8d","./pa-in.js":"ff8d","./pl":"a883","./pl.js":"a883","./pt":"44b5","./pt-br":"c3ab","./pt-br.js":"c3ab","./pt.js":"44b5","./ro":"37d1","./ro.js":"37d1","./ru":"fd32","./ru.js":"fd32","./sd":"6b66","./sd.js":"6b66","./se":"a330","./se.js":"a330","./si":"47e7","./si.js":"47e7","./sk":"ab19","./sk.js":"ab19","./sl":"b242","./sl.js":"b242","./sq":"d033","./sq.js":"d033","./sr":"8096","./sr-cyrl":"2192","./sr-cyrl.js":"2192","./sr.js":"8096","./ss":"c7be","./ss.js":"c7be","./sv":"1c8f","./sv.js":"1c8f","./sw":"f09e","./sw.js":"f09e","./ta":"0a53","./ta.js":"0a53","./te":"b30b","./te.js":"b30b","./tet":"d019","./tet.js":"d019","./tg":"5487","./tg.js":"5487","./th":"761e","./th.js":"761e","./tk":"2ebd","./tk.js":"2ebd","./tl-ph":"1723","./tl-ph.js":"1723","./tlh":"0bc7","./tlh.js":"0bc7","./tr":"5a87","./tr.js":"5a87","./tzl":"21ed","./tzl.js":"21ed","./tzm":"35c5","./tzm-latn":"5003","./tzm-latn.js":"5003","./tzm.js":"35c5","./ug-cn":"cb0c","./ug-cn.js":"cb0c","./uk":"a1a4","./uk.js":"a1a4","./ur":"3bfd","./ur.js":"3bfd","./uz":"f0fc","./uz-latn":"65e7","./uz-latn.js":"65e7","./uz.js":"f0fc","./vi":"3ea8","./vi.js":"3ea8","./x-pseudo":"68a3","./x-pseudo.js":"68a3","./yo":"a309","./yo.js":"a309","./zh-cn":"b6b9","./zh-cn.js":"b6b9","./zh-hk":"18c7","./zh-hk.js":"18c7","./zh-mo":"f99f","./zh-mo.js":"f99f","./zh-tw":"369d","./zh-tw.js":"369d"};function n(e){var s=o(e);return t(s)}function o(e){if(!t.o(a,e)){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=o,e.exports=n,n.id="e11d"}});
//# sourceMappingURL=app.js.map