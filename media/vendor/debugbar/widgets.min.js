if(void 0===PhpDebugBar){var PhpDebugBar={};PhpDebugBar.$=jQuery}!function(e){PhpDebugBar.Widgets={};var t=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),a=PhpDebugBar.Widgets.htmlize=function(e){return e.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},s=PhpDebugBar.Widgets.renderValue=function(e,t){return"string"!=typeof e?t?a(JSON.stringify(e,void 0,2)):JSON.stringify(e):e},i=PhpDebugBar.Widgets.highlight=function(e,t){return"string"==typeof e?"undefined"==typeof hljs?a(e):t?hljs.highlight(t,e).value:hljs.highlightAuto(e).value:("object"==typeof hljs&&e.each((function(e,t){hljs.highlightBlock(t)})),e)},l=PhpDebugBar.Widgets.createCodeBlock=function(a,s,l,n){var r=e("<pre />").addClass(t("code-block")),d=e("<code />").text(a+"\n").appendTo(r);if(e.isNumeric(n)&&(e.isNumeric(l)&&(n=n-l+1),d.html((function(e,a){var s=1;return a.replace(/^.*$/gm,(function(e){return s++==n?'<span class="'+t("highlighted-line")+'">'+e+"</span>":e}))}))),s&&r.addClass("language-"+s),i(r),e.isNumeric(l)){var p=a.split("\n").length,o=e("<ul />").prependTo(r);r.children().addClass(t("numbered-code"));for(var h=l;h<l+p;h++)e("<li />").text(h).appendTo(o)}return r},n=PhpDebugBar.Widgets.ListWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:t("list"),initialize:function(e){e.itemRenderer||(e.itemRenderer=this.itemRenderer),this.set(e)},render:function(){this.bindAttr(["itemRenderer","data"],(function(){if(this.$el.empty(),this.has("data"))for(var a=this.get("data"),s=0;s<a.length;s++){var i=e("<li />").addClass(t("list-item")).appendTo(this.$el);this.get("itemRenderer")(i,a[s])}}))},itemRenderer:function(e,t){e.html(s(t))}}),r=PhpDebugBar.Widgets.KVListWidget=n.extend({tagName:"dl",className:t("kvlist"),render:function(){this.bindAttr(["itemRenderer","data"],(function(){if(this.$el.empty(),this.has("data")){var a=this;e.each(this.get("data"),(function(s,i){var l=e("<dt />").addClass(t("key")).appendTo(a.$el),n=e("<dd />").addClass(t("value")).appendTo(a.$el);a.get("itemRenderer")(l,n,s,i)}))}}))},itemRenderer:function(e,t,s,i){e.text(s),t.html(a(i))}});PhpDebugBar.Widgets.VariableListWidget=r.extend({className:t("kvlist varlist"),itemRenderer:function(a,s,i,n){e("<span />").attr("title",i).text(i).appendTo(a);var r=n;r&&r.length>100&&(r=r.substr(0,100)+"...");var d=null;s.text(r).click((function(){s.hasClass(t("pretty"))?s.text(r).removeClass(t("pretty")):(d=d||l(n),s.addClass(t("pretty")).empty().append(d))}))}}),PhpDebugBar.Widgets.HtmlVariableListWidget=r.extend({className:t("kvlist htmlvarlist"),itemRenderer:function(t,a,s,i){e("<span />").attr("title",s).text(s).appendTo(t),a.html(i)}}),PhpDebugBar.Widgets.IFrameWidget=PhpDebugBar.Widget.extend({tagName:"iframe",className:t("iframe"),render:function(){this.$el.attr({seamless:"seamless",border:"0",width:"100%",height:"100%"}),this.bindAttr("data",(function(e){this.$el.attr("src",e)}))}}),PhpDebugBar.Widgets.MessagesWidget=PhpDebugBar.Widget.extend({className:t("messages"),render:function(){var a=this;this.$list=new n({itemRenderer:function(a,s){if(s.message_html)var i=e("<span />").addClass(t("value")).html(s.message_html).appendTo(a);else{var n=s.message;n.length>100&&(n=n.substr(0,100)+"...");i=e("<span />").addClass(t("value")).text(n).appendTo(a);if(!s.is_string||s.message.length>100){var r=s.message;s.is_string||(r=null),a.css("cursor","pointer").click((function(){i.hasClass(t("pretty"))?i.text(n).removeClass(t("pretty")):(r=r||l(s.message,"php"),i.addClass(t("pretty")).empty().append(r))}))}}s.collector&&e("<span />").addClass(t("collector")).text(s.collector).prependTo(a),s.label&&(i.addClass(t(s.label)),e("<span />").addClass(t("label")).text(s.label).prependTo(a))}}),this.$list.$el.appendTo(this.$el),this.$toolbar=e('<div><i class="phpdebugbar-fa phpdebugbar-fa-search"></i></div>').addClass(t("toolbar")).appendTo(this.$el),e('<input type="text" aria-label="Search" placeholder="Search" />').on("change",(function(){a.set("search",this.value)})).appendTo(this.$toolbar),this.bindAttr("data",(function(a){this.set({exclude:[],search:""}),this.$toolbar.find(t(".filter")).remove();for(var s=[],i=this,l=0;l<a.length;l++)!a[l].label||e.inArray(a[l].label,s)>-1||(s.push(a[l].label),e("<a />").addClass(t("filter")).text(a[l].label).attr("rel",a[l].label).on("click",(function(){i.onFilterClick(this)})).appendTo(this.$toolbar))})),this.bindAttr(["exclude","search"],(function(){var t=this.get("data"),a=this.get("exclude"),s=this.get("search"),i=!1,l=[];s&&s===s.toLowerCase()&&(i=!0);for(var n=0;n<t.length;n++){var r=i?t[n].message.toLowerCase():t[n].message;t[n].label&&-1!==e.inArray(t[n].label,a)||s&&!(r.indexOf(s)>-1)||l.push(t[n])}this.$list.set("data",l)}))},onFilterClick:function(a){e(a).toggleClass(t("excluded"));var s=[];this.$toolbar.find(t(".filter")+t(".excluded")).each((function(){s.push(this.rel)})),this.set("exclude",s)}}),PhpDebugBar.Widgets.TimelineWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:t("timeline"),render:function(){this.bindAttr("data",(function(a){if(this.$el.empty(),a.measures){for(var s={},i=0;i<a.measures.length;i++){var l=a.measures[i];s[l.label]||(s[l.label]={count:0,duration:0}),s[l.label].count+=1,s[l.label].duration+=l.duration;var n=e("<div />").addClass(t("measure")),r=e("<li />"),d=(100*l.relative_start/a.duration).toFixed(2),p=Math.min((100*l.duration/a.duration).toFixed(2),100-d);if(n.append(e("<span />").addClass(t("value")).css({left:d+"%",width:p+"%"})),n.append(e("<span />").addClass(t("label")).text(l.label+" ("+l.duration_str+")")),l.collector&&e("<span />").addClass(t("collector")).text(l.collector).appendTo(n),n.appendTo(r),this.$el.append(r),l.params&&!e.isEmptyObject(l.params)){var o=e('<table><tr><th colspan="2">Params</th></tr></table>').addClass(t("params")).appendTo(r);for(var h in l.params)"function"!=typeof l.params[h]&&o.append('<tr><td class="'+t("name")+'">'+h+'</td><td class="'+t("value")+'"><pre><code>'+l.params[h]+"</code></pre></td></tr>");r.css("cursor","pointer").click((function(){var t=e(this).find("table");t.is(":visible")?t.hide():t.show()}))}}s=e.map(s,(function(e,t){return{label:t,data:e}})).sort((function(e,t){return t.data.duration-e.data.duration}));var c=e('<table style="display: table; border: 0; width: 99%"></table>').addClass(t("params"));e.each(s,(function(e,s){var i;p=Math.min((100*s.data.duration/a.duration).toFixed(2),100),c.append('<tr><td class="'+t("name")+'">'+s.data.count+" x "+s.label+" ("+p+'%)</td><td class="'+t("value")+'"><div class="'+t("measure")+'"><span class="'+t("value")+'" style="width:'+p+'%"></span><span class="'+t("label")+'">'+(((i=s.data.duration)<.001?(1e6*i).toFixed()+"Î¼s":i<1?(1e3*i).toFixed(2)+"ms":i.toFixed(2)+"s")+"</span></div></td></tr>"))})),this.$el.append("<li/>").find("li:last").append(c)}}))}}),PhpDebugBar.Widgets.ExceptionsWidget=PhpDebugBar.Widget.extend({className:t("exceptions"),render:function(){this.$list=new n({itemRenderer:function(a,s){if(e("<span />").addClass(t("message")).text(s.message).appendTo(a),s.file){var i=e("<span />").addClass(t("filename")).text(s.file+"#"+s.line);s.xdebug_link&&(s.xdebug_link.ajax?e('<a title="'+s.xdebug_link.url+'"></a>').on("click",(function(){e.ajax(s.xdebug_link.url)})).addClass(t("editor-link")).appendTo(i):e('<a href="'+s.xdebug_link.url+'"></a>').addClass(t("editor-link")).appendTo(i)),i.appendTo(a)}if(s.type&&e("<span />").addClass(t("type")).text(s.type).appendTo(a),s.surrounding_lines){var n=l(s.surrounding_lines.join(""),"php").addClass(t("file")).appendTo(a);s.stack_trace_html||a.click((function(){n.is(":visible")?n.hide():n.show()}))}s.stack_trace_html?e("<span />").addClass(t("filename")).html(s.stack_trace_html).appendTo(a):s.stack_trace&&s.stack_trace.split("\n").forEach((function(s){var i=e("<div />");e("<span />").addClass(t("filename")).text(s).appendTo(i),i.appendTo(a)}))}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",(function(e){this.$list.set("data",e),1==e.length&&this.$list.$el.children().first().find(t(".file")).show()}))}})}(PhpDebugBar.$);