(function(e){function s(s){for(var a,r,o=s[0],m=s[1],l=s[2],u=0,g=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&g.push(n[r][0]),n[r]=0;for(a in m)Object.prototype.hasOwnProperty.call(m,a)&&(e[a]=m[a]);c&&c(s);while(g.length)g.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var e,s=0;s<i.length;s++){for(var t=i[s],a=!0,o=1;o<t.length;o++){var m=t[o];0!==n[m]&&(a=!1)}a&&(i.splice(s--,1),e=r(r.s=t[0]))}return e}var a={},n={app:0},i=[];function r(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=a,r.d=function(e,s,t){r.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,s){if(1&s&&(e=r(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)r.d(t,a,function(s){return e[s]}.bind(null,a));return t},r.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(s,"a",s),s},r.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],m=o.push.bind(o);o.push=s,o=o.slice();for(var l=0;l<o.length;l++)s(o[l]);var c=m;i.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"16b4":function(e,s,t){},"367a":function(e,s,t){},"56d7":function(e,s,t){"use strict";t.r(s);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__vue"},[t("span",{attrs:{id:"messages"}},[t("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"70%",scrollable:!0,delay:100,clickToClose:!0},on:{opened:e.getCampaignsByUser}},[t("div",{staticClass:"drag-window"},[t("div",{staticClass:"col-md-3 messages__campaigns-list"},e._l(e.campaigns,(function(s){return t("div",{staticClass:"messages__block",class:s.fnum==e.campaignSelected?"messages__active-campaign":"",on:{click:function(t){e.campaignSelected=s.fnum}}},[t("div",{staticClass:"messages__campaign-block"},[t("img",{staticClass:"messages__campaigns_folder-icon",attrs:{src:"/images/emundus/messenger/folder.svg"}}),t("span",{staticClass:"messages__campaigns_title"},[e._v(e._s(s.label))])])])})),0),t("div",{staticClass:"messages__list col-md-9"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.messages,(function(s){return t("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left"},[t("p",[t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(s.name))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user"},[e._v(e._s(s.message))])])])})),0),t("div",{staticClass:"messages__bottom-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),e.sendMessage(s))},input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/send.svg"},on:{click:e.sendMessage}})])])])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},i=[],r=(t("a9e3"),t("bc3a")),o=t.n(r),m=(t("16b4"),t("367a"),t("4328")),l={name:"Messages",props:{user:Number,notifications:Object},components:{},data:function(){return{messages:[],campaigns:[],campaignSelected:0,message:"",loading:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE")}}},methods:{getCampaignsByUser:function(){var e=this;o()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getcampaignsbyuser"}).then((function(s){e.campaigns=s.data.data,e.campaignSelected=e.campaigns[0].fnum}))},getMessagesByFnum:function(){var e=this;this.loading=!0,o()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getmessagesbyfnum",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return m.stringify(e)}}).then((function(s){e.messages=s.data.data,e.markAsRead(),e.scrollToBottom(),e.loading=!1}))},markAsRead:function(){var e=this;o()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=markasread",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return m.stringify(e)}}).then((function(s){e.$emit("removeNotifications",s.data.data)}))},sendMessage:function(){var e=this;""!==this.message&&o()({method:"post",url:"index.php?option=com_emundus_messenger&controller=messages&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:m.stringify({message:this.message,fnum:this.campaignSelected})}).then((function(s){e.message="",e.messages.push(s.data),e.scrollToBottom()}))},scrollToBottom:function(){setTimeout((function(){var e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight}),500)}},created:function(){},watch:{campaignSelected:function(){this.getMessagesByFnum()}}},c=l,u=t("2877"),g=Object(u["a"])(c,n,i,!1,null,null,null),d=g.exports,_=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"messages__coordinator_vue"},[t("div",{staticClass:"messages__list col-md-12"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.messages,(function(s){return t("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left"},[t("p",[t("em",{staticClass:"messages__message-item-from"},[e._v(e._s(s.name))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user"},[e._v(e._s(s.message))])])])})),0),t("div",{staticClass:"messages__bottom-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.preventDefault(),e.sendMessage(s))},input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/send.svg"},on:{click:e.sendMessage}})])]),e.loading?t("div",{staticClass:"loader"}):e._e()])},p=[],f=t("4328"),h={name:"MessagesCoordinator",props:{fnum:String,user:Number},components:{},data:function(){return{messages:[],campaignSelected:0,message:"",loading:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE")}}},methods:{getMessagesByFnum:function(){var e=this;this.loading=!0,o()({method:"get",url:"index.php?option=com_emundus_messenger&controller=messages&task=getmessagesbyfnum",params:{fnum:this.campaignSelected},paramsSerializer:function(e){return f.stringify(e)}}).then((function(s){e.messages=s.data.data,e.scrollToBottom(),e.loading=!1}))},sendMessage:function(){var e=this;""!==this.message&&o()({method:"post",url:"index.php?option=com_emundus_messenger&controller=messages&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:f.stringify({message:this.message,fnum:this.campaignSelected})}).then((function(s){e.message="",e.messages.push(s.data),e.scrollToBottom()}))},scrollToBottom:function(){setTimeout((function(){var e=document.getElementsByClassName("messages__list-block")[0];e.scrollTop=e.scrollHeight}),500)}},created:function(){"undefined"!=typeof this.fnum&&(this.campaignSelected=this.fnum)},watch:{campaignSelected:function(){this.getMessagesByFnum()}}},v=h,y=Object(u["a"])(v,_,p,!1,null,null,null),b=y.exports,C=t("d277");a["a"].config.productionTip=!1,a["a"].config.devtools=!0,a["a"].use(C),document.getElementById("em-messages-vue")&&new a["a"]({el:"#em-messages-vue",render:function(e){return e(d,{props:{fnum:this.$el.attributes.fnum.value,user:this.$el.attributes.user.value,modal:this.$el.attributes.modal.value}})}}),document.getElementById("em-messages-coordinator-vue")&&new a["a"]({el:"#em-messages-coordinator-vue",render:function(e){return e(b,{props:{fnum:this.$el.attributes.fnum.value,user:this.$el.attributes.user.value}})}})}});
//# sourceMappingURL=app.js.map