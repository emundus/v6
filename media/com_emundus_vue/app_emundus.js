(function(e){function t(t){for(var s,o,l=t[0],r=t[1],c=t[2],m=0,u=[];m<l.length;m++)o=l[m],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&u.push(i[o][0]),i[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);d&&d(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,l=1;l<a.length;l++){var r=a[l];0!==i[r]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},i={app:0},n=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0066":function(e,t,a){},"049c":function(e,t,a){"use strict";a("0066")},"0619":function(e,t,a){},"0709":function(e,t,a){},"0718":function(e,t,a){"use strict";a("dcb5")},"07c5":function(e,t,a){},"0888":function(e,t,a){},"090a":function(e,t,a){},"0921":function(e,t,a){"use strict";a("1c98")},"092e":function(e,t,a){"use strict";a("1ac9")},"0987":function(e,t,a){"use strict";a("2675")},"0a1f":function(e,t,a){},"0d40":function(e,t,a){},"0d61":function(e,t,a){"use strict";a("f0a4")},"0dd4":function(e,t,a){"use strict";a("1017")},"0fd2":function(e,t,a){},"0fd5":function(e,t,a){var s={"./af":"8206","./af.js":"8206","./ar":"cdac","./ar-dz":"7f26","./ar-dz.js":"7f26","./ar-kw":"8e88","./ar-kw.js":"8e88","./ar-ly":"cd65","./ar-ly.js":"cd65","./ar-ma":"e8d6","./ar-ma.js":"e8d6","./ar-sa":"a284","./ar-sa.js":"a284","./ar-tn":"64f7","./ar-tn.js":"64f7","./ar.js":"cdac","./az":"b139","./az.js":"b139","./be":"98e2","./be.js":"98e2","./bg":"a1a5","./bg.js":"a1a5","./bm":"4d0d","./bm.js":"4d0d","./bn":"e8ae","./bn-bd":"5dd8","./bn-bd.js":"5dd8","./bn.js":"e8ae","./bo":"bcf2","./bo.js":"bcf2","./br":"69f1","./br.js":"69f1","./bs":"24d1","./bs.js":"24d1","./ca":"3507","./ca.js":"3507","./cs":"d15f","./cs.js":"d15f","./cv":"7bfe","./cv.js":"7bfe","./cy":"1d35","./cy.js":"1d35","./da":"a019","./da.js":"a019","./de":"0cfa","./de-at":"edea","./de-at.js":"edea","./de-ch":"9aae","./de-ch.js":"9aae","./de.js":"0cfa","./dv":"1722","./dv.js":"1722","./el":"5390","./el.js":"5390","./en-au":"dad9","./en-au.js":"dad9","./en-ca":"6f13","./en-ca.js":"6f13","./en-gb":"6267","./en-gb.js":"6267","./en-ie":"80b1","./en-ie.js":"80b1","./en-il":"ad38","./en-il.js":"ad38","./en-in":"eb60","./en-in.js":"eb60","./en-nz":"39db","./en-nz.js":"39db","./en-sg":"c30d","./en-sg.js":"c30d","./eo":"1a30","./eo.js":"1a30","./es":"48a3","./es-do":"f306","./es-do.js":"f306","./es-mx":"56d9","./es-mx.js":"56d9","./es-us":"60bf","./es-us.js":"60bf","./es.js":"48a3","./et":"f891","./et.js":"f891","./eu":"a403","./eu.js":"a403","./fa":"ce14","./fa.js":"ce14","./fi":"fc14","./fi.js":"fc14","./fil":"f46e","./fil.js":"f46e","./fo":"2bf2","./fo.js":"2bf2","./fr":"c1e8","./fr-ca":"50a2","./fr-ca.js":"50a2","./fr-ch":"b087","./fr-ch.js":"b087","./fr.js":"c1e8","./fy":"4665","./fy.js":"4665","./ga":"b396","./ga.js":"b396","./gd":"056c","./gd.js":"056c","./gl":"efde","./gl.js":"efde","./gom-deva":"12ea","./gom-deva.js":"12ea","./gom-latn":"8e2c","./gom-latn.js":"8e2c","./gu":"533d","./gu.js":"533d","./he":"7520","./he.js":"7520","./hi":"d2f3","./hi.js":"d2f3","./hr":"7e79","./hr.js":"7e79","./hu":"148f","./hu.js":"148f","./hy-am":"6711","./hy-am.js":"6711","./id":"2b10","./id.js":"2b10","./is":"1feb","./is.js":"1feb","./it":"1b21","./it-ch":"8d2c","./it-ch.js":"8d2c","./it.js":"1b21","./ja":"926e","./ja.js":"926e","./jv":"5a78","./jv.js":"5a78","./ka":"5975","./ka.js":"5975","./kk":"cc93","./kk.js":"cc93","./km":"66e1","./km.js":"66e1","./kn":"5421","./kn.js":"5421","./ko":"1297","./ko.js":"1297","./ku":"16f8","./ku.js":"16f8","./ky":"3df9","./ky.js":"3df9","./lb":"c124","./lb.js":"c124","./lo":"20a5","./lo.js":"20a5","./lt":"c14a","./lt.js":"c14a","./lv":"c553","./lv.js":"c553","./me":"ae25","./me.js":"ae25","./mi":"6f56","./mi.js":"6f56","./mk":"c8fc","./mk.js":"c8fc","./ml":"752d","./ml.js":"752d","./mn":"f09e","./mn.js":"f09e","./mr":"0a56","./mr.js":"0a56","./ms":"55b6","./ms-my":"a9e9","./ms-my.js":"a9e9","./ms.js":"55b6","./mt":"624b","./mt.js":"624b","./my":"e256","./my.js":"e256","./nb":"e1d5","./nb.js":"e1d5","./ne":"761a","./ne.js":"761a","./nl":"a0f2","./nl-be":"5cb2","./nl-be.js":"5cb2","./nl.js":"a0f2","./nn":"4fda","./nn.js":"4fda","./oc-lnc":"ec3d","./oc-lnc.js":"ec3d","./pa-in":"2f2f","./pa-in.js":"2f2f","./pl":"317f","./pl.js":"317f","./pt":"5553","./pt-br":"a9ab","./pt-br.js":"a9ab","./pt.js":"5553","./ro":"db12","./ro.js":"db12","./ru":"7aa4","./ru.js":"7aa4","./sd":"e87b","./sd.js":"e87b","./se":"a296","./se.js":"a296","./si":"51ec","./si.js":"51ec","./sk":"608b","./sk.js":"608b","./sl":"b367","./sl.js":"b367","./sq":"f68f","./sq.js":"f68f","./sr":"0991","./sr-cyrl":"c577","./sr-cyrl.js":"c577","./sr.js":"0991","./ss":"cf76","./ss.js":"cf76","./sv":"0153","./sv.js":"0153","./sw":"cb6f","./sw.js":"cb6f","./ta":"8bfa","./ta.js":"8bfa","./te":"668b","./te.js":"668b","./tet":"eae7","./tet.js":"eae7","./tg":"70b1","./tg.js":"70b1","./th":"7180","./th.js":"7180","./tk":"4912","./tk.js":"4912","./tl-ph":"f8bb","./tl-ph.js":"f8bb","./tlh":"b026","./tlh.js":"b026","./tr":"371d","./tr.js":"371d","./tzl":"c744","./tzl.js":"c744","./tzm":"787a","./tzm-latn":"71e0","./tzm-latn.js":"71e0","./tzm.js":"787a","./ug-cn":"6b5c","./ug-cn.js":"6b5c","./uk":"8c0c","./uk.js":"8c0c","./ur":"519e","./ur.js":"519e","./uz":"7982","./uz-latn":"3137","./uz-latn.js":"3137","./uz.js":"7982","./vi":"ae22","./vi.js":"ae22","./x-pseudo":"1129","./x-pseudo.js":"1129","./yo":"b4bf","./yo.js":"b4bf","./zh-cn":"fdc4","./zh-cn.js":"fdc4","./zh-hk":"747d","./zh-hk.js":"747d","./zh-mo":"fe39","./zh-mo.js":"fe39","./zh-tw":"d3e0","./zh-tw.js":"d3e0"};function i(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id="0fd5"},1:function(e,t){},"100b":function(e,t,a){"use strict";a("cbac")},1017:function(e,t,a){},1024:function(e,t,a){},1074:function(e,t,a){},1106:function(e,t,a){},"11fe":function(e,t,a){"use strict";a("7c99")},1353:function(e,t,a){"use strict";a("07c5")},1655:function(e,t,a){},"178e":function(e,t,a){},1795:function(e,t,a){"use strict";a("498e")},"1ac9":function(e,t,a){},"1c98":function(e,t,a){},2051:function(e,t,a){e.exports={"row-fluid":"formbuilder_row-fluid_1_FRK","control-group":"formbuilder_control-group_25KA8",fabrikElementContainer:"formbuilder_fabrikElementContainer_3Urmr",fabrikLabel:"formbuilder_fabrikLabel_GywiO","control-label":"formbuilder_control-label_7ELCw",fabrikTip:"formbuilder_fabrikTip_2Sgca","icon-star":"formbuilder_icon-star_ZpyzP",small:"formbuilder_small_31_V_"}},"21c8":function(e,t,a){"use strict";a("963a")},2209:function(e,t,a){"use strict";a("0d40")},2356:function(e,t,a){"use strict";a("8ab9")},"23c5":function(e,t,a){"use strict";a("178e")},2429:function(e,t,a){"use strict";a("a92f")},2675:function(e,t,a){},"268f":function(e,t,a){"use strict";a("1655")},"2a42":function(e,t,a){"use strict";a("1074")},"2a7e":function(e,t,a){},"2bb7":function(e,t,a){},"2d28":function(e,t,a){"use strict";a("cc04")},"2d8d":function(e,t,a){"use strict";a("f4e2")},"2f77":function(e,t,a){"use strict";a("455c")},"2fe3":function(e,t,a){},3208:function(e){e.exports=JSON.parse('{"field":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE","name":"password","type":"dropdown","options":[{"value":0,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_TEXT"},{"value":3,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_EMAIL"},{"value":5,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_LINK"},{"value":6,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_NUMBER"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_PLACEHOLDER","name":"placeholder","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_HELPTEXT","name":"rollover","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_MAXLENGTH","name":"maxlength","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_TITLE","name":"text_input_mask","type":"text","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_HINT","placeholder":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_PLACEHOLDER","published":true,"sysadmin_only":false}],"textarea":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_DISPLAY_LABEL","name":"textarea_showlabel","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":false,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_PLACEHOLDER","name":"textarea_placeholder","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_WYSIWIG","name":"use_wysiwyg","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT","name":"textarea-maxlength","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_SHOWMAX_LIMIT","name":"textarea-showmax","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE","name":"textarea_limit_type","type":"dropdown","options":[{"value":"char","label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE_CHARACTERS"},{"value":"word","label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE_WORDS"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"checkbox":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CHECKBOX_OPTIONS_PER_ROW","name":"ck_options_per_row","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"radiobutton":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_RADIOBUTTON_OPTIONS_PER_ROW","name":"options_per_row","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"birthday":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_ADVANCED","name":"advanced_behavior","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":false,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD","name":"birthday_yearopt","type":"dropdown","options":[{"value":"number","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_YEARS_NUMBER"},{"value":"since","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_SINCE_YEAR"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_NUMBER","name":"birthday_yearstart","type":"number","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_NUMBER_TIP","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_YEARS_FUTURE_PAST","name":"birthday_forward","type":"number","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_YEARS_FUTURE_PAST_TIP","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_FORMAT","name":"list_date_format","type":"dropdown","options":[{"value":"d.m.Y","label":"21.12.2022"},{"value":"m.d.Y","label":"12.21.2022"},{"value":"d/m/Y","label":"21/12/2022"},{"value":"d m","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_FORMAT_D_M"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"yesno":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_YESNO_DEFAULT_VALUE","name":"yesno_default","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"calc":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALC_VALUE","name":"calc_calculation","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"databasejoin":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE","name":"database_join_display_type","type":"dropdown","options":[{"value":"dropdown","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_DROPDOWN"},{"value":"radio","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_RADIO"},{"value":"auto-complete","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_AUTOCOMPLETE"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_TABLE","name":"join_db_name","type":"databasejoin","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_VALUE","name":"join_key_column","type":"databasejoin_cascade","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_LABEL","name":"join_val_column","type":"databasejoin_cascade","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_LABEL_CONCAT","name":"join_val_column_concat","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_SHOW_PLEASE_SELECT","name":"database_join_show_please_select","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_WHERE","name":"database_join_where_sql","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_WHERE_AJAX","name":"databasejoin_where_ajax","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"date":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_DEFAULT_TODAY","name":"date_defaulttotoday","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_FIRST_DAY","name":"date_firstday","type":"dropdown","options":[{"value":0,"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_SUNDAY"},{"value":1,"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_MONDAY"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}]}')},3380:function(e,t,a){"use strict";a("fb04")},"33f2":function(e,t,a){"use strict";a("8602")},"367a":function(e,t,a){e.exports={app:"messenger_app_1_wpb",messages__vue:"messenger_messages__vue_wc18U","vm--container":"messenger_vm--container_1-Y1-",scrollable:"messenger_scrollable_1lv4s","vm--modal":"messenger_vm--modal_YInqZ","messages__campaigns-list-select":"messenger_messages__campaigns-list-select_2s7nD","messages__campaigns-list":"messenger_messages__campaigns-list_1WqUA","drag-window":"messenger_drag-window_LsA3E",messages__block:"messenger_messages__block_1fPjJ","messages__campaign-block":"messenger_messages__campaign-block_2gRfr","messages__active-campaign":"messenger_messages__active-campaign_1q1D4",messages__list:"messenger_messages__list_3Pvcg","messages__list-block":"messenger_messages__list-block_1ldNN","messages__bottom-input":"messenger_messages__bottom-input_2unUJ","messages__bottom-input-actions":"messenger_messages__bottom-input-actions_2YlSw",messages__input_text:"messenger_messages__input_text_5cjRs","messages__send-icon":"messenger_messages__send-icon_QYqff",messages__current_user:"messenger_messages__current_user_1v2DR",messages__other_user:"messenger_messages__other_user_FC20o","messages__message-item":"messenger_messages__message-item_2znU8","messages__message-item-block":"messenger_messages__message-item-block_1OiIb","messages__message-item-span":"messenger_messages__message-item-span_1Uaw3","messages__message-item-span_current-user":"messenger_messages__message-item-span_current-user_iYFdF","messages__message-item-span_other-user":"messenger_messages__message-item-span_other-user_3vS4G","messages__message-item-from":"messenger_messages__message-item-from_3Fd7t",messages__campaigns_title:"messenger_messages__campaigns_title_2OFiR",messages__campaigns_fnum:"messenger_messages__campaigns_fnum_1SjD1","messages__campaigns_folder-icon":"messenger_messages__campaigns_folder-icon_3ZWHH","messages__text-align-right":"messenger_messages__text-align-right_2NZ1L","messages__text-align-left":"messenger_messages__text-align-left_2VyzM",message__header:"messenger_message__header_1NcqQ",messages__send_button:"messenger_messages__send_button_3PsfC",loader:"messenger_loader_2s1lH",spin:"messenger_spin_3BMjc",pointer:"messenger_pointer_1Vxlz","messages__date-section":"messenger_messages__date-section_dI2fV",messages__actions_bar:"messenger_messages__actions_bar_eS_Ia",messages__attach_content:"messenger_messages__attach_content_1jCCU",messages__attach_actions_tabs:"messenger_messages__attach_actions_tabs_3qEDY",messages__attach_action:"messenger_messages__attach_action_3j70e",messages__attach_action__current:"messenger_messages__attach_action__current_22fvD",messages__button_send:"messenger_messages__button_send_lHsB5",messages__download_icon:"messenger_messages__download_icon_2ICtv",messages__attach_applicant_doc:"messenger_messages__attach_applicant_doc_1_Kkl",customdropzone_messenger:"messenger_customdropzone_messenger_p3pr1","dz-preview":"messenger_dz-preview_2tFq3","dz-image":"messenger_dz-image_fsVk4","dz-details":"messenger_dz-details_3Y3u9","dz-success-mark":"messenger_dz-success-mark_3nxKc","dz-default":"messenger_dz-default_1Ztvs","dz-message":"messenger_dz-message_p7095","dz-error-mark":"messenger_dz-error-mark_3jKgf","slide-fade-enter-active":"messenger_slide-fade-enter-active_2G13G","slide-fade-leave-active":"messenger_slide-fade-leave-active__OQGC","slide-fade-enter":"messenger_slide-fade-enter_xhzOu","slide-right-enter-active":"messenger_slide-right-enter-active_2vzUN","slide-right-leave-active":"messenger_slide-right-leave-active_rnJdy","slide-right-enter":"messenger_slide-right-enter_4FLGS","slide-right-leave-to":"messenger_slide-right-leave-to_6cMAc","slide-down-enter-active":"messenger_slide-down-enter-active_2baMB","slide-down-leave-active":"messenger_slide-down-leave-active_3m48j","slide-down-enter":"messenger_slide-down-enter_NVuAn","slide-down-leave-to":"messenger_slide-down-leave-to_2I3cK","slide-up-enter-active":"messenger_slide-up-enter-active_3FLho","slide-up-leave-active":"messenger_slide-up-leave-active_1W0jE","slide-up-enter":"messenger_slide-up-enter_346xg","slide-up-leave-to":"messenger_slide-up-leave-to_3yqPj","move-right-enter-active":"messenger_move-right-enter-active_3YPOY","move-right-leave-active":"messenger_move-right-leave-active_f3kNx","move-right-enter":"messenger_move-right-enter_35zVk","move-right-leave-to":"messenger_move-right-leave-to_3Wmlg","move-left-enter-active":"messenger_move-left-enter-active_3-Muk","move-left-leave-active":"messenger_move-left-leave-active_1l_j1","move-left-enter":"messenger_move-left-enter_2ioo-","move-left-leave-to":"messenger_move-left-leave-to_2Mfsb","little-move-right-enter-active":"messenger_little-move-right-enter-active_guPN7","little-move-right-leave-active":"messenger_little-move-right-leave-active_3RHqI","little-move-right-enter":"messenger_little-move-right-enter_CynDI","little-move-right-leave-to":"messenger_little-move-right-leave-to_1dwJw","little-move-left-enter-active":"messenger_little-move-left-enter-active_fGMd_","little-move-left-leave-active":"messenger_little-move-left-leave-active_2CE77","little-move-left-enter":"messenger_little-move-left-enter_DbHzM","little-move-left-leave-to":"messenger_little-move-left-leave-to_1ZwJR"}},"36fe":function(e,t,a){"use strict";a("6eca")},"37ba":function(e,t,a){},3923:function(e,t,a){},3940:function(e,t,a){"use strict";a("bba0")},"3a70":function(e,t,a){"use strict";a("85a0")},"3d3d":function(e,t,a){"use strict";a("0fd2")},"3d63":function(e,t,a){},"3ec9":function(e,t,a){},"40cb":function(e,t,a){},4298:function(e,t,a){},"455c":function(e,t,a){},4938:function(e,t,a){},"498e":function(e,t,a){},"49e9":function(e,t,a){},"49f6":function(e,t,a){"use strict";a("bf66")},"4a5f":function(e,t,a){"use strict";a("40cb")},"4c13":function(e){e.exports=JSON.parse('{"parameters":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_INTRO","name":"intro","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_OUTRO","name":"outro","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT","name":"repeat_group_button","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT_MIN","name":"repeat_min","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT_MAX","name":"repeat_max","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false}]}')},"4cea":function(e,t,a){"use strict";a("a4bc")},"4d24":function(e,t,a){},"4dc7":function(e,t,a){},"4dec":function(e,t,a){},"4eb7":function(e,t,a){},"4f19":function(e,t,a){},"4f82":function(e,t,a){},5114:function(e,t,a){"use strict";a("4938")},"532a":function(e,t,a){"use strict";a("37ba")},5561:function(e,t,a){"use strict";a("bcfd")},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("e832"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"com_emundus_vue em-flex-column em-flex-col-center"},["attachments"===e.component?a("Attachments",{attrs:{fnum:e.data.fnum,user:e.data.user,defaultAttachments:e.data.attachments?e.data.attachments:null}}):"files"===e.component?a("Files",{attrs:{type:e.data.type,user:e.data.user,ratio:e.data.ratio}}):a("transition",{attrs:{name:"slide-right"}},[a(e.$props.component,{tag:"component"})],1)],1)},n=[],o=a("4e22"),l=a.n(o),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-w-100",attrs:{id:"em-attachments"}},[a("div",{staticClass:"wrapper",class:{loading:e.loading}},[a("div",{staticClass:"em-flex-row em-flex-space-between",attrs:{id:"filters"}},[a("div",{staticClass:"em-flex-row searchbar-wrapper"},[a("input",{ref:"searchbar",attrs:{id:"searchbar",type:"text",placeholder:e.translate("COM_EMUNDUS_ACTIONS_SEARCH")},on:{input:e.searchInFiles}}),a("span",{staticClass:"material-icons-outlined search"},[e._v("search")]),a("span",{staticClass:"material-icons-outlined clear em-pointer",on:{click:e.resetSearch}},[e._v("clear")])]),a("div",{staticClass:"actions em-flex-row"},[Object.entries(e.thisAttachmentCategories).length>0?a("select",{ref:"categoryFilter",staticClass:"category-select",attrs:{name:"category"},on:{change:e.filterByCategory}},[a("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SELECT_CATEGORY")))]),e._l(e.thisAttachmentCategories,(function(t,s){return a("option",{key:s,domProps:{value:s}},[e._v(" "+e._s(t)+" ")])}))],2):e._e(),e.canExport?a("div",{staticClass:"btn-icon-text",class:{disabled:e.checkedAttachments.length<1},on:{click:e.exportAttachments}},[a("span",{staticClass:"material-icons-outlined export em-mr-8"},[e._v("file_upload")]),a("span",[e._v(e._s(e.translate("COM_EMUNDUS_EXPORTS_EXPORT")))])]):e._e(),e.sync&&e.canSync?a("div",{staticClass:"btn-icon-text",class:{disabled:e.checkedAttachments.length<1},on:{click:function(t){return e.synchronizeAttachments(e.checkedAttachments)}}},[a("span",{staticClass:"material-icons cloud_sync",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_TITLE")}},[e._v(" cloud_sync ")]),a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_TITLE")))])]):e._e(),a("span",{staticClass:"material-icons-outlined refresh em-pointer",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_REFRESH_TITLE")},on:{click:function(t){return e.refreshAttachments(!0)}}},[e._v(" autorenew ")]),e.canDelete?a("span",{staticClass:"material-icons-outlined delete",class:{disabled:e.checkedAttachments.length<1},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_DELETE_TITLE")},on:{click:e.confirmDeleteAttachments}},[e._v(" delete_outlined ")]):e._e()])]),a("div",{staticClass:"em-mt-16 em-mb-16"},[e.exportLink?a("a",{attrs:{href:e.exportLink,target:"_blank"},on:{click:function(t){e.exportLink=""}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_EXPORT_LINK"))+" ")]):e._e()]),e.attachments.length?a("div",{staticClass:"table-wrapper"},[a("table",{class:{loading:e.loading},attrs:{"aria-describedby":"Table of attachments information"}},[a("thead",[a("tr",[a("th",{attrs:{id:"check-th"}},[a("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},on:{change:e.updateAllCheckedAttachments}})]),e.columns.includes("name")?a("th",{attrs:{id:"name"},on:{click:function(t){return e.orderBy("value")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_NAME"))+" "),"value"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"value"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("date")?a("th",{staticClass:"date",attrs:{id:"date"},on:{click:function(t){return e.orderBy("timedate")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE"))+" "),"timedate"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"timedate"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("desc")?a("th",{staticClass:"desc",attrs:{id:"desc"},on:{click:function(t){return e.orderBy("upload_description")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_DESCRIPTION"))+" "),"upload_description"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"upload_description"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("category")?a("th",{staticClass:"category",attrs:{id:"category"},on:{click:function(t){return e.orderBy("category")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY"))+" "),"category"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"category"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("status")?a("th",{staticClass:"status",attrs:{id:"status"},on:{click:function(t){return e.orderBy("is_validated")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CHECK"))+" "),"is_validated"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"is_validated"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.canSee&&e.columns.includes("user")?a("th",{attrs:{id:"user"},on:{click:function(t){return e.orderBy("user_id")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY"))+" "),"user_id"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"user_id"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.canSee&&e.columns.includes("modified_by")?a("th",{attrs:{id:"modified_by"},on:{click:function(t){return e.orderBy("modified_by")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY"))+" "),"modified_by"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"modified_by"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("modified")?a("th",{staticClass:"date",attrs:{id:"modified"},on:{click:function(t){return e.orderBy("modified")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE"))+" "),"modified"==e.sort.orderBy&&"asc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_upward")]):e._e(),"modified"==e.sort.orderBy&&"desc"==e.sort.order?a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("permissions")?a("th",{staticClass:"permissions",attrs:{id:"permissions"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSIONS")))]):e._e(),e.sync&&e.columns.includes("sync")?a("th",{staticClass:"sync",attrs:{id:"sync"},on:{click:function(t){return e.orderBy("sync")}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC"))+" ")]):e._e()])]),a("tbody",e._l(e.displayedAttachments,(function(t){return a("AttachmentRow",{key:t.aid,attrs:{attachment:t,checkedAttachmentsProp:e.checkedAttachments,canUpdate:e.canUpdate,sync:e.sync,canSee:e.canSee,columns:e.$props.columns},on:{"open-modal":function(a){return e.openModal(t)},"update-checked-attachments":e.updateCheckedAttachments,"update-status":e.updateStatus,"change-permission":e.changePermission}})})),1)])]):a("p",[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_NO_ATTACHMENTS_FOUND"))+" ")])]),a("modal",{attrs:{id:"edit-modal",name:"edit",resizable:!0,draggable:!0,styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"}},[a("div",{staticClass:"modal-head em-w-100 em-flex-row em-flex-space-between"},[a("div",{staticClass:"em-flex-row em-flex-start",attrs:{id:"actions-left"}},[a("span",[e._v(e._s(e.selectedAttachment.filename))])]),a("div",{staticClass:"em-flex-row",attrs:{id:"actions-right"}},[e.sync&&e.syncSelectedPreview?a("a",{staticClass:"download btn-icon-text em-mr-24",attrs:{href:e.syncSelectedPreview,target:"_blank"}},[a("span",{staticClass:"material-icons-outlined"},[e._v("open_in_new")]),a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_OPEN_IN_GED")))])]):e._e(),e.canDownload?a("a",{staticClass:"download btn-icon-text em-mr-24",attrs:{download:"",href:e.attachmentPath}},[a("span",{staticClass:"material-icons"},[e._v(" file_download ")]),a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_LINK_TO_DOWNLOAD")))])]):e._e(),a("div",{staticClass:"prev-next-attachments em-flex-row em-flex-space-between em-mr-8"},[a("div",{staticClass:"prev em-flex-row em-mr-4",class:{active:e.selectedAttachmentPosition>0},on:{click:function(t){return e.changeAttachment(e.selectedAttachmentPosition-1,!0)}}},[a("span",{staticClass:"material-icons"},[e._v(" navigate_before ")])]),a("span",{staticClass:"lvl"},[e._v(e._s(e.selectedAttachmentPosition+1)+" /"+e._s(e.displayedAttachments.length))]),a("div",{staticClass:"next em-flex-row em-ml-4",class:{active:e.selectedAttachmentPosition<e.displayedAttachments.length-1},on:{click:function(t){return e.changeAttachment(e.selectedAttachmentPosition+1)}}},[a("span",{staticClass:"material-icons"},[e._v(" navigate_next ")])])]),a("span",{staticClass:"material-icons em-pointer",on:{click:e.closeModal}},[e._v("close")])])]),a("transition",{attrs:{name:e.slideTransition},on:{"before-leave":e.beforeLeaveSlide}},[!e.modalLoading&&e.displayedUser.user_id&&e.displayedFnum?a("div",{staticClass:"modal-body em-flex-row",class:{"only-preview":e.onlyPreview}},[a("AttachmentPreview",{attrs:{user:e.displayedUser.user_id},on:{fileNotFound:function(t){e.canDownload=!1},canDownload:function(t){e.canDownload=!0}}}),e.displayEdit?a("AttachmentEdit",{attrs:{fnum:e.displayedFnum,"is-displayed":!e.onlyPreview},on:{closeModal:e.closeModal,saveChanges:e.updateAttachment,"update-displayed":e.toggleOnlyPreview}}):e._e()],1):e._e()])],1),e.loading?a("div",{staticClass:"vue-em-loader em-loader"}):e._e()],1)},c=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"em-attachment-preview"}},[a("div",{ref:"a-preview",staticClass:"attachment-preview",class:{"overflow-x":e.overflowX,"overflow-y":e.overflowY,hidden:!e.needShadowDOM}}),e.needShadowDOM?e._e():a("div",{staticClass:"attachment-preview",domProps:{innerHTML:e._s(e.preview)}}),a("div",{class:{active:e.msg&&e.openMsg},attrs:{id:"msg"}},[a("p",[e._v(e._s(e.msg))])])])},m=[],u=a("7338"),p=a.n(u);const _="undefined"!=typeof Joomla&&null!==Joomla?Joomla.getOptions("system.paths"):{base:""};p.a.defaults.baseURL=void 0!==_.base&&""!==_.base?_.base:"/";var h=(e={"Content-Type":"application/json","Cache-Control":"no-cache"})=>p.a.create({timeout:3e4,headers:e,responseType:"json",withCredentials:!0}),g={async getAttachmentProgress(e){try{const t=await h().get("index.php?option=com_emundus&controller=files&task=getattachmentprogress",{params:{fnum:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentsByUser(e){try{const t=await h().get("index.php?option=com_emundus&controller=application&task=getuserattachments",{params:{user_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentsByFnum(e){try{const t=await h().get("index.php?option=com_emundus&controller=application&task=getattachmentsbyfnum",{params:{fnum:e}});return t.data.status&&("string"===typeof t.data.attachments&&(t.data.attachments=JSON.parse(t.data.attachments)),"object"===typeof t.data.attachments&&(t.data.attachments=Object.values(t.data.attachments)),t.data.attachments.forEach(e=>{null===e.is_validated&&(e.is_validated=-2),e.show=!0})),t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentCategories(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=getattachmentcategories");return e.data}catch(e){return{status:!1,msg:e.message}}},async deleteAttachments(e,t,a){try{const s=new FormData;return s.append("ids",JSON.stringify(a)),await h().post(`index.php?option=com_emundus&controller=application&task=deleteattachement&fnum=${e}&student_id=${t}`,s,{headers:{"Content-Type":"multipart/form-data"}})}catch(s){return{status:!1,msg:s.message}}},async updateAttachment(e){try{const t=await h().post("index.php?option=com_emundus&controller=application&task=updateattachment",e,{headers:{"Content-Type":"multipart/form-data"}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getPreview(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=application&task=getattachmentpreview",{params:{user:e,filename:t}});return a.data}catch(a){return{status:!1,msg:a.message}}},exportAttachments(e,t,a){const s=new FormData;return s.append("attachments_only",!0),s.append("student_id",e),s.append("fnum",t),a.forEach(e=>{s.append("ids[]",e)}),h().post("index.php?option=com_emundus&controller=application&task=exportpdf",s,{headers:{"Content-Type":"multipart/form-data"}})},async getProfileAttachments(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getprofileattachments");return e.data}catch(e){return{status:!1,msg:e.message}}},async getProfileAttachmentsAllowed(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getprofileattachmentsallowed");return e.data}catch(e){return{status:!1,msg:e.message}}},async deleteProfileAttachment(e,t){try{const a=await h().delete("index.php?option=com_emundus&controller=users&task=deleteprofileattachment",{params:{id:e,filename:t}});return a.data}catch(a){return{status:!1,msg:a.message}}},async isExpiresDateDisplayed(){try{const e=await h().get("index.php?option=com_emundus&controller=settings&task=isexpiresdatedisplayed");return e.data}catch(e){return{status:!1,msg:e.message}}}},f={props:{user:{type:Number,required:!0}},data(){return{attachment:this.$store.state.attachment.selectedAttachment,preview:"",overflowX:!1,overflowY:!1,style:"",msg:"",openMsg:!1,needShadowDOM:!1}},mounted(){"function"===typeof this.$refs["a-preview"].attachShadow&&this.$refs["a-preview"].attachShadow({mode:"open"}),this.attachment=this.$store.state.attachment.selectedAttachment,this.getPreview()},methods:{async getPreview(){let e;switch(this.$store.state.attachment.previews[this.attachment.aid]?e=this.$store.state.attachment.previews[this.attachment.aid]:(e=await g.getPreview(this.user,this.attachment.filename),e.status&&this.$store.commit("attachment/setPreview",{preview:e,id:this.attachment.aid})),this.$emit("canDownload"),e.status?(this.preview=e.content,this.overflowX=e.overflowX,this.overflowY=e.overflowY,this.style=e.style,e.msg&&(this.msg=e.msg,this.openMsg=!0,setTimeout(()=>{this.openMsg=!1},3e3))):("file_not_found"===e.error&&this.$emit("fileNotFound"),this.overflowX=!1,this.overflowY=!1,this.preview=e.content,this.msg=""),this.style){case"sheet":case"presentation":case"word":this.needShadowDOM=!0;break;default:this.needShadowDOM=!1;break}this.needShadowDOM?(this.$refs["a-preview"].shadowRoot.innerHTML=null!=this.preview?this.preview:"","sheet"==this.style?this.addSheetStyles():"presentation"==this.style?this.addPresentationStyles():"word"==this.style&&this.addWordStyles()):this.$refs["a-preview"].shadowRoot.innerHTML=""},addSheetStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelectorAll("div");e.forEach((e,t)=>{e.style.width="fit-content",e.style.margin="20px auto",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",t>0&&(e.style.display="none")});const t=this.$refs["a-preview"].shadowRoot.querySelector(".navigation");t&&(t.style.display="flex",t.style.flexDirection="row",t.style.justifyContent="flex-start",t.style.alignItems="center",t.querySelectorAll("li").forEach((t,a)=>{t.style.listStyleType="none",t.style.margin="0 10px",t.addEventListener("click",()=>{e.forEach((e,t)=>{e.style.display=t==a?"block":"none"})})}))},addPresentationStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelectorAll(".slide");e.forEach(e=>{e.style.padding="16px",e.style.margin="20px",e.style.width="calc(100% - 72px)",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",e.style.borderRadius="8px",e.style.backgroundColor="white"})},addWordStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelector(".wrapper");e&&(e.style.border="var(--border-color)",e.style.boxShadow="var(--box-shadow)",e.style.backgroundColor="white",e.style.padding="20px",e.style.margin="16px",e.style.overflow="hidden")}},watch:{"$store.state.attachment.selectedAttachment":function(){const e=Object.keys(this.$store.state.attachment.selectedAttachment);0!==e.length&&(this.attachment=this.$store.state.attachment.selectedAttachment,this.openMsg=!1,this.getPreview())}}},v=f,b=(a("e1bc"),a("17e1")),E=Object(b["a"])(v,d,m,!1,null,null,null),O=E.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"attachment-edit"}},[a("div",{staticClass:"wrapper"},[a("h2",{staticClass:"title"},[e._v(e._s(e.attachment.value))]),a("div",{staticClass:"editable-data"},[a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"description"}},[e._v(e._s(e.translate("DESCRIPTION")))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.attachmentDescription,expression:"attachmentDescription"}],attrs:{name:"description",id:"description",type:"text",disabled:!e.canUpdate},domProps:{value:e.attachmentDescription},on:{focusout:e.saveChanges,input:function(t){t.target.composing||(e.attachmentDescription=t.target.value)}}})]),a("div",{staticClass:"input-group valid-state",class:{success:1==e.attachmentIsValidated,warning:2==e.attachmentIsValidated,error:0==e.attachmentIsValidated}},[a("label",{attrs:{for:"status"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CHECK")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.attachmentIsValidated,expression:"attachmentIsValidated"}],attrs:{name:"status",disabled:!e.canUpdate},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachmentIsValidated=t.target.multiple?a:a[0]},e.updateAttachmentStatus]}},[a("option",{attrs:{value:"1"}},[e._v(e._s(e.translate("VALID")))]),a("option",{attrs:{value:"0"}},[e._v(e._s(e.translate("INVALID")))]),a("option",{attrs:{value:"2"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WARNING")))]),a("option",{attrs:{value:"-2"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WAITING")))])])]),e.canUpdate?a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"replace"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_REPLACE")))]),a("input",{attrs:{type:"file",name:"replace",accept:e.allowedType},on:{change:e.updateFile}})]):e._e(),a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"can_be_viewed"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_VIEWED")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.attachmentCanBeViewed,expression:"attachmentCanBeViewed"}],attrs:{type:"checkbox",name:"can_be_viewed",disabled:!e.canUpdate},domProps:{checked:Array.isArray(e.attachmentCanBeViewed)?e._i(e.attachmentCanBeViewed,null)>-1:e.attachmentCanBeViewed},on:{click:e.saveChanges,change:function(t){var a=e.attachmentCanBeViewed,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.attachmentCanBeViewed=a.concat([n])):o>-1&&(e.attachmentCanBeViewed=a.slice(0,o).concat(a.slice(o+1)))}else e.attachmentCanBeViewed=i}}})]),a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"can_be_deleted"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_DELETED")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.attachmentCanBeDeleted,expression:"attachmentCanBeDeleted"}],attrs:{type:"checkbox",name:"can_be_deleted",disabled:!e.canUpdate},domProps:{checked:Array.isArray(e.attachmentCanBeDeleted)?e._i(e.attachmentCanBeDeleted,null)>-1:e.attachmentCanBeDeleted},on:{click:e.saveChanges,change:function(t){var a=e.attachmentCanBeDeleted,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.attachmentCanBeDeleted=a.concat([n])):o>-1&&(e.attachmentCanBeDeleted=a.slice(0,o).concat(a.slice(o+1)))}else e.attachmentCanBeDeleted=i}}})])]),a("div",{staticClass:"non-editable-data"},[a("div",[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE")))]),a("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.formattedDate(e.attachment.timedate)))])]),e.attachment.user_id&&e.canSee?a("div",[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY")))]),a("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.getUserNameById(e.attachment.user_id)))])]):e._e(),e.attachment.category?a("div",[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY")))]),a("span",{staticClass:"em-text-align-right"},[e._v(e._s(this.categories[e.attachment.category]))])]):e._e(),e.attachment.modified_by&&e.canSee?a("div",[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY")))]),a("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.getUserNameById(e.attachment.modified_by)))])]):e._e(),e.attachment.modified?a("div",[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE")))]),a("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.formattedDate(e.attachment.modified)))])]):e._e()])]),a("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[a("div",{attrs:{id:"toggle-display"}},[e.displayed?a("span",{staticClass:"material-icons-outlined displayed em-pointer",on:{click:function(t){return e.toggleDisplay(!1)}}},[e._v(" chevron_right ")]):a("span",{staticClass:"material-icons-outlined not-displayed em-pointer",on:{click:function(t){return e.toggleDisplay(!0)}}},[e._v(" menu_open ")])])]),e.error?a("div",{staticClass:"error-msg"},[e._v(e._s(e.errorMessage))]):e._e()])},y=[],D={async getUsers(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getusers");return{data:e.data,status:!0}}catch(e){return{status:!1,msg:e.message}}},async getUserById(e){try{const t=await h().get("index.php?option=com_emundus&controller=users&task=getuserbyid",{params:{id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAccessRights(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=users&task=getattachmentaccessrights",{params:{id:e,fnum:t}});return a.data}catch(a){return{status:!1,msg:a.message}}},async getProfileForm(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getprofileform");return e.data}catch(e){return{status:!1,msg:e.message}}},async getProfileGroups(e){try{const t=await h().get("index.php?option=com_emundus&controller=users&task=getprofilegroups",{params:{formid:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getProfileElements(e){try{const t=await h().get("index.php?option=com_emundus&controller=users&task=getprofileelements",{params:{groupid:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async saveUser(e){try{return await h().post("index.php?option=com_emundus&controller=users&task=saveuser",JSON.stringify(e),{headers:{"Content-Type":"application/json"}})}catch(t){return{status:!1,msg:t.message}}},async updateProfilePicture(e){try{const t=new FormData;return t.append("file",e),await h().post("index.php?option=com_emundus&controller=users&task=updateprofilepicture",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}}},M={mimeTypes:{aac:"audio/aac",abw:"application/x-abiword",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip",mp4:"video/mp4",mov:"video/mov"}},N={methods:{formattedDate:function(e="",t="LLLL",a=0){let s="";return null!==e&&(s=""!==e?l()(e).utcOffset(a).format(t):l()().utcOffset(a).format(t)),s},strippedHtml:function(e){return null===e||void 0===e?"":e.replace(/<(?:.|\n)*?>/gm,"")},getUserNameById:function(e){let t="";if(e=parseInt(e),e>0){const a=this.$store.state.user.users[e];a?t=a.firstname+" "+a.lastname:D.getUserById(e).then(a=>{a.status&&a.user[0]&&(t=a.user[0].firstname+" "+a.user[0].lastname,a.user[0].id=e,this.$store.dispatch("user/setUsers",a.user))})}return t},async getAttachmentCategories(){const e=await g.getAttachmentCategories();return!0===e.status?(Object.entries(e.categories).forEach(([t,a])=>{e.categories[t]=this.translate(a)}),delete e.categories[""],this.$store.dispatch("attachment/setCategories",e.categories),e.categories):{}},async asyncForEach(e,t){for(let a=0;a<e.length;a++)await t(e[a],a,e)},getMimeTypeFromExtension(e){return!!M.mimeTypes.hasOwnProperty(e)&&M.mimeTypes[e]},checkMaxMinlength(e,t,a=null){e.target.textContent.length>=t&&8!=e.keyCode&&e.preventDefault(),null!==a&&e.target.textContent.length<=a&&8==e.keyCode&&e.preventDefault()},differencesBetweenObjetcs(e,t,a=null){let s=[];if(null===a){const s=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);a=Array.from(new Set(s.concat(i)))}return a=a.filter(e=>"__ob__"!==e),a.forEach(a=>{(void 0===typeof e[a]||void 0===typeof t[a]||e[a]!=t[a]&&("object"!=typeof e[a]||"object"==typeof e[a]&&JSON.stringify(e[a])!==JSON.stringify(t[a])))&&s.push(a)}),s},tip(e,t="",a="Information"){this.$notify({group:e,title:""+a,text:t,duration:3e3})}}},A=N,S={name:"AttachmentEdit",props:{fnum:{type:String,required:!0},isDisplayed:{type:Boolean,default:!0}},mixins:[A],data(){return{displayed:!0,attachment:{},categories:{},file:null,canUpdate:!1,canSee:!0,error:!1,errorMessage:"",attachmentIsValidated:"-2",attachmentCanBeViewed:!1,attachmentCanBeDeleted:!1,attachmentDescription:""}},mounted(){this.displayed=this.isDisplayed,this.canUpdate=!!this.$store.state.user.rights[this.fnum]&&this.$store.state.user.rights[this.fnum].canUpdate,this.canSee=!this.$store.state.global.anonyme,this.attachment=this.$store.state.attachment.selectedAttachment,this.categories=this.$store.state.attachment.categories,this.attachmentCanBeViewed="1"==this.attachment.can_be_viewed,this.attachmentCanBeDeleted="1"==this.attachment.can_be_deleted,this.attachmentDescription=this.attachment.upload_description,this.attachmentIsValidated=this.attachment.is_validated},methods:{async saveChanges(){let e=new FormData;const t=this.attachmentCanBeViewed?"1":"0",a=this.attachmentCanBeDeleted?"1":"0";e.append("fnum",this.fnum),e.append("user",this.$store.state.user.currentUser),e.append("id",this.attachment.aid),e.append("description",this.attachmentDescription),e.append("is_validated",this.attachmentIsValidated),e.append("can_be_viewed",t),e.append("can_be_deleted",a),this.file&&e.append("file",this.file);const s=await g.updateAttachment(e);if(s.status.update){if(this.attachment.modified_by=this.$store.state.user.currentUser,this.attachment.upload_description=this.attachmentDescription,this.attachment.is_validated=this.attachmentIsValidated,this.attachment.can_be_viewed=this.attachmentCanBeViewed,this.attachment.can_be_deleted=this.attachmentCanBeDeleted,this.$store.dispatch("attachment/updateAttachmentOfFnum",{fnum:this.fnum,attachment:this.attachment}),s.status.file_update){const e=await g.getPreview(this.$store.state.user.displayedUser,this.attachment.filename);this.$store.dispatch("attachment/setPreview",{preview:e,id:this.attachment.aid})}}else this.showError(s.msg)},updateFile(e){this.file=e.target.files[0],this.saveChanges()},updateAttachmentStatus(e){this.attachmentIsValidated=e.target.value,this.saveChanges()},showError(e){this.error=!0,this.errorMessage=e,setTimeout(()=>{this.error=!1,this.errorMessage=""},3e3)},toggleDisplay(e){this.displayed=e,this.$emit("update-displayed",this.displayed)}},computed:{allowedType(){let e="";return this.attachment.filename&&(e="."+this.attachment.filename.split(".").pop()),e}},watch:{"$store.state.attachment.selectedAttachment":function(){const e=Object.keys(this.$store.state.attachment.selectedAttachment);e.length>0&&(this.attachment=this.$store.state.attachment.selectedAttachment)}}},w=S,U=(a("82b5"),Object(b["a"])(w,C,y,!1,null,null,null)),T=U.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{key:e.attachment.aid,staticClass:"attachment-row",class:{checked:e.checkedAttachments.includes(e.attachment.aid)}},[a("td",[a("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},domProps:{checked:e.checkedAttachments.includes(e.attachment.aid)},on:{change:function(t){return e.updateCheckedAttachments(e.attachment.aid)}}})]),e.columns.includes("name")?a("td",{staticClass:"td-document",on:{click:e.openModal}},[a("span",[e._v(e._s(e.attachment.value))]),e.attachment.existsOnServer?e._e():a("span",{staticClass:"material-icons-outlined warning file-not-found",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_FILE_NOT_FOUND")}},[e._v(" warning ")])]):e._e(),e.columns.includes("date")?a("td",{staticClass:"date"},[e._v(e._s(e.formattedDate(e.attachment.timedate)))]):e._e(),e.columns.includes("desc")?a("td",{staticClass:"desc"},[e._v(" "+e._s(e.strippedHtml(e.attachment.upload_description)))]):e._e(),e.columns.includes("category")?a("td",{staticClass:"category"},[e._v(" "+e._s(e.category)+" ")]):e._e(),e.columns.includes("status")?a("td",{staticClass:"status valid-state",class:{success:1==e.attachment.is_validated,warning:2==e.attachment.is_validated,error:0==e.attachment.is_validated}},[a("select",{attrs:{disabled:!1===e.canUpdate},on:{change:function(t){return e.updateStatus(t)}}},[a("option",{attrs:{value:"1"},domProps:{selected:1==e.attachment.is_validated}},[e._v(" "+e._s(e.translate("VALID"))+" ")]),a("option",{attrs:{value:"0"},domProps:{selected:0==e.attachment.is_validated}},[e._v(" "+e._s(e.translate("INVALID"))+" ")]),a("option",{attrs:{value:"2"},domProps:{selected:2==e.attachment.is_validated}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WARNING"))+" ")]),a("option",{attrs:{value:"-2"},domProps:{selected:-2==e.attachment.is_validated||null===e.attachment.is_validated}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WAITING"))+" ")])])]):e._e(),e.canSee&&e.columns.includes("user")?a("td",[e._v(e._s(e.getUserNameById(e.attachment.user_id)))]):e._e(),e.canSee&&e.columns.includes("modified_by")?a("td",[e._v(e._s(e.getUserNameById(e.attachment.modified_by)))]):e._e(),e.columns.includes("modified")?a("td",{staticClass:"date"},[e._v(e._s(e.formattedDate(e.attachment.modified)))]):e._e(),e.columns.includes("permissions")?a("td",{staticClass:"permissions"},[a("span",{staticClass:"material-icons-outlined visibility-permission em-pointer",class:{active:"1"==e.attachment.can_be_viewed},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_VIEW")},on:{click:function(t){return e.changePermission("can_be_viewed",e.attachment)}}},[e._v("visibility")]),a("span",{staticClass:"material-icons-outlined delete-permission em-pointer",class:{active:"1"==e.attachment.can_be_deleted},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_DELETE")},on:{click:function(t){return e.changePermission("can_be_deleted",e.attachment)}}},[e._v("delete_outlined")])]):e._e(),e.sync&&e.columns.includes("sync")?a("td",[e.attachment.sync>0?a("div",["write"!=e.attachment.sync_method||e.syncLoading?"read"!=e.attachment.sync_method||e.syncLoading?e._e():a("span",{staticClass:"material-icons sync em-pointer",class:{success:1==e.synchronizeState,error:1!=e.synchronizeState},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_READ")},on:{click:function(t){return e.synchronizeAttachments(e.attachment.aid)}}},[e._v(" cloud_download ")]):a("span",{staticClass:"material-icons sync em-pointer",class:{success:1==e.synchronizeState,error:1!=e.synchronizeState},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_WRITE")},on:{click:function(t){return e.synchronizeAttachments(e.attachment.aid)}}},[e._v(" cloud_upload ")]),e.syncLoading?a("div",{staticClass:"sync-loader em-loader"}):e._e()]):e._e()]):e._e()])},x=[],L={async isSyncModuleActive(){try{const e=await h().get("index.php?option=com_emundus&controller=sync&task=issyncmoduleactive");return e.data}catch(e){return{status:!1,msg:e.message}}},async getSyncType(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getsynctype",{params:{upload_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getSynchronizeState(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getsynchronizestate",{params:{upload_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async synchronizeAttachments(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=synchronizeattachments",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async deleteAttachments(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=deleteattachments",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async checkAttachmentsExists(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=checkattachmentsexists",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async saveConfig(e,t){try{const a=new FormData;return a.append("config",JSON.stringify(e)),a.append("type",t),await h().post("index.php?option=com_emundus&controller=sync&task=saveconfig",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getConfig(e){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getconfig",{params:{type:e}})}catch(t){return{status:!1,msg:t.message}}},async getAttachmentAspectsConfig(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getattachmentaspectsconfig",{params:{attachmentId:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},saveAttachmentAspectsConfig(e,t){try{const a=new FormData;return a.append("attachmentId",e),a.append("config",JSON.stringify(t)),h().post("index.php?option=com_emundus&controller=sync&task=saveattachmentaspectsconfig",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getAspects(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getaspects")}catch(e){return{status:!1,msg:e.message}}},async uploadAspectFile(e){try{const t=new FormData;return t.append("file",e),await h().post("index.php?option=com_emundus&controller=sync&task=uploadaspectfile",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async updateAspectListFromFile(e){try{const t=new FormData;return t.append("file",e),await h().post("index.php?option=com_emundus&controller=sync&task=updateaspectlistfromfile",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async getDocuments(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getdocuments")}catch(e){return{status:!1,msg:e.message}}},async getEmundusTags(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getemundustags")}catch(e){return{status:!1,msg:e.message}}},async updateSync(e,t){try{const a=new FormData;return a.append("did",e),a.append("sync",t),await h().post("index.php?option=com_emundus&controller=sync&task=updatedocumentsync",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async updateSyncMethod(e,t){try{const a=new FormData;return a.append("did",e),a.append("sync_method",t),await h().post("index.php?option=com_emundus&controller=sync&task=updatedocumentsyncmethod",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getSetupTags(){try{const e=await h().get("index.php?option=com_emundus&controller=sync&task=getsetuptags");return e.data}catch(e){return{status:!1,msg:e.message}}},async getAttachmentSyncNodeId(e){let t=null;if("undefined"!=typeof e&&null!==e)try{const a=await h().get("index.php?option=com_emundus&controller=sync&task=getnodeid",{params:{uploadId:e}});a.status&&a.data.status&&(t=a.data.data)}catch(a){console.log("Error occurred trying to get upload sync node id "+e)}return t}},B={name:"AttachmentRow",props:{attachment:{type:Object,required:!0},checkedAttachmentsProp:{type:Array,required:!0},canUpdate:{type:Boolean,default:!1},sync:{type:Boolean,default:!1},canSee:{type:Boolean,default:!0},columns:{type:Array}},mixins:[A],data(){return{categories:{},category:"",checkedAttachments:[],synchronizeState:!1,syncLoading:!1}},mounted(){this.categories=this.$store.state.attachment.categories,Object.entries(this.categories).length>0&&(this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:""),this.checkedAttachments=this.checkedAttachmentsProp,this.sync&&this.getSynchronizeState(this.attachment.aid).then(e=>{this.synchronizeState=e}).catch(e=>{this.synchronizeState=!1})},methods:{updateCheckedAttachments(e){this.checkedAttachments.includes(e)?this.checkedAttachments.splice(this.checkedAttachments.indexOf(e),1):this.checkedAttachments.push(e),this.$emit("update-checked-attachments",this.checkedAttachments)},openModal(){this.$emit("open-modal",this.attachment)},updateStatus(e){this.canUpdate&&this.$emit("update-status",e,this.attachment)},changePermission(e,t){this.canUpdate&&this.$emit("change-permission",e,t)},async getSynchronizeState(e){const t=await L.checkAttachmentsExists([e]);return!!t.status&&t.data[0]},synchronizeAttachments(e){e.length>0&&(this.syncLoading=!0,L.synchronizeAttachments([e]).then(t=>{t&&!1===t.status||this.getSynchronizeState(e).then(e=>{this.synchronizeState=e,this.syncLoading=!1}).catch(e=>{this.synchronizeState=!1,this.syncLoading=!1})}))}},watch:{"$store.state.attachment.checkedAttachments":function(){this.checkedAttachments=this.$store.state.attachment.checkedAttachments},"$store.state.attachment.categories":function(){this.categories=this.$store.state.attachment.categories,this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:""}}},I=B,k=(a("2429"),Object(b["a"])(I,R,x,!1,null,null,null)),P=k.exports,F={async getFnums(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=getallfnums");return e.data}catch(e){return!1}},async getFnumInfos(e){try{const t=await h().get("index.php?option=com_emundus&controller=files&task=getfnuminfos",{params:{fnum:e}});return t.data}catch(t){return!1}},async isDataAnonymized(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=isdataanonymized");return e.data}catch(e){return{status:!1,message:e.message}}}},$=a("ac68"),j=a.n($),G={name:"Attachments",components:{AttachmentPreview:O,AttachmentEdit:T,AttachmentRow:P},props:{user:{type:String,required:!0},fnum:{type:String,required:!0},defaultAttachments:{type:Array,default:null},defaultRights:{type:Object,default:null},columns:{type:Array,default:["name","date","desc","category","status","user","modified_by","modified","permissions","sync"]},displayEdit:{type:Boolean,default:!0}},mixins:[A],data(){return{loading:!0,attachments:[],displayedAttachments:[],categories:{},fnums:[],users:[],displayedUser:{},displayedFnum:this.fnum,checkedAttachments:[],selectedAttachment:{},progress:"",sort:{last:"",order:"",orderBy:""},canSee:!0,canExport:!1,canDelete:!1,canDownload:!0,canUpdate:!1,canSync:!1,modalLoading:!1,slideTransition:"slide-fade",onlyPreview:!1,changeFileEvent:null,sync:!1,syncSelectedPreview:null,exportLink:""}},created(){this.canSee=!this.$store.state.global.anonyme,this.$store.dispatch("user/setCurrentUser",this.user),L.isSyncModuleActive().then(e=>{this.sync=e.data}).catch(e=>{this.sync=!1})},mounted(){this.loading=!0,this.setDisplayedUser().then(()=>{null!=this.defaultAttachments?this.getAttachmentCategories().then(e=>{this.categories=e||{},this.attachments=this.defaultAttachments,this.displayedAttachments=this.attachments,this.$store.dispatch("attachment/setAttachmentsOfFnum",{fnum:[this.displayedFnum],attachments:this.attachments}),this.setAccessRights().then(()=>{this.loading=!1})}):this.getAttachments().then(()=>{this.setAccessRights().then(()=>{this.loading=!1})}).catch(e=>{this.loading=!1,this.displayErrorMessage(e)})})},methods:{async setDisplayedUser(){const e=await F.getFnumInfos(this.displayedFnum);if(e&&e.fnumInfos){const t=!(!this.users||!this.users.length)&&this.users.find(t=>t.user_id==e.fnumInfos.applicant_id);if(t)this.displayedUser=t,this.$store.dispatch("user/setDisplayedUser",this.displayedUser.user_id),this.$store.dispatch("user/setUsers",[t]);else{const t=await D.getUserById(e.fnumInfos.applicant_id);t.status?(this.users.push(t.user[0]),this.displayedUser=t.user[0],this.$store.dispatch("user/setDisplayedUser",this.displayedUser.user_id),this.$store.dispatch("user/setUsers",t.user)):this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND"))}}else this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND"))},async getAttachments(){this.$store.state.attachment.attachments[this.displayedFnum]?(this.attachments=this.$store.state.attachment.attachments[this.displayedFnum],this.displayedAttachments=this.attachments,this.categories=this.$store.state.attachment.categories):await this.refreshAttachments()},async refreshAttachments(e=!1){!0===e&&(this.loading=!0),this.resetOrder(),this.checkedAttachments=[],this.$refs["searchbar"].value="";const t=await g.getAttachmentsByFnum(this.displayedFnum);if(t.status){this.attachments=t.attachments,this.displayedAttachments=this.attachments,this.$store.dispatch("attachment/setAttachmentsOfFnum",{fnum:[this.displayedFnum],attachments:this.attachments});const e=await this.getAttachmentCategories();this.categories=e||{}}else this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_ERROR_GETTING_ATTACHMENTS"));!0===e&&(this.loading=!1)},updateAttachment(){this.resetOrder(),this.getAttachments(),this.selectedAttachment={},this.checkedAttachments=[]},updateStatus(e,t){if(this.canUpdate){if(this.attachments.length<1)return;this.attachments.forEach((a,s)=>{if(a.aid==t.aid){this.resetOrder(),this.attachments[s].is_validated=e.target.value;let t=new FormData;t.append("fnum",this.displayedFnum),t.append("user",this.$store.state.user.currentUser),t.append("id",this.attachments[s].aid),t.append("is_validated",this.attachments[s].is_validated),g.updateAttachment(t).then(e=>{e&&!1===e.status&&this.displayErrorMessage(e.msg)}).catch(e=>{this.displayErrorMessage(e)})}})}},changePermission(e,t){this.canUpdate?this.attachments.forEach((a,s)=>{if(a.aid==t.aid){this.resetOrder(),this.attachments[s][e]="1"===this.attachments[s][e]?"0":"1";let t=new FormData;t.append("fnum",this.displayedFnum),t.append("user",this.$store.state.user.currentUser),t.append("id",this.attachments[s].aid),t.append(e,this.attachments[s][e]),g.updateAttachment(t).then(e=>{e.status||this.displayErrorMessage(e.msg)})}}):this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_UNAUTHORIZED_ACTION"))},synchronizeAttachments(e){e.length>0&&L.synchronizeAttachments(e).then(e=>{e&&!1===e.status?this.displayErrorMessage(e.msg):this.refreshAttachments(!0)})},async setAccessRights(){if(!this.$store.state.user.rights[this.displayedFnum]){const e=await D.getAccessRights(this.$store.state.user.currentUser,this.displayedFnum);!0===e.status&&this.$store.dispatch("user/setAccessRights",{fnum:this.displayedFnum,rights:e.rights})}this.canExport=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canExport,this.canDelete=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canDelete,this.canUpdate=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canUpdate},async exportAttachments(){this.canExport&&g.exportAttachments(this.displayedUser.user_id,this.displayedFnum,this.checkedAttachments).then(e=>{!0===e.data.status?(window.open(e.data.link,"_blank"),this.exportLink=e.data.link):this.displayErrorMessage(e.data.msg)})},confirmDeleteAttachments(){if(this.canDelete){let e="<p>"+this.translate("CONFIRM_DELETE_SELETED_ATTACHMENTS")+"</p><br>",t="";this.checkedAttachments.forEach(e=>{this.attachments.forEach(a=>{a.aid==e&&(t+=a.value+", ")})}),t=t.substring(0,t.length-2),e+="<p>"+t+"</p>",j.a.fire({title:this.translate("DELETE_SELECTED_ATTACHMENTS"),html:e,type:"warning",showCancelButton:!0,confirmButtonText:this.translate("JYES"),cancelButtonText:this.translate("JNO"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(e=>{e.value&&this.deleteAttachments()})}else this.displayErrorMessage(this.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"))},async deleteAttachments(){if(this.canDelete){this.attachments=this.attachments.filter(e=>!this.checkedAttachments.includes(e.aid));let e=null;this.sync?L.deleteAttachments(this.checkedAttachments).then(async e=>{await g.deleteAttachments(this.displayedFnum,this.displayedUser.user_id,this.checkedAttachments)}):e=await g.deleteAttachments(this.displayedFnum,this.displayedUser.user_id,this.checkedAttachments),e.status}else this.displayErrorMessage(this.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"))},changeAttachment(e,t=!1){this.slideTransition=t?"slide-fade-reverse":"slide-fade",this.modalLoading=!0,this.selectedAttachment=this.displayedAttachments[e],this.$store.dispatch("attachment/setSelectedAttachment",this.selectedAttachment),setTimeout(()=>{this.modalLoading=!1},500)},searchInFiles(){this.attachments.forEach((e,t)=>{e.upload_description.toLowerCase().includes(this.$refs["searchbar"].value.toLowerCase())||e.value.toLowerCase().includes(this.$refs["searchbar"].value.toLowerCase())?this.attachments[t].show=!0:(this.checkedAttachments=this.checkedAttachments.filter(t=>t!==e.aid),this.attachments[t].show=!1)}),this.displayedAttachments=this.attachments.filter(e=>!0===e.show||"undefined"==typeof e.show||null==e.show)},resetSearch(){this.attachments.forEach((e,t)=>{this.attachments[t].show=!0}),this.$refs["searchbar"].value="",this.displayedAttachments=this.attachments.filter(e=>!0===e.show||"undefined"==typeof e.show||null==e.show)},resetOrder(){this.sort={last:"",order:"",orderBy:""}},resetCategoryFilters(){this.$refs["categoryFilter"]&&(this.$refs["categoryFilter"].value="all")},orderBy(e){this.sort.last==e?(this.sort.order="asc"==this.sort.order?"desc":"asc",this.attachments.reverse()):(this.attachments.sort((t,a)=>t[e]<a[e]?-1:t[e]>a[e]?1:0),this.sort.order="asc"),this.sort.orderBy=e,this.sort.last=e},filterByCategory(e){this.attachments.forEach(t=>{"all"==e.target.value||t.category==e.target.value?t.show=!0:(this.checkedAttachments=this.checkedAttachments.filter(e=>e!==t.aid),t.show=!1)}),this.displayedAttachments=this.attachments.filter(e=>!0===e.show||"undefined"==typeof e.show||null==e.show)},updateAllCheckedAttachments(e){e.target.checked?this.checkedAttachments=this.displayedAttachments.map(e=>e.aid):this.checkedAttachments=[],this.$store.dispatch("attachment/setCheckedAttachments",this.checkedAttachments)},updateCheckedAttachments(e){Array.isArray(e)?this.checkedAttachments=e:(console.warn("updateCheckedAttachments() expects an array as argument"),this.displayErrorMessage("Something went wrong while updating the checked attachments"),this.checkedAttachments=[])},openModal(e){this.displayedUser.user_id&&this.displayedFnum&&(this.$modal.show("edit"),this.selectedAttachment=e,this.$store.dispatch("attachment/setSelectedAttachment",e))},closeModal(){this.$modal.hide("edit"),this.selectedAttachment={},this.$store.dispatch("attachment/setSelectedAttachment",{})},displayErrorMessage(e){j.a.fire({title:this.translate("ERROR"),text:e,type:"error",confirmButtonColor:"#3085d6",confirmButtonText:this.translate("COM_EMUNDUS_ATTACHMENTS_CLOSE")})},beforeLeaveSlide(e){"slide-fade"==this.slideTransition&&(e.style.transform="translateX(-100%)"),e.setAttribute("class","modal-body "+this.slideTransition+"-leave-active "+this.slideTransition+"-leave-to")},toggleOnlyPreview(e){this.onlyPreview=!e}},computed:{fnumPosition(){return this.fnums.indexOf(this.displayedFnum)},selectedAttachmentPosition(){return this.displayedAttachments.indexOf(this.selectedAttachment)},attachmentPath(){return this.$store.state.attachment.attachmentPath+this.displayedUser.user_id+"/"+this.selectedAttachment.filename},thisAttachmentCategories(){let e={};if(Object.entries(this.categories).length>0)for(let t in this.categories)for(let a in this.attachments)this.attachments[a].category==t&&(e[t]=this.categories[t]);return e}},watch:{"$store.state.global.anonyme":function(){this.canSee=!this.$store.state.global.anonyme},selectedAttachment:function(){this.syncSelectedPreview=null,L.getAttachmentSyncNodeId(this.selectedAttachment.aid).then(e=>{this.syncSelectedPreview=e})}}},H=G,z=(a("6a28"),Object(b["a"])(H,r,c,!1,null,null,null)),V=z.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-16 em-ml-32 em-files"},[e.currentFile?a("Application",{attrs:{file:e.currentFile,type:e.$props.type,user:e.$props.user,ratio:e.$props.ratio},on:{getFiles:function(t){return e.getFiles(!0)}}}):e._e(),a("div",{staticClass:"em-mb-12 em-flex-row em-flex-space-between"},[a("p",{staticClass:"em-h4"},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_"+e.type.toUpperCase())))])]),e.files?a("div",[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("div",{staticClass:"em-flex-row"},[a("div",{staticClass:"em-flex-row"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_TOTAL")))]),a("span",{staticClass:"em-ml-4"},[e._v(e._s(e.total_count))])]),a("span",{staticClass:"em-ml-8 em-mr-8"},[e._v("|")]),a("div",{staticClass:"em-flex-row"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_DISPLAY_PAGE")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.limit,expression:"limit"}],staticClass:"em-select-no-border em-ml-8",staticStyle:{width:"40px",height:"20px"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.limit=t.target.multiple?a:a[0]}}},[a("option",[e._v("10")]),a("option",[e._v("25")]),a("option",[e._v("50")]),a("option",[e._v("100")])])])]),e.displayPagination?a("div",{staticClass:"em-flex-row"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_PAGE"))+" "+e._s(e.displayPage))]),a("span",{staticClass:"em-ml-8 em-mr-8"},[e._v("|")]),0!=e.page?a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:e.prevPage}},[e._v("chevron_left")]):e._e(),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:e.nextPage}},[e._v("navigate_next")])]):e._e()])]):e._e(),e.files?a("div",["evaluation"===e.$props.type?a("tabs",{attrs:{tabs:e.tabs},on:{updateTab:e.updateTab}}):e._e(),a("hr"),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("div",{staticClass:"em-flex-row"},[e.defaultFilters.length>0?a("div",{attrs:{id:"default-filters"}},[a("div",{staticClass:"em-tabs em-pointer em-flex-row em-s-justify-content-center",on:{click:function(t){e.openedFilters=!e.openedFilters}}},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_FILTER")))]),a("span",{staticClass:"material-icons-outlined"},[e._v("filter_list")])]),a("ul",{class:{hidden:!e.openedFilters,"em-input":!0}},e._l(e.defaultFilters,(function(t){return a("li",{key:t.id,staticClass:"em-pointer",on:{click:function(a){return e.addFilter(t)}}},[e._v(e._s(t.label))])})),0)]):e._e(),e.filters.length>0?a("div",{staticClass:"em-flex-row",attrs:{id:"applied-filters"}},e._l(e.filters,(function(t){return a("div",{key:t.key,staticClass:"em-ml-8 em-flex-row"},[a("div",[a("label",{staticClass:"filter-label",attrs:{for:t.id+"-"+t.key,title:t.label}},[e._v(e._s(t.label))]),"field"==t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedValue,expression:"filter.selectedValue"}],attrs:{name:t.id+"-"+t.key,type:"text",placeholder:t.label},domProps:{value:t.selectedValue},on:{input:function(a){a.target.composing||e.$set(t,"selectedValue",a.target.value)}}}):"date"==t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedValue,expression:"filter.selectedValue"}],attrs:{name:t.id+"-"+t.key,type:"date"},domProps:{value:t.selectedValue},on:{input:function(a){a.target.composing||e.$set(t,"selectedValue",a.target.value)}}}):"select"==t.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedValue,expression:"filter.selectedValue"}],attrs:{name:t.id+"-"+t.key},on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"selectedValue",a.target.multiple?s:s[0])}}},e._l(t.values,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.label))])})),0):e._e()]),a("span",{staticClass:"material-icons-outlined",on:{click:function(a){return e.removeFilter(t)}}},[e._v("close")])])})),0):e._e()]),a("div",[a("span",{staticClass:"em-primary-button em-pointer",class:{disbaled:e.filters.length<1},on:{click:e.applyFilters}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_APPLY_FILTER")))])])])],1):e._e(),e.files&&e.columns&&e.files.length>0?a("div",{staticClass:"em-flex-row"},[a("div",{staticClass:"table-columns-move em-flex-column em-mr-4",class:e.moveRight?"":"em-disabled-state",attrs:{id:"table_columns_move_right"},on:{click:e.scrollToRight}},[a("span",{staticClass:"material-icons-outlined em-pointer",staticStyle:{"font-size":"16px"}},[e._v("arrow_back")])]),a("el-table",{ref:"tableFiles",staticStyle:{width:"100%"},attrs:{height:"500",data:e.files},on:{"select-all":e.selectRow,select:e.selectRow}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{fixed:"",label:e.translate("COM_EMUNDUS_ONBOARD_FILE"),width:"270"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"em-pointer",on:{click:function(a){return e.openApplication(t.row)}}},[a("p",{staticClass:"em-font-weight-500"},[e._v(e._s(t.row.applicant_name))]),a("span",{staticClass:"em-text-neutral-500 em-font-size-14"},[e._v(e._s(t.row.fnum))])])]}}],null,!1,3192032070)}),e._l(e.columns,(function(t){return 1==t.show_in_list_summary?["status"===t.name?a("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"em-neutral-700-color",attrs:{title:e.translate("COM_EMUNDUS_ONBOARD_STATUS")}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_STATUS")))])]}},{key:"default",fn:function(t){return[a("p",{staticClass:"em-status",class:"label-text-"+t.row.status_color+" label-"+t.row.status_color},[e._v(e._s(t.row.status))])]}}],null,!0)}):"assocs"===t.name?a("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("span",{staticClass:"em-neutral-700-color",attrs:{title:e.translate("COM_EMUNDUS_FILES_ASSOCS")}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_ASSOCS")))])]}},{key:"default",fn:function(t){return[a("div",{staticClass:"em-group-assoc-column"},e._l(t.row.assocs,(function(t){return a("span",{staticClass:"em-status em-mb-4",class:t.class},[e._v(e._s(t.label))])})),0)]}}],null,!0)}):a("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(s){return[a("span",{staticClass:"em-neutral-700-color",attrs:{title:t.label}},[e._v(e._s(t.label))])]}},{key:"default",fn:function(s){return[a("p",[e._v(e._s(s.row[t.name]))])]}}],null,!0)})]:e._e()}))],2),e.moveLeft?a("div",{staticClass:"table-columns-move em-flex-column em-ml-4",attrs:{id:"table_columns_move_left"},on:{click:e.scrollToLeft}},[a("span",{staticClass:"material-icons-outlined em-pointer",staticStyle:{"font-size":"16px"}},[e._v("arrow_forward")])]):e._e()],1):e._e(),e.files&&e.columns&&0===e.files.length?a("div",[a("span",{staticClass:"em-h6"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_NOFILES")))])]):e._e(),e.rows_selected.length>0?a("div",{staticClass:"selected-rows-tip"},[a("div",{staticClass:"selected-rows-tip__content em-flex-row"},[1===e.rows_selected.length?a("span",[e._v(e._s(e.rows_selected.length)+" "+e._s(e.translate("COM_EMUNDUS_FILES_ELEMENT_SELECTED"))+" :")]):e.rows_selected.length>1?a("span",[e._v(e._s(e.rows_selected.length)+" "+e._s(e.translate("COM_EMUNDUS_FILES_ELEMENTS_SELECTED"))+" :")]):e._e(),a("a",{staticClass:"em-pointer em-ml-16",on:{click:function(t){return e.toggleSelection()}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_UNSELECT")))]),a("a",{staticClass:"em-pointer em-ml-16",on:{click:function(t){return e.openInNewTab()}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_OPEN_IN_NEW_TAB")))])])]):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},q=[],J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-flex-row em-gap-8"},e._l(e.$props.tabs,(function(t){return a("div",{staticClass:"em-tabs em-pointer",class:e.selected===t.name?"em-selected-tab":"",on:{click:function(a){e.selected=t.name,e.$emit("updateTab",t.name)}}},[a("p",[e._v(e._s(e.translate(t.label))+" ("+e._s(t.total)+")")])])})),0)},W=[],K={name:"Tabs",props:{tabs:Array},data:()=>({selected:"to_evaluate"})},X=K,Q=Object(b["a"])(X,J,W,!1,null,"0215ffa9",null),Z=Q.exports,ee=a("cca1"),te={async getFiles(e="default",t=!1,a=25,s=0){try{const a=await h().get("index.php?option=com_emundus&controller=file&task=getfiles",{params:{type:e,refresh:t}});return a.data}catch(i){return!1}},async getColumns(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getcolumns",{params:{type:e}});return t.data}catch(t){return!1}},async getEvaluationFormByFnum(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getevaluationformbyfnum",{params:{fnum:e}});return t.data}catch(t){return!1}},async getMyEvaluation(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getmyevaluation",{params:{fnum:e}});return t.data}catch(t){return!1}},async checkAccess(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=checkaccess",{params:{fnum:e}});return t.data}catch(t){return!1}},async getLimit(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getlimit",{params:{type:e}});return t.data}catch(t){return!1}},async getPage(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getpage",{params:{type:e}});return t.data}catch(t){return!1}},async updateLimit(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=updatelimit",{params:{limit:e}});return t.data}catch(t){return!1}},async updatePage(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=updatepage",{params:{page:e}});return t.data}catch(t){return!1}},async setSelectedTab(e,t="evaluation"){try{const a=await h().get("index.php?option=com_emundus&controller=file&task=setselectedtab",{params:{tab:e,type:t}});return a.data}catch(a){return!1}},async getFile(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getfile",{params:{fnum:e}});return t.data}catch(t){return!1}},async getDefaultFilters(){try{const e=await h().get("index.php?option=com_emundus&controller=file&task=getdefaultfilters");return e.data}catch(e){return!1}},async applyFilters(e,t){const a=new FormData;a.append("filters",JSON.stringify(e)),a.append("tab",t);try{const e=await h().post("index.php?option=com_emundus&controller=file&task=applyfilters",a);return e.data}catch(s){return!1}},async getComments(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getcomments",{params:{fnum:e}});return t.data}catch(t){return!1}},async saveComment(e,t){const a=new FormData;a.append("fnum",e),Object.keys(t).forEach(e=>{a.append(e,t[e])});try{const e=await h().post("index.php?option=com_emundus&controller=file&task=savecomment",a);return e.data}catch(s){return{status:!1,msg:s.message}}},async deleteComment(e){try{const t=await h().delete("index.php?option=com_emundus&controller=file&task=deletecomment",{params:{cid:e}});return t.data}catch(t){return{status:!1,msg:t.message}}}},ae={methods:{async displayError(e,t,a="error",s=!1,i="COM_EMUNDUS_OK",n="COM_EMUNDUS_ACTIONS_CANCEL",o=!1,l=null){let r={title:this.translate(e),text:this.translate(t),type:a,showCancelButton:s,confirmButtonText:this.translate(i),cancelButtonText:this.translate(n),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}};return o?r.html=t:r.text=this.translate(t),j.a.fire(r).then(e=>!!e.value&&(null!=l&&l(),!0))}}},se=ae,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{id:"application-modal",name:"application-modal",height:"100vh",width:"100vw",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"},on:{"before-open":e.beforeOpen,"before-close":function(t){return e.updateURL()},closed:function(t){return e.$emit("getFiles")}}},[a("div",{staticClass:"em-modal-header em-w-100 em-h-50 em-p-12-16 em-bg-main-900 em-flex-row"},[a("div",{staticClass:"em-flex-row em-pointer em-gap-8",attrs:{id:"evaluation-modal-close"}},[a("div",{staticClass:"em-w-max-content em-flex-row",on:{click:function(t){return e.$modal.hide("application-modal")}}},[a("span",{staticClass:"material-icons-outlined em-font-size-16",staticStyle:{color:"white"}},[e._v("arrow_back")])]),a("span",{staticClass:"em-text-neutral-500"},[e._v("|")]),a("p",{staticClass:"em-font-size-14",staticStyle:{color:"white"}},[e._v(" "+e._s(e.file.applicant_name)+" - "+e._s(e.file.fnum)+" ")])])]),e.access?a("div",{staticClass:"modal-grid",style:"grid-template-columns:"+this.ratioStyle},[a("div",{attrs:{id:"modal-applicationform"}},[a("div",{staticClass:"scrollable"},[a("div",{staticClass:"em-flex-row em-flex-center em-gap-16 em-border-bottom-neutral-300 sticky-tab"},e._l(e.tabs,(function(t){return e.access[t.access].r?a("div",{staticClass:"em-light-tabs em-pointer",class:e.selected===t.name?"em-light-selected-tab":"",on:{click:function(a){e.selected=t.name}}},[a("span",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate(t.label)))])]):e._e()})),0),"application"===e.selected?a("div",{domProps:{innerHTML:e._s(e.applicationform)}}):e._e(),"attachments"===e.selected?a("Attachments",{attrs:{fnum:e.file.fnum,user:e.$props.user,columns:["name","date","category","status"],displayEdit:!1}}):e._e(),"comments"===e.selected?a("Comments",{attrs:{fnum:e.file.fnum,user:e.$props.user,access:e.access["10"]}}):e._e()],1)]),a("div",{attrs:{id:"modal-evaluationgrid"}},[e.loading?e._e():a("div",{staticClass:"em-flex-column",staticStyle:{width:"40px",height:"40px",margin:"24px 0 12px 24px"}},[a("div",{staticClass:"em-circle-main-100 em-flex-column",staticStyle:{width:"40px"}},[a("div",{staticClass:"em-circle-main-200 em-flex-column",staticStyle:{width:"24px"}},[a("span",{staticClass:"material-icons-outlined em-main-400-color",staticStyle:{"font-size":"14px"}},[e._v("troubleshoot")])])])]),e.url?a("iframe",{staticClass:"iframe-evaluation",attrs:{src:e.url,id:"iframe-evaluation",title:"Evaluation form"},on:{load:function(t){return e.iframeLoaded(t)}}}):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])]):e._e()])},ne=[],oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"em-flex-column em-flex-center em-mt-24"},e._l(e.comments,(function(t){return a("div",{staticClass:"em-input-card em-w-50 em-mb-16"},[a("div",{staticClass:"em-flex-row em-flex-space-between"},[a("div",[a("p",[e._v(e._s(t.user))]),a("span",{staticClass:"em-text-neutral-500"},[e._v(e._s(e.formattedDate(t.date,"LLLL","+0200")))])]),a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hideOptions,expression:"hideOptions"}]},[a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(a){e.show_options=t.id}}},[e._v("more_vert")]),e.show_options===t.id?a("div",{staticClass:"em-comment-option"},[e.$props.access.d||e.$props.access.c&&t.user_id==e.$props.user?a("span",{staticClass:"em-pointer",on:{click:function(a){return e.deleteComment(t.id)}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_DELETE")))]):e._e()]):e._e()])]),a("hr"),a("div",[a("strong",{staticClass:"em-mb-8"},[e._v(e._s(t.reason))]),a("p",[e._v(e._s(t.comment_body))])])])})),0),e.adding_comment?a("div",{staticClass:"em-flex-row em-flex-center em-mt-24"},[a("div",{staticClass:"em-input-card em-w-50"},[a("div",[a("span",{staticClass:"material-icons-outlined em-pointer em-float-right em-mb-4",on:{click:function(t){e.adding_comment=!1}}},[e._v("close")])]),a("div",{staticClass:"em-mb-8"},[a("label",{attrs:{for:"reason"}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_TITLE")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.comment.reason,expression:"comment.reason"}],staticClass:"em-w-100",attrs:{id:"reason",type:"text"},domProps:{value:e.comment.reason},on:{input:function(t){t.target.composing||e.$set(e.comment,"reason",t.target.value)}}})]),a("div",[a("label",{staticClass:"em-mb-4",attrs:{for:"body"}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_BODY")))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment.comment_body,expression:"comment.comment_body"}],attrs:{id:"body"},domProps:{value:e.comment.comment_body},on:{input:function(t){t.target.composing||e.$set(e.comment,"comment_body",t.target.value)}}})]),a("div",{staticClass:"em-mt-8"},[a("button",{staticClass:"em-primary-button em-w-auto em-float-right",on:{click:e.saveComment}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_VALIDATE_COMMENT")))])])])]):e._e(),e.$props.access.c&&!e.adding_comment?a("div",{staticClass:"em-flex-row em-flex-center em-mt-32"},[a("button",{staticClass:"em-primary-button em-w-auto",on:{click:function(t){e.adding_comment=!0}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_ADD_COMMENT")))])]):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},le=[],re={name:"Comments",props:{user:{type:String,required:!0},fnum:{type:String,required:!0},access:{type:Array,required:!0}},mixins:[A],data:()=>({comments:[],comment:{reason:"",comment_body:""},loading:!1,adding_comment:!1,show_options:!1}),created(){this.getComments()},methods:{getComments(){this.loading=!0,te.getComments(this.$props.fnum).then(e=>{1==e.status?(this.comments=e.data,this.loading=!1):this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC")})},saveComment(){this.loading=!0,te.saveComment(this.$props.fnum,this.comment).then(e=>{1==e.status?(this.comments.push(e.data),this.adding_comment=!1,this.loading=!1):this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC")})},deleteComment(e){this.loading=!0,te.deleteComment(e).then(t=>{1==t.status?(this.comments.splice(this.comments.findIndex(t=>t.id===e),1),this.loading=!1):this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC")})},hideOptions(){this.show_options=!1}}},ce=re,de=(a("bce3"),Object(b["a"])(ce,oe,le,!1,null,"e0040760",null)),me=de.exports,ue={name:"Application",components:{Comments:me,Attachments:V},props:{file:Object|String,type:String,user:{type:String,required:!0},ratio:{type:String,default:"66/33"}},mixins:[se],data:()=>({applicationform:"",selected:"application",tabs:[{label:"COM_EMUNDUS_FILES_APPLICANT_FILE",name:"application",access:"1"},{label:"COM_EMUNDUS_FILES_ATTACHMENTS",name:"attachments",access:"4"},{label:"COM_EMUNDUS_FILES_COMMENTS",name:"comments",access:"10"}],evaluation_form:0,url:null,access:null,student_id:null,loading:!1}),methods:{beforeOpen(){var e=document.querySelector(":root");let t=this.$props.ratio.split("/");e.style.setProperty("--attachment-width",t[0]+"%"),this.loading=!0;let a="";a="string"==typeof this.$props.file?this.$props.file:this.$props.file.fnum,"string"==typeof this.$props.file?te.getFile(a).then(e=>{1==e.status?(this.$props.file=e.data,this.access=e.rights,this.updateURL(this.$props.file.fnum),this.getApplicationForm(),"evaluation"===this.$props.type&&this.getEvaluationForm()):this.displayError("COM_EMUNDUS_FILES_CANNOT_ACCESS","COM_EMUNDUS_FILES_CANNOT_ACCESS_DESC").then(e=>{!0===e&&this.$modal.hide("application-modal")})}):te.checkAccess(a).then(e=>{1==e.status?(this.access=e.data,this.updateURL(this.$props.file.fnum),this.access["1"].r?this.getApplicationForm():this.access["4"].r?this.selected="attachments":this.access["10"].r&&(this.selected="comments"),"evaluation"===this.$props.type&&this.getEvaluationForm()):this.displayError("COM_EMUNDUS_FILES_CANNOT_ACCESS","COM_EMUNDUS_FILES_CANNOT_ACCESS_DESC").then(e=>{!0===e&&this.$modal.hide("application-modal")})})},getApplicationForm(){p()({method:"get",url:"index.php?option=com_emundus&view=application&format=raw&layout=form&fnum="+this.file.fnum}).then(e=>{this.applicationform=e.data,"evaluation"!==this.$props.type&&(this.loading=!1)})},getEvaluationForm(){null!=this.$props.file.id&&(this.rowid=this.$props.file.id),"undefined"!=typeof this.$props.file.applicant_id?this.student_id=this.$props.file.applicant_id:this.student_id=this.$props.file.student_id;let e="form";te.getEvaluationFormByFnum(this.$props.file.fnum).then(t=>{0!==t.data&&("undefined"===typeof this.$props.file.id?te.getMyEvaluation(this.$props.file.fnum).then(a=>{this.rowid=a.data,null==this.rowid&&(this.rowid=""),this.url="index.php?option=com_fabrik&c=form&view="+e+"&formid="+t.data+"&rowid="+this.rowid+"&jos_emundus_evaluations___student_id[value]="+this.student_id+"&jos_emundus_evaluations___campaign_id[value]="+this.$props.file.campaign+"&jos_emundus_evaluations___fnum[value]="+this.$props.file.fnum+"&student_id="+this.student_id+"&tmpl=component&iframe=1"}):this.url="index.php?option=com_fabrik&c=form&view="+e+"&formid="+t.data+"&rowid="+this.rowid+"&jos_emundus_evaluations___student_id[value]="+this.student_id+"&jos_emundus_evaluations___campaign_id[value]="+this.$props.file.campaign+"&jos_emundus_evaluations___fnum[value]="+this.$props.file.fnum+"&student_id="+this.student_id+"&tmpl=component&iframe=1")})},iframeLoaded(e){this.loading=!1},updateURL(e=""){let t=window.location.href;t=t.split("#"),""===e?window.history.pushState("","",t[0]):window.history.pushState("","",t[0]+"#"+e)}},computed:{ratioStyle(){let e=this.$props.ratio.split("/");return e[0]+"% "+e[1]+"%"}}},pe=ue,_e=(a("0dd4"),Object(b["a"])(pe,ie,ne,!1,null,null,null)),he=_e.exports,ge={name:"Files",components:{Application:he,Tabs:Z,"el-table":ee["Table"],"el-table-column":ee["TableColumn"]},props:{type:{String:String,default:""},ratio:{type:String,default:"66/33"},user:{type:String,required:!0}},mixins:[se],data:()=>({loading:!1,moveRight:!1,moveLeft:!0,scrolling:null,total_count:0,tabs:[{label:"COM_EMUNDUS_FILES_TO_EVALUATE",name:"to_evaluate",total:0,page:0,limit:10},{label:"COM_EMUNDUS_FILES_EVALUATED",name:"evaluated",total:0,page:0,limit:10},{label:"COM_EMUNDUS_FILES_ALL",name:"all",total:0,page:0,limit:10}],tab:"to_evaluate",files:null,columns:null,page:null,limit:null,defaultFilters:[],filters:[],openedFilters:!1,currentFile:null,rows_selected:[]}),created(){this.getLimit(),this.getPage(),this.getFiles()},methods:{getLimit(){te.getLimit(this.$props.type).then(e=>{1==e.status?this.limit=e.data:this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg)})},getPage(){te.getPage(this.$props.type).then(e=>{1==e.status?this.page=e.data:this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg)})},getFiles(e=!1){this.loading=!0;let t=window.location.href.split("#")[1];"undefined"==typeof t&&(t=""),"evaluation"===this.$props.type&&te.getFiles(this.$props.type,e,this.limit,this.page).then(e=>{1==e.status?(this.total_count=e.total,"undefined"!==typeof e.data.all?this.files=e.data.all:this.files=[],this.tabs.forEach((t,a)=>{e[t.name]&&(this.tabs[a].total=e[t.name].total)}),te.getColumns(this.$props.type).then(e=>{this.columns=e.data,""!==t&&this.openModal(t),this.getDefaultFilters(),this.loading=!1})):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg))})},getDefaultFilters(){te.getDefaultFilters().then(e=>{1==e.status&&(this.defaultFilters=e.data)})},addFilter(e){this.filters.push({id:e.id,key:Math.random(),type:e.type,values:e.values,label:e.label,selectedValue:null})},removeFilter(e){this.filters.find((t,a)=>{t.key==e.key&&this.filters.splice(a,1)})},applyFilters(){te.applyFilters(this.filters,this.tab).then(e=>{this.getFiles(!0)})},updateLimit(e){this.loading=!0,te.updateLimit(e).then(e=>{1==e.status?this.getFiles(!0):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg)),this.loading=!1})},prevPage(){this.page--,this.updatePage()},nextPage(){this.page++,this.updatePage()},updatePage(){te.updatePage(this.page).then(e=>{1==e.status?this.getFiles(!0):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg))})},openModal(e){this.currentFile=e,setTimeout(()=>{this.$modal.show("application-modal")},500)},updateTab(e){this.loading=!0,this.tab=e,te.setSelectedTab(e).then(()=>{this.getFiles(!0)})},openApplication(e){this.openModal(e)},selectRow(e,t){this.rows_selected=e},toggleSelection(){this.$refs.tableFiles.clearSelection(),this.rows_selected=[]},openInNewTab(){this.rows_selected.forEach(e=>{window.open(window.location.href+"#"+e.fnum,"_blank")})},scrollToLeft(){this.moveRight=!0;let e=document.getElementsByClassName("el-table__body-wrapper")[0];e.scrollLeft+=180},scrollToRight(){let e=document.getElementsByClassName("el-table__body-wrapper")[0];e.scrollLeft-=180,0==e.scrollLeft&&(this.moveRight=!1)},stopScrolling(){clearInterval(this.scrolling),this.scrolling=null}},watch:{limit:function(e,t){null!==t&&this.updateLimit(e)}},computed:{displayPage(){return this.page+1},displayPagination(){return this.files.length*(this.page+1)<this.total_count}}},fe=ge,ve=(a("aeea"),Object(b["a"])(fe,Y,q,!1,null,"09a3e97c",null)),be=ve.exports,Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"list"}},["files"!==e.type?a("list-head",{attrs:{data:e.actions}}):e._e(),a("div",{staticClass:"search em-mb-16 em-flex-row"},[a("span",{staticClass:"material-icons-outlined em-mr-8"},[e._v("search")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.recherche,expression:"recherche"}],staticClass:"searchTerm",attrs:{placeholder:e.translate("COM_EMUNDUS_ONBOARD_SEARCH")},domProps:{value:e.recherche},on:{keyup:function(t){return e.cherche(e.recherche)},input:function(t){t.target.composing||(e.recherche=t.target.value)}}})]),a("div",{staticClass:"em-flex-row em-w-auto"},["campaign"===e.type?a("div",{staticClass:"em-list-filters"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedProgram,expression:"selectedProgram"}],staticClass:"list-vue-select",attrs:{name:"selectProgram"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedProgram=t.target.multiple?a:a[0]},e.validateFilters]}},[a("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ALL_PROGRAMS"))+" ")]),e._l(e.allPrograms,(function(t){return a("option",{key:t.code,domProps:{value:t.code}},[e._v(e._s(t.label))])}))],2)]):"campaign"===e.type?a("div",{staticClass:"em-list-filters em-ml-8"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedSession,expression:"selectedSession"}],staticClass:"list-vue-select",attrs:{name:"selectedSession"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedSession=t.target.multiple?a:a[0]},e.validateFilters]}},[a("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ALL_SESSIONS"))+" ")]),e._l(e.allSessions,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):"email"===e.type?a("div",{staticClass:"em-list-filters"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.menuEmail,expression:"menuEmail"}],staticClass:"list-vue-select",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.menuEmail=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"0"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ALL")))]),e._l(e.notEmptyEmailCategories,(function(t,s){return a("option",{key:"cat_"+s,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),a("filters",{attrs:{data:e.actions,selected:e.selecedItems,updateTotal:e.updateTotal,filter:e.filter,sort:e.sort,validateFilters:e.validateFilters,nbresults:e.nbresults}})],1),a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],class:1==e.countPages?"noPagination":"pagination-pages"},[e.total>0?a("ul",{staticClass:"pagination"},[a("a",{staticClass:"pagination-arrow arrow-left",on:{click:function(t){return e.nbpages(e.pages-1)}}},[a("em",{staticClass:"fas fa-chevron-left"})]),e._l(e.countPages,(function(t){return a("li",{directives:[{name:"show",rawName:"v-show",value:e.countPages<=10||t<4||t>e.countPages-3||t>e.pages-3&&t<e.pages+3||t==e.pages-3||t==e.pages+3,expression:"countPages <= 10 || index < 4 || index > countPages - 3 || (index > pages - 3 && index < pages + 3) || index == pages - 3 || index == pages + 3"}],key:t,staticClass:"pagination-number"},[a("a",{staticClass:"pagination-number",class:t==e.pages?"current-number":"",on:{click:function(a){return e.nbpages(t)}}},[e._v(" "+e._s(e.paginationNumber(t))+" ")])])})),a("a",{staticClass:"pagination-arrow arrow-right",on:{click:function(t){return e.nbpages(e.pages+1)}}},[a("em",{staticClass:"fas fa-chevron-right"})])],2):e._e()])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.total>0||"files"==e.type,expression:"total > 0 || type == 'files'"}]},["form"!==e.type&&"formulaire"!==e.type?a("div",[a("list-body",{attrs:{type:e.type,actions:e.actions,params:e.params,items:e.list},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading}})],1):a("div",[a("nav",{attrs:{id:"form-nav"}},[a("ul",{staticClass:"em-flex-row-start"},[a("li",{staticClass:"em-pointer em-p-8 em-font-weight-600 em-p-16",class:{"em-main-500-color em-border-bottom-main-500 ":"formulaire"===e.selectedListTab,"em-border-bottom-neutral-300":"formulaire"!==e.selectedListTab},on:{click:function(t){e.selectedListTab="formulaire"}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_MY_FORMS"))+" ")]),a("li",{staticClass:"em-pointer em-p-8 em-font-weight-600 em-p-16",class:{"em-main-500-color em-border-bottom-main-500":"formModels"===e.selectedListTab,"em-border-bottom-neutral-300":"formModels"!==e.selectedListTab},on:{click:function(t){e.selectedListTab="formModels"}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_PAGE_MODELS"))+" ")])])]),"formModels"===e.selectedListTab?a("list-body",{attrs:{type:"formModels",actions:{},params:{},items:e.formModelsItems},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading}}):a("list-body",{attrs:{type:e.type,actions:e.actions,params:e.params,items:e.list},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.total&&"files"!=e.type&&!e.loading,expression:"total == 0 && type != 'files' && !loading"}],staticClass:"noneDiscover",domProps:{innerHTML:e._s(e.noneDiscoverTranslation)}}),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},Oe=[],Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",{staticClass:"em-flex-row"},["campaign"===e.data.type?a("div",{staticClass:"em-flex-row em-list-filters em-ml-8"},[a("span",{staticClass:"material-icons-outlined em-ml-4"},[e._v("schedule")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.filtre,expression:"filtre"}],staticClass:"list-vue-select",attrs:{name:"selectFiltre"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.filtre=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_ALL")))]),a("option",{attrs:{value:"yettocome"}},[e._v(e._s(e.translate("COM_EMUNDUS_CAMPAIGN_YET_TO_COME")))]),a("option",{attrs:{value:"ongoing"}},[e._v(e._s(e.translate("COM_EMUNDUS_CAMPAIGN_ONGOING")))]),a("option",{attrs:{value:"Terminated"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_CLOSE")))]),a("option",{attrs:{value:"Publish"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_PUBLISH")))]),a("option",{attrs:{value:"Unpublish"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_UNPUBLISH")))])])]):e._e(),a("div",{staticClass:"em-flex-row em-list-filters em-ml-8"},[a("span",{staticClass:"material-icons-outlined em-ml-4"},[e._v("sort")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.afficher,expression:"afficher"}],staticClass:"list-vue-select",attrs:{name:"selectAfficher"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.afficher=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"max"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ALL_RESULTS")))]),a("option",{attrs:{value:"10"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 10")]),a("option",{attrs:{value:"25"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 25")]),a("option",{attrs:{value:"50"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 50")]),a("option",{attrs:{value:"100"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 100")])])])])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},ye=[],De={name:"action_menu",props:{data:Object,updateTotal:Function,filter:Function,sort:Function,cherche:Function,chercheGo:Function,validateFilters:Function,nbresults:Function},computed:{checkItem(){return this.$store.getters["lists/selectedItems"]}},data(){return{recherche:"",filterHover:!1,actionHover:!1,sortHover:!1,resultsHover:!1,loading:!1,filtre:"Publish",tri:"DESC",afficher:25}},methods:{updateFilter(e){this.filtre=e},updateSort(e){this.tri=e},updateDisplay(e){this.afficher=e}},watch:{filtre:function(e){this.filter(e),this.updateFilter(e)},afficher:function(e){"max"===e?this.nbresults(999999):this.nbresults(e),this.updateDisplay(e)}}},Me=De,Ne=(a("5923"),Object(b["a"])(Me,Ce,ye,!1,null,"44890159",null)),Ae=Ne.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"list-head"}},[a("div",{staticClass:"list-head-container"},[a("h2",{staticClass:"em-text-neutral-800"},[e._v(" "+e._s(e.translations["title_"+e.data.type]))]),"form"!==e.data.type&&"formulaire"!==e.data.type?a("a",{staticClass:"em-primary-button em-w-auto",attrs:{href:e.data.add_url}},[e._v(" "+e._s(e.translations["add_"+e.data.type])+" ")]):a("a",{staticClass:"em-primary-button em-w-auto",on:{click:function(t){return e.getAddUrlToCreateForm()}}},[e._v(" "+e._s(e.translations["add_"+e.data.type])+" ")])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},we=[];a("bef5");var Ue={props:{data:{type:Object,required:!0}},data:function(){return{title:"List",loading:!1,translations:{title_campaign:"COM_EMUNDUS_ONBOARD_CAMPAIGNS",title_email:"COM_EMUNDUS_ONBOARD_EMAILS",title_formulaire:"COM_EMUNDUS_ONBOARD_FORMS",title_grilleEval:"COM_EMUNDUS_ONBOARD_FORMS",title_form:"COM_EMUNDUS_ONBOARD_FORMS",add_campaign:"COM_EMUNDUS_ONBOARD_ADD_CAMPAIGN",add_email:"COM_EMUNDUS_ONBOARD_ADD_EMAIL",add_formulaire:"COM_EMUNDUS_ONBOARD_ADD_FORM",add_grilleEval:"COM_EMUNDUS_ONBOARD_ADD_FORM",add_form:"COM_EMUNDUS_ONBOARD_ADD_FORM"}}},methods:{getAddUrlToCreateForm(){this.loading=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=createform",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.loading=!1;const t=e.data.data;window.location.href="index.php?option=com_emundus&view=form&layout=formbuilder&prid="+t+"&index=0&cid="}).catch(e=>{console.log(e),this.loading=!1})}}},Te=Ue,Re=(a("3a70"),Object(b["a"])(Te,Se,we,!1,null,"a49eda40",null)),xe=Re.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"list-body"}},["email"==e.type?a("ModalEmailPreview",{attrs:{model:e.email.emailToPreview,models:e.items}}):e._e(),a("div",{staticClass:"em-flex-row-justify-end em-mt-16 em-mb-16",attrs:{id:"actions"}},[a("div",{staticClass:"view-type"},e._l(e.viewTypeOptions,(function(t){return a("span",{key:t.value,staticClass:"material-icons-outlined",class:{active:t.value===e.viewType},on:{click:function(a){return e.changeViewType(t)}}},[e._v(" "+e._s(t.icon)+" ")])})),0)]),0===e.items.length&&"formModels"==e.type?a("div",{staticClass:"em-h5 em-flex-column"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_NO_PAGE_MODELS")))]):e._e(),a("list-table",{key:"list-table",staticClass:"list-view",class:{"not-displayed":"table"!==e.viewType},attrs:{type:e.type,actions:e.actions,params:e.params,items:e.items},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:e.showModalPreview}}),a("list-blocs",{key:"list-blocs",staticClass:"list-view",class:{"not-displayed":"blocs"!==e.viewType},attrs:{type:e.type,actions:e.actions,params:e.params,items:e.items},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:e.showModalPreview}})],1)},Be=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"list-table"}},[e.isEmptyRowsData?e._e():a("table",{attrs:{"aria-describedby":"Table of "+e.type}},[a("thead",{staticClass:"list-table-head"},[a("tr",e._l(e.rowsData,(function(t){return a("th",{key:t.value,attrs:{id:t.value}},[e._v(e._s(e.translate(t.label)))])})),0)]),a("tbody",e._l(e.items,(function(t){return a("list-table-row",{key:t.id,attrs:{data:t,type:e.type,actions:e.actions},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:function(a){return e.showModalPreview(t.id)}}})})),1)]),e.isEmptyRowsData?a("p",[e._v("Unable to create table...")]):e._e()])},ke=[],Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{staticClass:"list-row"},e._l(e.tds,(function(t){return a("td",{key:t.value},["actions"==t.value?a("span",[a("list-action-menu",{attrs:{id:"list-row action-menu",type:e.type,itemId:e.data.id,isPublished:e.actionMenuIsPublished,showTootlip:e.hasActionMenu},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:e.showModalPreview}})],1):"message"==t.value||"status"==t.value?a("div",{class:e.classFromTd(t),domProps:{innerHTML:e._s(e.formattedDataFromTd(t))}}):a("span",{class:e.classFromTd(t),on:{click:function(a){return e.redirectToEditItem(t)}}},[e._v(e._s(e.formattedDataFromTd(t)))])])})),0)},Fe=[],$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-actions-menu"},["campaign"==e.type&&1==e.allowPinnedCampaign?a("span",{staticClass:"em-pointer",class:1==e.pinned?"material-icons":"material-icons-outlined em-text-neutral-500",attrs:{title:e.translate("COM_EMUNDUS_CAMPAIGNS_PIN")},on:{click:e.pinCampaign}},[e._v("push_pin")]):e._e(),!0===e.showTootlip?a("v-popover",{staticClass:"em-pointer",attrs:{popoverArrowClass:"custom-popover-arrow"}},[a("span",{staticClass:"tooltip-target b3 material-icons-outlined"},[e._v("more_vert")]),a("template",{slot:"popover"},[a("actions",{attrs:{data:{type:e.type},selected:e.itemId,published:e.isPublished,nb_files:e.nb_files},on:{validateFilters:function(t){return e.validateFilters()},updateLoading:e.updateLoading}})],1)],2):e._e(),"email"==e.type?a("button",{staticClass:"em-transparent-button",attrs:{type:"button",title:e.translations.visualize},on:{click:e.showModalPreview}},[a("span",{staticClass:"material-icons-outlined"},[e._v("visibility")])]):e._e()],1)},je=[],Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"container-2 w-container",staticStyle:{"max-width":"unset"}},[a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",[a("nav",{staticClass:"em-flex-col-start",attrs:{"aria-label":"action"}},[["formulaire","email","formModels"].includes(e.data.type)||e.published?e._e():a("a",{staticClass:"action-submenu",on:{click:function(t){return e.publishSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.ActionPublish)+" ")]),!["formulaire","email","formModels"].includes(e.data.type)&&e.published?a("a",{staticClass:"action-submenu",on:{click:function(t){return e.unpublishSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.ActionUnpublish)+" ")]):e._e(),"formulaire"!==e.data.type||e.published?e._e():a("a",{staticClass:"action-submenu",staticStyle:{"border-right":"0"},on:{click:function(t){return e.publishSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.Restore)+" ")]),"campaign"===e.data.type||"formulaire"===e.data.type?a("a",{staticClass:"action-submenu w-dropdown-link",staticStyle:{"border-left":"0","border-right":"0"},on:{click:function(t){return e.duplicateSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.ActionDuplicate)+" ")]):a("a",{staticClass:"action-submenu",on:{click:function(t){return e.deleteSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.ActionDelete)+" ")]),"campaign"===e.data.type&&0===e.nb_files?a("a",{staticClass:"action-submenu",on:{click:function(t){return e.deleteSelected(e.checkItem)}}},[e._v(" "+e._s(e.translations.ActionDelete)+" ")]):e._e()])])])],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},He=[],ze={async createSimpleElement(e){try{const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsimpleelement",t);return a}catch(t){return{status:!1,message:t.message}}},async createSectionSimpleElements(e){try{const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsectionsimpleelements",t);return a}catch(t){return{status:!1,message:t.message}}},async createSimpleGroup(e,t){try{const a=new FormData;return a.append("fid",e),a.append("label",JSON.stringify(t)),await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsimplegroup",a)}catch(a){return{status:!1,message:a.message}}},async createTestingFile(e){try{const t=new FormData;t.append("cid",e);const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createtestingfile",t);return a}catch(t){return{status:!1,message:t.message}}},async getElement(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getElement",{params:{gid:e,element:t}});return a}catch(a){return{status:!1,message:a.message}}},async getJTEXT(e){const t=new FormData;t.append("toJTEXT",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getJTEXT",t);return e}catch(a){return{status:!1,message:a.message}}},async getJTEXTA(e){const t=new FormData;e.forEach((e,a)=>{t.append("toJTEXT["+a+"]",e)});try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getJTEXTA",t);return e}catch(a){return{status:!1,message:a.message}}},async getAllTranslations(e){const t=new FormData;t.append("toJTEXT",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getalltranslations",t);return e}catch(a){return{status:!1,message:a.message}}},async getTestingParams(e){try{const t=await h().get("index.php?option=com_emundus&controller=formbuilder&task=gettestingparams",{params:{prid:e}});return t}catch(t){return{status:!1,message:t.message}}},async getDatabases(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getdatabasesjoin");return e}catch(e){return{status:!1,message:e.message}}},getDatabaseJoinOrderColumns(e){try{const t=h().get("index.php?option=com_emundus&controller=formbuilder&task=getDatabaseJoinOrderColumns",{params:{database_name:e}});return t}catch(t){return{status:!1,message:t.message}}},async updateParams(e){const t=new FormData,a=JSON.stringify(e);t.append("element",a);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updateparams",t);return e}catch(s){return{status:!1,message:s.message}}},async updateGroupParams(e,t,a=null){const s=new FormData;s.append("group_id",e),s.append("params",JSON.stringify(t)),null!=a&&s.append("lang",a);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updategroupparams",s);return e}catch(i){return{status:!1,message:i.message}}},async updateOrder(e,t,a){const s=new FormData;if(s.append("elements",JSON.stringify(e)),s.append("group_id",t),s.append("moved_el",JSON.stringify(a)),0==a.length)return{status:!1,message:"No elements to update"};try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updateOrder",s);return e}catch(i){return{status:!1,message:i.message}}},updateElementOrder(e,t,a){const s=new FormData;s.append("group_id",e),s.append("element_id",t),s.append("new_index",a);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateelementorder",s);return e}catch(i){return{status:!1,message:i.message}}},async updateDocument(e){const t=new FormData;t.append("document_id",e.document_id),t.append("profile_id",e.profile_id),t.append("document",e.document),t.append("types",e.types);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updatedocument",t);return e}catch(a){return{status:!1,msg:a}}},async toggleElementPublishValue(e){const t=new FormData;t.append("element",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=publishunpublishelement",t);return e}catch(a){return{status:!1,message:a.message}}},async toggleElementHiddenValue(e){const t=new FormData;t.append("element",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=hiddenunhiddenelement",t);return e}catch(a){return{status:!1,message:a.message}}},async reorderMenu(e,t){const a=new FormData;a.append("menus",JSON.stringify(e)),a.append("profile",t);try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=reordermenu",a)}catch(s){return{status:!1,message:s.message}}},async reorderSections(e,t){const a=new FormData;a.append("groups",JSON.stringify(t)),a.append("fid",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=reordergroups",a);return e}catch(s){return{status:!1,message:s.message}}},async addPage(e){if(!e.prid)return{status:!1,msg:"Missing prid"};const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,JSON.stringify(e[a]))});try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=createmenu",t)}catch(a){return{status:!1,msg:a.message}}},async deletePage(e){if(!e)return{status:!1,message:"Missing page id"};const t=new FormData;t.append("mid",e);try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=deletemenu",t)}catch(a){return{status:!1,message:a.message}}},async updateTranslation(e,t,a){const s=new FormData;null!==e&&s.append(e.key,e.value),s.append("labelTofind",t),Object.keys(a).forEach(e=>{s.append("NewSubLabel["+e+"]",a[e])});try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=formsTrad",s);return e}catch(i){return{status:!1,message:i.message}}},async updateOption(e,t,a,s,i){const n=new FormData;n.append("element",e),n.append("options",JSON.stringify(t)),n.append("index",a),n.append("newTranslation",s),n.append("lang",i);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateElementOption",n);return e}catch(o){return{status:!1,message:o.message}}},addOption(e,t,a){const s=new FormData;s.append("element",e),s.append("newOption",t),s.append("lang",a);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=addElementSubOption",s);return e}catch(i){return{status:!1,message:i.message}}},deleteElementSubOption(e,t){const a=new FormData;a.append("element",e),a.append("index",t);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteElementSubOption",a);return e}catch(s){return{status:!1,message:s.message}}},updateElementSubOptionsOrder(e,t,a){const s=new FormData;s.append("element",e),s.append("options_old_order",JSON.stringify(t)),s.append("options_new_order",JSON.stringify(a));try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateElementSubOptionsOrder",s);return e}catch(i){return{status:!1,message:i.message}}},getElementSubOptions(e){try{const t=h().get("index.php?option=com_emundus&controller=formbuilder&task=getelementsuboptions",{params:{element:e}});return t}catch(t){return{status:!1,message:t.message}}},deleteElement(e){const t=new FormData;t.append("element",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteElement",t);return e}catch(a){return{status:!1,message:a.message}}},deleteGroup(e){const t=new FormData;t.append("gid",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteGroup",t);return e}catch(a){return{status:!1,message:a.message}}},async updateDefaultValue(e,t){const a=new FormData;a.append("eid",e),a.append("value",t);try{return h().post("index.php?option=com_emundus&controller=formbuilder&task=updatedefaultvalue",a)}catch(s){return{status:!1,message:s.message}}},async getAllDatabases(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getalldatabases");return e}catch(e){return{status:!1,message:e.message}}},async getSection(e){try{const t=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getsection",{params:{section:e}});return t}catch(t){return{status:!1,message:t.message}}},async getModels(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getpagemodels");return e.data}catch(e){return{status:!1,message:e.message}}},async addFormModel(e,t){if(!(e>0))return{status:!1,message:"MISSING_PARAMS"};{const s=new FormData;s.append("form_id",e),s.append("label",t);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=addformmodel",s);return e.data}catch(a){return{status:!1,message:a.message}}}},async deleteFormModel(e){if(!(e>0))return{status:!1,message:"MISSING_PARAMS"};{const a=new FormData;a.append("form_id",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteformmodel",a);return e.data}catch(t){return{status:!1,message:t.message}}}},async deleteFormModelFromId(e){if(!(e.length>0))return{status:!1,message:"MISSING_PARAMS"};{const a=new FormData;a.append("model_ids",JSON.stringify(e));try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteformmodelfromids",a);return e.data}catch(t){return{status:!1,message:t.message}}}}};const Ve=a("bef5");var Ye={name:"action_menu",props:{data:Object,isEmpty:Boolean,selected:String,published:Boolean,nb_files:Number},computed:{checkItem(){return[this.selected]}},data(){return{loading:!1,translations:{ActionPublish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_PUBLISH"),ActionUnpublish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_UNPUBLISH"),ActionDuplicate:this.translate("COM_EMUNDUS_ONBOARD_ACTION_DUPLICATE"),ActionDelete:this.translate("COM_EMUNDUS_ONBOARD_ACTION_DELETE"),Archive:this.translate("COM_EMUNDUS_ONBOARD_ARCHIVE"),Restore:this.translate("COM_EMUNDUS_ONBOARD_RESTORE")}}},methods:{deleteSelected(e){switch(this.data.type){case"campaign":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPDELETE"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=deletecampaign",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.dispatch("lists/deleteSelected",e).then(()=>{this.$store.commit("lists/resetSelectedItemsList")}),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPDELETED"),type:"success",showConfirmButton:!1,timer:2e3})}).then(()=>{this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break;case"email":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_EMAILDELETE"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=deleteemail",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.dispatch("lists/deleteSelected",e).then(()=>{this.$store.commit("lists/resetSelectedItemsList")}),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_EMAILDELETED"),type:"success",showConfirmButton:!1,timer:2e3})}).then(()=>{this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break;case"formulaire":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMDELETE"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=deleteform",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.dispatch("lists/deleteSelected",e).then(()=>{this.$store.commit("lists/resetSelectedItemsList")}),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMDELETED"),type:"success",showConfirmButton:!1,timer:2e3})}).then(()=>{this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break;case"formModels":j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_MODEL"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&ze.deleteFormModelFromId(e).then(e=>{e.status?(j.a.fire({title:this.translate("COM_EMUNDUS_FORM_DELETE_MODEL_SUCCESS"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")):j.a.fire({title:this.translate("COM_EMUNDUS_FORM_DELETE_MODEL_FAILURE"),type:"warning",showConfirmButton:!1,timer:2e3})})});break;default:console.warn("Unhandled case "+type+" for delete action");break}},unpublishSelected(e){switch(this.data.type){case"program":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_PROGUNPUBLISH"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=unpublishprogram",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.commit("lists/unpublish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_PROGUNPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break;case"campaign":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNUNPUBLISH"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=unpublishcampaign",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.commit("lists/unpublish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNUNPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break;case"email":p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=unpublishemail",data:Ve.stringify({id:e})}).then(t=>{this.$store.commit("lists/unpublish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_EMAILUNPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)});break;case"formulaire":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMUNPUBLISH"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=unpublishform",data:Ve.stringify({id:e})}).then(t=>{this.$emit("updateLoading",!1),this.$store.commit("lists/unpublish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMUNPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)}))});break}},publishSelected(e){switch(this.data.type){case"program":p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=publishprogram",data:Ve.stringify({id:e})}).then(t=>{this.$store.commit("lists/publish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_PROGPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)});break;case"campaign":p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=publishcampaign",data:Ve.stringify({id:e})}).then(t=>{this.$store.commit("lists/publish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)});break;case"email":p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=publishemail",data:Ve.stringify({id:e})}).then(t=>{this.$store.commit("lists/publish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_EMAILPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)});break;case"formulaire":p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=publishform",data:Ve.stringify({id:e})}).then(t=>{this.$store.commit("lists/publish",e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMPUBLISHED"),type:"success",showConfirmButton:!1,timer:2e3}),this.$emit("validateFilters")}).catch(e=>{console.log(e)});break}},duplicateSelected(e){switch(this.data.type){case"campaign":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNDUPLICATE"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=duplicatecampaign",data:Ve.stringify({id:e})}).then(e=>{window.location.reload()}))});break;case"formulaire":j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_FORMDUPLICATE"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.$emit("updateLoading",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=duplicateform",data:Ve.stringify({id:e})}).then(e=>{window.location.reload()}))});break}}}},qe=Ye,Je=(a("f6b7"),Object(b["a"])(qe,Ge,He,!1,null,"7a768bd8",null)),We=Je.exports,Ke={async updateDocument(e,t=!1){const a=new FormData;Object.keys(e).forEach(t=>{a.append(t,e[t])});const s=t?"createdocument":"updatedocument";try{const e=await h().post("index.php?option=com_emundus&controller=campaign&task="+s,a);return e.data}catch(i){return{status:!1,msg:i.message}}},async setDocumentMandatory(e){const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});try{const e=await h().post("index.php?option=com_emundus&controller=campaign&task=updatedocumentmandatory",t);return e.data}catch(a){return{status:!1,msg:a.message}}},async getAllCampaigns(e="",t="DESC",a="",s=9999,i=0,n="all"){try{const o=await h().get("index.php?option=com_emundus&controller=campaign&task=getallcampaign",{params:{filter:e,sort:t,recherche:a,lim:s,page:i,program:n}});return o.data}catch(o){return{status:!1,msg:o.message}}},async createCampaign(e){try{const t=new FormData;return t.append("label",JSON.stringify(e.label)),t.append("start_date",e.start_date),t.append("end_date",e.end_date),t.append("short_description",e.short_description),t.append("description",e.description),t.append("training",e.training),t.append("year",e.year),t.append("published",e.published),t.append("is_limited",e.is_limited),t.append("profile_id",e.profile_id),t.append("limit",e.limit),t.append("limit_status",e.limit_status),await h().post("index.php?option=com_emundus&controller=campaign&task=createcampaign",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async pinCampaign(e){try{const t=new FormData;return t.append("cid",e),await h().post("index.php?option=com_emundus&controller=campaign&task=pincampaign",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}}},Xe={components:{actions:We},props:{type:{type:String,required:!0},itemId:{type:String,required:!0},isPublished:{type:Boolean,required:!0},showTootlip:{type:Boolean,default:!0},nb_files:{type:Number,default:0},pinned:{type:Number,default:0}},data(){return{translations:{visualize:this.translate("COM_EMUNDUS_ONBOARD_VISUALIZE")}}},methods:{showModalPreview(){this.$emit("showModalPreview")},validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},pinCampaign(){Ke.pinCampaign(this.itemId).then(e=>{1==e.data.status&&(this.$store.dispatch("campaign/setPinned",this.itemId),Swal.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNS_CAMPAIGN_PINNED"),text:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNS_CAMPAIGN_PINNED_TEXT"),type:"success",showCancelButton:!1,showConfirmButton:!1,customClass:{title:"em-swal-title"},timer:2e3}))})}},computed:{pinned:function(){return this.$store.getters["campaign/pinned"]===this.itemId},allowPinnedCampaign:function(){return this.$store.getters["campaign/allowPinnedCampaign"]}}},Qe=Xe,Ze=(a("8116"),Object(b["a"])(Qe,$e,je,!1,null,"03d7d2e6",null)),et=Ze.exports,tt={campaign:[{label:"COM_EMUNDUS_ONBOARD_NAME",value:"label",redirect:!0},{label:"COM_EMUNDUS_ONBOARD_START_DATE",value:"start_date"},{label:"COM_EMUNDUS_ONBOARD_END_DATE",value:"end_date"},{label:"COM_EMUNDUS_ONBOARD_STATE",value:"status"},{label:"COM_EMUNDUS_ONBOARD_NB_FILES",value:"nb_files"},{label:"",value:"actions"}],email:[{label:"COM_EMUNDUS_ONBOARD_SUBJECT",value:"subject",redirect:!0},{label:"COM_EMUNDUS_ONBOARD_CATEGORY",value:"category"},{label:"",value:"actions"}],form:[{label:"COM_EMUNDUS_ONBOARD_NAME",value:"label",redirect:!0},{label:"COM_EMUNDUS_ONBOARD_STATUS",value:"published"},{label:"",value:"actions"}],formulaire:[{label:"COM_EMUNDUS_ONBOARD_NAME",value:"label",redirect:!0},{label:"COM_EMUNDUS_ONBOARD_STATUS",value:"published"},{label:"",value:"actions"}],grilleEval:[{label:"COM_EMUNDUS_ONBOARD_NAME",value:"label",redirect:!0},{label:"COM_EMUNDUS_ONBOARD_STATUS",value:"published"},{label:"",value:"actions"}],formModels:[{label:"COM_EMUNDUS_ONBOARD_NAME",value:"label"},{label:"",value:"actions"}]};a("bef5");var at={components:{ListActionMenu:et},props:{data:{type:Object,required:!0},type:{type:String,required:!0}},data(){return{tds:[],lang:"fr",translations:{finished:"COM_EMUNDUS_ONBOARD_FILTER_CLOSE",yettocome:"COM_EMUNDUS_CAMPAIGN_YET_TO_COME",ongoing:"COM_EMUNDUS_CAMPAIGN_ONGOING",published:"COM_EMUNDUS_ONBOARD_FILTER_PUBLISH",unpublished:"COM_EMUNDUS_ONBOARD_FILTER_UNPUBLISH",active:"COM_EMUNDUS_ONBOARD_FILTER_PUBLISH_FORM",inactive:"COM_EMUNDUS_ONBOARD_FILTER_UNPUBLISH_FORM"}}},mounted(){this.tds=void 0!==typeof tt[this.type]?tt[this.type]:[],this.lang=this.$store.getters["global/shortLang"]},methods:{formattedDataFromTd(e){return"campaign"===this.type?this.formattedCampaignData(e):"email"===this.type?this.formattedEmailData(e):"form"===this.type||"formulaire"===this.type||"grilleEval"===this.type?this.formattedFormData(e):this.data[e.value]?this.data[e.value]:"-"},formattedCampaignData(e){switch(e.value){case"status":let t="";return this.isPublished?t+='<span class="tag published">'+this.translations.published+"</span>":t+='<span class="tag unpublished">'+this.translations.unpublished+"</span>",this.isFinished?t+='<span class="tag finished">'+this.translations.finished+"</span>":this.isYetToCome?t+='<span class="tag">'+this.translations.yettocome+"</span>":t+='<span class="tag">'+this.translations.ongoing+"</span>",t;case"start_date":case"end_date":return l()(this.data[e.value]).format("DD/MM/YYYY");case"actions":return"";default:return this.data[e.value]?this.data[e.value]:"-"}},formattedEmailData(e){switch(e.value){case"published":return this.isPublished?this.translations.published:this.translations.unpublished;case"actions":return"";default:return this.data[e.value]?this.data[e.value]:"-"}},formattedFormData(e){return"published"===e.value?this.isActive?this.translations.active:this.translations.inactive:"label"===e.value&&this.data.label&&"object"===typeof this.data.label?this.data.label[this.lang]?this.data.label[this.lang]:this.data.label.fr:"actions"===e.value?"":this.data[e.value]?this.data[e.value]:"-"},classFromTd(e){let t;switch(e.value){case"status":t="";break;case"published":t=this.isFinished?"tag finished":this.isPublished||this.isActive?"tag published":"tag unpublished";break;case"type":t="tag "+this.data[e.value];break;case"actions":return"";default:t="list-td-"+e.value}return t},validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},showModalPreview(){this.$emit("showModalPreview")},redirectToEditItem(e){!0===e.redirect&&(window.location.href=this.getEditUrlByType())},getEditUrlByType(){let e;switch(this.type){case"campaign":e="index.php?option=com_emundus&view=campaigns&layout=addnextcampaign&cid="+this.data.id+"&index=0";break;case"form":case"formulaire":e="index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.data.id+"&index=0&cid=";break;case"grilleEval":e="index.php?option=com_emundus&view=form&layout=formbuilder&prid=&index=0&cid=&evaluation="+this.data.id;break;case"email":e="index.php?option=com_emundus&view=emails&layout=add&eid="+this.data.id;break}return e}},computed:{isPublished(){return("campaign"==this.type||"email"==this.type)&&1==this.data.published},isActive(){return"form"==this.type||"formulaire"==this.type||"grilleEval"==this.type?1==this.data.status:null},isFinished(){return"campaign"==this.type&&l()(this.data.end_date)<l()()},isYetToCome(){return"campaign"==this.type&&l()(this.data.start_date)>l()()},hasActionMenu(){let e=!0;return"email"==this.type?!1===this.data.lbl.startsWith("custom_")&&!1===this.data.lbl.startsWith("email_")&&(e=!1):"grilleEval"==this.type&&(e=!1),e},actionMenuIsPublished(){return"email"==this.type||"campaign"==this.type?this.isPublished:"form"==this.type||"formulaire"==this.type||"grilleEval"==this.type?this.isActive:1==this.data.published}}},st=at,it=(a("8747"),Object(b["a"])(st,Pe,Fe,!1,null,null,null)),nt=it.exports,ot={components:{ListTableRow:nt},props:{type:{type:String,required:!0},actions:{type:Object,required:!0},params:{type:Object,default:{}},items:{type:[],required:!0}},data(){return{rowsData:[]}},mounted(){this.rowsData=void 0!==typeof tt[this.type]?tt[this.type]:[]},methods:{validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},showModalPreview(e){this.$emit("showModalPreview",e)}},computed:{isEmptyRowsData(){return 0===this.rowsData.length}},watch:{type:function(){this.rowsData=void 0!==typeof tt[this.type]?tt[this.type]:[]}}},lt=ot,rt=(a("d734"),Object(b["a"])(lt,Ie,ke,!1,null,"7bbc07f6",null)),ct=rt.exports,dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-grid",class:{"less-than-4":e.items.length<4},attrs:{id:"list-blocs"}},e._l(e.items,(function(t){return a("list-bloc",{key:t.id,attrs:{data:t,type:e.type,actions:e.actions},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:function(a){return e.showModalPreview(t.id)}}})})),1)},mt=[],ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-bloc-item"},[a("div",{staticClass:"title em-mb-16"},[a("h3",[e._v(e._s(e.title))]),e.data.start_date&&e.data.end_date?a("div",{staticClass:"dates"},[e._v(" "+e._s(e.translations.from)+" "),a("span",[e._v(e._s(e.formatDate(e.data.start_date)))]),e._v(" "+e._s(e.translations.to)+" "),a("span",[e._v(e._s(e.formatDate(e.data.end_date)))])]):e._e()]),a("div",{staticClass:"informations"},[e.data.short_description?a("div",{staticClass:"description",domProps:{innerHTML:e._s(e.data.short_description)}}):e._e(),null!==e.campaign.associatedCampaigns&&1===e.campaign.associatedCampaigns.length?a("div",{staticClass:"associated-campaigns em-w-100 em-flex-row",attrs:{title:e.translations.associatedCampaigns}},e._l(e.campaign.associatedCampaigns,(function(t){return a("div",{key:t.id,staticClass:"tag campaign-item em-p-4-8"},[e._v(" "+e._s(t.label)+" ")])})),0):null!==e.campaign.associatedCampaigns&&e.campaign.associatedCampaigns.length>1?a("div",{on:{click:e.displayAssociatedCampaigns}},[a("span",{staticClass:"em-pointer em-hover-underline"},[e._v(e._s(e.campaign.associatedCampaigns.length)+" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNS_ASSOCIATED")))])]):null!==e.campaign.associatedCampaigns&&0===e.campaign.associatedCampaigns.length?a("div",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNS_ASSOCIATED_NOT")))]):e._e(),a("div",{staticClass:"tags em-flex-row em-flex-start"},[e.displayPublished&&null!==e.isPublished?a("div",{class:{published:e.isPublished,unpublished:!e.isPublished}},[e._v(" "+e._s(e.isPublished?e.translations.publishedTag:e.translations.unpublishedTag)+" ")]):e._e(),e.displayPublished&&null!==e.isActive?a("div",{class:{published:e.isActive,unpublished:!e.isActive}},[e._v(" "+e._s(e.isActive?e.translations.active:e.translations.inactive)+" ")]):e._e(),"campaign"==e.type?a("div",{class:e.campaignStateClass},[e._v(" "+e._s(e.campaignState)+" ")]):e._e(),e.data.nb_files?a("div",[a("div",[e._v(" "+e._s(e.data.nb_files)+" "),e.data.nb_files>1?a("span",[e._v(e._s(e.translations.files))]):a("span",[e._v(e._s(e.translations.file))])])]):e._e(),"email"==e.type&&e.data.category&&e.data.category.length>0?a("div",[a("div",[e._v(" "+e._s(e.data.category)+" ")])]):e._e()])]),a("hr",{staticClass:"em-w-100"}),a("div",{staticClass:"actions em-flex-row em-w-100",class:{"em-flex-row-justify-end":""===e.getEditUrlByType(),"em-flex-space-between":""!==e.getEditUrlByType()}},[""!==e.getEditUrlByType()?a("a",{staticClass:"em-primary-button em-font-size-14 em-pointer",on:{click:e.redirectToEditItem}},[e._v(" "+e._s(e.translations.edit)+" ")]):e._e(),a("list-action-menu",{attrs:{type:e.type,itemId:e.data.id,isPublished:e.actionMenuIsPublished,showTootlip:e.hasActionMenu,nb_files:"campaign"===e.type?parseInt(e.data.nb_files):0,pinned:"campaign"===e.type?parseInt(e.data.pinned):0},on:{validateFilters:e.validateFilters,updateLoading:e.updateLoading,showModalPreview:e.showModalPreview}})],1)])},pt=[];const _t=a("bef5");var ht={components:{ListActionMenu:et},props:{data:{type:Object,required:!0},type:{type:String,required:!0},actions:{type:Object,required:!0}},data(){return{title:"",lang:"fr",translations:{publishedTag:"COM_EMUNDUS_ONBOARD_FILTER_PUBLISH",unpublishedTag:"COM_EMUNDUS_ONBOARD_FILTER_UNPUBLISH",active:"COM_EMUNDUS_ONBOARD_FILTER_PUBLISH_FORM",inactive:"COM_EMUNDUS_ONBOARD_FILTER_UNPUBLISH_FORM",isFinished:"COM_EMUNDUS_ONBOARD_FILTER_CLOSE",edit:"COM_EMUNDUS_ONBOARD_MODIFY",files:"COM_EMUNDUS_ONBOARD_FILES",file:"COM_EMUNDUS_ONBOARD_FILE",campaignAssociated:"COM_EMUNDUS_ONBOARD_CAMPAIGN_ASSOCIATED",campaignsAssociated:"COM_EMUNDUS_ONBOARD_CAMPAIGNS_ASSOCIATED",from:"COM_EMUNDUS_ONBOARD_FROM",to:"COM_EMUNDUS_ONBOARD_TO"},campaign:{associatedCampaigns:null}}},mounted(){this.lang=this.$store.getters["global/shortLang"],this.getTitle(),"formulaire"!==this.type&&"form"!==this.type&&"grilleEval"!==this.type||this.getAssociatedCampaigns()},methods:{getTitle(){this.data.label&&"string"===typeof this.data.label?this.title=this.data.label:this.data.label&&this.data.label[this.lang]?this.title=this.data.label[this.lang]:this.data.subject&&(this.title=this.data.subject)},redirectToEditItem(){window.location.href=this.getEditUrlByType()},getEditUrlByType(){let e="";switch(this.type){case"campaign":e="index.php?option=com_emundus&view=campaigns&layout=addnextcampaign&cid="+this.data.id+"&index=0";break;case"form":case"formulaire":e="index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.data.id+"&index=0&cid=";break;case"grilleEval":e="index.php?option=com_emundus&view=form&layout=formbuilder&prid=&index=0&cid=&evaluation="+this.data.id;break;case"email":e="index.php?option=com_emundus&view=emails&layout=add&eid="+this.data.id;break}return e},getAssociatedCampaigns(){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getassociatedcampaign",params:{pid:this.data.id},paramsSerializer:e=>_t.stringify(e)}).then(e=>{this.campaign.associatedCampaigns=e.data.data})},validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},showModalPreview(){this.$emit("showModalPreview")},formatDate(e){return l()(e).format("DD/MM/YYYY")},displayAssociatedCampaigns(){let e='<div class="em-flex-col-start" style="text-align: left">';this.campaign.associatedCampaigns.forEach(t=>{e+="<p>"+t.label+'</p><hr style="width: 100%; margin: 4px 0">'}),e+="</div>",j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_CAMPAIGNS_ASSOCIATED_TITLE"),html:e,type:"info",confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})}},computed:{isPublished(){return"campaign"==this.type||"email"==this.type?1==this.data.published:null},isActive(){return"form"==this.type||"formulaire"==this.type||"grilleEval"==this.type?1==this.data.status:null},isFinished(){return"campaign"==this.type&&l()(this.data.end_date)<l()()},campaignState(){if("campaign"==this.type){let e="";return e=l()(this.data.end_date)<l()()?this.translate("COM_EMUNDUS_ONBOARD_FILTER_CLOSE"):l()(this.data.start_date)>l()()?this.translate("COM_EMUNDUS_CAMPAIGN_YET_TO_COME"):this.translate("COM_EMUNDUS_CAMPAIGN_ONGOING"),e}return!1},campaignStateClass(){if("campaign"==this.type){let e="";return l()(this.data.end_date)<l()()&&(e="finished"),e}return!1},hasActionMenu(){let e=!0;return"email"==this.type?!1===this.data.lbl.startsWith("custom_")&&!1===this.data.lbl.startsWith("email_")&&(e=!1):"grilleEval"==this.type&&(e=!1),e},actionMenuIsPublished(){return"email"==this.type||"campaign"==this.type?this.isPublished:"form"==this.type||"formulaire"==this.type||"grilleEval"==this.type?this.isActive:1==this.data.published},displayPublished(){const e=tt[this.type].filter(e=>"published"==e.value||"status"==e.value);return e.length}}},gt=ht,ft=(a("3940"),Object(b["a"])(gt,ut,pt,!1,null,"d5b31bb0",null)),vt=ft.exports,bt={components:{ListBloc:vt},props:{type:{type:String,required:!0},actions:{type:Object,required:!0},params:{type:Object,default:{}},items:{type:[],required:!0}},methods:{validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},showModalPreview(e){this.$emit("showModalPreview",e)}}},Et=bt,Ot=(a("2209"),Object(b["a"])(Et,dt,mt,!1,null,"3b09f100",null)),Ct=Ot.exports,yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalEmailPreview_"+e.model}},[a("modal",{attrs:{name:"modalEmailPreview_"+e.model,height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{"before-open":e.beforeOpen}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.ModelPreview)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEmailPreview_"+e.model)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",{staticClass:"em-mb-16"},[null!=e.email?a("p",[a("span",{domProps:{innerHTML:e._s(e.email.message)}})]):e._e()])])],1)},Dt=[];a("bef5");var Mt={name:"modalEmailPreview",props:{model:String,models:Array},data(){return{email:null,ModelPreview:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_PREVIEWMODEL")}},methods:{beforeOpen(){this.models.forEach(e=>{e.id==this.model&&(this.email=e)})}}},Nt=Mt,At=Object(b["a"])(Nt,yt,Dt,!1,null,"6ffc524d",null),St=At.exports,wt={components:{ListTable:ct,ListBlocs:Ct,ModalEmailPreview:St},props:{type:{type:String,required:!0},actions:{type:Object,required:!0},params:{type:Object,default:{}},items:{type:[],required:!0}},data(){return{viewType:"blocs",viewTypeOptions:[{value:"table",icon:"dehaze"},{value:"blocs",icon:"grid_view"}],email:{emailToPreview:"-1"}}},created(){this.viewType=localStorage.getItem("tchooz_view_type/"+document.location.hostname),(null===this.viewType||"undefined"===typeof this.viewType||"blocs"!==this.viewType&&"table"!==this.viewType)&&(this.viewType="blocs",localStorage.setItem("tchooz_view_type/"+document.location.hostname,"blocs"))},methods:{changeViewType(e){this.viewType=e.value,localStorage.setItem("tchooz_view_type/"+document.location.hostname,e.value)},validateFilters(){this.$emit("validateFilters")},updateLoading(e){this.$emit("updateLoading",e)},showModalPreview(e){this.email.emailToPreview=e,setTimeout(()=>{this.$modal.show("modalEmailPreview_"+e)},200)}}},Ut=wt,Tt=(a("dbc3"),Object(b["a"])(Ut,Le,Be,!1,null,"671f389e",null)),Rt=Tt.exports,xt={components:{filters:Ae,ListHead:xe,ListBody:Rt},name:"List",data:()=>({loading:!1,actualLanguage:"",datas:{},all_datas:[],limited_datas:[],params:{},type:"",filter_columns:[],selecedItems:[],actions:{type:"",add_url:""},allPrograms:[],allSessions:[],selectedProgram:"all",selectedSession:"all",actualProgramShowingCampaignName:"Tous",recherche:"",timer:null,translations:{noCampaign:"COM_EMUNDUS_ONBOARD_NOCAMPAIGN",noProgram:"COM_EMUNDUS_ONBOARD_NOPROGRAM",noEmail:"COM_EMUNDUS_ONBOARD_NOEMAIL",noForm:"COM_EMUNDUS_ONBOARD_NOFORM",noFiles:"COM_EMUNDUS_ONBOARD_NOFILES"},total:0,filtersCount:"",filters:"",filtersCountFilter:"&filterCount=",filtersCountSearch:"&rechercheCount=",filtersFilter:"&filter=",filtersSort:"&sort=",filtersSearch:"&recherche=",filtersLim:"&lim=",filtersPage:"&page=",filtre:"",tri:"",search:"",limit:25,pages:1,countPages:1,menuEmail:0,email_categories:[],formModelsItems:[],selectedListTab:"formulaire"}),created(){this.datas=this.$store.getters["global/datas"],this.type=this.datas.type.value,this.filtersFilter="&filter=Publish",p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getActualLanguage"}).then(e=>{this.actualLanguage=e.data.msg}),"campaign"===this.type?(p.a.get("index.php?option=com_emundus&controller=programme&task=getallprogram").then(e=>{this.allPrograms=e.data.data,this.allPrograms.sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)}).catch(e=>{console.log(e)}),p.a.get("index.php?option=com_emundus&controller=programme&task=getallsessions").then(e=>{this.allSessions=e.data.data,this.allSessions.sort((e,t)=>e.year<t.year?-1:e.year>t.year?1:0)}).catch(e=>{console.log(e)})):"form"==this.type&&this.getFormModels(),this.getFiltersByType()},methods:{updateLoading(e){this.loading=e},getFiltersByType(){switch(this.type){case"campaign":this.filter_columns=["label","short_description"];break;case"email":this.filter_columns=["subject"];break;case"form":this.filter_columns=["label"];break;default:}},validateFilters(){this.updateLoading(!0),this.filtersCount=this.filtersCountFilter+this.filtersCountSearch,this.filters=this.filtersFilter+this.filtersSort+this.filtersSearch+this.filtersLim+this.filtersPage,"campaign"===this.type&&(this.filtersCount+="&program="+this.selectedProgram+"&session="+this.selectedSession,this.filters+="&program="+this.selectedProgram+"&session="+this.selectedSession),"formulaire"==this.type&&this.getFormModels(),this.allFilters()},filter(e){this.filtersCountFilter="&filterCount="+e,this.filtersFilter="&filter="+e,this.filtre=e,this.validateFilters()},sort(e){this.filtersSort="&sort="+e,this.tri=e,this.validateFilters()},cherche(e){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{if(this.recherche){let t=this.all_datas.filter((t,a)=>{let s=e.toLowerCase().split(" ");return this.filter_columns.some(e=>s.every(a=>t[e].toLowerCase().includes(a)))});this.$store.commit("lists/listUpdate",t),this.countPages=Math.ceil(t.length/this.limit)}else this.$store.commit("lists/listUpdate",this.limited_datas),this.countPages=Math.ceil(this.total/this.limit)},300)},nbresults(e){this.filtersLim="&lim="+e,this.limit=e,this.validateFilters()},nbpages(e){e>=1&&e<=this.countPages&&(this.filtersPage="&page="+e,this.pages=e,this.validateFilters())},paginationNumber(e){return this.countPages>10?e<4||e>this.countPages-3||e>this.pages-3&&e<this.pages+3?e:"...":e},allFilters(){let e="grilleEval"===this.typeForAdd?"form":this.typeForAdd;"files"!==this.type&&p.a.get("index.php?option=com_emundus&controller="+e+"&task=getall"+this.typeForAdd+this.filters).then(e=>{"undefined"!==typeof e.data.data.datas&&(this.total=e.data.data.count,0===this.all_datas.length&&(this.all_datas=e.data.data.datas),this.limited_datas=e.data.data.datas),this.$store.commit("lists/listUpdate",this.limited_datas),this.countPages=Math.ceil(this.total/this.limit),"email"==this.type&&p.a.get("index.php?option=com_emundus&controller=email&task=getemailcategories").then(e=>{this.email_categories=e.data.data}),"campaign"==this.type&&(this.$store.commit("campaign/setAllowPinnedCampaign",e.data.allow_pinned_campaigns),this.limited_datas.forEach(e=>{1==e.pinned&&this.$store.commit("campaign/setPinned",e.id)})),this.loading=!1}).catch(e=>{console.log(e),this.updateLoading(!1)})},updateTotal(e){this.total=e},selectAllItem(){return this.list.filter((function(e){this.$store.commit("lists/selectItem",e.id)}))},deselectItem(){this.$store.commit("lists/resetSelectedItemsList")},selectItem(e){this.$store.commit("lists/selectItem",e)},getFormModels(){return ze.getModels().then(e=>{e.status&&Array.isArray(e.data)&&(this.formModelsItems=[],e.data.forEach(e=>{this.formModelsItems.push({id:e.id,label:e.label[this.shortDefaultLang]})}))}),this.formModelsItems}},computed:{isEmpty:()=>list.getters.isSomething,noneDiscoverTranslation(){return"campaign"===this.type?this.translations.noCampaign:"program"===this.type?this.translations.noProgram:"email"===this.type?this.translations.noEmail:"formulaire"===this.type?this.translations.noForm:this.translations.noFiles},notEmptyEmailCategories(){return this.email_categories.filter(e=>""!==e)},list(){let e=this.$store.getters["lists/list"];return this.params.email_category&&(e=e.filter(e=>0==this.params.email_category||e.category===this.params.email_category)),e}},watch:{type:function(e){this.actions.type=e,this.typeForAdd="formulaire"===e?"form":e,"form"===this.typeForAdd&&(this.type="formulaire");let t="grilleEval"===this.typeForAdd?"form":this.typeForAdd;"email"==this.type||"campaign"==this.type?this.actions.add_url="index.php?option=com_emundus&view="+this.type+"s&layout=add":this.actions.add_url="index.php?option=com_emundus&view="+t+"&layout=add",this.validateFilters()},menuEmail:function(e){this.type="email",this.params={email_category:e}}}},Lt=xt,Bt=(a("adea"),Object(b["a"])(Lt,Ee,Oe,!1,null,"23ad9de0",null)),It=Bt.exports,kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"campaigns__add-campaign em-w-100"},["undefined"==typeof e.campaignId||0==e.campaignId?a("div",[a("div",{staticClass:"em-flex-row em-mt-16 em-pointer",on:{click:function(t){return e.redirectJRoute("index.php?option=com_emundus&view=campaigns")}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("p",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("BACK")))])]),a("div",{staticClass:"em-h3 em-mt-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CAMPAIGN")))]),a("p",{staticClass:"em-mt-16"},[e._v(e._s(e.translate("COM_EMUNDUS_GLOBAL_INFORMATIONS_DESC")))]),a("hr")]):e._e(),a("div",[e.ready?a("form",{staticClass:"fabrikForm",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[a("div",[a("div",{staticClass:"em-red-500-color em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_REQUIRED_FIELDS_INDICATE")))]),a("div",{staticClass:"em-mb-16"},[a("label",{attrs:{for:"campLabel"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_CAMPNAME"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.label[e.actualLanguage],expression:"form.label[actualLanguage]"}],staticClass:"form-control fabrikinput em-w-100",class:{"is-invalid":e.errors.label},attrs:{id:"campLabel",type:"text",required:""},domProps:{value:e.form.label[e.actualLanguage]},on:{focusout:function(t){return e.onFormChange()},input:function(t){t.target.composing||e.$set(e.form.label,e.actualLanguage,t.target.value)}}}),e.errors.label?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME")))])]):e._e()]),a("div",{staticClass:"em-grid-2 em-mb-16"},[a("div",[a("div",[a("label",{attrs:{for:"startDate"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_STARTDATE"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("datetime",{staticClass:"em-w-100",attrs:{id:"startDate",type:"datetime",format:"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_STARTDATE"),"input-id":"start_date",phrases:{ok:e.translate("COM_EMUNDUS_ONBOARD_OK"),cancel:e.translate("COM_EMUNDUS_ONBOARD_CANCEL")}},on:{focusout:function(t){return e.onFormChange()}},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1)]),a("div",[a("div",[a("label",{attrs:{for:"endDate"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_ENDDATE"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("datetime",{staticClass:"em-w-100",attrs:{id:"endDate",type:"datetime",format:"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_ENDDATE")+" *","input-id":"end_date","min-datetime":e.minDate,phrases:{ok:e.translate("COM_EMUNDUS_ONBOARD_OK"),cancel:e.translate("COM_EMUNDUS_ONBOARD_CANCEL")}},on:{focusout:function(t){return e.onFormChange()}},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1)])]),a("div",{staticClass:"em-mb-16"},[a("label",{attrs:{for:"year"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_PICKYEAR"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("autocomplete",{attrs:{id:"year",items:this.session,year:e.form.year,name:"2020 - 2021"},on:{searched:e.onSearchYear}})],1),a("div",{staticClass:"em-mb-16 em-flex-row"},[a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.published,expression:"form.published"}],staticClass:"em-toggle-check",attrs:{type:"checkbox","true-value":"1","false-value":"0",id:"published",name:"published"},domProps:{checked:Array.isArray(e.form.published)?e._i(e.form.published,null)>-1:e._q(e.form.published,"1")},on:{click:function(t){return e.onFormChange()},change:function(t){var a=e.form.published,s=t.target,i=s.checked?"1":"0";if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&e.$set(e.form,"published",a.concat([n])):o>-1&&e.$set(e.form,"published",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(e.form,"published",i)}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})]),a("span",{staticClass:"em-ml-8",attrs:{for:"published"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_PUBLISH")))])])]),a("hr"),a("div",{staticClass:"em-mb-16"},[a("div",{staticClass:"em-mb-16"},[a("div",{staticClass:"em-h4"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_INFORMATION")))])]),a("div",{staticClass:"em-mb-16"},[a("label",{staticStyle:{top:"5em"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_RESUME"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("editor-quill",{key:e.editorResumeKey,staticStyle:{height:"25em"},attrs:{text:e.form.short_description,enable_variables:!1,placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_RESUME"),id:"campResume",limit:500,toolbar:"light"},on:{focusout:e.onFormChange},model:{value:e.form.short_description,callback:function(t){e.$set(e.form,"short_description",t)},expression:"form.short_description"}})],1),a("label",{staticClass:"em-mt-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_DESCRIPTION")))]),"undefined"!=typeof e.form.description?a("div",{staticClass:"em-mb-16"},[a("editor-quill",{key:e.editorKey,staticStyle:{height:"25em"},attrs:{text:e.form.description,enable_variables:!1,placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_DESCRIPTION"),id:"campaign_description"},on:{focusout:e.onFormChange},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1):e._e()]),a("hr",{staticClass:"em-mt-64"}),a("div",{staticClass:"em-mt-32"},[a("div",{staticClass:"em-mb-16"},[a("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_PROGRAM")))])]),a("div",{staticClass:"em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGRAM_INTRO_DESC"))),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("div",{staticClass:"em-flex-row em-mb-16"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.training,expression:"form.training"}],staticClass:"form-control fabrikinput em-w-100",attrs:{id:"select_prog",disabled:this.programs.length<=0},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"training",t.target.multiple?a:a[0])},e.setCategory]}},[a("option",{attrs:{value:""}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_CHOOSEPROG")))]),e._l(this.programs,(function(t,s){return a("option",{key:s,attrs:{"data-category":t.programmes},domProps:{value:t.code}},[e._v(" "+e._s(t.label)+" ")])}))],2),0!=e.coordinatorAccess?a("button",{staticClass:"em-ml-8 em-transparent-button",attrs:{title:e.translate("COM_EMUNDUS_ONBOARD_ADDPROGRAM"),type:"button",id:"add-program"},on:{click:e.displayProgram}},[a("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("add_circle_outline")])]):e._e()]),a("transition",{attrs:{name:"slide-fade"}},[e.isHiddenProgram?a("div",[a("div",[a("div",{staticClass:"em-mb-16"},[a("label",{attrs:{for:"prog_label"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGNAME"))+" "),a("span",{staticClass:"em-red-500-color"},[e._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.programForm.label,expression:"programForm.label"}],staticClass:"form-control fabrikinput em-w-100",class:{"is-invalid":e.errors.progLabel},attrs:{type:"text",id:"prog_label",placeholder:" "},domProps:{value:e.programForm.label},on:{input:function(t){t.target.composing||e.$set(e.programForm,"label",t.target.value)}}})]),e.errors.progLabel?a("p",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROG_REQUIRED_LABEL")))])]):e._e(),a("div",{staticClass:"em-mb-16",staticStyle:{display:"none"}},[a("label",{attrs:{for:"prog_color"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGCOLOR")))]),a("div",{staticClass:"em-flex-row"},e._l(e.colors,(function(t,s){return a("div",[a("div",{staticClass:"em-color-round em-pointer em-flex-row em-flex-center",class:0!=s?"em-ml-8":"",style:e.selectedColor==t.text?"background-color:"+t.text+";border: 2px solid "+t.background:"background-color:"+t.text,on:{click:function(a){e.programForm.color=t.text,e.selectedColor=t.text}}},[e.selectedColor==t.text?a("span",{staticClass:"material-icons-outlined",staticStyle:{"font-weight":"bold",color:"black",filter:"invert(1)"}},[e._v("done")]):e._e()])])})),0)])])]):e._e()])],1),a("hr"),a("div",{staticClass:"em-flex-row em-flex-space-between em-float-right"},[a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){e.quit=1,e.submit()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"))+" ")])])]):e._e()]),e.submitted||!e.ready?a("div",{staticClass:"em-page-loader"}):e._e()])},Pt=[],Ft=a("0065"),$t=a("aaac"),jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"editor"},[a("div",{attrs:{id:"tiny_"+e.selector_id}})])},Gt=[],Ht=a("8e5c"),zt=a.n(Ht),Vt=a("f6f6"),Yt=a.n(Vt),qt=(a("a881"),a("59d1"),a("9908"),a("53b8"),a("66c5"),a("26ab"),a("2efd"),a("5cb9"),a("0898"),a("5aa7"),a("750b"),a("8f8e"),a("bedc"),{components:{editor:zt.a},props:{text:String,lang:String,placeholder:String,id:String,height:String,enable_variables:Boolean},data(){return{selector_id:this.id+Yt.a.random(1e4,99999),variables:{},data:null}},methods:{saveText(){void 0!==typeof zt.a.activeEditor&&null!==zt.a.activeEditor&&this.$emit("input",zt.a.activeEditor.getContent())}},watch:{text:function(){this.$forceUpdate()}},mounted(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=geteditorvariables"}).then(e=>{this.variables=e.data.data});var e=window.location.protocol+"//"+window.location.host+"/media/com_emundus_vue/";let t={selector:"#tiny_"+this.selector_id,images_upload_url:"index.php?option=com_emundus&controller=settings&task=uploadimages",plugins:"paste link media preview image code advlist hr emoticons lists searchreplace charmap quickbars pagebreak autolink print mention",toolbar:"undo redo | forecolor bold italic underline strikethrough | fontsizeselect | image preview | alignleft aligncenter alignright alignjustify hr | bullist numlist | outdent indent | insertfile media anchor| charmap emoticons backcolor | searchreplace print",fontsize_formats:"8pt 10pt 12pt 14pt 18pt 24pt 36pt",content_css:e+"skins/ui/oxide/content.min.css",convert_urls:!1,height:this.height,branding:!1,elementpath:!1,statusbar:!1,menubar:!1,a11y_advanced_options:!1,toolbar_sticky:!1,quickbars_insert_toolbar:"",quickbars_selection_toolbar:"bold italic underline | quicklink h2 h3 blockquote",toolbar_mode:"sliding",placeholder:this.placeholder,file_picker_types:"image",paste_data_images:!0,file_picker_callback:function(e,t,a){var s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.onchange=function(){var t=this.files[0],a=new FileReader;a.onload=function(){var s="blobid"+(new Date).getTime(),i=zt.a.activeEditor.editorUpload.blobCache,n=a.result.split(",")[1],o=i.create(s,t,n);i.add(o),e(o.blobUri(),{title:t.name})},a.readAsDataURL(t)},s.click()},mentions:{delimiter:"/",source:(e,t,a)=>{"/"===a&&1==this.enable_variables&&t(this.variables)},queryBy:"value",delay:200,insert:e=>(setTimeout(()=>{this.$emit("input",zt.a.activeEditor.getContent())},500),"<span>["+e.value+"]</span>"),render:function(e){return'<li class="email-tags"><a href="javascript:;"><span>'+e.value+"</span><p>"+e.description+"</p></a></li>"},renderDropdown:function(){return'<ul class="rte-autocomplete em-autocomplete dropdown-menu"></ul>'}},setup:e=>{e.on("keyup",()=>{this.$emit("input",zt.a.activeEditor.getContent())}),e.on("blur",()=>{this.$emit("focusout",zt.a.activeEditor.getContent())}),e.on("init",()=>{zt.a.activeEditor.setContent(this.text)})}};"fr"==this.lang?(t.language="fr_FR",t.language_url=e+"languages/fr_FR.js",zt.a.init(t)):zt.a.init(t),this.$forceUpdate(),setInterval(this.saveText,3e3)}}),Jt=qt,Wt=(a("c185"),Object(b["a"])(Jt,jt,Gt,!1,null,"da9a3e9e",null)),Kt=Wt.exports,Xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"autocomplete"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-w-100",class:""!==e.year?"":"placeholder",attrs:{type:"text",id:e.id,placeholder:""!==e.year?e.year:e.name},domProps:{value:e.search},on:{input:[function(t){t.target.composing||(e.search=t.target.value)},e.onChange],keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onArrowDown.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onArrowUp.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter.apply(null,arguments)}]}}),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"autocomplete-results"},e._l(e.results,(function(t,s){return a("li",{key:s,staticClass:"autocomplete-result",class:{"is-active":s===e.arrowCounter},on:{click:function(a){return e.setResult(t)}}},[e._v(" "+e._s(t)+" ")])})),0)])},Qt=[],Zt={name:"autocomplete",props:{items:{type:Array,required:!1,default:()=>[]},name:String,year:String,id:String},data(){return{search:"",results:[],isOpen:!1,sLoading:!1,arrowCounter:-1}},created(){const e=e=>new Promise(t=>setTimeout(t,e));e(2e3).then(()=>{this.search=this.year})},methods:{onSearching(e){this.$emit("searched",this.search)},onChange(){this.isOpen=!0,this.filterResults(),this.onSearching()},filterResults(){this.results=this.items.filter(e=>e.toLowerCase().indexOf(this.search.toLowerCase())>-1)},setResult(e){this.search=e,this.isOpen=!1,this.onSearching()},onArrowDown(){this.arrowCounter<this.results.length&&(this.arrowCounter=this.arrowCounter+1)},onArrowUp(){this.arrowCounter>0&&(this.arrowCounter=this.arrowCounter-1)},onEnter(){this.search=this.results[this.arrowCounter],this.isOpen=!1,this.arrowCounter=-1,this.onSearching()},handleClickOutside(e){this.$el.contains(e.target)||(this.isOpen=!1,this.arrowCounter=-1)}},mounted(){document.addEventListener("click",this.handleClickOutside)},destroyed(){document.removeEventListener("click",this.handleClickOutside)}},ea=Zt,ta=(a("532a"),Object(b["a"])(ea,Xt,Qt,!1,null,"2d2a5112",null)),aa=ta.exports,sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"translation"},[a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",{staticClass:"inlineflex",staticStyle:{margin:"25px"}},[a("label",{staticClass:"translate-label"},[e._v(e._s(e.TranslateIn))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.currentLangTranslation,expression:"currentLangTranslation"}],staticClass:"dropdown-toggle ml-10px",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.currentLangTranslation=t.target.multiple?a:a[0]}}},e._l(e.languages,(function(t){return a("option",{key:t.sef,domProps:{value:t.sef}},[e._v(e._s(t.title_native))])})),0)])]),a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.label[e.currentLangTranslation],expression:"label[currentLangTranslation]"}],staticClass:"form__input field-general w-input",attrs:{type:"text",id:"label_"+e.currentLangTranslation},domProps:{value:e.label[e.currentLangTranslation]},on:{input:function(t){t.target.composing||e.$set(e.label,e.currentLangTranslation,t.target.value)}}})])],1)},ia=[],na={name:"translation",props:{label:Object,actualLanguage:String},data(){return{currentLangTranslation:"en",languages:[],TranslateIn:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATE_IN")}},created(){this.getLanguages()},methods:{getLanguages(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getactivelanguages"}).then(e=>{this.languages=e.data.data,this.languages.forEach((e,t)=>{e.sef==this.actualLanguage&&this.languages.splice(t,1)}),this.currentLangTranslation=this.languages[0].sef})}},mounted(){document.addEventListener("click",this.handleClickOutside)},destroyed(){document.removeEventListener("click",this.handleClickOutside)}},oa=na,la=Object(b["a"])(oa,sa,ia,!1,null,"3122308b",null),ra=la.exports,ca=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{class:"editor_"+this.$attrs.id})])},da=[],ma={name:"editorQuill",components:{},props:{placeholder:String,text:String,enable_variables:{type:Boolean,default:!1},limit:{type:Number,default:null},toolbar:{type:String,default:"complete"}},data:()=>({editor:null,toolbarOptions:{complete:[["bold","italic","underline","strike"],["blockquote"],["image","link"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{color:[]}],[{font:[]}],[{align:[]}]],light:[["bold","italic","underline","strike"]]}}),mounted(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=geteditorvariables"}).then(e=>{this.variables=e.data.data});var e={modules:{toolbar:this.toolbarOptions[this.$props.toolbar],imageResize:{},mention:null},placeholder:this.$props.placeholder,theme:"snow"};if(this.$props.enable_variables&&(e.modules.mention={allowedChars:/^[A-Za-z\sÅÄÖåäö]*$/,mentionDenotationChars:["/"],source:(e,t,a)=>{let s;if("/"===a&&(s=this.variables),0===e.length)t(s,e);else{const a=[];for(let t=0;t<s.length;t++)~s[t].value.toLowerCase().indexOf(e.toLowerCase())&&a.push(s[t]);t(a,e)}},onSelect:(e,t)=>{t({denotationChar:"",id:e.id,value:"["+e.value+"]"},!0)},renderItem:(e,t)=>`<div><p>${e.value}</p><p class="em-font-size-12">${e.description}</p></div>`}),this.editor=new Quill(".editor_"+this.$attrs.id,e),""!==this.text&&null!==this.text&&"undefined"!==typeof this.text){let e=this.editor.clipboard.convert(this.text);this.editor.setContents(e)}this.editor.on("editor-change",(e,...t)=>{"text-change"===e&&(this.$props.limit&&this.editor.getLength()>this.$props.limit&&this.editor.deleteText(this.$props.limit,this.editor.getLength()),null===this.editor.root.innerHTML&&(this.editor.root.innerHTML=""),this.$emit("input",this.editor.root.innerHTML))}),this.editor.on("selection-change",(e,t,a)=>{e&&(e.length||this.$emit("focusout"))});var t=this.editor.getModule("toolbar");t.addHandler("image",this.imageHandler)},methods:{async imageHandler(){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{var t=e.files[0],a=new FormData;a.append("image",t);var s=t.name;await this.uploadFiles(t,s)}},async uploadFiles(e,t){try{const t=new FormData;t.append("image",e),await h().post("index.php?option=com_emundus&controller=settings&task=uploadimagetocustomfolder",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{const t=this.editor.getSelection();this.editor.insertEmbed(t.index,"image",e.data.file)})}catch(a){return{status:!1,msg:a.message}}}}},ua=ma,pa=(a("5114"),Object(b["a"])(ua,ca,da,!1,null,null,null)),_a=pa.exports;const ha=a("bef5");var ga={name:"addCampaign",components:{EditorQuill:_a,Datetime:Ft["Datetime"],Editor:Kt,Autocomplete:aa,Translation:ra},directives:{focus:{inserted:function(e){e.focus()}}},props:{campaign:Number},data:()=>({campaignId:0,actualLanguage:"",coordinatorAccess:0,quit:1,isHiddenProgram:!1,minDate:"",programs:[],years:[],status:[],languages:[],session:[],old_training:"",old_program_form:"",editorKey:0,editorResumeKey:0,form:{label:{},start_date:"",end_date:"",short_description:"",description:null,training:"",year:"",published:1,is_limited:0,profile_id:9,limit:50,limit_status:[]},programForm:{code:"",label:"",notes:"",programmes:"",published:1,apply_online:1,color:"#1C6EF2"},year:{label:"",code:"",schoolyear:"",published:1,profile_id:"",programmes:""},errors:{label:!1,progCode:!1,progLabel:!1,short_description:!1,limit_files_number:!1,limit_status:!1},colors:[{text:"#1C6EF2",background:"#79B6FB"},{text:"#20835F",background:"#87D4B8"},{text:"#DB333E",background:"#FBABAB"},{text:"#FFC633",background:"#FEEBA1"}],selectedColor:"#1C6EF2",submitted:!1,ready:!1}),created(){""==this.$props.campaign?this.campaignId=this.$store.getters["global/datas"].campaign?this.$store.getters["global/datas"].campaign.value:0:this.campaignId=this.$props.campaign?this.$props.campaign:0,this.actualLanguage=this.$store.getters["global/shortLang"],this.coordinatorAccess=this.$store.getters["global/coordinatorAccess"],$t["Settings"].defaultLocale=this.actualLanguage;let e=new Date;this.form.start_date=$t["DateTime"].local(e.getFullYear(),e.getMonth()+1,e.getDate(),0,0,0).toISO(),this.getLanguages().then(()=>{this.getCampaignById()})},methods:{getCampaignById(){"undefined"!==typeof this.campaignId&&""!==this.campaignId&&this.campaignId>0?p.a.get("index.php?option=com_emundus&controller=campaign&task=getcampaignbyid&id="+this.campaignId).then(e=>{let t=e.data.data.campaign.label;this.form=e.data.data.campaign,this.$emit("getInformations",this.form),this.programForm=e.data.data.program,this.form.label=e.data.data.label,this.languages.forEach(e=>{""!==this.form.label[e.sef]&&null!=this.form.label[e.sef]||(this.form.label[e.sef]=t)}),this.form.start_date=$t["DateTime"].fromSQL(this.form.start_date).toISO(),this.form.end_date=$t["DateTime"].fromSQL(this.form.end_date).toISO(),"0000-00-00T00:00:00.000Z"===this.form.end_date&&(this.form.end_date=""),"undefined"!=typeof e.data.data.campaign.status?(this.form.limit_status=[],this.form.is_limited=1,Object.values(e.data.data.campaign.status).forEach(e=>{this.form.limit_status[parseInt(e.limit_status)]=!0})):this.form.limit_status=[],this.ready=!0}).catch(e=>{console.log(e)}):this.ready=!0,this.getAllPrograms()},getAllPrograms(){p.a.get("index.php?option=com_emundus&controller=programme&task=getallprogram").then(e=>{e.data.status>0?(this.programs=e.data.data,0!==Object.keys(this.programs).length&&this.programs.sort((e,t)=>e.id-t.id)):this.programs=[]}).catch(e=>{console.log(e)}),this.getYears()},getYears(){p.a.get("index.php?option=com_emundus&controller=campaign&task=getyears").then(e=>{this.years=e.data.data,this.years.forEach(e=>{this.session.push(e.schoolyear)})}).catch(e=>{console.log(e)}),this.getStatus()},async getLanguages(){const e=await p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getactivelanguages"});return e&&(this.languages=e.data.data),e},setCategory(e){this.year.programmes=e.target.options[e.target.options.selectedIndex].dataset.category,this.programForm=this.programs.find(e=>e.code==this.form.training)},getStatus(){p.a.get("index.php?option=com_emundus&controller=settings&task=getstatus").then(e=>{this.status=e.data.data})},createCampaign(e){Ke.createCampaign(e).then(e=>{this.campaignId=e.data.data,this.quitFunnelOrContinue(this.quit)})},createCampaignWithNoExistingProgram(e){p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=createprogram",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ha.stringify({body:e})}).then(e=>{e.data.status?(this.form.progid=e.data.data.programme_id,this.form.training=e.data.data.programme_code,this.form.start_date=$t["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=$t["DateTime"].fromISO(this.form.end_date).toISO(),this.createCampaign(this.form)):(j.a.fire({title:this.translate(e.data.msg),text:e.data.data,type:"error",confirmButtonText:this.translate("OK"),customClass:{title:"em-swal-title",confirmButton:"em-flex-center"}}),this.submitted=!1)})},submit(){if(this.$store.dispatch("campaign/setUnsavedChanges",!0),this.errors={label:!1,progCode:!1,progLabel:!1,short_description:!1,limit_files_number:!1,limit_status:!1},""===this.form.label[this.actualLanguage]||null==this.form.label[this.actualLanguage]||"undefined"===typeof this.form.label[this.actualLanguage])return window.scrollTo({top:0,behavior:"smooth"}),this.errors.label=!0,0;if(""==this.form.end_date||"0000-00-00 00:00:00"==this.form.end_date){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("end_date");return e&&e.focus(),0}if(""==this.form.start_date||"0000-00-00 00:00:00"==this.form.start_date){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("start_date");return e&&e.focus(),0}if(""==this.form.year){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("year");return e&&e.focus(),0}if(1==this.form.is_limited){let e=this.form.limit_status.every(e=>!1===e);if(""==this.form.limit)return window.scrollTo({top:0,behavior:"smooth"}),this.errors.limit_files_number=!0,0;if(0==this.form.limit_status.length||e)return window.scrollTo({top:0,behavior:"smooth"}),this.errors.limit_status=!0,0}if(""==this.form.training){if(!this.isHiddenProgram)return document.getElementById("select_prog").focus(),0;if(""==this.programForm.label)return this.errors.progLabel=!0,document.getElementById("prog_label").focus(),0;{const e=this.programs.find(e=>e.label==this.programForm.label);if(void 0!=e)return this.errors.progLabel=!0,document.getElementById("prog_label").focus(),0}}this.year.label=this.form.label,this.year.code=this.form.training,this.year.schoolyear=this.form.year,this.year.published=this.form.published,this.year.profile_id=this.form.profile_id,""!=this.form.label.en&&null!=this.form.label.en&&"undefined"!=typeof this.form.label.en||(this.form.label.en=this.form.label.fr),this.submitted=!0,"undefined"!==typeof this.campaignId&&null!==this.campaignId&&""!==this.campaignId&&0!==this.campaignId?""!=this.form.training?this.updateCampaign():p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=createprogram",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ha.stringify({body:this.programForm})}).then(e=>{this.programForm.code=e.data.data.programme_code,this.form.progid=e.data.data.programme_id,this.updateCampaign()}).catch(e=>{console.log(e)}):""!==this.form.training?(this.programForm=this.programs.find(e=>e.code==this.form.training),this.form.training=this.programForm.code,this.form.start_date=$t["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=$t["DateTime"].fromISO(this.form.end_date).toISO(),this.createCampaign(this.form)):this.createCampaignWithNoExistingProgram(this.programForm)},updateCampaign(){this.form.training=this.programForm.code,this.form.start_date=$t["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=$t["DateTime"].fromISO(this.form.end_date).toISO(),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updatecampaign",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ha.stringify({body:this.form,cid:this.campaignId})}).then(e=>{if(!e.status)return j.a.fire({type:"error",title:this.translate("COM_EMUNDUS_ADD_CAMPAIGN_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.submitted=!1,0;this.$emit("nextSection"),this.$emit("updateHeader",this.form)}).catch(e=>{console.log(e)})},quitFunnelOrContinue(e){0===e?this.redirectJRoute("index.php?option=com_emundus&view=campaign"):1===e&&(document.cookie="campaign_"+this.campaignId+"_menu = 1; expires=Session; path=/",this.redirectJRoute("index.php?option=com_emundus&view=campaigns&layout=addnextcampaign&cid="+this.campaignId+"&index=0"))},redirectJRoute(e){window.location.href=e},onSearchYear(e){this.form.year=e},onFormChange(){this.$store.dispatch("campaign/setUnsavedChanges",!0)},displayProgram(){this.isHiddenProgram?(document.getElementById("add-program").style="transform: rotate(0)",this.form.training=this.old_training,this.programForm=this.old_program_form,document.getElementById("select_prog").removeAttribute("disabled")):(this.old_training=this.form.training,this.old_program_form=this.programForm,this.form.training="",this.programForm={code:"",label:"",notes:"",programmes:"",published:1,apply_online:1},document.getElementById("add-program").style="transform: rotate(135deg)",document.getElementById("select_prog").setAttribute("disabled","disabled")),this.isHiddenProgram=!this.isHiddenProgram}},watch:{"form.start_date":function(e){this.minDate=$t["DateTime"].fromISO(e).plus({days:1}).toISO(),""==this.form.end_date&&(this.form.end_date=$t["DateTime"].fromISO(e).plus({days:1}).toISO())}}},fa=ga,va=(a("6c87"),Object(b["a"])(fa,kt,Pt,!1,null,"77afb2ef",null)),ba=va.exports,Ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"emails__add-email em-mt-24"},[a("notifications",{attrs:{group:"foo-velocity",position:"bottom left","animation-type":"velocity",speed:500,classes:"vue-notification-custom"}}),a("div",[a("form",{on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[a("div",[a("span",{staticClass:"em-red-500-color em-mb-8"},[e._v(e._s(e.translations.RequiredFieldsIndicate))]),a("div",{staticClass:"em-mb-16"},[a("h2",[e._v(e._s(e.translations.Informations))])]),a("div",[a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.translations.emailName)+" "),a("span",{staticStyle:{color:"#E5283B"}},[e._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.subject,expression:"form.subject"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.subject},attrs:{type:"text"},domProps:{value:e.form.subject},on:{input:function(t){t.target.composing||e.$set(e.form,"subject",t.target.value)}}})]),e.errors.subject?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.SubjectRequired))])]):e._e(),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.translations.emailBody)+" "),a("span",{staticStyle:{color:"#E5283B"}},[e._v("*")])]),e.dynamicComponent?a("editor",{class:{"is-invalid":e.errors.message},attrs:{id:"email",height:"30em",text:e.form.message,lang:e.actualLanguage,enable_variables:!0,placeholder:e.translations.EmailResume},model:{value:e.form.message,callback:function(t){e.$set(e.form,"message",t)},expression:"form.message"}}):e._e(),a("div",{staticClass:"em-mt-8"},[a("a",{staticClass:"em-main-500-color em-hover-main-600",attrs:{href:"component/emundus/?view=export_select_columns&format=html&layout=all_programs&Itemid=1173",target:"_blank"}},[e._v(e._s(e.translate("COM_EMUNDUS_EMAIL_SHOW_TAGS")))])])],1),e.errors.message?a("p",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.BodyRequired))])]):e._e()])]),a("hr"),a("div",[a("div",{staticClass:"em-flex-row em-mb-16"},[a("p",{staticClass:"em-h4 em-pointer",on:{click:e.displayAdvanced}},[e._v(e._s(e.translations.Advanced))]),a("button",{directives:[{name:"show",rawName:"v-show",value:!e.displayAdvancedParameters,expression:"!displayAdvancedParameters"}],staticClass:"em-transparent-button em-flex-column",attrs:{title:e.translations.Advanced,type:"button"},on:{click:e.displayAdvanced}},[a("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("add_circle_outline")])]),a("button",{directives:[{name:"show",rawName:"v-show",value:e.displayAdvancedParameters,expression:"displayAdvancedParameters"}],staticClass:"em-transparent-button em-flex-column",attrs:{title:e.translations.Advanced,type:"button"},on:{click:e.displayAdvanced}},[a("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("remove_circle_outline")])])]),e.displayAdvancedParameters?a("div",{attrs:{id:"email-advanced-parameters"}},[a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.translations.receiverName))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"em-w-100",attrs:{type:"text"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.translations.emailAddress))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.emailfrom,expression:"form.emailfrom"}],staticClass:"em-w-100",attrs:{type:"text"},domProps:{value:e.form.emailfrom},on:{input:function(t){t.target.composing||e.$set(e.form,"emailfrom",t.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.translations.emailCategory))]),a("autocomplete",{attrs:{items:this.categories,year:this.form.category},on:{searched:e.onSearchCategory}})],1),a("div",{staticClass:"form-group em-mb-8",attrs:{id:"receivers_cc"}},[a("label",[e._v(e._s(e.translations.ReceiversCC))]),a("multiselect",{attrs:{label:"email","track-by":"email",options:e.receivers_cc,multiple:!0,searchable:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.ReceiversCCPlaceHolder,"close-on-select":!1,"clear-on-select":!1},on:{tag:e.addNewCC},model:{value:e.selectedReceiversCC,callback:function(t){e.selectedReceiversCC=t},expression:"selectedReceiversCC"}})],1),a("div",{staticClass:"form-group em-mb-8",attrs:{id:"receivers_bcc"}},[a("label",[e._v(e._s(e.translations.ReceiversBCC))]),a("multiselect",{attrs:{label:"email","track-by":"email",options:e.receivers_bcc,multiple:!0,searchable:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.ReceiversBCCPlaceHolder,"close-on-select":!1,"clear-on-select":!1},on:{tag:e.addNewBCC},model:{value:e.selectedReceiversBCC,callback:function(t){e.selectedReceiversBCC=t},expression:"selectedReceiversBCC"}})],1),e.attached_letters?a("div",{staticClass:"form-group em-mb-8",attrs:{id:"attached_letters"}},[a("label",[e._v(e._s(e.translations.Letters))]),a("multiselect",{attrs:{label:"value","track-by":"id",options:e.attached_letters,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.LettersPlaceHolder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedLetterAttachments,callback:function(t){e.selectedLetterAttachments=t},expression:"selectedLetterAttachments"}})],1):e._e(),e.tags?a("div",{staticClass:"form-group em-mb-8"},[a("label",[e._v(e._s(e.translations.Tags))]),a("multiselect",{attrs:{label:"label","track-by":"id",options:e.action_tags,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.TagsPlaceHolder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1):e._e(),a("div",{staticClass:"form-group em-mb-8"},[a("label",[e._v(e._s(e.translations.CandidateAttachments))]),a("multiselect",{attrs:{label:"value","track-by":"id",options:e.candidate_attachments,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.CandidateAttachmentsPlaceholder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedCandidateAttachments,callback:function(t){e.selectedCandidateAttachments=t},expression:"selectedCandidateAttachments"}})],1)]):e._e()]),a("div",{staticClass:"em-flex-row em-flex-space-between em-mt-16"},[a("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button",onclick:"history.back()"}},[e._v(" "+e._s(e.translations.retour)+" ")]),a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"submit"}},[e._v(" "+e._s(e.translations.continuer)+" ")])])])]),e.loading||e.submitted?a("div",{staticClass:"em-page-loader"}):e._e()],1)},Oa=[],Ca=a("e191"),ya=a.n(Ca);const Da={datas:[],currentLanguage:"",shortLang:"",manyLanguages:"",defaultLang:"",coordinatorAccess:"",sysadminAccess:!1,anonyme:!1},Ma={datas:e=>e.datas,currentLanguage:e=>e.currentLanguage,shortLang:e=>e.shortLang,manyLanguages:e=>e.manyLanguages,defaultLang:e=>e.defaultLang,coordinatorAccess:e=>e.coordinatorAccess,sysadminAccess:e=>e.sysadminAccess},Na={setLang({commit:e},t){e("setLang",t)},setAnonyme({commit:e},t){e("setAnonyme",t)}},Aa={initDatas(e,t){return e.datas=t,e.datas},initCurrentLanguage(e,t){return e.currentLanguage=t,e.currentLanguage},initShortLang(e,t){return e.shortLang=t,e.shortLang},initManyLanguages(e,t){return e.manyLanguages=t,e.manyLanguages},initDefaultLang(e,t){return e.defaultLang=t,e.defaultLang},initCoordinatorAccess(e,t){return e.coordinatorAccess=t,e.coordinatorAccess},initSysadminAccess(e,t){return e.sysadminAccess=t,e.sysadminAccess},setAnonyme(e,t){e.anonyme=t}};var Sa={namespaced:!0,state:Da,getters:Ma,actions:Na,mutations:Aa};const wa=a("bef5");var Ua={name:"addEmail",components:{Editor:Kt,Autocomplete:aa,Multiselect:ya.a},data:()=>({email:0,actualLanguage:"",langue:0,dynamicComponent:!1,displayAdvancedParameters:!1,translations:{AddEmail:"COM_EMUNDUS_ONBOARD_ADD_EMAIL",Advanced:"COM_EMUNDUS_ONBOARD_ADVANCED_CUSTOMING",Informations:"COM_EMUNDUS_ONBOARD_ADDCAMP_INFORMATION",Trigger:"COM_EMUNDUS_ONBOARD_EMAIL_TRIGGER",emailType:"COM_EMUNDUS_ONBOARD_ADDEMAIL_CHOOSETYPE",emailCategory:"COM_EMUNDUS_ONBOARD_CHOOSECATEGORY",retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",continuer:"COM_EMUNDUS_ONBOARD_ADD_CONTINUER",emailName:"COM_EMUNDUS_ONBOARD_ADDEMAIL_NAME",emailBody:"COM_EMUNDUS_ONBOARD_ADDEMAIL_BODY",receiverName:"COM_EMUNDUS_ONBOARD_ADDEMAIL_RECEIVER",emailAddress:"COM_EMUNDUS_ONBOARD_ADDEMAIL_ADDRESS",EmailResume:"COM_EMUNDUS_ONBOARD_ADDEMAIL_RESUME",RequiredFieldsIndicate:"COM_EMUNDUS_ONBOARD_REQUIRED_FIELDS_INDICATE",EmailType:"COM_EMUNDUS_ONBOARD_EMAILTYPE",SubjectRequired:"COM_EMUNDUS_ONBOARD_SUBJECT_REQUIRED",BodyRequired:"COM_EMUNDUS_ONBOARD_BODY_REQUIRED",Program:"COM_EMUNDUS_ONBOARD_ADDCAMP_PROGRAM",Model:"COM_EMUNDUS_ONBOARD_TRIGGERMODEL",ModelRequired:"COM_EMUNDUS_ONBOARD_TRIGGERMODEL_REQUIRED",Status:"COM_EMUNDUS_ONBOARD_TRIGGERSTATUS",StatusRequired:"COM_EMUNDUS_ONBOARD_TRIGGERSTATUS_REQUIRED",Target:"COM_EMUNDUS_ONBOARD_TRIGGERTARGET",TargetRequired:"COM_EMUNDUS_ONBOARD_TRIGGERTARGET_REQUIRED",Administrators:"COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS",Evaluators:"COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS",Candidates:"COM_EMUNDUS_ONBOARD_PROGRAM_CANDIDATES",DefinedUsers:"COM_EMUNDUS_ONBOARD_PROGRAM_DEFINED_USERS",ChooseUsers:"COM_EMUNDUS_ONBOARD_TRIGGER_CHOOSE_USERS",UsersRequired:"COM_EMUNDUS_ONBOARD_TRIGGER_USERS_REQUIRED",Search:"COM_EMUNDUS_ONBOARD_SEARCH_USERS",TheCandidate:"COM_EMUNDUS_ONBOARD_THE_CANDIDATE",Manual:"COM_EMUNDUS_ONBOARD_MANUAL",Actions:"COM_EMUNDUS_ONBOARD_TRIGGER_ACTIONS",Tags:"COM_EMUNDUS_ONBOARD_EMAIL_TAGS",DocumentType:"COM_EMUNDUS_ONBOARD_EMAIL_DOCUMENT",Letters:"COM_EMUNDUS_ONBOARD_EMAIL_DOCUMENT",LettersPlaceHolder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_EMAIL_DOCUMENT",ReceiversCC:"COM_EMUNDUS_ONBOARD_RECEIVER_CC_TAGS",ReceiversCCPlaceHolder:"COM_EMUNDUS_ONBOARD_RECEIVER_CC_TAGS_PLACEHOLDER",ReceiversBCC:"COM_EMUNDUS_ONBOARD_RECEIVER_BCC_TAGS",ReceiversBCCPlaceHolder:"COM_EMUNDUS_ONBOARD_RECEIVER_BCC_TAGS_PLACEHOLDER",CopiesTooltips:"COM_EMUNDUS_ONBOARD_CC_BCC_TOOLTIPS",TagsPlaceHolder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_EMAIL_TAGS",CandidateAttachments:"COM_EMUNDUS_ONBOARD_CANDIDAT_ATTACHMENTS",CandidateAttachmentsPlaceholder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_CANDIDAT_ATTACHMENTS"},categories:[],programs:[],status:[],users:[],selectedUsers:[],enableTip:!1,searchTerm:"",selectall:!1,tags:[],documents:[],selectedTags:[],selectedCandidateAttachments:[],form:{lbl:"",subject:"",name:"",emailfrom:"",message:"",type:2,category:"",published:1},trigger:{model:null,status:null,action_status:null,target:null,program:null},triggered:!1,errors:{subject:!1,message:!1,trigger:{model:!1,status:!1,target:!1,selectedUsers:!1,action_status:!1}},submitted:!1,loading:!1,selectedReceiversCC:[],selectedReceiversBCC:[],selectedLetterAttachments:[],receivers_cc:[],receivers_bcc:[],attached_letters:[],action_tags:[],candidate_attachments:[]}),created(){this.loading=!0,this.getAllAttachments(),this.getAllTags(),this.getAllDocumentLetter(),this.actualLanguage=this.$store.getters["global/shortLang"],p.a.get("index.php?option=com_emundus&controller=email&task=getemailcategories").then(e=>{this.categories=e.data.data,this.email=this.$store.getters["global/datas"].email.value,"undefined"!==typeof this.email&&0!==this.email&&""!==this.email?this.getEmailById(this.email):(this.dynamicComponent=!0,this.loading=!1)}).catch(e=>{console.log(e)}),setTimeout(()=>{this.enableVariablesTip()},2e3),this.getProgramsList(),this.getStatus(),this.getUsers()},mounted(){"en"===this.actualLanguage&&(this.langue=1)},methods:{getEmailById(){p.a.get("index.php?option=com_emundus&controller=email&task=getemailbyid&id="+this.email).then(e=>{!1!==e.data.data&&0!=e.data.status?(this.form=e.data.data.email,this.dynamicComponent=!0,this.selectedLetterAttachments=e.data.data.letter_attachment?e.data.data.letter_attachment:[],this.selectedCandidateAttachments=e.data.data.candidate_attachment?e.data.data.candidate_attachment:[],this.selectedTags=e.data.data.tags?e.data.data.tags:[],null!==e.data.data.receivers&&void 0!==e.data.data.receivers&&""!==e.data.data.receivers&&this.setEmailReceivers(e.data.data.receivers),this.loading=!1):this.runError(void 0,e.data.msg)}).catch(e=>{console.log(e),this.runError(void 0,e.data.msg)})},setEmailReceivers(e){let t=[],a=[];for(let n=0;n<e.length;n++)t[n]={},a[n]={},"receiver_cc_email"===e[n].type||"receiver_cc_fabrik"===e[n].type?(t[n]["id"]=e[n].id,t[n]["email"]=e[n].receivers):"receiver_bcc_email"!==e[n].type&&"receiver_bcc_fabrik"!==e[n].type||(a[n]["id"]=e[n].id,a[n]["email"]=e[n].receivers);const s=t.filter(e=>null!==e["id"]&&void 0!==e["id"]),i=a.filter(e=>null!==e["id"]&&void 0!==e["id"]);this.selectedReceiversCC=s,this.selectedReceiversBCC=i},displayAdvanced(){this.displayAdvancedParameters=!this.displayAdvancedParameters},addNewCC(e){const t={email:e,id:e.substring(0,2)+Math.floor(1e7*Math.random())};this.receivers_cc.push(t),this.selectedReceiversCC.push(t)},addNewBCC(e){const t={email:e,id:e.substring(0,2)+Math.floor(1e7*Math.random())};this.receivers_bcc.push(t),this.selectedReceiversBCC.push(t)},getAllUsers:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=getallusers",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.receivers_cc=e.data.users,this.receivers_bcc=e.data.users}).catch(e=>{console.log(e)})},getProgramsList(){p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getallprogram",params:{filter:"",sort:"",recherche:"",lim:100,page:1},paramsSerializer:e=>wa.stringify(e)}).then(e=>{this.programs=e.data.data})},getStatus(){p.a.get("index.php?option=com_emundus&controller=email&task=getstatus").then(e=>{this.status=e.data.data})},getUsers(){p.a.get("index.php?option=com_emundus&controller=programme&task=getuserswithoutapplicants").then(e=>{this.users=e.data.data})},searchUserByTerm(){p.a.get("index.php?option=com_emundus&controller=programme&task=searchuserbytermwithoutapplicants&term="+this.searchTerm).then(e=>{this.users=e.data.data})},addTrigger(){null!=this.trigger.program?this.triggered=!0:this.triggered=!1},selectAllUsers(){this.users.forEach(e=>{this.selectall?this.selectedUsers[e.id]=!1:this.selectedUsers[e.id]=!0}),this.$forceUpdate()},submit(){if(this.errors={subject:!1,message:!1,trigger:{model:!1,status:!1,target:!1,selectedUsers:!1}},""==this.form.subject)return this.errors.subject=!0,0;if(""==this.form.message)return this.errors.message=!0,0;if(null!=this.trigger.program){if(null==this.trigger.action_status)return this.errors.trigger.action_status=!0,0;if(null==this.trigger.status)return this.errors.trigger.status=!0,0;if(null==this.trigger.target)return this.errors.trigger.target=!0,0;if(0==this.trigger.target&&0===this.selectedUsers.length)return this.errors.trigger.selectedUsers=!0,0}this.submitted=!0,""!==this.email?p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=updateemail",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:wa.stringify({body:this.form,code:this.email,selectedReceiversCC:this.selectedReceiversCC,selectedReceiversBCC:this.selectedReceiversBCC,selectedLetterAttachments:this.selectedLetterAttachments,selectedCandidateAttachments:this.selectedCandidateAttachments,selectedTags:this.selectedTags})}).then(()=>{this.redirectJRoute("index.php?option=com_emundus&view=emails")}).catch(e=>{console.log(e)}):p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createemail",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:wa.stringify({body:this.form,selectedReceiversCC:this.selectedReceiversCC,selectedReceiversBCC:this.selectedReceiversBCC,selectedLetterAttachments:this.selectedLetterAttachments,selectedCandidateAttachments:this.selectedCandidateAttachments,selectedTags:this.selectedTags})}).then(e=>{this.trigger.model=e.data.data,p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createtrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:wa.stringify({trigger:this.trigger,users:this.selectedUsers})}).then(()=>{this.redirectJRoute("index.php?option=com_emundus&view=emails")})}).catch(e=>{console.log(e)})},onSearchCategory(e){this.form.category=e},enableVariablesTip(){this.enableTip||(this.enableTip=!0,this.tip())},redirectJRoute(e){window.location.href=e},tip:function(){this.show("foo-velocity",this.translate("COM_EMUNDUS_ONBOARD_VARIABLESTIP")+' <strong style="font-size: 16px">/</strong>',this.translate("COM_EMUNDUS_ONBOARD_TIP"))},show(e,t="",a="Information"){this.$notify({group:e,title:""+a,text:t,duration:1e4})},clean(e){this.$notify({group:e,clean:!0})},getAllTags:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=gettags",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.action_tags=e.data.data}).catch(e=>{console.log(e)})},getAllDocumentLetter:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=messages&task=getalldocumentsletters",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.attached_letters=e.data.documents}).catch(e=>{console.log(e)})},getAllAttachments:function(){p()({method:"get",url:"index.php?option=com_emundus&controller=messages&task=getallattachments",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.candidate_attachments=e.data.attachments}).catch(e=>{console.log(e)})}}},Ta=Ua,Ra=(a("21c8"),Object(b["a"])(Ta,Ea,Oa,!1,null,"2469f4f4",null)),xa=Ra.exports,La=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"add-form-next-campaign"}},[a("div",{staticClass:"em-w-custom"}),a("div",[a("ModalWarningFormBuilder",{attrs:{pid:e.getProfileId,cid:e.campaignId}}),a("div",[a("div",{staticClass:"em-flex-row em-mt-16 em-pointer",on:{click:function(t){return e.redirectJRoute("index.php?option=com_emundus&view=campaigns")}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("p",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("BACK")))])]),a("div",{staticClass:"em-flex-row em-mt-16"},[-1!=e.menuHighlight?a("h2",[e._v(e._s(this.translate(e.formCategories[e.menuHighlight])))]):e._e(),-1!=e.menuHighlightProg?a("h2",[e._v(e._s(this.translate(e.formPrograms[e.menuHighlightProg])))]):e._e()]),-1!=e.menuHighlight?a("p",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:e._s(this.translate(e.formCategoriesDesc[e.menuHighlight]))}}):e._e(),-1!=e.menuHighlightProg?a("p",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:e._s(this.translate(e.formProgramsDesc[e.menuHighlightProg]))}}):e._e(),a("hr"),a("div",{staticClass:"em-flex-row em-mb-32"},[a("p",[a("b",{staticStyle:{color:"var(--main-500)","font-weight":"700 !important"}},[e._v(" "+e._s(e.form.label))]),e._v(" "+e._s(e.translations.From)+" "),a("strong",[e._v(e._s(e.form.start_date))]),e._v(" "+e._s(e.translations.To)+" "),a("strong",[e._v(e._s(e.form.end_date))])])]),a("div",{staticClass:"em-flex-row"},[a("ul",{staticClass:"nav nav-tabs topnav"},[e._l(e.formCategories,(function(t,s){return a("li",{directives:[{name:"show",rawName:"v-show",value:e.closeSubmenu,expression:"closeSubmenu"}],key:"category-"+s},[a("a",{staticClass:"em-neutral-700-color em-pointer",class:[e.menuHighlight==s?"w--current":"",null==e.profileId?"grey-link":""],on:{click:function(t){null!=e.profileId&&e.changeToCampMenu(s)}}},[e._v(" "+e._s(e.translate(t))+" ")])])})),e._l(e.formPrograms,(function(t,s){return a("li",{directives:[{name:"show",rawName:"v-show",value:e.closeSubmenu,expression:"closeSubmenu"}],key:"program-"+s},[a("a",{staticClass:"em-neutral-700-color em-pointer",class:[e.menuHighlightProg==s?"w--current":"",null==e.profileId?"grey-link":""],on:{click:function(t){null!=e.profileId&&e.changeToProgMenu(s)}}},[e._v(" "+e._s(e.translate(t))+" ")])])}))],2)]),a("br"),-1!=e.menuHighlightProg?a("div",{staticClass:"warning-message-program mb-1"},[a("p",{staticClass:"em-red-500-color em-flex-row"},[a("span",{staticClass:"material-icons-outlined em-mr-8 em-red-500-color"},[e._v("warning_amber")]),e._v(e._s(e.translations.ProgramWarning))]),e.campaignsByProgram.length>0?a("ul",{staticClass:"em-mt-8 em-mb-32"},e._l(e.campaignsByProgram,(function(t,s){return a("li",{key:"camp_progs_"+s},[e._v(e._s(t.label))])})),0):e._e()]):e._e(),a("transition",{attrs:{name:"fade"}},[0==e.menuHighlight&&""!==e.campaignId?a("add-campaign",{attrs:{campaign:e.campaignId,coordinatorAccess:!0,actualLanguage:e.actualLanguage,manyLanguages:e.manyLanguages},on:{nextSection:function(t){e.menuHighlight++},getInformations:e.initInformations,updateHeader:e.updateHeader}}):e._e(),2==e.menuHighlight?a("addFormulaire",{key:e.formReload,attrs:{profileId:e.profileId,campaignId:e.campaignId,profiles:e.profiles,visibility:null},on:{profileId:e.setProfileId}}):e._e(),1==e.menuHighlight?a("add-documents-dropfiles",{attrs:{funnelCategorie:e.formCategories[e.langue][e.menuHighlight],profileId:e.getProfileId,campaignId:e.campaignId,menuHighlight:e.menuHighlight,langue:e.actualLanguage,manyLanguages:e.manyLanguages}}):e._e(),0==e.menuHighlightProg&&0!=e.program.id?a("add-email",{attrs:{prog:Number(e.program.id)}}):e._e()],1)],1),0!==e.menuHighlight&&0!==e.menuHighlightProg?a("div",{staticClass:"em-flex-row em-flex-space-between em-float-right"},[a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:e.next}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"))+" ")])]):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)])},Ba=[],Ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalWarningFormBuilder"}},[a("modal",{attrs:{name:"modalWarningFormBuilder",height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"fixed-header-modal"},[a("div",{staticClass:"topright"},[a("button",{staticClass:"btnCloseModal",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalWarningFormBuilder")}}},[a("em",{staticClass:"fas fa-times"})])]),a("div",{staticClass:"update-field-header"},[a("h2",{staticClass:"update-title-header"},[e._v(" "+e._s(e.Warning)+" ")]),a("p",[e._v(" "+e._s(e.FormAffectedToFiles)+" ")])]),a("div",{staticClass:"modalC-content"},[a("div",{staticClass:"em-flex-row em-flex-space-between mb-1"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer w-retour",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalWarningFormBuilder")}}},[e._v(" "+e._s(e.Retour)+" ")]),a("button",{staticClass:"bouton-sauvergarder-et-continuer em-mr-4",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.formbuilder()}}},[e._v(" "+e._s(e.Update)+" ")])])])])])],1)},ka=[];a("bef5");var Pa={name:"modalWarningFormBuilder",props:{pid:Number,cid:Number},data(){return{Warning:this.translate("COM_EMUNDUS_ONBOARD_WARNING"),FormAffectedToFiles:this.translate("COM_EMUNDUS_ONBOARD_FORM_AFFECTEDFILES"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Duplicate:this.translate("COM_EMUNDUS_ONBOARD_DUPLICATE"),Update:this.translate("COM_EMUNDUS_ONBOARD_MODIFY")}},methods:{beforeClose(e){},beforeOpen(e){},formbuilder(){window.location.replace("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.pid+"&index=0&cid="+this.cid)}}},Fa=Pa,$a=(a("4cea"),Object(b["a"])(Fa,Ia,ka,!1,null,"f0d240c8",null)),ja=$a.exports,Ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"w-form"},[a("vue-dropzone",{ref:"dropzone",staticStyle:{width:"100%"},attrs:{id:"customdropzone","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-removed-file":e.afterRemoved,"vdropzone-success":e.onComplete,"vdropzone-error":e.catchError}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.DropHere)+" ")])]),a("hr"),a("draggable",e._b({staticClass:"em-flex-row",staticStyle:{margin:"0"},attrs:{handle:".handle","chosen-class":"em-grabbing"},on:{end:e.updateDocumentsOrder},model:{value:e.documents,callback:function(t){e.documents=t},expression:"documents"}},"draggable",e.dragOptions,!1),[a("transition-group",{staticClass:"em-grid-3 em-w-100 handle",attrs:{type:"transition",value:e.drag?null:"flip-list"}},e._l(e.documents,(function(t,s){return a("div",{key:t.id,staticClass:"em-document-dropzone-card em-grab",attrs:{id:"itemDoc"+t.id}},[a("button",{staticClass:"em-float-right em-transparent-button",attrs:{type:"button"},on:{click:function(a){return e.deleteDoc(s,t.id)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])]),a("div",{staticClass:"em-flex-row em-w-100 em-flex-center"},[a("div",{staticClass:"em-flex-column em-edit-cursor",on:{click:function(a){return e.editName(t)}}},["pdf"===t.ext?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/pdf.png",alt:"filetype"}}):["docx","doc","odf"].includes(t.ext)?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/doc.png",alt:"filetype"}}):["xls","xlsx","csv"].includes(t.ext)?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/excel.png",alt:"filetype"}}):["png","gif","jpg","jpeg"].includes(t.ext)?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/image.png",alt:"filetype"}}):["zip","rar"].includes(t.ext)?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/zip.png",alt:"filetype"}}):["svg"].includes(t.ext)?a("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/svg.png",alt:"filetype"}}):e._e(),a("div",{staticClass:"em-mt-8"},[a("span",{staticClass:"em-overflow-ellipsis em-max-width-250 em-mr-4"},[e._v(e._s(t.title))])])])]),a("hr"),a("div",[a("span",[a("strong",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILE_SIZE"))+" : ")])]),a("span",[e._v(e._s(e.formatBytes(t.size)))])])])})),0)],1)],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Ha=[],za=a("d9b7"),Va=a.n(za),Ya=a("ca98"),qa=a.n(Ya);const Ja=a("bef5"),Wa=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var Ka={name:"addDocumentsDropfiles",components:{vueDropzone:Va.a,draggable:qa.a},props:{funnelCategorie:String,profileId:Number,campaignId:Number,langue:String,menuHighlight:Number,manyLanguages:Number},data(){return{dropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=uploaddropfiledoc&cid="+this.campaignId,maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,acceptedFiles:"image/*,application/pdf,.doc,.csv,.xls,.xlsx,.docx,.odf,.zip",previewTemplate:Wa(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG"),dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")},documents:[],Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),DropHere:this.translate("COM_EMUNDUS_ONBOARD_DROP_FILE_HERE"),Error:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),DocumentName:this.translate("COM_EMUNDUS_ONBOARD_DOCUMENT_NAME"),drag:!1,loading:!1}},methods:{getDocumentsDropfiles(){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=campaign&task=getdocumentsdropfiles",params:{cid:this.campaignId},paramsSerializer:e=>Ja.stringify(e)}).then(e=>{this.loading=!1,this.documents=e.data.documents})},updateDocumentsOrder(){this.documents.forEach((e,t)=>{e.ordering=t}),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updateorderdropfiledocuments",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ja.stringify({documents:this.documents})})},editName(e){j.a.fire({title:"",html:'<div class="form-group campaign-label"><label for="campLabel">'+this.DocumentName+'</label><input type="text" max="100" id="label_'+e.id+'" value="'+e.title+'"/></div>',showCloseButton:!0,allowOutsideClick:!1,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}).then(t=>{if(t){let t=document.getElementById("label_"+e.id).value;p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=editdocumentdropfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ja.stringify({did:e.id,name:t})}).then(()=>{e.title=t})}})},deleteDoc(e,t){this.documents.splice(e,1),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=deletedocumentdropfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ja.stringify({did:t})})},formatBytes(e,t=2){if(0===e)return"0 Bytes";const a=1024,s=t<0?0:t,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,n)).toFixed(s))+" "+i[n]},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){this.documents.push(JSON.parse(e.xhr.response)),this.$refs.dropzone.removeFile(e)},catchError:function(e,t){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)}},computed:{dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},created(){this.getDocumentsDropfiles()}},Xa=Ka,Qa=(a("100b"),Object(b["a"])(Xa,Ga,Ha,!1,null,"4b4d6931",null)),Za=Qa.exports,es=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ModalAddTrigger",{key:"candidate"+e.candidate_trigger,attrs:{prog:this.prog,trigger:this.triggerSelected,triggerAction:"candidate"},on:{UpdateTriggers:e.getTriggers}}),a("ModalAddTrigger",{key:"manual-"+e.manual_trigger,attrs:{prog:this.prog,trigger:this.triggerSelected,triggerAction:"manual"},on:{UpdateTriggers:e.getTriggers}}),a("div",{staticClass:"em-flex-row"},[a("span",{staticClass:"em-h4"},[e._v(e._s(e.CandidateAction))])]),a("p",[e._v(e._s(e.TheCandidateDescription))]),a("button",{staticClass:"em-primary-button em-w-auto em-mt-8",on:{click:function(t){e.$modal.show("modalAddTriggercandidate"),e.triggerSelected=null}}},[e._v(" "+e._s(e.addTrigger)+" ")]),a("transition-group",{staticClass:"em-grid-2 em-m-16",staticStyle:{"margin-left":"0"},attrs:{name:"slide-down",type:"transition"}},e._l(e.candidateTriggers,(function(t){return a("div",{key:t.trigger_id,staticClass:"em-email-card"},[a("div",{staticClass:"em-flex-row em-align-start em-flex-space-between em-w-100"},[a("div",[a("span",{staticClass:"em-mb-8"},[e._v(e._s(t.subject))]),a("div",{staticClass:"em-mt-8 em-mb-8"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.Target)+" : ")]),e._l(e.triggerUsersWithProfile(t),(function(s,i){return a("span",{key:"user_"+i},[e._v(" "+e._s(s.firstname)+" "+e._s(s.lastname)+" "),i!=Object.keys(t.users).length-1?a("span",[e._v(", ")]):e._e()])})),0==t.users.length&&5!=t.profile&&6!=t.profile?a("span",[e._v(e._s(e.TheCandidate))]):e._e(),5==t.profile?a("span",[e._v(e._s(e.Administrators))]):e._e(),6==t.profile?a("span",[e._v(e._s(e.Evaluators))]):e._e()],2),a("span",[e._v(e._s(e.Status)+" "+e._s(t.status))])]),a("div",{staticClass:"em-flex-row em-flex-end"},[a("a",{staticClass:"em-mr-8 em-pointer",on:{click:function(a){return e.editTrigger(t)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("edit")])]),a("a",{staticClass:"em-pointer",attrs:{title:e.removeTrig},on:{click:function(a){return e.removeTrigger(t.trigger_id)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])])])])})),0),a("div",{staticClass:"em-flex-row"},[a("span",{staticClass:"em-h4 em-mt-16"},[e._v(e._s(e.ManagerAction))])]),a("p",[e._v(e._s(e.ManualDescription))]),a("button",{staticClass:"em-primary-button em-w-auto em-mt-8",on:{click:function(t){e.$modal.show("modalAddTriggermanual"),e.triggerSelected=null}}},[e._v(" "+e._s(e.addTrigger)+" ")]),a("transition-group",{staticClass:"em-grid-2 em-m-16",staticStyle:{"margin-left":"0"},attrs:{name:"slide-down",type:"transition"}},e._l(e.manualTriggers,(function(t){return a("div",{key:t.trigger_id,staticClass:"em-email-card"},[a("div",{staticClass:"em-flex-row em-align-start em-flex-space-between em-w-100"},[a("div",[a("span",{staticClass:"em-mb-8"},[e._v(e._s(t.subject))]),a("div",{staticClass:"em-mt-8 em-mb-8"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.Target)+" : ")]),e._l(e.triggerUsersNoProfile(t),(function(s,i){return a("span",{key:"user_manual_"+i},[e._v(" "+e._s(s.firstname)+" "+e._s(s.lastname)+" "),i!=Object.keys(t.users).length-1?a("span",[e._v(", ")]):e._e()])})),0==t.users.length&&5!=t.profile&&6!=t.profile?a("span",[e._v(e._s(e.TheCandidate))]):e._e(),5==t.profile?a("span",[e._v(e._s(e.Administrators))]):e._e(),6==t.profile?a("span",[e._v(e._s(e.Evaluators))]):e._e()],2),a("p",[e._v(e._s(e.Status)+" "+e._s(t.status))])]),a("div",{staticClass:"em-flex-row em-flex-end"},[a("a",{staticClass:"em-pointer em-mr-8",on:{click:function(a){return e.editTrigger(t)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("edit")])]),a("a",{staticClass:"em-pointer",on:{click:function(a){return e.removeTrigger(t.trigger_id)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])])])])})),0),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},ts=[],as=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalAddTrigger"+e.triggerAction}},[a("modal",{attrs:{name:"modalAddTrigger"+e.triggerAction,height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("ModalEmailPreview",{attrs:{model:this.form.model,models:this.models}}),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.addTrigger)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddTrigger"+e.triggerAction)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",[a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.Model)+"* :")]),a("div",{staticClass:"em-flex-row"},[e.models.length>0?a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.model,expression:"form.model"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.model},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"model",t.target.multiple?a:a[0])}}},e._l(e.models,(function(t,s){return a("option",{key:s,domProps:{value:t.id}},[e._v(e._s(t.subject))])})),0):a("p",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ADD_TRIGGER_MISSING_EMAIL_MODELS")))])]),e.errors.model?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.ModelRequired))])]):e._e()]),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.Status)+"* :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.status,expression:"form.status"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.status},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"status",t.target.multiple?a:a[0])}}},e._l(e.status,(function(t,s){return a("option",{key:s,domProps:{value:t.step}},[e._v(e._s(t.value))])})),0),e.errors.status?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.StatusRequired))])]):e._e()]),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.Target)+"* :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.target,expression:"form.target"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.target},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"target",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"5"}},[e._v(e._s(e.Administrators))]),a("option",{attrs:{value:"6"}},[e._v(e._s(e.Evaluators))]),a("option",{attrs:{value:"1000"}},[e._v(e._s(e.Candidates))])]),e.errors.target?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.TargetRequired))])]):e._e()]),0==e.form.target?a("div",{staticClass:"em-mb-16",staticStyle:{"align-items":"baseline"}},[a("label",[e._v(e._s(e.ChooseUsers)+"* :")]),a("div",{staticClass:"em-flex-row"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],staticClass:"em-w-100",attrs:{type:"text",placeholder:e.Search},domProps:{value:e.searchTerm},on:{keyup:e.searchUserByTerm,input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}}),a("button",{staticClass:"em-transparent-button em-ml-8",attrs:{type:"button"},on:{click:e.searchUserByTerm}},[a("span",{staticClass:"material-icons-outlined"},[e._v("search")])])]),a("div",{staticClass:"em-flex-row"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectall,expression:"selectall"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selectall)?e._i(e.selectall,null)>-1:e.selectall},on:{click:e.selectAllUsers,change:function(t){var a=e.selectall,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.selectall=a.concat([n])):o>-1&&(e.selectall=a.slice(0,o).concat(a.slice(o+1)))}else e.selectall=i}}}),a("label",{staticClass:"em-ml-8"},[e._v(" "+e._s(e.SelectAll)+" ")])]),a("div",{class:{"is-invalid":e.errors.selectedUsers}},e._l(e.users,(function(t,s){return a("div",{key:s},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedUsers[t.id],expression:"selectedUsers[user.id]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selectedUsers[t.id])?e._i(e.selectedUsers[t.id],null)>-1:e.selectedUsers[t.id]},on:{change:function(a){var s=e.selectedUsers[t.id],i=a.target,n=!!i.checked;if(Array.isArray(s)){var o=null,l=e._i(s,o);i.checked?l<0&&e.$set(e.selectedUsers,t.id,s.concat([o])):l>-1&&e.$set(e.selectedUsers,t.id,s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.selectedUsers,t.id,n)}}}),a("div",{staticClass:"em-ml-8"},[a("p",[e._v(e._s(t.name))]),a("p",[e._v(e._s(t.email))])])])})),0),e.errors.selectedUsers?a("span",{staticClass:"em-red-500-color em-mb-8"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.UsersRequired))])]):e._e()]):e._e()]),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-8"},[a("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddTrigger"+e.triggerAction)}}},[e._v(e._s(e.Retour))]),a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createTrigger()}}},[e._v(e._s(e.Continuer))])])],1)],1)},ss=[];const is=a("bef5");var ns={name:"modalAddTrigger",components:{ModalEmailPreview:St},props:{prog:Number,trigger:Number,triggerAction:String},data(){return{errors:{model:!1,status:!1,action_status:!1,target:!1,selectedUsers:!1},form:{model:-1,status:null,action_status:null,target:null,program:this.prog},users:[],selectedUsers:[],models:[],status:[],searchTerm:"",changes:!1,selectall:!1,addTrigger:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_ADDTRIGGER"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),Model:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERMODEL"),ModelRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERMODEL_REQUIRED"),Status:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS"),StatusRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS_REQUIRED"),Target:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET"),TargetRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET_REQUIRED"),Administrators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS"),Evaluators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS"),Candidates:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_CANDIDATES"),DefinedUsers:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_DEFINED_USERS"),ChooseUsers:this.translate("COM_EMUNDUS_ONBOARD_TRIGGER_CHOOSE_USERS"),UsersRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGER_USERS_REQUIRED"),Search:this.translate("COM_EMUNDUS_ONBOARD_SEARCH_USERS"),ChangedActionStatus:this.translate("COM_EMUNDUS_ONBOARD_CHANGED_ACTION_STATUS"),TheCandidate:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE"),Manual:this.translate("COM_EMUNDUS_ONBOARD_MANUAL"),SelectAll:this.translate("COM_EMUNDUS_ONBOARD_SELECT_ALL")}},methods:{beforeClose(e){this.trigger=null,this.form={model:-1,status:null,action_status:null,target:null,program:this.prog}},beforeOpen(e){this.searchTerm="",this.getUsers(),this.getEmailModels(),this.getStatus(),setTimeout(()=>{null!=this.trigger&&this.getTrigger()},200),"candidate"===this.triggerAction?this.form.action_status="to_current_user":this.form.action_status="to_applicant"},createTrigger(){return this.errors={model:!1,status:!1,action_status:!1,target:!1,selectedUsers:!1},-1===this.form.model?(this.errors.model=!0,0):null==this.form.status?(this.errors.status=!0,0):null==this.form.action_status?(this.errors.action_status=!0,0):null==this.form.target?(this.errors.target=!0,0):0==this.form.target&&0===this.selectedUsers.length?(this.errors.selectedUsers=!0,0):void(null!=this.trigger?p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=updatetrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:is.stringify({tid:this.trigger,trigger:this.form,users:this.selectedUsers})}).then(e=>{this.selectedUsers=[],this.$emit("UpdateTriggers"),this.$modal.hide("modalAddTrigger"+this.triggerAction)}):p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createtrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:is.stringify({trigger:this.form,users:this.selectedUsers})}).then(e=>{this.selectedUsers=[],this.$emit("UpdateTriggers"),this.$modal.hide("modalAddTrigger"+this.triggerAction)}))},getUsers(){p.a.get("index.php?option=com_emundus&controller=programme&task=getuserswithoutapplicants").then(e=>{this.users=e.data.data})},searchUserByTerm(){p.a.get("index.php?option=com_emundus&controller=programme&task=searchuserbytermwithoutapplicants&term="+this.searchTerm).then(e=>{this.users=e.data.data})},getEmailModels(){p.a.get("index.php?option=com_emundus&controller=email&task=getallemail").then(e=>{e.data.status&&(this.models=e.data.data.datas)})},getStatus(){p.a.get("index.php?option=com_emundus&controller=email&task=getstatus").then(e=>{this.status=e.data.data})},getTrigger(){p.a.get("index.php?option=com_emundus&controller=email&task=gettriggerbyid&tid="+this.trigger).then(e=>{this.form.model=e.data.data.model,this.form.status=e.data.data.status,null==e.data.data.target&&0===e.data.data.to_current_user&&0===e.data.data.to_applicant?(this.form.target=0,e.data.data.users.forEach(e=>{this.selectedUsers[e.user_id]=!0})):5!=e.data.data.target&&6!=e.data.data.target||1===e.data.data.to_current_user?this.form.target=1e3:this.form.target=e.data.data.target})},selectAllUsers(){this.users.forEach(e=>{this.selectall?this.selectedUsers[e.id]=!1:this.selectedUsers[e.id]=!0}),this.$forceUpdate()}}},os=ns,ls=(a("d363"),Object(b["a"])(os,as,ss,!1,null,"13eb6d6e",null)),rs=ls.exports;const cs=a("bef5");var ds={name:"addEmail",components:{ModalAddTrigger:rs},props:{funnelCategorie:String,prog:Number},data(){return{triggers:[],triggerSelected:null,manual_trigger:0,candidate_trigger:0,loading:!1,addTrigger:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_ADDTRIGGER"),removeTrig:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_REMOVETRIGGER"),affectTriggers:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_AFFECTTRIGGERS"),ChooseEmailTrigger:this.translate("COM_EMUNDUS_ONBOARD_CHOOSE_EMAIL_TRIGGER"),Target:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET"),Status:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS"),Administrators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS"),Evaluators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS"),TheCandidate:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE"),Manual:this.translate("COM_EMUNDUS_ONBOARD_MANUAL"),TheCandidateDescription:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE_DESCRIPTION"),ManualDescription:this.translate("COM_EMUNDUS_ONBOARD_MANUAL_DESCRIPTION"),CandidateAction:this.translate("COM_EMUNDUS_ONBOARD_CANDIDATE_ACTION"),ManagerAction:this.translate("COM_EMUNDUS_ONBOARD_MANAGER_ACTION")}},methods:{editTrigger(e){this.triggerSelected=e.trigger_id,this.manual_trigger+=1,this.candidate_trigger+=1,setTimeout(()=>{1==e.candidate?this.$modal.show("modalAddTriggercandidate"):this.$modal.show("modalAddTriggermanual")},500)},removeTrigger(e){p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=removetrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:cs.stringify({tid:e})}).then(()=>{this.getTriggers()})},getTriggers(){p.a.get("index.php?option=com_emundus&controller=email&task=gettriggersbyprogram&pid="+this.prog).then(e=>{this.triggers=e.data.data,this.loading=!1})},triggerUsersWithProfile(e){return null!==e.profile?e.users:[]},triggerUsersNoProfile(e){return null===e.profile&&e.users.length>0?e.users:[]}},computed:{candidateTriggers(){return this.triggers.filter(e=>1==e.candidate)},manualTriggers(){return this.triggers.filter(e=>1==e.manual)}},created(){this.loading=!0,this.getTriggers()}},ms=ds,us=(a("a4a5"),Object(b["a"])(ms,es,ts,!1,null,"998e8f68",null)),ps=us.exports,_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a",{staticClass:"em-pointer",on:{click:e.addNewForm}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_NO_FORM_FOUND_ADD_FORM")))]),a("div",{staticClass:"em-mb-4 em-mt-16 em-text-color"},[e._v(e._s(e.ChooseForm)+" : ")]),a("div",{staticClass:"em-mb-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.$props.profileId,expression:"$props.profileId"}],attrs:{id:"select_profile"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.$props,"profileId",t.target.multiple?a:a[0])},e.updateProfileCampaign]}},e._l(e.profiles,(function(t,s){return a("option",{key:s,domProps:{value:t.id}},[e._v(" "+e._s(t.form_label)+" ")])})),0)]),a("a",{staticClass:"em-pointer",on:{click:e.formbuilder}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_EDIT_FORM")))]),a("hr"),a("p",{staticClass:"em-h5"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_PAGES_PREVIEW")))]),a("div",{staticClass:"em-flex-row"},e._l(e.formList,(function(t){return t.link.includes("fabrik")?a("div",{key:t.id,staticClass:"card-wrapper em-mr-32",attrs:{title:t.label}},[a("form-builder-preview-form",{staticClass:"card em-shadow-cards model-preview em-pointer",attrs:{form_id:Number(t.id),form_label:t.label}})],1):e._e()})),0),e.documentsList.length>0?a("div",[a("p",{staticClass:"em-h5 em-mt-12"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_ATTACHMENTS_PREVIEW")))]),a("div",{staticClass:"em-flex-row"},e._l(e.documentsList,(function(e){return a("div",{key:e.id,staticClass:"card-wrapper em-mr-32",attrs:{title:e.label}},[a("form-builder-preview-attachments",{staticClass:"card em-shadow-cards model-preview em-pointer",attrs:{document_id:Number(e.id),document_label:e.label}})],1)})),0)]):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},hs=[],gs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"em-flex-row em-flex-space-between em-align-start"},[a("div",{staticClass:"em-w-100"},[e.formLinkArray[e.indexHighlight]?a("FormViewer",{attrs:{link:e.formLinkArray[e.indexHighlight],visibility:this.visibility},on:{editPage:e.EditPage}}):e._e()],1),a("hr",{staticClass:"vertical-divider"}),a("div",{staticClass:"em-flex-column em-align-start em-mt-48"},[a("div",{staticClass:"em-mb-16"},[a("p",{staticClass:"em-h4"},[a("span",{staticClass:"material-icons-outlined"},[e._v("article")]),e._v(" "+e._s(e.Form)+" ")]),e._l(e.formNameArray,(function(t,s){return a("div",{key:s,staticClass:"MenuForm em-mb-8"},[a("a",{staticClass:"em-pointer em-text-neutral-900",class:e.indexHighlight==s?"MenuFormItem_current":"",domProps:{innerHTML:e._s(t.value)},on:{click:function(t){return e.ChangeIndex(s)}}},[e._v(e._s(t.value))])])}))],2),a("div",[a("p",{staticClass:"em-h4"},[a("span",{staticClass:"material-icons-outlined"},[e._v("folder")]),e._v(" "+e._s(e.Documents)+" ")]),e._l(e.documentsList,(function(t,s){return a("div",{key:s,staticClass:"MenuForm em-mb-8"},[a("p",{staticClass:"em-text-neutral-900"},[e._v(e._s(t.label))])])}))],2)])])])},fs=[],vs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-16 applicant-form",attrs:{id:"FormViewer"}},[e.object_json.show_page_heading?a("div",{class:e.object_json.show_page_heading.class,domProps:{innerHTML:e._s(e.object_json.show_page_heading.page_heading)}}):e._e(),a("div",{staticClass:"em-flex-row em-flex-space-between page-header"},[e.object_json.show_title?a("h1",{staticClass:"em-mt-0",domProps:{innerHTML:e._s(e.object_json.show_title.value)}}):e._e()]),e.object_json.intro_value?a("p",{staticClass:"em-mt-16",domProps:{innerHTML:e._s(e.object_json.intro_value)}}):e._e(),a("form",{staticClass:"fabrikForm",attrs:{method:"post","object_json.attribs":"",id:"form_"+e.object_json.id}},[e.object_json.plugintop?a("div",{domProps:{innerHTML:e._s(e.object_json.plugintop)}}):e._e(),e._l(e.object_json.Groups,(function(t){return a("fieldset",{key:t.index,staticClass:"fabrikGroup",class:t.group_class,style:t.group_css,attrs:{id:"group"+t.group_id}},[t.group_showLegend?a("legend",{staticClass:"legend"},[e._v(" "+e._s(t.group_showLegend)+" ")]):e._e(),t.group_intro?a("div",{domProps:{innerHTML:e._s(t.group_intro)}}):e._e(),e._l(t.elements,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:!1===t.hidden,expression:"element.hidden === false"}],key:t.index,staticClass:"row-fluid",class:{unpublished:!t.publish}},[a("div",{staticClass:"control-group fabrikElementContainer span12",class:"plg-"+t.plugin},[a("span",{domProps:{innerHTML:e._s(t.label_value)}}),t.params.date_table_format?a("div",[a("date-picker",{attrs:{config:e.options},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):0==t.labelsAbove?a("div",{staticClass:"controls"},[t.element?a("div",{class:t.errorClass,domProps:{innerHTML:e._s(t.element)}}):e._e(),t.tipSide?a("span",{domProps:{innerHTML:e._s(t.tipSide)}}):e._e()]):a("div",{staticClass:"fabrikElement",class:t.errorClass,domProps:{innerHTML:e._s(t.element)}}),t.tipSide?a("span",{domProps:{innerHTML:e._s(t.tipSide)}}):e._e(),t.tipBelow?a("span",{domProps:{innerHTML:e._s(t.tipBelow)}}):e._e()])])})),t.group_outro?a("div",{staticClass:"groupoutro",domProps:{innerHTML:e._s(e.group_outro)}}):e._e()],2)})),e.object_json.pluginbottom?a("div",{domProps:{innerHTML:e._s(e.object_json.pluginbottom)}}):e._e()],2),e.submitted?a("div",{staticClass:"em-page-loader"}):e._e()])},bs=[],Es=a("daef"),Os=a.n(Es);const Cs=a("bef5");var ys={name:"FormViewer",props:{link:{type:Object,default:{link:""}},visibility:Number},components:{datePicker:Os.a},data(){return{object_json:"",date:new Date,submitted:!1,options:{format:"DD/MM/YYYY",useCurrent:!1}}},methods:{splitProfileIdfromLabel(e){return e.split(/-(.+)/)[1]},formbuilder(){this.$emit("editPage")},getDataObject:Yt.a.debounce((function(){this.submitted=!0;let e=this.link.link.replace("fabrik","emundus");p.a.get(e+"&format=vue_jsonclean").then(e=>{this.object_json=e.data,null!=this.visibility&&p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=checkconstraintgroup",params:{cid:this.visibility},paramsSerializer:e=>Cs.stringify(e)}).then(e=>{Object.keys(this.object_json.Groups).forEach(t=>{null!=e.data.data?p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=checkvisibility",params:{group:this.object_json.Groups[t]["group_id"],cid:this.visibility},paramsSerializer:e=>Cs.stringify(e)}).then(e=>{parseInt(e.data.data)>0?this.object_json.Groups[t].visibility=!0:this.object_json.Groups[t].visibility=!1}):this.object_json.Groups[t].visibility=!0}),this.$forceUpdate()}),this.submitted=!1}).catch(e=>{console.log(e)})}),150),updateVisibility(e){this.object_json.Groups["group_"+e]["visibility"]=!this.object_json.Groups["group_"+e]["visibility"],p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=updatevisibility",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Cs.stringify({visibility:this.object_json.Groups["group_"+e]["visibility"],gid:e,cid:this.visibility})}).then(e=>{this.$forceUpdate()})}},created(){this.getDataObject()},watch:{link:function(){this.getDataObject()}}},Ds=ys,Ms=(a("1795"),Object(b["a"])(Ds,vs,bs,!1,null,"45f26282",null)),Ns=Ms.exports,As=(a("2051"),{name:"FormCarrousel",props:{formList:Array,documentsList:Array,visibility:Number},components:{FormViewer:Ns},data(){return{indexHighlight:"0",formNameArray:[],formLinkArray:[],formArray:[],FormPage:this.translate("COM_EMUNDUS_ONBOARD_FORM_PAGE"),Form:this.translate("COM_EMUNDUS_ONBOARD_FORM"),Documents:this.translate("COM_EMUNDUS_ONBOARD_DOCUMENTS")}},methods:{splitProfileIdfromLabel(e){return e.split(/-(.+)/)[1]},ChangeIndex(e){this.indexHighlight=e},EditPage(){this.$emit("formbuilder",this.indexHighlight)},getDataObject:function(){this.formList.forEach(e=>{let t=e.link.replace("fabrik","emundus");p.a.get(t+"&format=vue_jsonclean").then(t=>{this.formNameArray.push({value:t.data.show_title.value,rgt:e.rgt}),this.formLinkArray.push({link:e.link,rgt:e.rgt})}).then(e=>{this.formNameArray.sort((e,t)=>e.rgt-t.rgt),this.formLinkArray.sort((e,t)=>e.rgt-t.rgt)}).catch(e=>{console.log(e)})})}},created(){this.getDataObject()}}),Ss=As,ws=(a("2a42"),Object(b["a"])(Ss,gs,fs,!1,null,"1445cb68",null)),Us=ws.exports,Ts=(a("d22c"),a("2b9c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-h-100 em-w-100",class:{loading:e.loading},attrs:{id:"form-builder-preview-form"}},[e.loading?a("skeleton",{attrs:{height:"100%",width:"100%"}}):a("div",[a("p",{staticClass:"em-font-size-12 em-w-100 em-text-align-left em-mb-16"},[e._v(e._s(e.form_label))]),a("div",{staticClass:"preview-groups em-flex-column"},e._l(e.formData.groups,(function(t,s){return a("section",{key:t.id,staticClass:"em-mb-8 form-builder-page-section"},[a("div",{staticClass:"section-card em-flex-column"},[a("div",{staticClass:"section-identifier em-bg-main-500 em-flex-row"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION"))+" "+e._s(s+1)+" / "+e._s(e.formData.groups.length))])]),a("div",{staticClass:"section-content em-w-100"},[a("p",{staticClass:"em-font-size-8 em-w-100 em-text-align-left"},[e._v(e._s(t.label.replace("Model - ","")))])])])])})),0)])],1)}),Rs=[];const xs="index.php?option=com_emundus&controller=form";var Ls={async updateFormLabel(e){const t=new FormData;Object.keys(e).forEach(a=>t.append(a,e[a]));try{const e=await h().post(xs+"&task=updateformlabel",t);return e}catch(a){return{status:!1,error:a}}},async getFilesByForm(e){try{const t=await h().get(xs+"&task=getfilesbyform&pid="+e);return t}catch(t){return{status:!1,error:t}}},async getSubmissionPage(e){try{const t=await h().get(xs+"&task=getsubmittionpage",{params:{prid:e}});return t}catch(t){return{status:!1,error:t}}},async getFormsByProfileId(e){try{const t=await h().get(xs+"&task=getFormsByProfileId",{params:{profile_id:e}});return t}catch(t){return{status:!1,error:t}}},async getProfileLabelByProfileId(e){const t=new FormData;t.append("profile_id",e);try{const e=await h().post(xs+"&task=getProfileLabelByProfileId",t);return e}catch(a){return{status:!1,error:a}}},async getDocuments(e){try{const t=await h().get(xs+"&task=getDocuments",{params:{pid:e}});return t}catch(t){return{status:!1,error:t}}},async getDocumentModels(e=null){try{let t={status:!1};const a=await h().get(xs+"&task=getundocuments");if(a.data.status)if(null!==e){const s=a.data.data.filter(t=>t.id===e);t=s.length>0?{status:!0,data:s[0]}:{status:!1,error:"Document not found"}}else t=a.data;return t}catch(t){return{status:!1,error:t}}},async getDocumentModelsUsage(e){const t=new FormData;t.append("documentIds",e);try{const e=await h().post(xs+"&task=getdocumentsusage",t);return e.data}catch(a){return{status:!1,error:a}}},async getPageGroups(e){if(!("number"==typeof e&&e>0))return{status:!1,msg:"MISSING_PARAMS"};try{const t=await h().get(xs+"&task=getpagegroups&form_id="+e);return t.data}catch(t){return{status:!1,error:t}}},async reorderDocuments(e){try{const t=new FormData;t.append("documents",JSON.stringify(e));const a=await h().post(xs+"&task=reorderDocuments",t);return a}catch(t){return{status:!1,error:t}}},async addDocument(e){const t=new FormData;Object.keys(e).forEach(a=>t.append(a,e[a]));try{const e=await h().post(xs+"&task=addDocument",t);return e}catch(a){return{status:!1,error:a}}},async getAssociatedCampaigns(e){try{const t=h().get(xs+"&task=getassociatedcampaign",{params:{pid:e}});return t}catch(t){return{status:!1,error:t}}},async removeDocumentFromProfile(e){try{const t=await h().get(xs+"&task=removeDocumentFromProfile",{params:{did:e}});return t}catch(t){return{status:!1,error:t}}},async getPageObject(e){try{const t=await h().get("index.php?option=com_emundus&view=form&formid="+e+"&format=vue_jsonclean");return t}catch(t){return{status:!1,error:t}}},async checkIfDocumentCanBeDeletedForProfile(e,t){try{const a=await h().get(xs+"&task=checkcandocbedeleted&docid="+e+"&prid="+t);return a.data}catch(a){return{status:!1,error:a}}}},Bs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.elements.length?a("div",{staticClass:"fabrikGroup"},[a("legend",[e._v(e._s(e.translate(e.group.label)))]),e._l(e.filteredElements,(function(t){return a("div",{key:t.id,staticClass:"em-profile-element row-fluid",attrs:{id:"element_"+t.id}},[a(t.plugin,{key:t.id,tag:"component",attrs:{element:t,value:e.user[t.name]},on:{input:e.updateValue}})],1)}))],2):e._e()},Is=[],ks=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-group fabrikElementContainer"},[a("label",{staticClass:"fabrikLabel",attrs:{for:"input_"+e.element.id}},[e._v(e._s(e.element.label))]),a("div",{staticClass:"fabrikElement"},[e.tip.length>0?a("span",{staticClass:"em-tip"},[e._v(e._s(e.tip))]):e._e(),"checkbox"!==e.type||e.readonly?"radio"!==e.type||e.readonly?e.readonly?a("p",[e._v(e._s(e.value))]):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"fabrikinput em-w-100",attrs:{id:"input_"+e.element.id,name:e.element.name,type:e.type},domProps:{value:e.value,value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"fabrikinput em-w-100",attrs:{id:"input_"+e.element.id,name:e.element.name,type:"radio"},domProps:{value:e.value,checked:e._q(e.value,e.value)},on:{change:function(t){e.value=e.value}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"fabrikinput em-w-100",attrs:{id:"input_"+e.element.id,name:e.element.name,type:"checkbox"},domProps:{value:e.value,checked:Array.isArray(e.value)?e._i(e.value,e.value)>-1:e.value},on:{change:function(t){var a=e.value,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=e.value,o=e._i(a,n);s.checked?o<0&&(e.value=a.concat([n])):o>-1&&(e.value=a.slice(0,o).concat(a.slice(o+1)))}else e.value=i}}})])])},Ps=[],Fs=a("e214"),$s=a.n(Fs),js={name:"field",components:{},mixins:[],props:{element:{type:Object,required:!0},value:{type:String,default:""}},data:()=>({params:{}}),created(){this.params=JSON.parse(this.element.params)},mounted(){if(""!==this.params.text_input_mask){let e=document.getElementById("input_"+this.element.id),t=new $s.a(this.params.text_input_mask);t.mask(e)}},methods:{},computed:{readonly:function(){return 1===parseInt(this.params.readonly)},tip:function(){return this.params.rollover},type:function(){switch(this.params.password){case"1":return"password";case"2":return"tel";case"3":return"email";case"6":return"number";default:return"text"}}},watch:{value:function(e){this.$emit("input",{value:e,name:this.element.name})}}},Gs=js,Hs=Object(b["a"])(Gs,ks,Ps,!1,null,null,null),zs=Hs.exports,Vs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-group fabrikElementContainer"},[a("label",{staticClass:"fabrikLabel"},[e._v(e._s(e.element.label))]),e.readonly?a("p",[e._v(e._s(e.value))]):a("div",{staticClass:"fabrikElement"},[a("div",{staticClass:"fabrikSubElementContainer"},[a("div",{staticClass:"row-fluid"},e._l(e.options.sub_labels,(function(t,s){return a("div",{staticClass:"fabrikgrid_radio"},[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"fabrikinput",attrs:{type:"radio",id:e.options.sub_values[s],name:e.element.name},domProps:{value:e.options.sub_values[s],checked:e._q(e.value,e.options.sub_values[s])},on:{change:function(t){e.value=e.options.sub_values[s]}}}),a("span",{attrs:{for:e.options.sub_values[s]}},[e._v(e._s(t))])])])})),0)])])])},Ys=[],qs={name:"radiobutton",components:{},mixins:[],props:{element:{type:Object,required:!0},value:{type:String,default:""}},data:()=>({params:{},options:[]}),created(){this.params=JSON.parse(this.element.params),this.options=this.params.sub_options},mounted(){},methods:{},computed:{readonly:function(){return 1===parseInt(this.params.readonly)}},watch:{value:function(e){this.$emit("input",{value:e,name:this.element.name})}}},Js=qs,Ws=(a("3380"),Object(b["a"])(Js,Vs,Ys,!1,null,"5c01969a",null)),Ks=Ws.exports,Xs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-group fabrikElementContainer"},[a("label",{staticClass:"fabrikLabel"},[e._v(e._s(e.element.label))]),a("div",{staticClass:"fabrikElement"},[e.readonly||e.advanced_select?!e.readonly&&e.advanced_select?a("multiselect",{attrs:{label:"value","track-by":"primary_key",options:e.options,multiple:!1,taggable:!1,"select-label":"",placeholder:e.translate("PLEASE_SELECT"),"selected-label":"","deselect-label":"","close-on-select":!0,"clear-on-select":!1,searchable:!0,"allow-empty":!1},model:{value:e.object_value,callback:function(t){e.object_value=t},expression:"object_value"}}):a("p",[e._v(e._s(e.value))]):a("select",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"fabrikinput em-w-100",attrs:{id:"input_"+e.element.id,name:e.element.name},domProps:{value:e.value},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.value=t.target.multiple?a:a[0]}}},[1==e.params.database_join_show_please_select?a("option",{attrs:{value:""}},[e._v(e._s(e.translate("PLEASE_SELECT")))]):e._e(),e._l(e.options,(function(t){return a("option",{domProps:{value:t.primary_key}},[e._v(e._s(t.value))])}))],2)],1)])},Qs=[],Zs={methods:{async getDatabasejoinOptions(e,t,a,s,i){try{const n=await h().get("index.php?option=com_emundus&controller=form&task=getdatabasejoinoptions",{params:{table_name:e,column_name:t,value:a,concat_value:s,where_clause:i}});return n.data}catch(n){return{status:!1,msg:n.message}}}}},ei=Zs,ti={name:"databasejoin",components:{multiselect:ya.a},mixins:[ei],props:{element:{type:Object,required:!0},value:{type:String,default:""}},data:()=>({params:{},options:[],object_value:{}}),mounted(){this.params=JSON.parse(this.element.params),this.getDatabasejoinOptions(this.params.join_db_name,this.params.join_key_column,this.params.join_val_column,this.params.join_val_column_concat,this.params.database_join_where_sql).then(e=>{1==e.status&&(this.options=e.options,1===parseInt(this.params.advanced_behavior)&&""!==this.value&&0!=this.value&&(this.object_value=this.options.find(e=>e.primary_key===this.value)))})},computed:{readonly:function(){return 1===parseInt(this.params.readonly)},advanced_select:function(){return 1===parseInt(this.params.advanced_behavior)}},watch:{value:function(e){this.$emit("input",{value:e,name:this.element.name})},object_value:function(e){this.value=e.primary_key}}},ai=ti,si=Object(b["a"])(ai,Xs,Qs,!1,null,null,null),ii=si.exports,ni=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-group fabrikElementContainer"},[a("label",{staticClass:"fabrikLabel"},[e._v(e._s(e.element.label))]),e.readonly?a("p",[e._v(e._s(e.value))]):a("div",{staticClass:"fabrikElement"},[a("div",{staticClass:"fabrikSubElementContainer"},[a("div",{staticClass:"row-fluid"},e._l(e.options.sub_labels,(function(t,s){return a("div",{staticClass:"fabrikgrid_checkbox"},[a("label",{staticClass:"checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.values_selected[s],expression:"values_selected[index]"}],staticClass:"fabrikinput",attrs:{type:"checkbox",id:e.options.sub_values[s],name:e.element.name+"["+[s]+"]"},domProps:{value:e.options.sub_values[s],checked:Array.isArray(e.values_selected[s])?e._i(e.values_selected[s],e.options.sub_values[s])>-1:e.values_selected[s]},on:{change:function(t){var a=e.values_selected[s],i=t.target,n=!!i.checked;if(Array.isArray(a)){var o=e.options.sub_values[s],l=e._i(a,o);i.checked?l<0&&e.$set(e.values_selected,s,a.concat([o])):l>-1&&e.$set(e.values_selected,s,a.slice(0,l).concat(a.slice(l+1)))}else e.$set(e.values_selected,s,n)}}}),a("span",{attrs:{for:e.options.sub_values[s]}},[e._v(e._s(t))])])])})),0)])])])},oi=[],li={name:"checkbox",components:{},mixins:[],props:{element:{type:Object,required:!0},value:{type:String,default:""}},data:()=>({params:{},options:[],values_selected:[]}),created(){this.params=JSON.parse(this.element.params),this.options=this.params.sub_options;let e=this.value.replace("[","").replace("]","").split(",");e.forEach(e=>{this.values_selected[parseInt(e.replace('"',""))]=!0})},methods:{},computed:{readonly:function(){return 1===parseInt(this.params.readonly)}},watch:{value:function(e){this.$emit("input",{value:e,name:this.element.name})},values_selected:function(e){let t="[",a=[];e.forEach((e,t)=>{!0===e&&a.push('"'+t+'"')}),a=a.join(","),t+=a+"]",this.value=t}}},ri=li,ci=(a("b1bf"),Object(b["a"])(ri,ni,oi,!1,null,"7c4489f8",null)),di=ci.exports,mi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-group fabrikElementContainer"},[a("label",{staticClass:"fabrikLabel",attrs:{for:"input_"+e.element.id}},[e._v(e._s(e.element.label))]),a("div",{staticClass:"fabrikElement"},[e.tip.length>0?a("span",{staticClass:"em-tip"},[e._v(e._s(e.tip))]):e._e(),a("p",[e._v(e._s(e.element.value))])])])},ui=[],pi={name:"calc",components:{},mixins:[],props:{element:{type:Object,required:!0}},data:()=>({params:{}}),created(){this.params=JSON.parse(this.element.params)},methods:{},computed:{tip:function(){return this.params.rollover}}},_i=pi,hi=Object(b["a"])(_i,mi,ui,!1,null,null,null),gi=hi.exports,fi={name:"Section",components:{field:zs,radiobutton:Ks,databasejoin:ii,checkbox:di,calc:gi},props:{group:Object,user:Object},data:()=>({elements:[]}),created(){D.getProfileElements(this.group.id).then(e=>{this.elements=e.elements})},methods:{updateValue(e){this.$emit("input",e)}},computed:{filteredElements(){return this.elements.filter(e=>0==["id","date_time","fnum","user"].includes(e.name))}}},vi=fi,bi=(a("33f2"),Object(b["a"])(vi,Bs,Is,!1,null,"db02c904",null)),Ei=bi.exports,Oi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"em-skeleton",class:e.classes,style:{height:e.height,width:e.width}})},Ci=[],yi={name:"Skeleton.vue",props:{height:{type:String,default:"auto"},width:{type:String,default:"auto"},classes:{type:String,default:""}}},Di=yi,Mi=(a("bd91"),Object(b["a"])(Di,Oi,Ci,!1,null,"59286d38",null)),Ni=Mi.exports,Ai={name:"FormBuilderPreviewForm",components:{Skeleton:Ni,Section:Ei},props:{form_id:{type:Number,required:!0},form_label:{type:String,default:""}},data(){return{loading:!0,formData:{}}},created(){Ls.getPageGroups(this.form_id).then(e=>{e.status&&(e.data.groups=e.data.groups.filter(e=>1===Number(e.published)),this.formData=e.data),this.loading=!1})},methods:{}},Si=Ai,wi=(a("d17e"),Object(b["a"])(Si,Ts,Rs,!1,null,null,null)),Ui=wi.exports,Ti=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-h-100 em-w-100",class:{loading:e.loading},attrs:{id:"form-builder-preview-attachment"}},[e.loading?a("skeleton",{attrs:{height:"100%",width:"100%"}}):a("div",{staticClass:"em-text-align-center"},[a("img",{staticStyle:{width:"50px"},attrs:{src:"media/com_emundus/images/icones/filetype/doc.png",alt:"filetype"}}),a("p",{staticClass:"em-font-size-12 em-w-100 em-mt-16"},[e._v(e._s(e.document_label))])])],1)},Ri=[],xi={name:"FormBuilderPreviewAttachments",components:{Skeleton:Ni,Section:Ei},props:{document_id:{type:Number,required:!0},document_label:{type:String,default:""}},data(){return{loading:!1}},created(){},methods:{}},Li=xi,Bi=(a("80ea"),Object(b["a"])(Li,Ti,Ri,!1,null,null,null)),Ii=Bi.exports;const ki=a("bef5");var Pi={name:"addFormulaire",props:{profileId:String,campaignId:Number,profiles:Array,formulaireEmundus:Number,visibility:Number},components:{FormBuilderPreviewAttachments:Ii,FormBuilderPreviewForm:Ui,FormCarrousel:Us},data(){return{ChooseForm:this.translate("COM_EMUNDUS_ONBOARD_CHOOSE_FORM"),AddForm:this.translate("COM_EMUNDUS_ONBOARD_ADD_FORM"),EmitIndex:"0",formList:[],documentsList:[],loading:!1,form:{label:"Nouveau formulaire",description:"",published:1},formdescription:this.translate("COM_EMUNDUS_ONBOARD_FORMDESCRIPTION")}},methods:{getEmitIndex(e){this.EmitIndex=e},getForms(e){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getFormsByProfileId",params:{profile_id:e},paramsSerializer:e=>ki.stringify(e)}).then(e=>{this.formList=e.data.data,this.loading=!1}).catch(e=>{console.log(e)})},getDocuments(e){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getDocuments",params:{pid:e},paramsSerializer:e=>ki.stringify(e)}).then(e=>{this.documentsList=e.data.data})},redirectJRoute(e){window.location.href=e},addNewForm(){this.loading=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=createform",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ki.stringify({body:this.form})}).then(e=>{this.loading=!1,this.$props.profileId=e.data.data,this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.profileId+"&index=0&cid="+this.campaignId)}).catch(e=>{console.log(e)})},updateProfileCampaign(){p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updateprofile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ki.stringify({profile:this.profileId,campaign:this.campaignId})}).then(()=>{this.getForms(this.profileId),this.getDocuments(this.profileId),this.$emit("profileId",this.profileId)})},formbuilder(e){e=0,this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.profileId+"&index="+e+"&cid="+this.campaignId)}},created(){this.getForms(this.profileId),this.getDocuments(this.profileId)}},Fi=Pi,$i=(a("cc32"),Object(b["a"])(Fi,_s,hs,!1,null,"6cca7eee",null)),ji=$i.exports,Gi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ModalAddEvaluation",{attrs:{prog:e.prog,grid:e.grid},on:{updateGrid:function(t){return e.getEvaluationGridByProgram(1)}}}),a("div",{staticClass:"container-evaluation"},[null==e.grid?a("div",{staticClass:"text-center"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:function(t){return e.$modal.show("modalAddEvaluation")}}},[e._v(e._s(e.translations.addGrid))])]):e._e(),null!=e.grid?a("div",{staticClass:"em-flex-row"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer em-mr-4",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:e.evaluationBuilder}},[e._v(e._s(e.translations.editGrid))]),a("button",{staticClass:"bouton-sauvergarder-et-continuer w-delete",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:e.deleteGrid}},[e._v(" "+e._s(e.translations.deleteGrid))])]):e._e(),null!=e.grid?a("FormViewerEvaluation",{key:e.viewer,attrs:{link:e.link,prog:e.prog}}):e._e()],1)],1)},Hi=[],zi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"FormViewer container-fluid",attrs:{id:"FormViewerEvaluation"}},[a("link",{attrs:{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css"}}),a("notifications",{attrs:{group:"foo-velocity",position:"top right","animation-type":"velocity",speed:500}}),e.object_json.show_page_heading?a("div",{class:e.object_json.show_page_heading.class,domProps:{innerHTML:e._s(e.object_json.show_page_heading.page_heading)}}):e._e(),a("form",{attrs:{method:"post","object_json.attribs":""},on:{submit:function(e){e.preventDefault()}}},[e.object_json.plugintop?a("div",{domProps:{innerHTML:e._s(e.object_json.plugintop)}}):e._e(),e._l(e.object_json.Groups,(function(t,s){return a("div",{key:t.index},[a("fieldset",{class:t.group_class,style:t.group_css,attrs:{id:"group_"+t.group_id}},[a("div",{staticClass:"em-flex-row"},[t.group_showLegend?a("legend",{staticClass:"legend ViewerLegend"},[e._v(e._s(t.group_showLegend))]):e._e()]),t.group_intro?a("div",{staticClass:"groupintro",domProps:{innerHTML:e._s(t.group_intro)}}):e._e(),a("div",{staticClass:"elements-block"},[a("transition-group",{attrs:{name:"slide-down",type:"transition"}},e._l(t.elts,(function(t,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:!1===t.hidden,expression:"element.hidden === false"}],key:t.id,staticClass:"builder-item-element",class:{unpublished:!t.publish}},[a("div",{staticClass:"em-flex-row builder-item-element__properties"},[a("div",{staticClass:"w-100"},[a("div",{staticClass:"em-flex-row",staticStyle:{"align-items":"baseline"}},[t.label_value?a("span",{directives:[{name:"show",rawName:"v-show",value:2!=t.labelsAbove,expression:"element.labelsAbove != 2"}],domProps:{innerHTML:e._s(t.label_value)}}):e._e()]),t.params.date_table_format?a("div",[a("date-picker",{attrs:{config:e.options},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):0==t.labelsAbove?a("div",{staticClass:"controls"},[t.error?a("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(t.error)}}):e._e(),t.element?a("div",{class:t.errorClass,domProps:{innerHTML:e._s(t.element)}}):e._e(),t.tipSide?a("span",{domProps:{innerHTML:e._s(t.tipSide)}}):e._e()]):a("span",{staticClass:"em-flex-row w-100"},[t.element?a("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(t.error)}}):e._e(),t.element?a("div",{staticClass:"w-100",class:t.errorClass,domProps:{innerHTML:e._s(t.element)}}):e._e(),t.tipSide?a("span",{domProps:{innerHTML:e._s(t.tipSide)}}):e._e()]),t.tipBelow?a("span",{domProps:{innerHTML:e._s(t.tipBelow)}}):e._e()])])])})),0)],1),t.group_outro?a("div",{staticClass:"groupoutro",domProps:{innerHTML:e._s(e.group_outro)}}):e._e()])])})),e.object_json.pluginbottom?a("div",{domProps:{innerHTML:e._s(e.object_json.pluginbottom)}}):e._e()],2),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},Vi=[],Yi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalEditElement"+e.elementId}},[a("modal",{attrs:{name:"modalEditElement"+e.elementId,transition:"little-move-left","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!0},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.ElementOptions)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEditElement"+e.elementId)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),null!=e.element?a("div",[a("div",{staticClass:"em-mb-16"},[a("div",{staticClass:"em-flex-row em-mb-16 em-pointer",on:{click:function(t){return e.publishUnpublishElement()}}},[a("em",{class:[e.element.publish?"fa-eye-slash":"fa-eye","far"],staticStyle:{width:"45px"},attrs:{id:"publish_icon_"+e.element.id}}),e.element.publish?a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.Unpublish))]):e._e(),e.element.publish?e._e():a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.Publish))])]),"display"!=e.plugin?a("div",{staticClass:"em-mb-16 em-flex-row"},[a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.FRequire,expression:"element.FRequire"}],staticClass:"em-toggle-check",attrs:{type:"checkbox",id:"require",name:"require"},domProps:{checked:Array.isArray(e.element.FRequire)?e._i(e.element.FRequire,null)>-1:e.element.FRequire},on:{click:function(t){return e.updateRequireElement()},change:function(t){var a=e.element.FRequire,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&e.$set(e.element,"FRequire",a.concat([n])):o>-1&&e.$set(e.element,"FRequire",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(e.element,"FRequire",i)}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})]),a("span",{staticClass:"em-ml-8 em-pointer",attrs:{for:"require"},on:{click:function(t){return e.updateRequireElement()}}},[e._v(e._s(e.Required))])]):e._e()]),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.fieldType)+" :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.plugin,expression:"plugin"}],staticClass:"em-w-100",attrs:{id:"select_type",disabled:0!=e.files&&"birthday"==e.element.plugin||0!=e.files&&6==e.element.params.password},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.plugin=t.target.multiple?a:a[0]}}},e._l(e.plugins,(function(t,s){return a("option",{key:s,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),0)]),a("hr"),a("div",{staticClass:"em-mb-16"},["field"==e.plugin?a("fieldF",{attrs:{files:e.files,element:e.element}}):e._e(),"birthday"==e.plugin?a("birthdayF",{attrs:{element:e.element}}):e._e(),"checkbox"==e.plugin?a("checkboxF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"dropdown"==e.plugin?a("dropdownF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"radiobutton"==e.plugin?a("radiobtnF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"textarea"==e.plugin?a("textareaF",{attrs:{element:e.element}}):e._e(),"display"==e.plugin?a("displayF",{attrs:{element:e.element}}):e._e(),"yesno"==e.plugin?a("yesnoF",{attrs:{element:e.element}}):e._e()],1)]):e._e(),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEditElement"+e.elementId)}}},[e._v(" "+e._s(e.Retour)+" ")]),a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.UpdateParams.apply(null,arguments)}}},[e._v(e._s(e.Continuer))])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])],1)},qi=[];const Ji=a("bef5");var Wi={name:"modalEditElement",props:{elementId:{type:Number,required:!0},gid:Number,files:Number,manyLanguages:Number,actualLanguage:String,profileId:Number},components:{},data(){return{label:{fr:"",en:""},done:!1,changes:!1,loading:!1,sublabel:"",plugin:"",element:null,plugins:{field:{value:"field",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_FIELD")},birthday:{value:"birthday",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_BIRTHDAY")},checkbox:{value:"checkbox",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_CHECKBOX")},dropdown:{value:"dropdown",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DROPDOWN")},radiobutton:{value:"radiobutton",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_RADIOBUTTON")},textarea:{value:"textarea",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_TEXTAREA")},display:{value:"display",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DISPLAY")},yesno:{value:"yesno",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_YESNO")}},databases:[],Name:this.translate("COM_EMUNDUS_ONBOARD_FIELD_NAME"),Require:this.translate("COM_EMUNDUS_ONBOARD_FIELD_REQUIRED"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_SAVE"),dataSaved:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DATASAVED"),informations:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_INFORMATIONS"),fieldType:this.translate("COM_EMUNDUS_ONBOARD_FIELD_TYPE"),Delete:this.translate("COM_EMUNDUS_ONBOARD_ACTION_DELETE"),LabelRequired:this.translate("COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME"),TranslateEnglish:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH"),ElementOptions:this.translate("COM_EMUNDUS_ONBOARD_ELEMENT_OPTIONS"),Unpublish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_UNPUBLISH"),Publish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_PUBLISH"),Required:this.translate("COM_EMUNDUS_ONBOARD_ACTIONS_REQUIRED"),update:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATE"),updating:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATING"),updateSuccess:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATESUCESS"),updateFailed:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATEFAILED")}},methods:{subOptions(e){this.sublabel=e},UpdateParams(){this.changes=!0,"undefined"!==typeof this.element.params.sub_options&&(this.element.params.sub_options.sub_labels=this.sublabel.map(e=>e.sub_label),this.element.params.sub_options.sub_values=this.sublabel.map(e=>e.sub_value)),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ji.stringify({element:this.element})}).then(e=>{setTimeout(()=>{this.$emit("reloadElement")},200),this.$modal.hide("modalEditElement"+this.elementId)}).catch(e=>{console.log(e)})},axiostrad:function(e){return p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=getalltranslations",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ji.stringify({toJTEXT:e})})},getElement(){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:this.elementId,gid:this.gid},paramsSerializer:e=>Ji.stringify(e)}).then(e=>{this.element=e.data,"databasejoin"==this.element.plugin?"radio"==this.element.params.database_join_display_type?this.plugin="radiobutton":this.plugin=this.element.params.database_join_display_type:"date"==this.element.plugin||"years"==this.element.plugin?this.plugin="birthday":this.plugin=this.element.plugin,this.axiostrad(this.element.label_tag).then(e=>{this.label.fr=e.data.fr,this.label.en=e.data.en}),0!=this.files&&"birthday"!=this.element.plugin&&delete this.plugins.birthday,this.loading=!1})},getDatabases(){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getdatabasesjoin"}).then(e=>{this.databases=e.data.data})},beforeClose(e){!0===this.changes&&(this.changes=!1,this.$emit("show","foo-velocity","warn",this.dataSaved,this.informations)),this.$emit("modalClosed")},beforeOpen(e){this.initialisation()},initialisation(){this.getElement(),this.getDatabases()},publishUnpublishElement(){p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=publishunpublishelement",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ji.stringify({element:this.element.id})}).then(e=>{this.element.publish=!this.element.publish,this.$emit("publishUnpublishEvent"),this.$emit("show","foo-velocity","success",this.updateSuccess,this.update)}).catch(e=>{this.$emit("show","foo-velocity","error",this.updateFailed,this.updating),console.log(e)})},updateRequireElement(){setTimeout(()=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=changerequire",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ji.stringify({element:this.element})}).then(()=>{this.$emit("updateRequireEvent")}).catch(e=>{this.$emit("show","foo-velocity","error",this.updateFailed,this.updating),console.log(e)})},300)}},watch:{element:function(){this.tempEl=JSON.parse(JSON.stringify(this.element))},plugin:function(e){switch(e){case"dropdown":"databasejoin"!==this.element.plugin&&(this.element.plugin=e);break;case"radiobutton":"databasejoin"!==this.element.plugin&&(this.element.plugin=e);break;case"birthday":"date"!==this.element.plugin&&"years"!==this.element.plugin&&(this.element.plugin=e);break;default:this.element.plugin=e}}}},Ki=Wi,Xi=(a("2d8d"),Object(b["a"])(Ki,Yi,qi,!1,null,"8d5a1256",null)),Qi=Xi.exports;a("bef5");var Zi={name:"FormViewerEvaluation",props:{link:String,prog:Number},components:{datePicker:Os.a,modalEditElement:Qi},data(){return{object_json:"",date:new Date,groups:[],loading:!1,options:{format:"DD/MM/YYYY",useCurrent:!1}}},methods:{getDataObject:Yt.a.debounce((function(){this.loading=!0;let e=this.link.link.replace("fabrik","emundus");p.a.get(e+"&format=vue_jsonclean").then(e=>{this.object_json=e.data,this.convertGroupElementsToArray(),this.loading=!1}).catch(e=>{this.loading=!1,console.log(e)})}),150),convertGroupElementsToArray(){Object.keys(this.object_json.Groups).forEach(e=>{this.groups.push(this.object_json.Groups[e]),this.object_json.Groups[e].elts=[],Object.keys(this.object_json.Groups[e].elements).forEach(t=>{this.object_json.Groups[e].elts.push(this.object_json.Groups[e].elements[t])})})}},created(){this.getDataObject()},computed:{dragOptions(){return{group:{name:"items",pull:"clone",put:!1},sort:!1,disabled:!1,ghostClass:"ghost"}}},watch:{}},en=Zi,tn=(a("68a2"),Object(b["a"])(en,zi,Vi,!1,null,"16207d30",null)),an=tn.exports,sn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalAddEvaluation"}},[a("modal",{attrs:{name:"modalAddEvaluation",height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{"before-open":e.beforeOpen}},[a("div",{staticClass:"fixed-header-modal"},[a("div",{staticClass:"topright"},[a("button",{staticClass:"btnCloseModal",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddEvaluation")}}},[a("em",{staticClass:"fas fa-times"})])]),a("div",{staticClass:"update-field-header"},[a("h2",{staticClass:"update-title-header"},[e._v(" "+e._s(e.translations.addGrid)+" ")])])]),a("div",{staticClass:"modalC-content"},[a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.translations.ChooseExistingGridModel)+" :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.model_id,expression:"model_id"}],staticClass:"dropdown-toggle",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.model_id=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"-1"}}),e._l(e.models,(function(t){return a("option",{key:t.form_id,domProps:{value:t.form_id}},[e._v(e._s(t.label))])}))],2)]),a("div",{staticClass:"form-group",class:{"mb-0":e.can_translate.label}},[a("label",[e._v(e._s(e.translations.Name)),a("span",{staticClass:"em-red-500-color"},[e._v("*")]),e._v(" :")]),a("div",{staticClass:"input-can-translate"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.label.fr,expression:"label.fr"}],staticClass:"form__input field-general w-input",class:{"is-invalid":e.errors},staticStyle:{margin:"0"},attrs:{type:"text",maxlength:"40",id:"menu_label"},domProps:{value:e.label.fr},on:{input:function(t){t.target.composing||e.$set(e.label,"fr",t.target.value)}}}),a("button",{staticClass:"translate-icon",class:{"translate-icon-selected":e.can_translate.label},attrs:{type:"button"},on:{click:function(t){e.can_translate.label=!e.can_translate.label}}})])]),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.label?a("div",{staticClass:"inlineflex"},[a("label",{staticClass:"translate-label"},[e._v(" "+e._s(e.translations.TranslateEnglish)+" ")]),a("i",{staticClass:"fas fa-sort-down"})]):e._e()]),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.label?a("div",{staticClass:"form-group mb-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.label.en,expression:"label.en"}],staticClass:"form__input field-general w-input",attrs:{type:"text",maxlength:"40"},domProps:{value:e.label.en},on:{input:function(t){t.target.composing||e.$set(e.label,"en",t.target.value)}}})]):e._e()]),e.errors&&-1==e.model_id?a("p",{staticClass:"error col-md-12 mb-2"},[a("span",{staticClass:"error"},[e._v(e._s(e.translations.LabelRequired))])]):e._e(),a("div",{staticClass:"form-group mt-1",class:{"mb-0":e.can_translate.intro}},[a("label",[e._v(e._s(e.translations.Intro)+" :")]),a("div",{staticClass:"input-can-translate"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.intro.fr,expression:"intro.fr"}],staticClass:"form__input field-general w-input",staticStyle:{margin:"0"},attrs:{rows:"3",maxlength:"300"},domProps:{value:e.intro.fr},on:{input:function(t){t.target.composing||e.$set(e.intro,"fr",t.target.value)}}}),a("button",{staticClass:"translate-icon",class:{"translate-icon-selected":e.can_translate.intro},attrs:{type:"button"},on:{click:function(t){e.can_translate.intro=!e.can_translate.intro}}})])]),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.intro?a("div",{staticClass:"inlineflex"},[a("label",{staticClass:"translate-label"},[e._v(" "+e._s(e.translations.TranslateEnglish)+" ")]),a("em",{staticClass:"fas fa-sort-down"})]):e._e()]),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.intro?a("div",{staticClass:"form-group mb-1"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.intro.en,expression:"intro.en"}],staticClass:"form__input field-general w-input",attrs:{rows:"3",maxlength:"300"},domProps:{value:e.intro.en},on:{input:function(t){t.target.composing||e.$set(e.intro,"en",t.target.value)}}})]):e._e()]),-1==e.model_id?a("div",{staticClass:"col-md-12 em-flex-row"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.template,expression:"template"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.template)?e._i(e.template,null)>-1:e.template},on:{change:function(t){var a=e.template,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.template=a.concat([n])):o>-1&&(e.template=a.slice(0,o).concat(a.slice(o+1)))}else e.template=i}}}),a("label",{staticClass:"ml-10px"},[e._v(e._s(e.translations.SaveAsTemplate)+" :")])]):e._e()],1),a("div",{staticClass:"em-flex-row em-flex-space-between mb-1"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer w-retour",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddEvaluation")}}},[e._v(e._s(e.translations.Retour))]),a("button",{staticClass:"bouton-sauvergarder-et-continuer",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createGrid()}}},[e._v(e._s(e.translations.Continuer))])]),e.submitted?a("div",{staticClass:"em-page-loader"}):e._e()])],1)},nn=[];const on=a("bef5");var ln={name:"modalAddEvaluation",components:{},props:{prog:Number,grid:Number},data(){return{can_translate:{label:!1,intro:!1},label:{fr:"",en:""},intro:{fr:"",en:""},model_id:-1,template:0,models:[],errors:!1,changes:!1,submitted:!1,translations:{addGrid:"COM_EMUNDUS_ONBOARD_BUILDER_ADDGRID",ChooseExistingGridModel:"COM_EMUNDUS_ONBOARD_GRIDMODEL",Name:"COM_EMUNDUS_ONBOARD_FIELD_NAME",Intro:"COM_EMUNDUS_ONBOARD_FIELD_INTRO",Retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Continuer:"COM_EMUNDUS_ONBOARD_ADD_CONTINUER",LabelRequired:"COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME",TranslateEnglish:"COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH",SaveAsTemplate:"COM_EMUNDUS_ONBOARD_SAVE_AS_TEMPLATE"}}},methods:{beforeOpen(e){this.getExistingGrids()},getExistingGrids(){p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getgridsmodel"}).then(e=>{this.models=e.data.data})},createGrid(){this.changes=!0,""!=this.label.fr||-1!=this.model_id?(this.can_translate.label||(this.label.en=this.label.fr),this.can_translate.intro||(this.intro.en=this.intro.fr),this.submitted=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=creategrid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:on.stringify({label:this.label,intro:this.intro,modelid:this.model_id,template:this.template,pid:this.prog})}).then(e=>{this.submitted=!1,this.$emit("updateGrid"),this.$modal.hide("modalAddEvaluation")}).catch(e=>{console.log(e)})):this.errors=!0}},watch:{model_id:function(e){-1!=e?this.models.forEach(e=>{e.form_id==this.model_id&&(this.label.fr=e.label,this.intro.fr=e.intro)}):(this.label.fr="",this.intro.fr="")}}},rn=ln,cn=Object(b["a"])(rn,sn,nn,!1,null,"636bdac5",null),dn=cn.exports;const mn=a("bef5");var un={name:"addEvaluationGrid",components:{ModalAddEvaluation:dn,Datetime:Ft["Datetime"],FormViewerEvaluation:an},props:{prog:{type:Number,default:""}},data(){return{link:{link:""},visibility:null,viewer:0,grid:null,translations:{addGrid:"COM_EMUNDUS_ONBOARD_BUILDER_ADDGRID",editGrid:"COM_EMUNDUS_ONBOARD_BUILDER_EDITGRID",deleteGrid:"COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID"}}},methods:{getEvaluationGridByProgram(e){p.a.get("index.php?option=com_emundus&controller=programme&task=getevaluationgrid&pid="+this.prog).then(t=>{this.grid=t.data.data,null!=this.grid&&(this.link.link="index.php?option=com_fabrik&view=form&formid="+t.data.data,this.viewer++,e&&this.evaluationBuilder())})},evaluationBuilder(){this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid=&index=0&cid="+this.prog+"&evaluation="+this.grid)},deleteGrid(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID"),text:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID_QUESTION"),type:"warning",showCancelButton:!0}).then(e=>{e.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=deletegrid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:mn.stringify({grid:this.grid,pid:this.prog})}).then(()=>{j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_GRIDDELETED"),type:"success",showConfirmButton:!1,timer:2e3}).then(()=>{this.getEvaluationGridByProgram(0)})}).catch(e=>{console.log(e)})})},redirectJRoute(e){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=redirectjroute",params:{link:e},paramsSerializer:e=>mn.stringify(e)}).then(e=>{window.location.href=window.location.pathname+e.data.data})}},created(){this.getEvaluationGridByProgram(0)}},pn=un,_n=Object(b["a"])(pn,Gi,Hi,!1,null,null,null),hn=_n.exports;const gn=a("bef5");var fn={name:"addFormNextCampaign",components:{AddEvaluationGrid:hn,AddDocumentsDropfiles:Za,addCampaign:ba,ModalWarningFormBuilder:ja,addFormulaire:ji,addEmail:ps},props:{index:Number},mixins:[A],data:()=>({campaignId:0,actualLanguage:"",manyLanguages:0,prid:"",menuHighlight:0,menuHighlightProg:-1,formReload:0,prog:0,loading:!1,closeSubmenu:!0,profileId:null,profiles:[],campaignsByProgram:[],langue:0,formCategoriesDesc:["COM_EMUNDUS_GLOBAL_INFORMATIONS_DESC","COM_EMUNDUS_DOCUMENTS_CAMPAIGNS_DESC","COM_EMUNDUS_FORM_CAMPAIGN_DESC"],formCategories:["COM_EMUNDUS_GLOBAL_INFORMATIONS","COM_EMUNDUS_DOCUMENTS_CAMPAIGNS","COM_EMUNDUS_FORM_CAMPAIGN"],formPrograms:["COM_EMUNDUS_EMAILS"],formProgramsDesc:["COM_EMUNDUS_EMAILS_DESC"],form:{},program:{id:0,label:"",code:"",programmes:"",notes:"",synthesis:'<ul><li><strong>[APPLICANT_NAME]</strong></li><li><a href="mailto:[EMAIL]">[EMAIL]</a></li></ul>',tmpl_trombinoscope:'<table cellpadding="2" style="width: 100%;"><tbody><tr style="border-collapse: collapse;"><td align="center" valign="top" style="text-align: center;"><p style="text-align: center;"><img src="[PHOTO]" alt="Photo" height="100" /> </p><p style="text-align: center;"><b>[NAME]</b><br /></p></td></tr></tbody></table>',tmpl_badge:'<table width="100%"><tbody><tr><td style="vertical-align: top; width: 100px;" align="left" valign="middle" width="30%"><img src="[LOGO]" alt="Logo" height="50" /></td><td style="vertical-align: top;" align="left" valign="top" width="70%"><b>[NAME]</b></td></tr></tbody></table>\n',published:1,apply_online:1},prog_group:{prog:null,evaluator:null,manager:null},translations:{DATE_FORMAT:"DATE_FORMAT_JS_LC2",From:"COM_EMUNDUS_ONBOARD_FROM",To:"COM_EMUNDUS_ONBOARD_TO",chooseProfileWarning:"COM_EMUNDUS_ONBOARD_CHOOSE_PROFILE_WARNING",ProgramWarning:"COM_EMUNDUS_ONBOARD_PROGRAM_WARNING"}}),created(){this.campaignId=Number(this.$store.getters["global/datas"].campaignId.value),this.actualLanguage=this.$store.getters["global/shortLang"],this.manyLanguages=Number(this.$store.getters["global/manyLanguages"]),"en"===this.actualLanguage&&(this.langue=1)},methods:{initInformations(e){this.form.label=e.label,this.form.profile_id=e.profile_id,this.form.program_id=e.progid,this.initDates(e),p.a.get("index.php?option=com_emundus&controller=form&task=getallformpublished").then(e=>{this.profiles=e.data.data,null==this.form.profile_id?(0!=this.profiles.length?this.profileId=this.profiles[0].id:this.profileId=null,null!=this.profileId&&(this.formReload+=1)):(this.formReload+=1,this.profileId=this.form.profile_id),this.loading=!1;let t=this.getCookie("campaign_"+this.campaignId+"_menu");t&&(this.menuHighlight=t,document.cookie="campaign_"+this.campaignId+"_menu =; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")})},updateHeader(e){this.form.label=e.label[this.actualLanguage],this.initDates(e)},initDates(e){this.form.start_date=e.start_date,this.form.end_date=e.end_date,this.form.start_date=this.formattedDate(this.form.start_date,"LLL"),"0000-00-00 00:00:00"===this.form.end_date?this.form.end_date=null:this.form.end_date=this.formattedDate(this.form.end_date,"LLL")},changeToProgMenu(e){p.a.get("index.php?option=com_emundus&controller=programme&task=getprogrambyid&id="+this.form.program_id).then(e=>{this.program.id=e.data.data.id,this.program.code=e.data.data.code,this.program.label=e.data.data.label,this.program.notes=e.data.data.notes,this.program.programmes=e.data.data.programmes,this.program.tmpl_badge=e.data.data.tmpl_badge,this.program.published=e.data.data.published,this.program.apply_online=e.data.data.apply_online,null!=e.data.data.synthesis&&(this.program.synthesis=e.data.data.synthesis.replace(/>\s+</g,"><")),null!=e.data.data.tmpl_trombinoscope&&(this.program.tmpl_trombinoscope=e.data.data.tmpl_trombinoscope.replace(/>\s+</g,"><")),this.prog_group.prog=e.data.data.group,this.prog_group.evaluator=e.data.data.evaluator_group,this.prog_group.manager=e.data.data.manager_group,p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getcampaignsbyprogram",params:{pid:this.program.id},paramsSerializer:e=>gn.stringify(e)}).then(e=>{this.campaignsByProgram=e.data.campaigns})}).catch(e=>{console.log(e)}),this.menuHighlightProg=e,this.menuHighlight=-1},changeToCampMenu(e){"COM_EMUNDUS_GLOBAL_INFORMATIONS"==this.formCategories[this.menuHighlight]&&!0===this.$store.getters["campaign/unsavedChanges"]?j.a.fire({title:this.translate("COM_EMUNDUS_CAMPAIGN_UNSAVED_CHANGES"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("JYES"),cancelButtonText:this.translate("JNO"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.menuHighlight=e,this.menuHighlightProg=-1,this.$store.dispatch("campaign/setUnsavedChanges",!1))}):(this.menuHighlight=e,this.menuHighlightProg=-1)},setProfileId(e){this.profileId=e},moment(e){return l()(e)},next(){if(this.menuHighlight<2){let e=this.menuHighlight+1;console.log(e),this.changeToCampMenu(e)}else this.menuHighlightProg<1&&this.changeToProgMenu(0)},previous(){this.menuHighlight>0?this.menuHighlight--:this.redirectJRoute("index.php?option=com_emundus&view=campaign")},redirectJRoute(e){window.location.href=e},getCookie(e){var t=e+"=",a=decodeURIComponent(document.cookie),s=a.split(";");for(let i of s){while(" "==i.charAt(0))i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}},computed:{console:()=>console,getProfileId(){return Number(this.profileId)}}},vn=fn,bn=(a("76e9"),Object(b["a"])(vn,La,Ba,!1,null,"16479d7e",null)),En=bn.exports,On=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-w-100 em-h-100",attrs:{id:"formBuilder"}},[a("modal",{attrs:{name:"formBuilder",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1}},[a("notifications",{attrs:{group:"foo-velocity","animation-type":"velocity",speed:500,position:"bottom left",classes:"vue-notification-custom"}}),a("header",{staticClass:"em-flex-row em-flex-space-between"},[a("div",{staticClass:"right-actions"},[a("span",{staticClass:"material-icons-outlined em-p-12-16 em-pointer",attrs:{id:"go-back",onclick:"history.go(-1)"}},[e._v(" navigate_before ")])]),a("span",{ref:"formTitle",staticClass:"em-font-size-14  em-font-weight-600 editable-data",attrs:{contenteditable:"true"},on:{focusout:e.updateFormTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateFormTitleKeyup.apply(null,arguments)}}},[e._v(" "+e._s(e.title)+" ")]),a("div",{staticClass:"left-actions em-flex-row em-flex-space-between em-p-12-16"},[e.lastSave?a("p",{staticClass:"em-font-size-14 em-main-500-color",attrs:{id:"saved-at"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SAVED_AT"))+" "+e._s(e.lastSave)+" ")]):e._e()])]),"default"===e.principalContainer?a("div",{staticClass:"body em-flex-row em-flex-space-between"},[a("aside",{staticClass:"left-panel em-flex-row em-flex-start em-h-100"},[a("div",{staticClass:"tabs em-flex-column em-flex-start em-h-100"},e._l(e.displayedLeftPanels,(function(t,s){return a("div",{key:e.title+"_"+s,staticClass:"tab",class:{active:t.active}},[a("span",{staticClass:"material-icons-outlined em-p-16",on:{click:function(a){t.url?e.goTo(t.url,"blank"):e.selectTab(t.title)}}},[e._v(" "+e._s(t.icon)+" ")])])})),0),a("div",{staticClass:"tab-content em-flex-start"},["Elements"===e.leftPanelActiveTab?a("form-builder-elements",{on:{"element-created":e.onElementCreated}}):"Documents"===e.leftPanelActiveTab?a("form-builder-document-formats",{attrs:{profile_id:e.profile_id},on:{"open-create-document":e.onEditDocument}}):e._e()],1)]),a("section",{staticClass:"em-flex-column em-w-100 em-h-100"},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[e.currentPage&&"page"===e.showInSection?a("form-builder-page",{key:e.currentPage.id,ref:"formBuilderPage",attrs:{profile_id:parseInt(e.profile_id),page:e.currentPage},on:{"open-element-properties":e.onOpenElementProperties,"open-section-properties":e.onOpenSectionProperties,"open-create-model":e.onOpenCreateModel,"update-page-title":function(t){return e.getPages(e.currentPage.id)}}}):"documents"===e.showInSection?a("form-builder-document-list",{ref:"formBuilderDocumentList",attrs:{profile_id:parseInt(e.profile_id),campaign_id:parseInt(e.campaign_id)},on:{"add-document":e.onOpenCreateDocument,"edit-document":e.onEditDocument,"delete-document":e.onDeleteDocument}}):e._e()],1)],1),a("aside",{staticClass:"right-panel em-flex-column em-h-100"},[a("transition",{attrs:{name:"fade",mode:"out-in"}},["hierarchy"===e.showInRightPanel?a("div",{staticClass:"em-w-100",attrs:{id:"form-hierarchy"}},[a("form-builder-pages",{attrs:{pages:e.pages,selected:parseInt(e.selectedPage),profile_id:parseInt(e.profile_id)},on:{"select-page":function(t){return e.selectPage(t)},"add-page":function(t){return e.getPages(e.currentPage.id)},"delete-page":function(t){e.selectedPage=e.pages[0].id},"open-page-create":function(t){e.principalContainer="create-page"}}}),a("hr"),a("form-builder-documents",{ref:"formBuilderDocuments",attrs:{profile_id:parseInt(e.profile_id),campaign_id:parseInt(e.campaign_id)},on:{"show-documents":function(t){return e.setSectionShown("documents")},"open-create-document":e.onOpenCreateDocument}})],1):e._e(),"element-properties"===e.showInRightPanel?a("form-builder-element-properties",{attrs:{element:e.selectedElement,profile_id:parseInt(e.profile_id)},on:{close:e.onCloseElementProperties}}):e._e(),"section-properties"===e.showInRightPanel?a("form-builder-section-properties",{attrs:{section_id:e.selectedSection.group_id,profile_id:parseInt(e.profile_id)},on:{close:e.onCloseSectionProperties}}):e._e(),"create-model"===e.showInRightPanel?a("form-builder-create-model",{attrs:{page:e.selectedPage},on:{close:function(t){e.showInRightPanel="hierarchy"}}}):e._e(),"create-document"===e.showInRightPanel?a("form-builder-create-document",{ref:"formBuilderCreateDocument",attrs:{profile_id:parseInt(e.profile_id),current_document:e.selectedDocument?e.selectedDocument:null,mandatory:e.createDocumentMandatory,mode:e.createDocumentMode},on:{close:function(t){e.showInRightPanel="hierarchy"},"documents-updated":e.onUpdateDocument}}):e._e()],1)],1)]):"create-page"===e.principalContainer?a("div",[a("form-builder-create-page",{attrs:{profile_id:parseInt(e.profile_id)},on:{close:e.onCloseCreatePage}})],1):e._e()],1)],1)},Cn=[],yn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-elements"}},[a("p",{staticClass:"em-text-align-center em-w-100 em-p-16",attrs:{id:"form-builder-elements-title"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENTS"))+" ")]),a("draggable",{staticClass:"draggables-list",attrs:{group:{name:"form-builder-section-elements",pull:"clone",put:!1},sort:!1,clone:e.setCloneElement},on:{end:e.onDragEnd},model:{value:e.elements,callback:function(t){e.elements=t},expression:"elements"}},[a("transition-group",e._l(e.publishedElements,(function(t){return a("div",{key:t.id,staticClass:"form-builder-element em-flex-row em-flex-space-between"},[a("span",{staticClass:"material-icons-outlined"},[e._v(e._s(t.icon))]),a("span",{staticClass:"em-w-100 em-p-16"},[e._v(e._s(e.translate(t.name)))]),a("span",{staticClass:"material-icons-outlined"},[e._v(" drag_indicator")])])})),0)],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},Dn=[],Mn={methods:{updateLastSave(){l.a.locale("fr"),this.$store.dispatch("formBuilder/updateLastSave",l()().format("LT"))},async swalConfirm(e,t,a,s,i=null,n=!0,o=!1){let l={title:e,text:t,type:"warning",showCancelButton:n,confirmButtonText:a,cancelButtonText:s,reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}};return o?l.html=t:l.text=t,j.a.fire(l).then(e=>!!e.value&&(null!=i&&i(),!0))}}},Nn={components:{draggable:qa.a},mixins:[Mn],data(){return{elements:[],cloneElement:{},loading:!1}},created(){this.elements=this.getElements()},methods:{getElements(){return a("ef96")},setCloneElement(e){this.cloneElement=e},onDragEnd(e){this.loading=!0;const t=e.to;if(null===t)return void(this.loading=!1);const a=t.dataset.sid;a?ze.createSimpleElement({gid:a,plugin:this.cloneElement.value}).then(t=>{ze.updateElementOrder(a,t.data.scalar,e.newDraggableIndex).then(e=>{this.$emit("element-created"),this.updateLastSave(),this.loading=!1})}).catch(e=>{this.loading=!1}):this.loading=!1}},computed:{publishedElements(){return this.elements.filter(e=>e.published)}}},An=Nn,Sn=(a("0718"),Object(b["a"])(An,yn,Dn,!1,null,null,null)),wn=Sn.exports,Un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-element-properties"}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-flex-align-start"},[a("div",[a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES")))]),a("span",{staticClass:"em-font-size-14 em-neutral-700-color"},[e._v(e._s(e.element.label[e.shortDefaultLang]))])]),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),a("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.publishedTabs,(function(t){return a("li",{key:t.id,staticClass:"em-p-16 em-pointer",class:{"is-active":t.active,"em-w-50":2==e.publishedTabs.length,"em-w-100":1==e.publishedTabs.length},on:{click:function(a){return e.selectTab(t)}}},[e._v(" "+e._s(e.translate(t.label))+" ")])})),0),a("div",{attrs:{id:"properties"}},[e.tabs[0].active?a("div",{staticClass:"em-p-16",attrs:{id:"element-parameters"}},[a("label",{attrs:{for:"element-label"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_LABEL")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.label[e.shortDefaultLang],expression:"element.label[shortDefaultLang]"}],staticClass:"em-w-100",attrs:{id:"element-label",name:"element-label",type:"text"},domProps:{value:e.element.label[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.element.label,e.shortDefaultLang,t.target.value)}}}),a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_UNPUBLISH")))]),a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isPublished,expression:"isPublished"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isPublished)?e._i(e.isPublished,null)>-1:e.isPublished},on:{click:e.togglePublish,change:function(t){var a=e.isPublished,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.isPublished=a.concat([n])):o>-1&&(e.isPublished=a.slice(0,o).concat(a.slice(o+1)))}else e.isPublished=i}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})])]),a("div",{directives:[{name:"show",rawName:"v-show",value:"display"!==this.element.plugin,expression:"this.element.plugin !== 'display'"}],staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_REQUIRED")))]),a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.FRequire,expression:"element.FRequire"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.element.FRequire)?e._i(e.element.FRequire,null)>-1:e.element.FRequire},on:{click:function(t){e.element.FRequire=!e.element.FRequire},change:function(t){var a=e.element.FRequire,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&e.$set(e.element,"FRequire",a.concat([n])):o>-1&&e.$set(e.element,"FRequire",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(e.element,"FRequire",i)}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})])]),e.sysadmin?a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_HIDDEN")))]),a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isHidden,expression:"isHidden"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isHidden)?e._i(e.isHidden,null)>-1:e.isHidden},on:{click:e.toggleHidden,change:function(t){var a=e.isHidden,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.isHidden=a.concat([n])):o>-1&&(e.isHidden=a.slice(0,o).concat(a.slice(o+1)))}else e.isHidden=i}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})])]):e._e()]):e._e(),e.tabs[1].active?a("div",{staticClass:"em-p-16"},[a("FormBuilderElementParams",{key:e.element.id,attrs:{element:e.element,params:e.params,databases:e.databases}})],1):e._e()]),a("div",{staticClass:"em-flex-row em-flex-space-between actions em-m-16"},[a("button",{staticClass:"em-primary-button",on:{click:function(t){return e.saveProperties()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_SAVE"))+" ")])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Tn=[],Rn=a("3208"),xn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.params,(function(t){return t.published&&!t.sysadmin_only||e.sysadmin&&t.sysadmin_only&&t.published?a("div",{staticClass:"form-group em-mb-8"},[a("label",[e._v(e._s(e.translate(t.label)))]),"dropdown"===t.type?a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,t.name,a.target.multiple?s:s[0])}}},e._l(t.options,(function(t){return a("option",{domProps:{value:t.value}},[e._v(e._s(e.translate(t.label)))])})),0)]):"textarea"===t.type?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",domProps:{value:e.element.params[t.name]},on:{input:function(a){a.target.composing||e.$set(e.element.params,t.name,a.target.value)}}}):"databasejoin"===t.type?a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],key:e.reloadOptions,staticClass:"em-w-100",class:e.databasejoin_description?"em-mb-4":"",attrs:{id:t.name},on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,t.name,a.target.multiple?s:s[0])},e.updateDatabasejoinParams]}},e._l(t.options,(function(t){return a("option",{domProps:{value:t.database_name}},[e._v(e._s(t.label))])})),0),e.databasejoin_description?a("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.databasejoin_description))]):e._e()]):"databasejoin_cascade"===t.type?a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],key:e.reloadOptionsCascade,staticClass:"em-w-100",on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,t.name,a.target.multiple?s:s[0])}}},e._l(t.options,(function(t){return a("option",{domProps:{value:t.COLUMN_NAME}},[e._v(e._s(t.COLUMN_NAME))])})),0)]):"checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:"checkbox"},domProps:{checked:Array.isArray(e.element.params[t.name])?e._i(e.element.params[t.name],null)>-1:e.element.params[t.name]},on:{change:function(a){var s=e.element.params[t.name],i=a.target,n=!!i.checked;if(Array.isArray(s)){var o=null,l=e._i(s,o);i.checked?l<0&&e.$set(e.element.params,t.name,s.concat([o])):l>-1&&e.$set(e.element.params,t.name,s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.element.params,t.name,n)}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:"radio"},domProps:{checked:e._q(e.element.params[t.name],null)},on:{change:function(a){return e.$set(e.element.params,t.name,null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[t.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:t.type},domProps:{value:e.element.params[t.name]},on:{input:function(a){a.target.composing||e.$set(e.element.params,t.name,a.target.value)}}}),""!==t.helptext?a("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.translate(t.helptext)))]):e._e()]):e._e()})),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],2)},Ln=[],Bn={name:"FormBuilderElementParams",components:{},props:{element:{type:Object,required:!1},params:{type:Array,required:!1},databases:{type:Array,required:!1}},data:()=>({databasejoin_description:null,reloadOptions:0,reloadOptionsCascade:0,loading:!1}),created(){this.params.forEach(e=>{"databasejoin"===e.type&&(this.sysadmin?(this.loading=!0,ze.getAllDatabases().then(t=>{e.options=t.data.data,this.reloadOptions+=1,""!=this.element.params["join_db_name"]&&this.updateDatabasejoinParams(),this.loading=!1})):(e.options=this.databases,""!=this.element.params["join_db_name"]&&this.updateDatabasejoinParams()))})},methods:{updateDatabasejoinParams(){if(this.sysadmin)ze.getDatabaseJoinOrderColumns(this.element.params["join_db_name"]).then(e=>{let t=this.params.map(e=>e.name).indexOf("join_key_column");this.params[t].options=e.data.data,""==this.element.params["join_key_column"]&&(this.element.params["join_key_column"]=this.params[t].options[0].COLUMN_NAME),t=this.params.map(e=>e.name).indexOf("join_val_column"),this.params[t].options=e.data.data,""==this.element.params["join_val_column"]&&(this.element.params["join_val_column"]=this.params[t].options[0].COLUMN_NAME),this.reloadOptionsCascade+=1});else{const e=this.databases.map(e=>e.database_name).indexOf(this.element.params["join_db_name"]);if(-1!==e){let t=this.databases[e];this.element.params["join_key_column"]=t.join_column_id,this.element.params["database_join_where_sql"]="order by {thistable}."+t.join_column_id,1==t.translation?(this.element.params["join_val_column"]=t.join_column_val+"_fr",this.element.params["join_val_column_concat"]="{thistable}."+t.join_column_val+"_{shortlang}"):(this.element.params["join_val_column"]=t.join_column_val,this.element.params["join_val_column_concat"]=""),this.databasejoin_description=this.databases[e].description}else{let e=this.params.map(e=>e.name).indexOf("join_db_name"),t={label:this.element.params["join_db_name"],database_name:this.element.params["join_db_name"]};this.params[e].options.push(t),setTimeout(()=>{document.getElementById("join_db_name").disabled=!0},500)}}}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)}}},In=Bn,kn=Object(b["a"])(In,xn,Ln,!1,null,"5e143db5",null),Pn=kn.exports,Fn={name:"FormBuilderElementProperties",components:{FormBuilderElementParams:Pn},props:{element:{type:Object,required:!0},profile_id:{type:Number,required:!0}},mixins:[Mn],data(){return{databases:[],params:[],elementsNeedingDb:["dropdown","checkbox","radiobutton","databasejoin"],tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!0,published:!0},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_PARAMETERS",active:!1,published:!0}],loading:!1}},mounted(){this.getDatabases(),this.paramsAvailable()},methods:{getDatabases(){ze.getDatabases().then(e=>{e.status&&(this.databases=e.data.data)})},saveProperties(){this.loading=!0,ze.updateTranslation({value:this.element.id,key:"element"},this.element.label_tag,this.element.label),["radiobutton","checkbox","dropdown"].includes(this.element.plugin)?ze.getJTEXTA(this.element.params.sub_options.sub_labels).then(e=>{e&&(this.element.params.sub_options.sub_labels.forEach((t,a)=>{this.element.params.sub_options.sub_labels[a]=Object.values(e.data)[a]}),ze.updateParams(this.element).then(e=>{e.status&&(this.loading=!1,this.updateLastSave(),this.$emit("close"))}))}):ze.updateParams(this.element).then(e=>{e.status&&(this.loading=!1,this.updateLastSave(),this.$emit("close"))})},togglePublish(){this.element.publish=!this.element.publish,ze.toggleElementPublishValue(this.element.id).then(e=>{e.status||(this.element.publish=!this.element.publish)})},toggleHidden(){this.element.hidden=!this.element.hidden,ze.toggleElementHiddenValue(this.element.id).then(e=>{e.status||(this.element.hidden=!this.element.hidden)})},selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},paramsAvailable(){"undefined"!==typeof Rn[this.element.plugin]?(this.tabs[1].published=!0,this.params=Rn[this.element.plugin]):(this.tabs[1].active=!1,this.tabs[0].active=!0,this.tabs[1].published=!1)}},computed:{componentType(){let e="";switch(this.element.plugin){case"databasejoin":e="radio"==this.element.params.database_join_display_type?"radiobutton":this.element.params.database_join_display_type;break;case"years":case"date":case"birthday":e="birthday";break;default:e=this.element.plugin;break}return e},isPublished(){return!this.element.publish},isHidden(){return this.element.hidden},sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},publishedTabs(){return this.tabs.filter(e=>e.published)}},watch:{"element.id":function(e){this.paramsAvailable()}}},$n=Fn,jn=(a("8a9a"),Object(b["a"])($n,Un,Tn,!1,null,null,null)),Gn=jn.exports,Hn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-element-properties"}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES")))]),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),a("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.publishedTabs,(function(t){return a("li",{key:t.id,staticClass:"em-p-16 em-pointer",class:{"is-active":t.active,"em-w-50":"2"==e.publishedTabs.length,"em-w-100":1==e.publishedTabs.length},on:{click:function(a){return e.selectTab(t)}}},[e._v(" "+e._s(e.translate(t.label))+" ")])})),0),a("div",{attrs:{id:"properties"}},[e.tabs[0].active?a("div",{staticClass:"em-p-16",attrs:{id:"section-parameters"}},[a("label",{attrs:{for:"section-label"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_LABEL")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.section_tmp.label,expression:"section_tmp.label"}],staticClass:"em-w-100",attrs:{id:"section-label",name:"section-label",type:"text"},domProps:{value:e.section_tmp.label},on:{input:function(t){t.target.composing||e.$set(e.section_tmp,"label",t.target.value)}}})]):e._e(),e.tabs[1].active?a("div",{staticClass:"em-p-16"},[a("form-builder-section-params",{attrs:{params:e.params,section:e.section_tmp}})],1):e._e()]),a("div",{staticClass:"em-flex-row em-flex-space-between actions em-m-16"},[a("button",{staticClass:"em-primary-button",on:{click:function(t){return e.saveProperties()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES_SAVE"))+" ")])])])},zn=[],Vn=a("4c13"),Yn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.params.length>0?a("div",[e._l(e.displayedParams,(function(t){return a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.translate(t.label)))]),"dropdown"===t.type?a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.section.params[t.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.section.params,t.name,a.target.multiple?s:s[0])}}},e._l(t.options,(function(t){return a("option",{domProps:{value:t.value}},[e._v(e._s(e.translate(t.label)))])})),0)]):"textarea"===t.type?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.section.params[t.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",domProps:{value:e.section.params[t.name]},on:{input:function(a){a.target.composing||e.$set(e.section.params,t.name,a.target.value)}}}):"checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[t.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:"checkbox"},domProps:{checked:Array.isArray(e.section.params[t.name])?e._i(e.section.params[t.name],null)>-1:e.section.params[t.name]},on:{change:function(a){var s=e.section.params[t.name],i=a.target,n=!!i.checked;if(Array.isArray(s)){var o=null,l=e._i(s,o);i.checked?l<0&&e.$set(e.section.params,t.name,s.concat([o])):l>-1&&e.$set(e.section.params,t.name,s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.section.params,t.name,n)}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[t.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:"radio"},domProps:{checked:e._q(e.section.params[t.name],null)},on:{change:function(a){return e.$set(e.section.params,t.name,null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[t.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(t.placeholder),type:t.type},domProps:{value:e.section.params[t.name]},on:{input:function(a){a.target.composing||e.$set(e.section.params,t.name,a.target.value)}}}),""!==t.helptext?a("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.translate(t.helptext)))]):e._e()])})),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],2):e._e()},qn=[],Jn={name:"FormBuilderSectionParams",props:{section:{type:Object,required:!1},params:{type:Array,required:!1}},data:()=>({loading:!1}),computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},displayedParams(){return this.params.filter(e=>e.published&&!e.sysadmin_only||this.sysadmin&&e.sysadmin_only&&e.published)}}},Wn=Jn,Kn=Object(b["a"])(Wn,Yn,qn,!1,null,"19da62a1",null),Xn=Kn.exports,Qn={name:"FormBuilderSectionProperties",components:{FormBuilderSectionParams:Xn},props:{section_id:{type:Number,required:!0},profile_id:{type:Number,required:!0}},data(){return{section_tmp:{},params:[],tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!1,published:!1},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_PARAMETERS",active:!0,published:!0}]}},created(){this.paramsAvailable(),this.getSection()},methods:{saveProperties(){ze.updateGroupParams(this.section_tmp.id,this.section_tmp.params,this.shortDefaultLang).then(()=>{this.$emit("close")})},toggleHidden(){this.section_tmp.params.hidden=!this.section_tmp.hidden},selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},paramsAvailable(){"undefined"!==typeof Vn["parameters"]?(this.tabs[1].published=!0,this.params=Vn["parameters"]):(this.tabs[1].active=!1,this.tabs[0].active=!0,this.tabs[1].published=!1)},getSection(){ze.getSection(this.$props.section_id).then(e=>{this.section_tmp=e.data.group})}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},publishedTabs(){return this.tabs.filter(e=>e.published)}},watch:{section:function(){this.paramsAvailable(),this.getSection()}}},Zn=Qn,eo=(a("7136"),Object(b["a"])(Zn,Hn,zn,!1,null,null,null)),to=eo.exports,ao=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-page"}},[a("div",{staticClass:"em-flex-row em-flex-space-between"},[a("span",{ref:"pageTitle",staticClass:"em-font-size-24 em-font-weight-800 editable-data",attrs:{contenteditable:"true",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_TITLE_ADD")},domProps:{innerHTML:e._s(e.translate(e.title))},on:{focusout:e.updateTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateTitleKeyup.apply(null,arguments)},keydown:function(t){return e.checkMaxMinlength(t,50,3)}}}),a("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_TITLE")},on:{click:function(t){return e.$emit("open-create-model",e.page.id)}}},[e._v("save_as")])]),a("span",{ref:"pageDescription",staticClass:"description editable-data",attrs:{id:"pageDescription",contenteditable:"true",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_INTRO_ADD")},domProps:{innerHTML:e._s(e.description)},on:{focusout:e.updateDescription}}),a("div",{staticClass:"form-builder-page-sections"},[e.sections.length>0?a("button",{staticClass:"em-secondary-button top",attrs:{id:"add-section"},on:{click:function(t){return e.addSection()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_SECTION"))+" ")]):e._e(),e._l(e.sections,(function(t,s){return a("form-builder-page-section",{key:t.group_id,ref:"section-"+t.group_id,refInFor:!0,attrs:{profile_id:parseInt(e.profile_id),page_id:parseInt(e.page.id),section:t,index:s+1,totalSections:e.sections.length},on:{"open-element-properties":function(t){return e.$emit("open-element-properties",t)},"move-element":e.updateElementsOrder,"delete-section":e.deleteSection,"update-element":e.getSections,"move-section":e.moveSection,"open-section-properties":function(a){return e.$emit("open-section-properties",t)}}})}))],2),a("button",{staticClass:"em-secondary-button",attrs:{id:"add-section"},on:{click:function(t){return e.addSection()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_SECTION"))+" ")]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},so=[],io=a("bef5"),no=a.n(io),oo={async checkSetup(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=checksetup")}catch(e){return!1}},async configureSetup(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=configuresetup")}catch(e){return!1}},async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");return e.data}catch(e){return!1}},async getDefaultLanguage(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getdefaultlanguage");return e.data}catch(e){return!1}},async updateLanguage(e,t,a=0){try{const s=new FormData;return s.append("published",t),s.append("lang_code",e),s.append("default_lang",a),await h().post("index.php?option=com_emundus&controller=translations&task=updatelanguage",s,{headers:{"Content-Type":"multipart/form-data"}})}catch(s){return{status:!1,msg:s.message}}},async getObjects(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=gettranslationsobjects")}catch(e){return{status:!1,msg:e.message}}},async getDatas(e,t,a,s){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getdatas",{params:{table:e,reference_id:t,label:a,filters:s}})}catch(i){return{status:!1,msg:i.message}}},async getChildrens(e,t,a){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getchildrens",{params:{table:e,reference_id:t,label:a}})}catch(s){return{status:!1,msg:s.message}}},async getTranslations(e,t,a,s="",i="",n=""){switch(e){case"falang":try{return await h().get("index.php?option=com_emundus&controller=translations&task=getfalangtranslations",{params:{default_lang:t,lang_to:a,reference_table:n,reference_id:s,fields:i}})}catch(o){return{status:!1,msg:o.message}}case"override":let e={default_lang:t,lang_to:a,reference_table:n,reference_id:s,fields:i},l=p.a.create({paramsSerializer:e=>no.a.stringify(e)});try{return await l.get("index.php?option=com_emundus&controller=translations&task=gettranslations",{params:e})}catch(o){return{status:!1,msg:o.message}}break;default:}},async updateTranslations(e,t,a,s,i,n){switch(t){case"falang":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("field",i),t.append("reference_table",n),t.append("reference_id",s),await h().post("index.php?option=com_emundus&controller=translations&task=updatefalangtranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(o){return{status:!1,msg:o.message}}break;case"override":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("tag",i),t.append("reference_table",n),t.append("reference_id",s),await h().post("index.php?option=com_emundus&controller=translations&task=updatetranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(o){return{status:!1,msg:o.message}}break;default:}},async insertTranslation(e,t,a,s,i,n){switch(t){case"override":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("tag",i),t.append("reference_table",n),t.append("reference_id",s),await h().post("index.php?option=com_emundus&controller=translations&task=inserttranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(o){return{status:!1,msg:o.message}}break;default:}},async getOrphelins(e,t){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getorphelins",{params:{default_lang:e,lang_to:t}})}catch(a){return{status:!1,msg:a.message}}},async sendMailToInstallLanguage(e,t=""){try{const a=new FormData;return a.append("suggest_language",e),a.append("comment",t),await h().post("index.php?option=com_emundus&controller=translations&task=sendpurposenewlanguage",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getJText(e){try{return await h().get("index.php?option=com_emundus&controller=formbuilder&task=getJTEXT",{params:{toJTEXT:e}})}catch(t){return{status:!1,msg:t.message}}}},lo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-builder-page-section em-mt-32 em-mb-32",attrs:{id:"form-builder-page-section-"+e.section.group_id}},[a("div",{staticClass:"section-card em-flex-column"},[a("div",{staticClass:"section-identifier em-bg-main-500 em-pointer em-flex-row",on:{click:function(t){e.closedSection=!e.closedSection}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.section.repeat_group,expression:"section.repeat_group"}],staticClass:"material-icons em-mr-8 em-color-white"},[e._v("library_add")]),e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION"))+" "+e._s(e.index)+" / "+e._s(e.totalSections)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.closedSection,expression:"!closedSection"}],staticClass:"material-icons em-ml-8 em-color-white"},[e._v("unfold_less")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.closedSection,expression:"closedSection"}],staticClass:"material-icons em-ml-8 em-color-white"},[e._v("unfold_more")])]),a("div",{staticClass:"section-content em-w-100 em-p-32",class:{closed:e.closedSection}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100 "},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.section.label[e.shortDefaultLang],expression:"section.label[shortDefaultLang]"}],staticClass:"editable-data em-w-100",attrs:{id:"section-title",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_TITLE_ADD"),maxlength:"100"},domProps:{value:e.section.label[e.shortDefaultLang]},on:{focusout:e.updateTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurElement("#section-title")},input:function(t){t.target.composing||e.$set(e.section.label,e.shortDefaultLang,t.target.value)}}}),a("div",{staticClass:"section-actions-wrapper"},[a("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section upwards"},on:{click:function(t){return e.moveSection("up")}}},[e._v("keyboard_double_arrow_up")]),a("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section downwards"},on:{click:function(t){return e.moveSection("down")}}},[e._v("keyboard_double_arrow_down")]),a("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer delete hover-opacity",on:{click:e.deleteSection}},[e._v("delete")]),a("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",on:{click:function(t){return e.$emit("open-section-properties")}}},[e._v("settings")])])]),a("transition",{attrs:{name:"slide-down"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.closedSection,expression:"!closedSection"}]},[a("p",{ref:"sectionIntro",staticClass:"editable-data",attrs:{id:"section-intro",contenteditable:"true"},domProps:{innerHTML:e._s(e.section.group_intro)},on:{focusout:e.updateIntro,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurElement("#section-intro")}}}),a("draggable",{staticClass:"draggables-list",attrs:{group:"form-builder-section-elements",sort:!0,handle:".handle"},on:{end:e.onDragEnd},model:{value:e.elements,callback:function(t){e.elements=t},expression:"elements"}},[a("transition-group",{attrs:{"data-prid":e.profile_id,"data-page":e.page_id,"data-sid":e.section.group_id}},e._l(e.elements,(function(t){return a("form-builder-page-section-element",{key:t.id,attrs:{element:t},on:{"open-element-properties":function(a){return e.$emit("open-element-properties",t)},"delete-element":e.deleteElement,"cancel-delete-element":e.cancelDeleteElement,"update-element":function(t){return e.$emit("update-element")}}})})),1)],1),e.publishedElements.length<1?a("div",{staticClass:"empty-section-element"},[a("draggable",{staticClass:"draggables-list",attrs:{list:e.emptySection,group:"form-builder-section-elements",sort:!1}},[a("transition-group",{attrs:{"data-prid":e.profile_id,"data-page":e.page_id,"data-sid":e.section.group_id}},e._l(e.emptySection,(function(t,s){return a("p",{key:s,staticClass:"em-w-100 em-text-align-center"},[e._v(" "+e._s(e.translate(t.text))+" ")])})),0)],1)],1):e._e()],1)])],1)])])},ro=[],co=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:!e.element.hidden&&-2!==e.element.publish||e.element.hidden&&e.sysadmin,expression:"(!element.hidden && element.publish !== -2) || (element.hidden && sysadmin)"}],staticClass:"form-builder-page-section-element",class:{unpublished:!e.element.publish||e.element.hidden,"properties-active":e.propertiesOpened==e.element.id},attrs:{id:"element_"+e.element.id}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100"},[a("label",{staticClass:"em-w-100 em-flex-row fabrikLabel control-label fabrikTip",on:{click:e.triggerElementProperties}},[e.element.FRequire?a("i",{staticClass:"icon-star small",attrs:{"data-isicon":"true"}}):e._e(),e.element.label_value&&2!=e.element.labelsAbove?a("input",{directives:[{name:"model",rawName:"v-model",value:e.element.label[e.shortDefaultLang],expression:"element.label[shortDefaultLang]"}],ref:"element-label-"+e.element.id,staticClass:"element-title editable-data",attrs:{id:"element-label-"+e.element.id,name:"element-label-"+e.element.id,type:"text"},domProps:{value:e.element.label[e.shortDefaultLang]},on:{focusout:e.updateLabel,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLabelKeyup.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.element.label,e.shortDefaultLang,t.target.value)}}}):e._e()]),a("div",{staticClass:"em-flex-row",attrs:{id:"element-action-icons"}},[a("span",{staticClass:"material-icons-outlined handle em-grab"},[e._v("drag_indicator")]),a("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer",attrs:{id:"delete-element"},on:{click:e.deleteElement}},[e._v("delete")]),e.sysadmin?a("span",{staticClass:"material-icons-outlined em-pointer em-ml-8",on:{click:e.openAdmin}},[e._v("content_copy")]):e._e()])]),a("div",{class:"element-field fabrikElement"+e.element.plugin,on:{click:e.triggerElementProperties}},[["radiobutton","checkbox"].includes(e.element.plugin)||e.displayOptions&&"dropdown"===e.element.plugin?a("form-builder-element-options",{attrs:{element:e.element,type:"radiobutton"==e.element.plugin?"radio":e.element.plugin},on:{"update-element":function(t){return e.$emit("update-element")}}}):"display"===e.element.plugin?a("form-builder-element-wysiwig",{attrs:{element:e.element,type:"display"},on:{"update-element":function(t){return e.$emit("update-element")}}}):a("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(e.element.element)}})],1)])},mo=[],uo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-radio-button"}},[e.loading?a("div",{staticClass:"em-loader"}):a("div",[a("draggable",{attrs:{handle:".handle-options"},on:{end:e.updateOrder},model:{value:e.arraySubValues,callback:function(t){e.arraySubValues=t},expression:"arraySubValues"}},e._l(e.arraySubValues,(function(t,s){return a("div",{key:t,staticClass:"element-option em-flex-row em-flex-space-between em-mt-8 em-mb-8",on:{mouseover:function(t){e.optionHighlight=s},mouseleave:function(t){e.optionHighlight=null}}},[a("div",{staticClass:"em-flex-row em-w-100"},[a("div",{staticClass:"em-flex-row"},[a("span",{staticClass:"icon-handle",style:e.optionHighlight===s?"opacity: 1":"opacity: 0"},[a("span",{staticClass:"material-icons-outlined handle-options em-grab"},[e._v("drag_indicator")])])]),"dropdown"!==e.type?a("input",{attrs:{type:e.type,name:"element-id-"+e.element.id},domProps:{value:e.optionsTranslations[s]}}):a("div",[e._v(e._s(s+1)+". ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.optionsTranslations[s],expression:"optionsTranslations[index]"}],staticClass:"editable-data editable-data-input em-ml-4 em-w-100",attrs:{type:"text",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_OPTION")},domProps:{value:e.optionsTranslations[s]},on:{focusout:function(t){return e.updateOption(s,e.optionsTranslations[s])},input:function(t){t.target.composing||e.$set(e.optionsTranslations,s,t.target.value)}}})]),a("div",{staticClass:"em-flex-row"},[a("span",{staticClass:"material-icons-outlined em-pointer",style:e.optionHighlight===s?"opacity: 1":"opacity: 0",on:{click:function(t){return e.removeOption(s)}}},[e._v("close")])])])})),0),a("div",{staticClass:"em-flex-row em-flex-start em-s-justify-content-center",attrs:{id:"add-option"}},[e._m(0),"dropdown"!==e.type?a("input",{attrs:{type:e.type,name:"element-id-"+e.element.id}}):a("div",[e._v(e._s(e.element.params.sub_options.sub_labels.length+1)+". ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newOption,expression:"newOption"}],staticClass:"editable-data editable-data-input em-ml-4 em-w-100",attrs:{type:"text",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_OPTION")},domProps:{value:e.newOption},on:{focusout:e.addOption,input:function(t){t.target.composing||(e.newOption=t.target.value)}}})])],1)])},po=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"icon-handle",staticStyle:{opacity:"0"}},[a("span",{staticClass:"material-icons-outlined handle-options"},[e._v("drag_indicator")])])}],_o={props:{element:{type:Object,required:!0},type:{type:String,required:!0}},components:{draggable:qa.a},data(){return{loading:!1,newOption:"",arraySubValues:[],optionsTranslations:[],optionHighlight:null}},created(){this.getSubOptionsTranslation()},methods:{async reloadOptions(){this.loading=!0,ze.getElementSubOptions(this.element.id).then(e=>{e.data.status?(this.element.params.sub_options=e.data.new_options,this.getSubOptionsTranslation()):this.loading=!1})},async getSubOptionsTranslation(){this.loading=!0,ze.getJTEXTA(this.element.params.sub_options.sub_labels).then(e=>{e&&(this.optionsTranslations=Object.values(e.data),this.arraySubValues=this.element.params.sub_options.sub_values.map((e,t)=>({sub_value:e,sub_label:this.element.params.sub_options.sub_labels[t]}))),this.loading=!1})},addOption(){""!=this.newOption.trim()&&(this.loading=!0,ze.addOption(this.element.id,this.newOption,this.shortDefaultLang).then(e=>{this.newOption="",e.data.status&&this.reloadOptions(),this.loading=!1}))},updateOption(e,t){this.loading=!0,ze.updateOption(this.element.id,this.element.params.sub_options,e,t,this.shortDefaultLang).then(e=>{e.data.status?this.reloadOptions():this.loading=!1})},updateOrder(){if(this.arraySubValues.length>1){let e={sub_values:[],sub_labels:[]};this.arraySubValues.forEach((t,a)=>{e.sub_values.push(t.sub_value),e.sub_labels.push(t.sub_label)}),this.element.params.sub_options.sub_values.every((t,a)=>t===e.sub_values[a])?console.log("No need to call reorder, same order"):(this.loading=!0,ze.updateElementSubOptionsOrder(this.element.id,this.element.params.sub_options,e).then(e=>{e.data.status?this.reloadOptions():this.loading=!1}))}else console.log("No need to reorder, only one element")},removeOption(e){this.loading=!0,ze.deleteElementSubOption(this.element.id,e).then(e=>{e.data.status?this.reloadOptions():this.loading=!1})}}},ho=_o,go=(a("b42f"),Object(b["a"])(ho,uo,po,!1,null,null,null)),fo=go.exports,vo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-wysiwig"}},[e.loading?a("div",{staticClass:"em-loader"}):a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editable,expression:"!editable"}],attrs:{id:e.element.id},domProps:{innerHTML:e._s(e.element.element)},on:{click:function(t){e.editable=!0}}}),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.editable?a("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.element.default,lang:"fr",enable_variables:!1,id:"editor_"+e.element.id},on:{focusout:e.updateDisplayText},model:{value:e.element.default,callback:function(t){e.$set(e.element,"default",t)},expression:"element.default"}}):e._e()],1)],1)])},bo=[],Eo={props:{element:{type:Object,required:!0},type:{type:String,required:!0}},components:{Editor:Kt},data(){return{loading:!1,editable:!1,dynamicComponent:0}},created(){},methods:{updateDisplayText(e){this.editable=!1,ze.updateDefaultValue(this.$props.element.id,e).then(e=>{this.$emit("update-element")})}},watch:{}},Oo=Eo,Co=Object(b["a"])(Oo,vo,bo,!1,null,null,null),yo=Co.exports,Do={components:{FormBuilderElementWysiwig:yo,FormBuilderElementOptions:fo},props:{element:{type:Object,default:{}}},mixins:[Mn,A],data(){return{keysPressed:[],options_enabled:!1}},methods:{updateLabel(){this.element.label[this.shortDefaultLang]=this.$refs["element-label-"+this.element.id].value.trim().replace(/[\r\n]/gm,""),ze.updateTranslation({value:this.element.id,key:"element"},this.element.label_tag,this.element.label).then(e=>{e.data.status?(this.element.label_tag=e.data.data,this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_SAVE_TRANSLATION"),type:"error",cancelButtonText:this.translate("OK")})})},updateLabelKeyup(){document.activeElement.blur()},updateElement(){ze.updateParams(this.element).then(e=>{e.data.status?(this.$emit("update-element"),this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_UPDATE_PARAMS"),type:"error",cancelButtonText:this.translate("OK")})})},deleteElement(){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_ELEMENT"),this.element.label[this.shortDefaultLang],this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_ELEMENT_CONFIRM"),this.translate("JNO"),()=>{ze.deleteElement(this.element.id),this.$emit("delete-element",this.element.id),this.updateLastSave(),this.tip("foo-velocity",this.translate("COM_EMUNDUS_FORM_BUILDER_DELETED_ELEMENT_TEXT"),this.translate("COM_EMUNDUS_FORM_BUILDER_DELETED_ELEMENT_TITLE")),window.addEventListener("keydown",this.cancelDelete)})},openAdmin(){navigator.clipboard.writeText(this.element.id),Swal.fire({title:"Identifiant de l'élément copié",type:"success",showCancelButton:!1,showConfirmButton:!1,customClass:{title:"em-swal-title"},timer:1500})},triggerElementProperties(){this.$emit("open-element-properties")},cancelDelete(e){let t=this.$parent.$parent.$parent.elementsDeletedPending,a=t.indexOf(this.element.id);t.indexOf(this.element.id)===t.length-1&&(e.stopImmediatePropagation(),this.keysPressed[e.key]=!0,(this.keysPressed["Control"]||this.keysPressed["Meta"])&&"z"===e.key&&(ze.toggleElementPublishValue(this.element.id),this.$emit("cancel-delete-element",this.element.id),this.keysPressed=[],document.removeEventListener("keydown",this.cancelDelete),this.$parent.$parent.$parent.elementsDeletedPending.splice(a,1)))}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},displayOptions:function(){return this.$parent.$parent.$parent.$parent.$parent.$parent.optionsSelectedElement&&null!==this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement&&this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement.id==this.element.id},propertiesOpened:function(){return null!==this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement?this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement.id:0}}},Mo=Do,No=(a("0921"),Object(b["a"])(Mo,co,mo,!1,null,null,null)),Ao=No.exports,So={components:{FormBuilderPageSectionElement:Ao,draggable:qa.a},props:{profile_id:{type:Number,required:!0},page_id:{type:Number,required:!0},section:{type:Object,required:!0},index:{type:Number,default:0},totalSections:{type:Number,default:0}},mixins:[Mn,A],data(){return{closedSection:!1,elements:[],emptySection:[{text:"COM_EMUNDUS_FORM_BUILDER_EMPTY_SECTION"}],elementsDeletedPending:[]}},created(){this.getElements()},methods:{getElements(){this.elements=Object.values(this.section.elements).length>0?Object.values(this.section.elements):[]},updateTitle(){this.section.label[this.shortDefaultLang]=this.section.label[this.shortDefaultLang].trim(),ze.updateTranslation({value:this.section.group_id,key:"group"},this.section.group_tag,this.section.label).then(e=>{e.data.status?(this.section.group_tag=e.data.data,this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_SAVE_TRANSLATION"),type:"error",cancelButtonText:this.translate("OK")})})},blurElement(e){document.querySelector(e).blur()},updateIntro(){this.$refs.sectionIntro.innerHTML=this.$refs.sectionIntro.innerHTML.trim().replace(/[\r\n]/gm," "),this.section.group_intro=this.$refs.sectionIntro.innerHTML,ze.updateGroupParams(this.section.group_id,{intro:this.section.group_intro},this.shortDefaultLang).then(e=>{e.data.status?this.updateLastSave():Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_UPDATE_GROUP_PARAMS"),type:"error",cancelButtonText:this.translate("OK")})})},onDragEnd(e){const t=e.to.getAttribute("data-sid");if(t==this.section.group_id){const t=this.elements.map((e,t)=>({id:e.id,order:t+1})),a=this.elements[e.newIndex];ze.updateOrder(t,this.section.group_id,a).then(e=>{this.updateLastSave();let t={};this.elements.forEach((e,a)=>{t["element"+e.id]=e}),this.section.elements=t})}else this.$emit("move-element",e,this.section.group_id,t)},deleteElement(e){this.section.elements["element"+e].publish=-2,this.elementsDeletedPending.push(e),this.getElements(),this.updateLastSave()},cancelDeleteElement(e){this.section.elements["element"+e].publish=!0,this.getElements()},deleteSection(){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_SECTION"),this.section.label[this.shortDefaultLang],this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_SECTION_CONFIRM"),this.translate("JNO"),()=>{ze.deleteGroup(this.section.group_id),this.$emit("delete-section",this.section.group_id),this.updateLastSave()})},moveSection(e="up"){this.$emit("move-section",this.section.group_id,e)}},watch:{section:{handler(){this.getElements()},deep:!0}},computed:{publishedElements(){return this.elements&&this.elements.length>0?this.elements.filter(e=>!0===e.publish):[]}}},wo=So,Uo=(a("7e56"),Object(b["a"])(wo,lo,ro,!1,null,null,null)),To=Uo.exports,Ro={components:{FormBuilderPageSection:To},props:{profile_id:{type:Number,default:0},page:{type:Object,default:{}}},mixins:[Mn,A],data(){return{fabrikPage:{},title:"COM_EMUNDUS_FORM_BUILDER_NEW_PAGE",description:"",sections:[],loading:!1}},mounted(){this.page.id&&(this.title=this.page.label,this.getSections())},methods:{getSections(){this.loading=!0,Ls.getPageObject(this.page.id).then(e=>{if(e.status&&""!=e.data){this.fabrikPage=e.data,this.title=this.fabrikPage.show_title.label[this.shortDefaultLang];const t=Object.values(e.data.Groups);this.sections=t.filter(e=>-1!=e.hidden_group),this.getDescription()}else j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}});this.loading=!1})},getDescription(){ze.getAllTranslations(this.fabrikPage.intro_raw).then(e=>{e.status&&e.data&&""!==e.data[this.shortDefaultLang]&&(this.description=e.data[this.shortDefaultLang])})},addSection(){this.sections.length<10?ze.createSimpleGroup(this.page.id,{fr:"Nouvelle section",en:"New section"}).then(e=>{e.status&&(this.getSections(),this.updateLastSave())}):j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_MAX_SECTION_TITLE"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_MAX_SECTION_TEXT"),type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},moveSection(e,t){let a=this.sections.map((e,t)=>({id:e.group_id,order:t}));const s=a.findIndex(t=>e===t.id),i=a[s].id;"up"===t?s>0&&(a[s].id=a[s-1].id,a[s-1].id=i):s<a.length-1&&(a[s].id=a[s+1].id,a[s+1].id=i),ze.reorderSections(this.page.id,a);const n=this.sections;let o=[];a.forEach(e=>{o.push(n.find(t=>t.group_id===e.id))}),this.sections=o},updateTitle(){this.fabrikPage.show_title.label[this.shortDefaultLang]=this.$refs.pageTitle.innerText.trim().replace(/[\r\n]/gm,""),this.$refs.pageTitle.innerText=this.$refs.pageTitle.innerText.trim().replace(/[\r\n]/gm,""),ze.updateTranslation(null,this.fabrikPage.show_title.titleraw,this.fabrikPage.show_title.label).then(e=>{e.status&&(oo.updateTranslations(this.fabrikPage.show_title.label[this.shortDefaultLang],"falang",this.shortDefaultLang,this.fabrikPage.menu_id,"title","menu"),this.$emit("update-page-title",{page:this.page.id,new_title:this.$refs.pageTitle.innerText}),this.updateLastSave())})},updateTitleKeyup(){document.activeElement.blur()},updateDescription(){this.fabrikPage.intro[this.shortDefaultLang]=this.$refs.pageDescription.innerText.replace(/[\r\n]/gm,"<br/>"),ze.updateTranslation(null,this.fabrikPage.intro_raw,this.fabrikPage.intro).then(e=>{e.data.status&&(this.updateLastSave(),this.fabrikPage.intro_raw=e.data.data),""===this.$refs.pageDescription.innerText&&(document.getElementById("pageDescription").textContent=this.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_INTRO_ADD"),document.getElementById("pageDescription").classList.add("em-text-neutral-600"))})},updateElementsOrder(e,t,a){const s=this.sections.find(e=>e.group_id===t),i=Object.values(s.elements),n=i[e.oldIndex],o=this.$refs["section-"+a][0].elements.map((e,t)=>({id:e.id,order:t+1}));n.id&&(ze.updateOrder(o,a,n),this.updateLastSave())},deleteSection(e){this.sections=this.sections.filter(t=>t.group_id!==e),this.updateLastSave()}}},xo=Ro,Lo=(a("7f9a"),Object(b["a"])(xo,ao,so,!1,null,null,null)),Bo=Lo.exports,Io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-w-100 em-p-32 em-pt-16",attrs:{id:"form-builder-create-page"}},[a("div",[a("h3",{staticClass:"em-mb-4 em-text-neutral-800"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE")))]),a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE_INTRO")))]),a("section",{attrs:{id:"new-page"}},[a("div",{staticClass:"em-mt-16 em-mb-16 card-wrapper",class:{selected:-1===e.selected},on:{click:function(t){e.selected=-1}}},[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.page.label[e.shortDefaultLang],expression:"page.label[shortDefaultLang]"}],staticClass:"em-p-4",class:{"em-color-white":-1===e.selected,"em-bg-main-500":-1===e.selected},attrs:{type:"text"},domProps:{value:e.page.label[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.page.label,e.shortDefaultLang,t.target.value)}}})])]),a("div",{staticClass:"separator em-mt-32"},[a("p",{staticClass:"line-head em-mt-4 em-p-8 em-color-white em-bg-main-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE_FROM_MODEL")))]),a("div",{staticClass:"line em-bg-main-500"})]),a("section",{staticClass:"em-flex-row em-w-100",attrs:{id:"models"}},[e.models.length<1&&!e.loading?a("p",{staticClass:"em-w-100 em-text-align-center empty-model-message"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EMPTY_PAGE_MODELS")))]):e._e(),e.loading?a("div",{staticClass:"em-w-100"},[a("skeleton",{attrs:{width:"206px",height:"41px",classes:"em-mt-16 em-mb-16 em-border-radius-5"}}),a("div",{staticClass:"models-card em-grid"},e._l(16,(function(e){return a("div",{key:e,staticClass:"em-flex-column card-wrapper em-mr-24"},[a("skeleton",{attrs:{width:"150px",height:"200px",classes:"card em-shadow-cards model-preview"}}),a("skeleton",{attrs:{width:"150px",height:"20px",classes:"em-p-4"}})],1)})),0)],1):a("div",{staticClass:"em-w-100"},[a("div",{attrs:{id:"search-model-wrapper"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-mt-16",attrs:{id:"search-model",type:"text",placeholder:"Rechercher"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),a("span",{staticClass:"reset-search material-icons-outlined em-pointer",on:{click:function(t){e.search=""}}},[e._v("close")])]),a("div",{staticClass:"models-card em-flex-row"},[e._l(e.models,(function(t){return a("div",{key:t.id,staticClass:"card-wrapper em-mr-32",class:{selected:t.id===e.selected,hidden:!t.displayed},attrs:{title:t.label[e.shortDefaultLang]},on:{click:function(a){e.selected=t.id}}},[a("form-builder-preview-form",{staticClass:"card em-shadow-cards model-preview em-pointer",class:{"em-color-white":t.id===e.selected,"em-bg-main-500":t.id===e.selected},attrs:{form_id:Number(t.form_id),form_label:t.label[e.shortDefaultLang]}}),a("p",{staticClass:"em-p-4",class:{"em-color-white":t.id===e.selected,"em-bg-main-500":t.id===e.selected}},[e._v(" "+e._s(t.label[e.shortDefaultLang])+" ")])],1)})),e.displayedModels.length<1?a("div",{staticClass:"empty-model-message em-w-100 em-text-align-center"},[a("span",{staticClass:"material-icons-outlined"},[e._v("manage_search")]),a("p",{staticClass:"em-w-100"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EMPTY_PAGE_MODELS")))])]):e._e()],2)])])]),a("div",{staticClass:"actions em-flex-row-justify-end em-w-100"},[a("button",{staticClass:"em-secondary-button em-w-max-content em-white-bg",on:{click:function(t){return e.close(!1)}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CANCEL")))]),a("button",{staticClass:"em-primary-button em-w-max-content em-ml-8",on:{click:e.createPage}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_PAGE_CREATE_SAVE")))])])])},ko=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card em-shadow-cards em-pointer em-flex-row"},[a("span",{staticClass:"add_circle material-icons-outlined em-main-500-color"},[e._v("add_circle")])])}],Po={name:"FormBuilderCreatePage.vue",components:{Skeleton:Ni,FormBuilderPreviewForm:Ui},props:{profile_id:{type:Number,required:!0}},data(){return{loading:!0,selected:-1,models:[],page:{label:{fr:"Nouvelle page",en:"New page"},intro:{fr:"",en:""},prid:this.profile_id,template:0},search:""}},created(){this.getModels()},methods:{getModels(){ze.getModels().then(e=>{e.status?this.models=e.data.map(e=>(e.displayed=!0,e)):Swal.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_GET_PAGE_MODELS_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.loading=!1})},createPage(){let e=-1;if(this.selected>0){const t=this.models.find(e=>e.id===this.selected);t&&(e=t.form_id,this.page.label=t.label,this.page.intro=t.intro)}const t={...this.page,modelid:e};ze.addPage(t).then(e=>{e.status?this.close(!0,e.data.id):(Swal.fire({type:"error",title:this.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_PAGE_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.close(!1))})},close(e=!0,t=0){this.$emit("close",{reload:e,newSelected:t})}},computed:{displayedModels(){return this.models.filter(e=>e.displayed)}},watch:{search:function(){this.models.forEach(e=>{e.displayed=e.label[this.shortDefaultLang].toLowerCase().includes(this.search.toLowerCase().trim())})}}},Fo=Po,$o=(a("36fe"),Object(b["a"])(Fo,Io,ko,!1,null,"612e6ca1",null)),jo=$o.exports,Go=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-pages"}},[a("p",{staticClass:"form-builder-title em-flex-row em-s-justify-content-center em-flex-space-between em-p-16"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EVERY_PAGE")))]),a("span",{staticClass:"material-icons em-pointer",on:{click:function(t){return e.$emit("open-page-create")}}},[e._v(" add ")])]),a("draggable",{staticClass:"draggables-list",attrs:{group:"form-builder-pages",sort:!0},on:{end:e.onDragEnd},model:{value:e.pages,callback:function(t){e.pages=t},expression:"pages"}},[a("transition-group",e._l(e.formPages,(function(t){return a("div",{key:t.id,staticClass:"em-font-weight-500 em-pointer",class:{selected:t.id===e.selected}},[a("div",{staticClass:"em-flex-row em-flex-space-between",on:{mouseover:function(a){e.pageOptionsShown=t.id},mouseleave:function(t){e.pageOptionsShown=0}}},[a("p",{staticClass:"em-w-100 em-p-16",on:{click:function(a){return e.selectPage(t.id)}}},[e._v(e._s(e.translate(t.label)))]),a("div",{staticClass:"em-flex-row em-p-16",style:e.pageOptionsShown===t.id?"opacity:1":"opacity: 0"},[a("v-popover",{attrs:{popoverArrowClass:"custom-popover-arraow"}},[a("span",{staticClass:"material-icons"},[e._v("more_horiz")]),a("template",{slot:"popover"},[a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",[a("nav",{staticClass:"em-flex-col-start",attrs:{"aria-label":"action"}},[a("p",{staticClass:"em-p-8-12 em-w-100 em-red-500-color",on:{click:function(a){return e.deletePage(t)}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE"))+" ")])])])])],1)],2)],1)])])})),0)],1),a("transition-group",e._l(e.submissionPages,(function(t){return a("div",{key:t.id,staticClass:"em-font-weight-500 em-pointer",class:{selected:t.id===e.selected}},[a("div",{staticClass:"em-flex-row em-flex-space-between"},[a("p",{staticClass:"em-w-100 em-p-16 em-main-500-color",on:{click:function(a){return e.selectPage(t.id)}}},[e._v(e._s(t.label))])])])})),0)],1)},Ho=[],zo={name:"FormBuilderPages",components:{draggable:qa.a},props:{pages:{type:Array,required:!0},selected:{type:Number,default:0},profile_id:{type:Number,required:!0}},mixins:[Mn],data(){return{pageOptionsShown:0}},created(){},methods:{selectPage(e){this.$emit("select-page",e)},deletePage(e){this.pages.length>2?j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_CONFIRMATION")+e.label,text:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_CONFIRMATION_TEXT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ACTIONS_DELETE"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-delete-button"}}).then(t=>{t.value&&ze.deletePage(e.id).then(t=>{if(t.status){let t=this.pages.findIndex(t=>t.id===e.id);this.pages.splice(t,1),this.selected==e.id&&this.$emit("delete-page"),this.updateLastSave()}})}):j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_ERROR_TEXT"),type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},onDragEnd(){const e=this.pages.map((e,t)=>({rgt:t,link:e.link}));ze.reorderMenu(e,this.$props.profile_id)}},computed:{formPages(){return this.pages.filter(e=>"submission"!=e.type)},submissionPages(){return this.pages.filter(e=>"submission"==e.type)}}},Vo=zo,Yo=(a("a3e0"),Object(b["a"])(Vo,Go,Ho,!1,null,null,null)),qo=Yo.exports,Jo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-documents"}},[a("div",{staticClass:"em-pointer em-flex-row em-flex-space-between em-p-16",attrs:{id:"form-builder-title"},on:{click:function(t){return e.$emit("show-documents")}}},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EVERY_DOCUMENTS")))]),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:e.createDocument}},[e._v("add")])]),e._l(e.documents,(function(t){return a("div",{key:t.id,staticClass:"em-p-16",on:{click:function(t){return e.$emit("show-documents")}}},[a("p",[e._v(e._s(t.label))])])}))],2)},Wo=[],Ko={name:"FormBuilderDocuments",props:{profile_id:{type:Number,required:!0},campaign_id:{type:Number,required:!0}},data(){return{documents:[]}},created(){this.getDocuments(),0===this.$store.getters["formBuilder/getDocumentModels"].length&&this.getDocumentModels()},methods:{getDocuments(){Ls.getDocuments(this.profile_id).then(e=>{this.documents=e.data.data})},getDocumentModels(){Ls.getDocumentModels().then(e=>{this.$store.dispatch("formBuilder/updateDocumentModels",e.data)})},createDocument(){this.$emit("open-create-document")}}},Xo=Ko,Qo=(a("7de6"),Object(b["a"])(Xo,Jo,Wo,!1,null,null,null)),Zo=Qo.exports,el=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-document-list"}},[a("div",{staticClass:"em-w-100 em-mb-32 em-mt-32",attrs:{id:"required-documents"}},[a("p",{staticClass:"em-font-size-24 em-font-weight-800"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_REQUIRED_DOCUMENTS")))]),e.requiredDocuments.length>0?a("div",[a("draggable",{attrs:{group:"form-builder-documents",sort:!1},model:{value:e.requiredDocuments,callback:function(t){e.requiredDocuments=t},expression:"requiredDocuments"}},[a("transition-group",{attrs:{id:"required-documents"}},e._l(e.requiredDocuments,(function(t,s){return a("form-builder-document-list-element",{key:"required-"+t.id,attrs:{document:t,documentIndex:s+1,totalDocuments:e.requiredDocuments.length,profile_id:e.profile_id},on:{"edit-document":function(a){return e.editDocument(t)},"delete-document":e.deleteDocument,"move-document":e.moveDocument}})})),1)],1)],1):e._e(),e.requiredDocuments.length<1?a("div",{staticClass:"empty-documents em-mt-16 em-mb-16"},[a("draggable",{staticClass:"draggables-list",attrs:{list:e.emptyDocuments,group:"form-builder-documents",sort:!1}},[a("transition-group",{attrs:{id:"required-documents"}},e._l(e.emptyDocuments,(function(t,s){return a("p",{key:s,staticClass:"em-w-100 em-text-align-center em-p-16"},[e._v(" "+e._s(e.translate(t.text))+" ")])})),0)],1)],1):e._e(),a("button",{staticClass:"em-secondary-button",attrs:{id:"add-document"},on:{click:function(t){return e.addDocument("1")}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_REQUIRED_DOCUMENT")))])]),a("div",{staticClass:"em-w-100 em-mb-32 em-mt-32",attrs:{id:"optional-documents"}},[a("p",{staticClass:"em-font-size-24 em-font-weight-800"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_OPTIONAL_DOCUMENTS")))]),e.optionalDocuments.length>0?a("div",[a("draggable",{attrs:{group:"form-builder-documents",sort:!1},model:{value:e.optionalDocuments,callback:function(t){e.optionalDocuments=t},expression:"optionalDocuments"}},[a("transition-group",{attrs:{id:"optional-documents"}},e._l(e.optionalDocuments,(function(t,s){return a("form-builder-document-list-element",{key:"optional-"+t.id,attrs:{document:t,documentIndex:s+1,totalDocuments:e.optionalDocuments.length,profile_id:e.profile_id},on:{"edit-document":function(a){return e.editDocument(t)},"delete-document":e.deleteDocument,"move-document":e.moveDocument}})})),1)],1)],1):e._e(),e.optionalDocuments.length<1?a("div",{staticClass:"empty-documents em-mt-16 em-mb-16"},[a("draggable",{staticClass:"draggables-list",attrs:{list:e.emptyDocuments,group:"form-builder-documents",sort:!1}},[a("transition-group",{attrs:{id:"optional-documents"}},e._l(e.emptyDocuments,(function(t,s){return a("p",{key:s,staticClass:"em-w-100 em-text-align-center em-p-16"},[e._v(" "+e._s(e.translate(t.text))+" ")])})),0)],1)],1):e._e(),a("button",{staticClass:"em-secondary-button",attrs:{id:"add-document"},on:{click:function(t){return e.addDocument("0")}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_OPTIONAL_DOCUMENT")))])])])},tl=[],al=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-document-list-element"},on:{click:e.editDocument}},[a("div",{staticClass:"section-card em-mt-32 em-mb-32 em-w-100 em-flex-column"},[a("div",{staticClass:"section-identifier em-bg-main-500 em-pointer"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT"))+" "+e._s(e.documentIndex)+" / "+e._s(e.totalDocuments)+" ")]),a("div",{staticClass:"section-content",class:{closed:e.closedSection}},[e.documentData.id?a("div",[a("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[a("span",{staticClass:"section-title"},[e._v(e._s(e.documentData.name[e.shortDefaultLang]))]),a("div",[a("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section upwards"},on:{click:function(t){return e.moveDocument("up")}}},[e._v("keyboard_double_arrow_up")]),a("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section downwards"},on:{click:function(t){return e.moveDocument("down")}}},[e._v("keyboard_double_arrow_down")]),e.canBeRemoved?a("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer hover-opacity",on:{click:e.deleteDocument}},[e._v("delete")]):e._e()])]),a("p",[e._v(" "+e._s(e.documentData.description[e.shortDefaultLang])+" ")]),a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_TYPES"))+" : "+e._s(e.documentData.allowed_types))]),a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MAX_DOCUMENTS"))+" : "+e._s(e.documentData.nbmax))])]):a("div",[a("span",{staticClass:"section-title"},[e._v(e._s(e.document.label))])])])])])},sl=[],il={name:"FormBuilderDocumentListElement",props:{document:{type:Object,required:!0},totalDocuments:{type:Number,default:1},documentIndex:{type:Number,default:1},profile_id:{type:Number,required:!0}},mixins:[Mn],data(){return{closedSection:!1,documentData:{},canBeRemoved:!1,reasonCantRemove:""}},created(){this.document.docid&&(this.getDocumentModel(this.document.docid),this.checkIfDocumentCanBeDeleted())},methods:{moveDocument(e){this.$emit("move-document",this.document,e)},getDocumentModel(e=null,t=!0){if(this.models=t?this.$store.getters["formBuilder/getDocumentModels"]:[],this.documentData={},this.models.length>0){const t=this.models.find(t=>t.id===e);t?this.documentData=t:Ls.getDocumentModels(e).then(e=>{e.status&&(this.documentData=e.data)})}else Ls.getDocumentModels(e).then(e=>{e.status&&(this.documentData=e.data)})},editDocument(e){"delete-section"!==e.target.id&&this.$emit("edit-document")},deleteDocument(e){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_DOCUMENT"),this.document.label,this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_DOCUMENT_CONFIRM"),this.translate("JNO"),()=>{Ls.removeDocumentFromProfile(this.document.id).then(e=>{this.$emit("delete-document",this.document.id),this.$destroy()})})},checkIfDocumentCanBeDeleted(){Ls.checkIfDocumentCanBeDeletedForProfile(this.document.docid,this.profile_id).then(e=>{e.status?e.data.can_be_deleted?(this.canBeRemoved=!0,this.reasonCantRemove=""):(this.canBeRemoved=!1,this.reasonCantRemove=e.data.reason):this.canBeRemoved=!1})}},watch:{document:{handler(e){this.getDocumentModel(e.docid,!1)},deep:!0}}},nl=il,ol=(a("a10b"),Object(b["a"])(nl,al,sl,!1,null,null,null)),ll=ol.exports,rl={name:"FormBuilderDocumentList",components:{FormBuilderDocumentListElement:ll,draggable:qa.a},props:{profile_id:{type:Number,required:!0},campaign_id:{type:Number,required:!0}},data(){return{documents:[],emptyDocuments:[{text:"COM_EMUNDUS_FORM_BUILDER_EMPTY_DOCUMENTS"}],closedSection:!1}},created(){this.getDocuments()},methods:{getDocuments(){Ls.getDocuments(this.profile_id).then(e=>{this.documents=e.data.data.filter(e=>e.id)})},moveDocument(e,t){let a=this.requiredDocuments.map((e,t)=>({id:e.id,order:t})),s=this.optionalDocuments.map((e,t)=>({id:e.id,order:t})),i=null,n=null,o=!0;1==e.mandatory?(i=a.findIndex(t=>t.id===e.id),n=a.length):(i=s.findIndex(t=>t.id===e.id),n=s.length),null!=i&&(1==e.mandatory?0==i&&"up"===t?o=!1:i==n-1&&"down"===t?(e.mandatory=!1,a=a.filter(t=>t.id!=e.id),s.unshift({id:e.id,order:0})):"up"===t?(a[i].id=a[i-1].id,a[i-1].id=e.id):(a[i].id=a[i+1].id,a[i+1].id=e.id):0==i&&"up"==t?(e.mandatory=!0,s=s.filter(t=>t.id!=e.id),a.push({id:e.id,order:a.length})):i==n-1&&"down"===t?o=!1:"up"===t?(s[i].id=s[i-1].id,s[i-1].id=e.id):(s[i].id=s[i+1].id,s[i+1].id=e.id),o&&(a.forEach((e,t)=>{e.order=t}),s.forEach((e,t)=>{e.order=t+a.length}),this.documents.forEach((e,t)=>{const i=a.find(t=>t.id==e.id),n=s.find(t=>t.id==e.id);i?(this.documents[t].mandatory=1,this.documents[t].ordering=i.order):n&&(this.documents[t].mandatory=0,this.documents[t].ordering=n.order)}),Ls.reorderDocuments(this.documents).then(t=>{Ke.setDocumentMandatory({mandatory:e.mandatory,pid:this.profile_id,did:e.attachment_id})})))},addDocument(e="1"){this.$emit("add-document",e)},editDocument(e){this.$emit("edit-document",e)},deleteDocument(){this.$emit("delete-document"),this.getDocuments()}},computed:{requiredDocuments(){const e=this.documents.filter(e=>1==e.mandatory);return e.sort((e,t)=>e.ordering-t.ordering)},optionalDocuments(){const e=this.documents.filter(e=>0==e.mandatory);return e.sort((e,t)=>e.ordering-t.ordering)}}},cl=rl,dl=(a("82f8"),Object(b["a"])(cl,el,tl,!1,null,null,null)),ml=dl.exports,ul=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-create-document"}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[a("p",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PROPERTIES")))]),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),a("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.activeTabs,(function(t){return a("li",{key:t.id,staticClass:"em-p-16 em-pointer em-font-weight-500",class:{"is-active":t.active,"is-no-active":!t.active,"em-w-50":"2"==e.activeTabs.length,"em-w-100":1==e.activeTabs.length},on:{click:function(a){return e.selectTab(t)}}},[e._v(" "+e._s(e.translate(t.label))+" ")])})),0),e.tabs[0].active?a("div",{staticClass:"em-p-16",attrs:{id:"general-properties"}},[a("div",{staticClass:"em-mb-16 em-flex-row em-flex-space-between"},[a("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_REQUIRED")))]),a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isMandatory,expression:"isMandatory"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isMandatory)?e._i(e.isMandatory,null)>-1:e.isMandatory},on:{click:e.toggleDocumentMandatory,change:function(t){var a=e.isMandatory,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.isMandatory=a.concat([n])):o>-1&&(e.isMandatory=a.slice(0,o).concat(a.slice(o+1)))}else e.isMandatory=i}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})])]),a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"em-font-weight-500",attrs:{for:"title"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_NAME")))]),e.models.length>0?a("incremental-select",{attrs:{options:e.documentList,defaultValue:e.incSelectDefaultValue,locked:"create"!=e.mode},on:{"update-value":e.updateDocumentSelectedValue}}):e._e()],1),a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_DESCRIPTION")))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.document.description[e.shortDefaultLang],expression:"document.description[shortDefaultLang]"}],attrs:{id:"",name:"",rows:"5"},domProps:{value:e.document.description[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.document.description,e.shortDefaultLang,t.target.value)}}},[e._v(e._s(e.document.description[e.shortDefaultLang]))])]),a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_TYPES")))]),e._l(e.fileTypes,(function(t,s){return a("div",{key:t.value,staticClass:"em-flex-row em-mb-4 em-flex-align-start"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.selectedTypes[t.value],expression:"document.selectedTypes[filetype.value]"}],staticStyle:{height:"auto"},attrs:{type:"checkbox",name:"filetypes",id:t.value},domProps:{value:t.value,checked:Array.isArray(e.document.selectedTypes[t.value])?e._i(e.document.selectedTypes[t.value],t.value)>-1:e.document.selectedTypes[t.value]},on:{change:[function(a){var s=e.document.selectedTypes[t.value],i=a.target,n=!!i.checked;if(Array.isArray(s)){var o=t.value,l=e._i(s,o);i.checked?l<0&&e.$set(e.document.selectedTypes,t.value,s.concat([o])):l>-1&&e.$set(e.document.selectedTypes,t.value,s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.document.selectedTypes,t.value,n)},e.checkFileType]}}),a("label",{staticClass:"em-font-weight-400 em-mb-0-important em-ml-8",attrs:{for:t.value}},[e._v(" "+e._s(e.translate(t.title))+" ("+e._s(t.value)+")")])])}))],2),a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"em-font-weight-500",attrs:{for:"nbmax"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_NBMAX")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.nbmax,expression:"document.nbmax"}],staticClass:"em-w-100",attrs:{type:"number",id:"nbmax"},domProps:{value:e.document.nbmax},on:{input:function(t){t.target.composing||e.$set(e.document,"nbmax",t.target.value)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.hasImg,expression:"hasImg"}],staticClass:"em-mb-16",attrs:{id:"resolution"}},[a("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_IMAGE_WIDTH")))]),a("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[a("div",{staticClass:"em-w-50 em-mr-4"},[a("label",{staticClass:"em-font-weight-400",attrs:{for:"minResolutionW"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MIN_RESOLUTION_PLACEHOLDER")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.minResolution.width,expression:"document.minResolution.width"}],staticClass:"em-w-100",attrs:{type:"number",id:"minResolutionW",max:e.document.maxResolution.width},domProps:{value:e.document.minResolution.width},on:{input:function(t){t.target.composing||e.$set(e.document.minResolution,"width",t.target.value)}}})]),a("div",{staticClass:"em-w-50 em-ml-4"},[a("label",{staticClass:"em-font-weight-400",attrs:{for:"maxResolutionW"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MAX_RESOLUTION_PLACEHOLDER")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.maxResolution.width,expression:"document.maxResolution.width"}],staticClass:"em-w-100",attrs:{type:"number",id:"maxResolutionW",min:e.document.minResolution.width},domProps:{value:e.document.maxResolution.width},on:{input:function(t){t.target.composing||e.$set(e.document.maxResolution,"width",t.target.value)}}})])]),a("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_IMAGE_HEIGHT")))]),a("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[a("div",{staticClass:"em-w-50 em-mr-4"},[a("label",{staticClass:"em-font-weight-400",attrs:{for:"minResolutionH"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MIN_RESOLUTION_PLACEHOLDER")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.minResolution.height,expression:"document.minResolution.height"}],staticClass:"em-w-100",attrs:{type:"number",id:"minResolutionH",max:e.document.maxResolution.height},domProps:{value:e.document.minResolution.height},on:{input:function(t){t.target.composing||e.$set(e.document.minResolution,"height",t.target.value)}}})]),a("div",{staticClass:"em-w-50 em-ml-4"},[a("label",{staticClass:"em-font-weight-400",attrs:{for:"maxResolutionH"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MAX_RESOLUTION_PLACEHOLDER")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.document.maxResolution.height,expression:"document.maxResolution.height"}],staticClass:"em-w-100",attrs:{type:"number",id:"maxResolutionH",min:e.document.minResolution.height},domProps:{value:e.document.maxResolution.height},on:{input:function(t){t.target.composing||e.$set(e.document.maxResolution,"height",t.target.value)}}})])])])]):e._e(),e.tabs[1].active?a("div",{staticClass:"em-p-16",attrs:{id:"advanced-properties"}}):e._e(),a("div",{staticClass:"em-p-16"},[a("button",{staticClass:"em-primary-button",on:{click:e.saveDocument}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_SAVE")))])])])},pl=[],_l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"incremental-selector"}},[a("div",{staticClass:"em-w-100 em-flex-row em-mb-16"},[e.isNewVal?a("div",{staticClass:"em-w-100",attrs:{id:"new-value"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newValue.label,expression:"newValue.label"}],staticClass:"em-w-100 em-mb-0-important",attrs:{type:"text"},domProps:{value:e.newValue.label},on:{focusin:function(t){e.showOptions=!0},focusout:e.emitValueChanges,input:function(t){t.target.composing||e.$set(e.newValue,"label",t.target.value)}}}),a("i",{staticClass:"em-main-500-color"},[e._v("("+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_NEW_VALUE"))+")")])]):e._e(),e.isNewVal?e._e():a("div",{staticClass:"em-w-100",attrs:{id:"existing-value"}},[a("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newExistingLabel,expression:"newExistingLabel"}],staticClass:"em-w-100 em-mb-0-important em-border-main-500 important",attrs:{type:"text"},domProps:{value:e.newExistingLabel},on:{focusout:e.emitValueChanges,input:function(t){t.target.composing||(e.newExistingLabel=t.target.value)}}}),e.locked?e._e():a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:e.unselectExistingValue,mouseenter:function(t){e.hoverUnselect=!0},mouseleave:function(t){e.hoverUnselect=!1}}},[e._v("close")])]),a("i",{staticClass:"em-main-500-color"},[e._v("("+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EXISTING_VALUE"))+")")])])]),e.existingValues&&e.showOptions?a("ul",{staticClass:"em-custom-selector em-border-neutral-300 em-w-100",on:{mouseenter:function(t){e.hoverOptions=!0},mouseleave:function(t){e.hoverOptions=!1}}},e._l(e.displayedOptions,(function(t){return a("li",{key:t.id,staticClass:"em-custom-selector-option em-pointer  em-p-8",attrs:{value:t.id,selected:e.selectedExistingValue==t.id},on:{click:function(a){return e.onSelectValue(t.id)}}},[e._v(" "+e._s(t.label)+" ")])})),0):e._e()])},hl=[],gl={props:{options:{type:Array,required:!0},defaultValue:{type:Number,required:!1},locked:{type:Boolean,default:!1}},data(){return{originalOptions:[],newValue:{id:0,label:""},existingValues:[],newExistingLabel:"",selectedExistingValue:-1,isNewVal:!0,showOptions:!1,hoverOptions:!1,hoverUnselect:!1}},beforeMount(){this.originalOptions=JSON.parse(JSON.stringify(this.options)),this.existingValues=this.options},mounted(){null!=this.defaultValue&&this.onSelectValue(this.defaultValue)},methods:{updateDefaultValue(){this.onSelectValue(this.defaultValue)},onSelectValue(e){if(this.selectedExistingValue=e,-1===this.selectedExistingValue)this.unselectExistingValue();else{this.isNewVal=!1;let e=this.existingValues.find(e=>e.id===this.selectedExistingValue);e?(e=JSON.parse(JSON.stringify(e)),this.newExistingLabel=e.label,this.newValue=e,this.emitValueChanges()):console.error("No value matched the selected one. It should be impossible.")}this.showOptions=!1},unselectExistingValue(){this.isNewVal=!0,this.newExistingLabel=this.existingValues.find(e=>e.id==this.selectedExistingValue).label,this.selectedExistingValue=-1,this.newValue.label="",this.newValue.id=0,this.existingValues=JSON.parse(JSON.stringify(this.originalOptions)),this.showOptions=!1,this.hoverOptions=!1,this.hoverUnselect=!1,this.emitValueChanges()},emitValueChanges(e=null){if(!this.hoverUnselect)if(this.showOptions&&!this.hoverOptions&&(this.showOptions=!1),this.isNewVal)this.$emit("update-value",this.newValue);else{const e=this.existingValues.find(e=>e.id===this.selectedExistingValue);e.label!==this.newExistingLabel&&(e.label=this.newExistingLabel),this.$emit("update-value",e)}}},computed:{displayedOptions(){return this.isNewVal?this.existingValues.filter(e=>-1===e.id||e.label.toLowerCase().includes(this.newValue.label.toLowerCase())):this.existingValues}},watch:{defaultValue:{handler(e){this.updateDefaultValue()}}}},fl=gl,vl=(a("f4cb"),Object(b["a"])(fl,_l,hl,!1,null,null,null)),bl=vl.exports,El={name:"FormBuilderCreateDocument",props:{profile_id:{type:Number,required:!0},current_document:{type:Object,default:null},mandatory:{type:Boolean,default:!0},mode:{type:String,default:"create"}},components:{IncrementalSelect:bl,editor:Kt},mixins:[A,Mn],data(){return{models:[],modelsUsage:[],document:{id:null,type:{},mandatory:"1",nbmax:1,description:{fr:"",en:""},name:{fr:"",en:""},selectedTypes:{},minResolution:{width:0,height:0},maxResolution:{width:0,height:0},max_pages_pdf:0},fileTypes:[],activeTab:"general",tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!0},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_ADVANCED",active:!1}],hasPDF:!1,hasImg:!1}},created(){this.document.mandatory=null==this.current_document||null===this.current_document.mandatory||"undefined"==typeof this.current_document.mandatory?this.mandatory:this.current_document.mandatory,this.getDocumentModels(),this.getFileTypes()},methods:{selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},getDocumentModels(){Ls.getDocumentModels().then(e=>{e.status&&(this.models=e.data,null!=this.current_document&&(this.current_document.docid||this.current_document.id)&&this.selectModel({target:{value:this.current_document.docid?this.current_document.docid:this.current_document.id}},null!==this.current_document.mandatory&&"undefined"!=this.current_document.mandatory?this.current_document.mandatory:null),Ls.getDocumentModelsUsage(this.models.map(e=>e.id)).then(e=>{e.status&&(this.modelsUsage=e.data)}))})},toggleDocumentMandatory(){this.document.mandatory="1"==this.document.mandatory?"0":"1"},getFileTypes(){this.fileTypes=a("9ac1"),this.fileTypes.forEach(e=>{this.document.selectedTypes[e.value]=!1})},checkFileType(e){this.document.selectedTypes[e.target.value]=e.target.checked,this.hasImgFormat(),this.hasPDFFormat()},selectModel(e,t=null){if("none"!==e.target.value){const a=this.models.find(t=>t.id==e.target.value);this.document.id=a.id,this.document.type=a.type,this.document.mandatory=null==t?a.mandatory:t,this.document.nbmax=a.nbmax,this.document.description=a.description,this.document.name=a.name,this.document.minResolution={width:a.min_width,height:a.min_height},this.document.maxResolution={width:a.max_width,height:a.max_height},this.document.max_pages_pdf=a.max_pages_pdf,this.fileTypes.forEach(e=>{this.document.selectedTypes[e.value]=!1});let s=a.allowed_types.split(";");s.forEach(e=>{["pdf"].includes(e)&&(this.document.selectedTypes["pdf"]=!0),["jpeg","jpg","png","gif"].includes(e)&&(this.document.selectedTypes["jpeg;jpg;png;gif"]=!0),["doc","docx","odt","ppt","pptx"].includes(e)&&(this.document.selectedTypes["doc;docx;odt;ppt;pptx"]=!0),["xls","xlsx","odf"].includes(e)&&(this.document.selectedTypes["xls;xlsx;odf"]=!0),["mp3"].includes(e)&&(this.document.selectedTypes["mp3"]=!0),["mp4"].includes(e)&&(this.document.selectedTypes["mp4"]=!0)}),this.hasImgFormat(),this.hasPDFFormat()}},saveDocument(){let e=!0;if(Object.values(this.document.name).forEach(t=>{""!=t&&(e=!1)}),!0===e)return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PLEASE_FILL_TYPE"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),!1;const t=this.models.find(e=>e.id==this.document.id);let a=[];if(Object.entries(this.document.selectedTypes).forEach((e,t)=>{e[1]&&a.push(e[0])}),a.length<1)return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PLEASE_FILL_FORMAT"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),!1;if(t){const e={profile_id:this.profile_id,document_id:this.document.id,types:JSON.stringify(a),document:JSON.stringify(this.document)};Object.keys(this.modelsUsage).includes(this.document.id)&&this.modelsUsage[this.document.id].usage>1?this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_MULTIPLE_FORMS_IMPACTED"),this.translate("COM_EMUNDUS_FORM_BUILDER_MULTIPLE_FORMS_IMPACTED_TEXT")+" : "+this.modelsUsage[this.document.id].profiles.map(e=>e.label).join(", "),this.translate("COM_EMUNDUS_ONBOARD_OK"),this.translate("COM_EMUNDUS_ONBOARD_CANCEL")).then(t=>{t&&ze.updateDocument(e).then(e=>{this.$emit("documents-updated")})}):ze.updateDocument(e).then(e=>{this.$emit("documents-updated")})}else{this.document.id=null;const e={pid:this.profile_id,types:JSON.stringify(a),document:JSON.stringify(this.document)};Ke.updateDocument(e,!0).then(e=>{this.$emit("documents-updated")})}},updateDocumentSelectedValue(e){e.id?(this.document.name[this.shortDefaultLang]=e.label,this.selectModel({target:{value:e.id}},this.current_document&&this.current_document.id&&this.current_document.id==e.id?this.current_document.mandatory:null)):(this.document.id=null,this.document.name[this.shortDefaultLang]=e.label)},hasImgFormat(){let e=!1;const t=["jpeg","jpg","png","gif"];Object.keys(this.document.selectedTypes).forEach(a=>{this.document.selectedTypes[a]&&t.some(e=>a.includes(e))&&(e=!0)}),this.hasImg=e},hasPDFFormat(){let e=!1;Object.keys(this.document.selectedTypes).forEach(t=>{this.document.selectedTypes[t]&&t.includes("pdf")&&(e=!0)}),this.hasPDF=e}},computed:{activeTabs(){return this.tabs.filter(e=>e.active)},documentList(){return this.models.map(e=>({id:e.id,label:e.name[this.shortDefaultLang]}))},isMandatory(){return"1"==this.document.mandatory},incSelectDefaultValue(){let e=null;return this.current_document&&(this.current_document.docid||this.current_document.id)&&(e=this.current_document.docid?this.current_document.docid:this.current_document.id),e}},watch:{current_document(e){e&&(e.docid||e.id)&&(this.models.length<1?this.getDocumentModels().then(()=>{this.selectModel({target:{value:e.docid?e.docid:e.id}},e.mandatory?e.mandatory:null)}):this.selectModel({target:{value:e.docid?e.docid:e.id}},e.mandatory?e.mandatory:null))},deep:!0}},Ol=El,Cl=Object(b["a"])(Ol,ul,pl,!1,null,null,null),yl=Cl.exports,Dl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"form-builder-document-formats"}},[a("p",{staticClass:"em-text-align-center em-w-100 em-p-16",attrs:{id:"form-builder-document-title"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_FORMATS"))+" ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-mt-16 em-w-100",attrs:{id:"search",type:"text",placeholder:""},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),a("draggable",{staticClass:"draggables-list",attrs:{group:{name:"form-builder-documents",pull:"clone",put:!1},sort:!1,clone:e.setCloneFormat},on:{start:function(t){return e.$emit("dragging-element")},end:e.onDragEnd},model:{value:e.formats,callback:function(t){e.formats=t},expression:"formats"}},[a("transition-group",e._l(e.displayedFormats,(function(t){return a("div",{key:t.id,staticClass:"em-flex-row em-flex-space-between draggable-element em-mt-8 em-mb-8 em-p-16"},[a("span",{staticClass:"em-w-100 em-p-16",attrs:{id:"format-name",title:t.name[e.shortDefaultLang]}},[e._v(e._s(t.name[e.shortDefaultLang]))]),a("span",{staticClass:"material-icons-outlined"},[e._v(" drag_indicator ")])])})),0)],1)],1)},Ml=[],Nl={components:{draggable:qa.a},props:{profile_id:{type:Number,required:!0}},mixins:[Mn],data(){return{formats:[],cloneFormat:null,search:""}},created(){this.getFormats()},methods:{getFormats(){Ls.getDocumentModels().then(e=>{e.status&&(this.formats=e.data)})},setCloneFormat(e){this.cloneFormat=e},onDragEnd(e){const t=e.to;null!==t&&(this.cloneFormat.mandatory="required-documents"==t.id?"1":"0",this.$emit("open-create-document",this.cloneFormat))}},computed:{displayedFormats(){return this.formats.filter(e=>e.name[this.shortDefaultLang].toLowerCase().includes(this.search.toLowerCase()))}}},Al=Nl,Sl=(a("6e07"),Object(b["a"])(Al,Dl,Ml,!1,null,null,null)),wl=Sl.exports,Ul=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-flex-column em-flex-space-between em-w-100",attrs:{id:"form-builder-create-model"}},[a("div",{staticClass:"em-w-100"},[a("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[a("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_PROPERTIES")))]),a("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),a("div",{staticClass:"em-flex-column em-flex-start em-p-16 em-text-align-left",attrs:{id:"model-properties"}},[a("p",{staticClass:"em-main-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_PROPERTIES_INTRO")))]),a("label",{staticClass:"em-mt-16 em-text-align-left em-w-100",attrs:{for:"page-model-title"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_INPUT_LABEL")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.modelTitle,expression:"modelTitle"}],staticClass:"em-w-100 em-mb-16",attrs:{id:"page-model-title",type:"text"},domProps:{value:e.modelTitle},on:{input:function(t){t.target.composing||(e.modelTitle=t.target.value)}}}),e.alreadyExists?a("p",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_WITH_SAME_TITLE_EXISTS")))]):e._e()])]),a("div",{staticClass:"em-flex-row em-flex-space-between actions em-w-100"},[a("button",{staticClass:"em-primary-button em-m-16",class:{"em-gray-bg":e.modelTitle.length<1,"em-color-white":e.modelTitle.length<1},attrs:{disabled:e.modelTitle.length<1},on:{click:function(t){return e.addFormModel()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES_SAVE"))+" ")])])])},Tl=[],Rl={props:{page:{type:Number,required:!0}},data(){return{modelTitle:"",models:[],alreadyExists:!1}},mounted(){this.getModels()},methods:{getModels(){ze.getModels().then(e=>{e.status&&(this.models=e.data)})},checkTitleNotAlreadyExists(){const e=this.models.filter(e=>e.label[this.shortDefaultLang]===this.modelTitle.trim());this.alreadyExists=e.length>0},addFormModel(){if(this.modelTitle=this.modelTitle.trim(),this.modelTitle.length<1)return void j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_MUST_HAVE_TITLE"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}});const e=this.models.filter(e=>e.label[this.shortDefaultLang]===this.modelTitle);this.alreadyExists=e.length>0,this.alreadyExists?this.replaceFormModel(e[0].id,this.modelTitle):ze.addFormModel(this.page,this.modelTitle).then(e=>{e.status||j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_FAILURE"),text:e.msg,reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.$emit("close")})},replaceFormModel(e,t){ze.addFormModel(this.page,t).then(t=>{if(t.status){const t=[e];ze.deleteFormModelFromId(t).then(()=>{this.$emit("close")})}else j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_FAILURE"),text:t.msg,reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.$emit("close")})}},watch:{modelTitle:function(e,t){e!=t&&this.checkTitleNotAlreadyExists()}}},xl=Rl,Ll=(a("49f6"),Object(b["a"])(xl,Ul,Tl,!1,null,null,null)),Bl=Ll.exports,Il={name:"FormBuilder",components:{FormBuilderCreateModel:Bl,FormBuilderSectionProperties:to,FormBuilderCreatePage:jo,FormBuilderElements:wn,FormBuilderElementProperties:Gn,FormBuilderPage:Bo,FormBuilderPages:qo,FormBuilderDocuments:Zo,FormBuilderDocumentList:ml,FormBuilderCreateDocument:yl,FormBuilderDocumentFormats:wl},data(){return{profile_id:0,campaign_id:0,title:"",pages:[],principalContainer:"default",showInSection:"page",selectedPage:0,selectedSection:null,selectedElement:null,optionsSelectedElement:!1,selectedDocument:null,showInRightPanel:"hierarchy",createDocumentMandatory:!0,lastSave:null,leftPanel:{tabs:[{title:"Elements",icon:"edit_note",active:!0,displayed:!0},{title:"Documents",icon:"edit_note",active:!1,displayed:!1},{title:"Translations",icon:"translate",active:!1,displayed:!0,url:"/parametres-globaux"}]}}},created(){0===parseInt(this.$store.state.global.manyLanguages)&&(this.leftPanel.tabs[2].displayed=!1),this.profile_id=this.$store.state.global.datas.prid.value,this.campaign_id=this.$store.state.global.datas.cid.value,this.getFormTitle(),this.getPages()},mounted(){this.$modal.show("formBuilder")},methods:{getFormTitle(){Ls.getProfileLabelByProfileId(this.profile_id).then(e=>{!1!==e.status&&(this.title=e.data.data.label)})},updateFormTitle(){this.title=this.$refs.formTitle.innerText.trim().replace(/[\r\n]/gm," "),this.$refs.formTitle.innerText=this.$refs.formTitle.innerText.trim().replace(/[\r\n]/gm," "),Ls.updateFormLabel({label:this.title,prid:this.profile_id})},updateFormTitleKeyup(){document.activeElement.blur()},getPages(e=0){Ls.getFormsByProfileId(this.profile_id).then(t=>{this.pages=t.data.data,0===e?this.selectPage(this.pages[0].id):this.selectPage(String(e)),this.principalContainer="default",Ls.getSubmissionPage(this.profile_id).then(e=>{const t=e.data.link.match(/formid=(\d+)/)[1];if(t){const e=this.pages.find(e=>e.id===t);e||this.pages.push({id:t,label:this.translate("COM_EMUNDUS_FORM_BUILDER_SUBMISSION_PAGE"),type:"submission",elements:[]})}})})},onElementCreated(e){this.$refs.formBuilderPage.getSections(e)},onDocumentCreated(){this.$refs.formBuilderDocuments.getDocuments(),this.$refs.formBuilderDocumentList.getDocuments()},onOpenSectionProperties(e){this.selectedSection=e,this.showInRightPanel="section-properties"},onOpenElementProperties(e){this.selectedElement=e,"dropdown"===this.selectedElement.plugin?this.optionsSelectedElement=!0:(!0===this.optionsSelectedElement&&this.$refs.formBuilderPage.getSections(),this.optionsSelectedElement=!1),this.showInRightPanel="element-properties"},onUpdateDocument(){this.$refs.formBuilderDocumentList.getDocuments(),this.showInRightPanel="hierarchy"},onCloseElementProperties(){this.selectedElement=null,this.showInRightPanel="hierarchy",this.$refs.formBuilderPage.getSections()},onCloseSectionProperties(){this.selectedSection=null,this.showInRightPanel="hierarchy",this.$refs.formBuilderPage.getSections()},onCloseCreatePage(e){e.reload?this.getPages(e.newSelected):this.principalContainer="default"},onOpenCreateModel(e){e>0&&(this.selectedPage=e,this.showInRightPanel="create-model")},onOpenCreateDocument(e="1"){this.selectedDocument=null,this.$refs.formBuilderCreateDocument?(this.$refs.formBuilderCreateDocument.document.mandatory=e,this.$refs.formBuilderCreateDocument.mode="create"):(this.createDocumentMandatory=e,this.createDocumentMode="create"),this.showInRightPanel="create-document",this.setSectionShown("documents")},onEditDocument(e){this.$refs.formBuilderCreateDocument&&(this.$refs.formBuilderCreateDocument.mode="update"),this.selectedDocument=e,this.showInRightPanel="create-document",this.createDocumentMode="update",this.setSectionShown("documents")},onDeleteDocument(){this.selectedDocument=null,this.showInRightPanel="hierarchy",this.setSectionShown("documents")},selectTab(e){this.leftPanel.tabs.forEach(t=>{t.active=t.title===e})},selectPage(e){this.selectedPage=e,this.setSectionShown("page")},setSectionShown(e){"documents"===e?(this.leftPanel.tabs.forEach((e,t)=>{this.leftPanel.tabs[t].displayed="Elements"!==e.title}),this.selectTab("Documents"),this.selectedPage=null):(this.leftPanel.tabs.forEach((e,t)=>{this.leftPanel.tabs[t].displayed="Documents"!==e.title}),this.selectTab("Elements")),this.showInSection=e},goTo(e,t=!1){const a=window.location.origin;t?window.open(a+e,"_blank"):window.location.href=a+e}},computed:{currentPage(){return this.pages.find(e=>e.id===this.selectedPage)},leftPanelActiveTab(){return this.leftPanel.tabs.find(e=>e.active).title},displayedLeftPanels(){return this.leftPanel.tabs.filter(e=>e.displayed)}},watch:{"$store.state.formBuilder.lastSave":{handler(e){this.lastSave=e},deep:!0}}},kl=Il,Pl=(a("0d61"),Object(b["a"])(kl,On,Cn,!1,null,null,null)),Fl=Pl.exports,$l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid",attrs:{id:"evaluation-builder"}},[a("notifications",{attrs:{group:"foo-velocity","animation-type":"velocity",speed:500,position:"bottom left",classes:"vue-notification-custom"}}),a("div",{staticClass:"row"},[a("div",{staticClass:"sidebar-formbuilder",style:e.actions_menu?"width: 250px":""},[a("transition",{attrs:{name:"move-right"}},[a("div",{staticClass:"actions-menu menu-block"},[a("a",{staticClass:"d-flex back-button-action pointer",staticStyle:{padding:"0 15px"},attrs:{title:e.translations.Back}},[e._v(" "+e._s(e.translations.BuildYourForm)+" ")]),a("hr",{staticStyle:{width:"80%",margin:"10px auto"}}),a("div",[a("div",{staticClass:"action-links"},[a("a",{staticClass:"d-flex action-link",staticStyle:{"padding-top":"2em"},attrs:{title:e.translations.addMenu},on:{click:function(t){return e.$modal.show("modalMenu")}}},[a("em",{staticClass:"add-page-icon"}),a("label",{directives:[{name:"show",rawName:"v-show",value:e.actions_menu,expression:"actions_menu"}],staticClass:"action-label col-md-offset-1 col-sm-offset-1"},[e._v(e._s(e.translations.addMenu))])]),a("a",{staticClass:"d-flex action-link",attrs:{title:e.translations.addGroup},on:{click:function(t){return e.createGroup()}}},[a("em",{staticClass:"add-group-icon"}),a("label",{directives:[{name:"show",rawName:"v-show",value:e.actions_menu,expression:"actions_menu"}],staticClass:"action-label col-md-offset-1 col-sm-offset-1"},[e._v(e._s(e.translations.addGroup))])]),a("a",{staticClass:"d-flex action-link",class:{"disable-element":e.elementDisabled},attrs:{title:e.translations.addItem},on:{click:e.showElements}},[a("em",{staticClass:"add-element-icon"}),a("label",{directives:[{name:"show",rawName:"v-show",value:e.actions_menu,expression:"actions_menu"}],staticClass:"action-label col-md-offset-1 col-sm-offset-1",class:[{"disable-element":e.elementDisabled},e.addingElement?"down-arrow":"right-arrow"]},[e._v(e._s(e.translations.addItem))])]),a("transition",{attrs:{name:"slide-right",type:"transition"}},[e.addingElement?a("div",{staticClass:"plugins-list"},[a("a",{staticClass:"d-flex col-md-offset-1 back-button-action pointer",staticStyle:{padding:"0 15px"},attrs:{title:e.translations.Back},on:{click:function(t){e.addingElement=!e.addingElement}}},[a("em",{staticClass:"fas fa-arrow-left mr-1"}),e._v(" "+e._s(e.translations.Back)+" ")]),a("hr",{staticStyle:{width:"80%",margin:"10px auto"}}),a("draggable",e._b({staticStyle:{"padding-bottom":"2em","margin-top":"10%"},attrs:{handle:".handle","drag-class":"plugin-drag","chosen-class":"plugin-chosen","ghost-class":"plugin-ghost"},on:{start:function(t){e.startDragging(),e.dragging=!0,e.draggingIndex=e.index},end:function(t){return e.addingNewElement(t)}},model:{value:e.plugins,callback:function(t){e.plugins=t},expression:"plugins"}},"draggable",e.dragOptions,!1),e._l(e.plugins,(function(t,s){return a("div",{staticClass:"d-flex plugin-link col-md-offset-1 col-sm-offset-1 handle",attrs:{id:"plugin_"+t.value,title:t.name},on:{dblclick:function(a){return e.addingNewElementByDblClick(t.value)}}},[a("em",{class:t.icon}),a("span",{staticClass:"ml-10px"},[e._v(e._s(t.name))])])})),0)],1):e._e()])],1)])])])],1),a("div",{staticClass:"menu-block",class:e.actions_menu?"col-md-8 col-md-offset-4 col-sm-9 col-sm-offset-3":""},[a("div",{staticClass:"heading-block",class:e.addingElement||e.actions_menu?"col-md-offset-2 col-md-9":"col-md-12"},[e._m(0),a("div",{staticClass:"d-flex"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer bouton-sauvergarder-et-continuer-green mt-1",staticStyle:{"margin-left":"10px"},attrs:{title:e.translations.Validate},on:{click:e.sendForm}},[e._v(e._s(e.translations.Validate))]),a("button",{staticClass:"bouton-sauvergarder-et-continuer mt-1",staticStyle:{"margin-left":"10px"},attrs:{title:e.translations.ExitFormbuilder},on:{click:e.sendForm}},[e._v(e._s(e.translations.ExitFormbuilder))])])]),a("div",{staticClass:"form-viewer-builder",class:[e.addingElement||e.actions_menu?"col-sm-offset-5 col-md-offset-4 col-lg-offset-1 col-sm-7":"col-md-10",e.optionsModal?"col-sm-5 col-md-6":"col-md-10"]},[e.formObjectArray[e.indexHighlight]?a("Builder",{key:e.builderKey,ref:"builder",attrs:{object:e.formObjectArray[e.indexHighlight],UpdateUx:e.UpdateUx,rgt:e.rgt,prid:e.prid,eval:1,files:e.files,actualLanguage:e.actualLanguage,manyLanguages:e.manyLanguages},on:{show:e.show,UpdateFormBuilder:e.updateFormObjectAndComponent,removeGroup:e.removeGroup,modalClosed:function(t){e.optionsModal=!1},modalOpen:function(t){e.optionsModal=!0}}}):e._e()],1)])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},jl=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h2",{staticClass:"form-title",staticStyle:{padding:"0",margin:"0"}},[a("img",{staticClass:"em-mr-4",attrs:{src:"/images/emundus/menus/form.png",alt:"Formulaire"}}),e._v("Evaluation")])}],Gl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-16 applicant-form",attrs:{id:"FormBuilder"}},[a("div",[e.object_json?a("BuilderViewer",{key:e.builderViewKey,ref:"builder_viewer",attrs:{object:e.object,groups:e.GroupList,change:this.change,changedElement:this.changedElement,changedGroup:this.changedGroup,UpdateUx:e.UpdateUx,files:e.files,prid:e.prid,eval:e.eval,actualLanguage:e.actualLanguage,manyLanguages:e.manyLanguages},on:{show:e.show,modalClosed:function(t){return e.$emit("modalClosed")},modalOpen:function(t){return e.$emit("modalOpen")},createGroup:function(t){return e.$emit("createGroup")},UpdateUxf:e.UpdateUXF}}):e._e()],1)])},Hl=[],zl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"BuilderViewer",attrs:{id:"BuilderViewer"}},[a("link",{attrs:{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css"}}),e.object_json.show_page_heading?a("div",{class:e.object_json.show_page_heading.class,domProps:{innerHTML:e._s(e.object_json.show_page_heading.page_heading)}}):e._e(),0!=e.eval||e.updatePage?e._e():a("div",{staticClass:"em-flex-row em-flex-space-between page-header"},[e.object_json.show_title?a("span",{staticClass:"em-mr-8 em-h3",domProps:{innerHTML:e._s(e.object_json.show_title.value)},on:{click:function(t){return e.enableUpdatingPage(e.object_json)}}}):e._e(),a("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translations.Edit},on:{click:function(t){e.$emit("modalOpen"),e.$modal.show("modalSide"+e.object.rgt)}}},[e._v("edit")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.updatePage&&e.indexPage==e.object_json.id,expression:"updatePage && indexPage == object_json.id"}],staticClass:"em-flex-row page-header"},[e.object_json.show_title?a("input",{directives:[{name:"model",rawName:"v-model",value:e.object_json.show_title.label[e.actualLanguage],expression:"object_json.show_title.label[actualLanguage]"}],staticStyle:{"margin-bottom":"0"},attrs:{id:"update_input_"+e.object_json.id},domProps:{value:e.object_json.show_title.label[e.actualLanguage]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLabelPage(e.object_json)},input:function(t){t.target.composing||e.$set(e.object_json.show_title.label,e.actualLanguage,t.target.value)}}}):e._e(),a("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translations.Validate},on:{click:function(t){return e.updateLabelPage(e.object_json)}}},[e._v("done")])]),0!=e.eval||e.updateIntroPage?e._e():a("p",{staticClass:"em-mt-16",domProps:{innerHTML:e._s(e.object_json.intro_value)}}),a("button",{staticClass:"em-primary-button em-w-auto em-m-center",on:{click:function(t){return e.$emit("createGroup")}}},[e._v(e._s(e.translate("COM_EMUNDUS_ADD_SECTION")))]),a("form",{staticClass:"fabrikForm",style:1==e.eval?"margin-top: 30px":"",attrs:{method:"post","object_json.attribs":"",id:"form_"+e.object_json.id},on:{submit:function(e){e.preventDefault()}}},[e.object_json.plugintop?a("div",{domProps:{innerHTML:e._s(e.object_json.plugintop)}}):e._e(),a("draggable",{staticClass:"groups-block",attrs:{handle:".handle"},on:{start:e.startGroupDrag,end:e.SomethingChangeInGroup},model:{value:e.groups,callback:function(t){e.groups=t},expression:"groups"}},e._l(e.orderedGroups,(function(t,s){return a("div",{key:"group_"+t.group_id,staticClass:"group-item-block",on:{mouseover:function(a){return e.enableGroupHover(t.group_id)},mouseleave:function(t){return e.disableGroupHover()}}},[a("fieldset",{staticClass:"fabrikGroup",class:[t.group_class],staticStyle:{"background-size":"20px",width:"100%"},style:-1==t.hidden_group?"background: #e3e3e3;":"",attrs:{id:"group_"+t.group_id}},[-1==t.hidden_group?a("div",{staticClass:"hidden-notice em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("warning_amber")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translations.HiddenGroup))])]):e._e(),a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100",class:e.updateGroup&&e.indexGroup==t.group_id?"hidden":""},[a("div",{staticClass:"em-flex-row em-flex-space-between em-w-100"},[a("div",{staticClass:"em-flex-row"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.hoverGroup&&e.indexGroup==t.group_id,expression:"hoverGroup && indexGroup == group.group_id"}],staticClass:"material-icons-outlined handle em-handle-group"},[e._v("drag_indicator")]),a("legend",{staticClass:"legend",on:{click:function(a){return e.enableUpdatingGroup(t)}}},[a("span",{staticClass:"em-ml-32",class:{"em-opacity-low":!t.group_showLegend}},[e._v(" "+e._s(t.group_showLegend?t.group_showLegend:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_TITLE"))+" ")])])]),a("div",{staticClass:"em-flex-row"},[a("span",{staticClass:"em-ml-8 em-pointer",class:t.repeat_group?"active-repeat":"",attrs:{title:e.translations.RepeatedGroup},on:{click:function(a){return e.enableRepatedGroup(t)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("table_rows")])]),a("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[a("span",{staticClass:"tooltip-target material-icons-outlined"},[e._v("more_vert")]),a("template",{slot:"popover"},[a("div",{staticClass:"container-2 w-container",staticStyle:{"max-width":"unset"}},[a("transition",{attrs:{name:"slide-down",type:"transition"}},[a("div",[a("nav",{staticClass:"em-flex-column em-align-start pointer",attrs:{"aria-label":"action"}},[a("a",{staticClass:"em-p-8-0 em-neutral-700-color",on:{click:function(a){return e.enableUpdatingGroup(t)}}},[e._v(" "+e._s(e.translations.EditName)+" ")]),a("a",{staticClass:"em-p-8-0 em-neutral-700-color",on:{click:function(a){return e.displayHideGroup(t)}}},[e._v(" "+e._s(e.translations.DisplayHide)+" ")]),0!=e.files||t.cannot_delete?e._e():a("a",{staticClass:"action-submenu",attrs:{title:e.translations.Delete},on:{click:function(a){return e.deleteAGroup(t,s)}}},[e._v(" "+e._s(e.translations.Delete)+" ")])])])])],1)])],2)],1)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.updateGroup&&e.indexGroup==t.group_id,expression:"updateGroup && indexGroup == group.group_id"}],staticClass:"em-flex-row em-flex-space-between"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.label[e.actualLanguage],expression:"group.label[actualLanguage]"}],class:e.translate.label_group?"":"mb-1",attrs:{id:"update_input_"+t.group_id},domProps:{value:t.label[e.actualLanguage]},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.updateLabelGroup(t)},input:function(a){a.target.composing||e.$set(t.label,e.actualLanguage,a.target.value)}}}),a("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translations.Validate},on:{click:function(a){return e.updateLabelGroup(t)}}},[e._v("done")])]),t.group_intro?a("div",{staticClass:"groupintro",domProps:{innerHTML:e._s(t.group_intro)}}):e._e(),void 0!==t.elts?[0==t.elts.length?a("div",{staticClass:"em-no-elements-in-group"},[e._v(e._s(e.translations.NoElementsTips))]):e._e()]:e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.openGroup[t.group_id],expression:"openGroup[group.group_id]"}],staticClass:"em-mt-16"},[a("draggable",{attrs:{handle:".handle",group:"items"},on:{start:function(t){e.draggable=!0},end:e.SomethingChange},model:{value:t.elts,callback:function(a){e.$set(t,"elts",a)},expression:"group.elts"}},[a("transition-group",{staticClass:"em-list-elements",attrs:{name:"slide-down",type:"transition"}},e._l(t.elts,(function(s,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:!1===s.hidden,expression:"element.hidden === false"}],key:s.id,staticClass:"row-fluid",on:{mouseover:function(t){return e.enableActionBar(s.id)},mouseleave:function(t){return e.disableActionBar()}}},[a("modalEditElement",{key:e.keyElements["element"+s.id],attrs:{elementId:s.id,gid:s.group_id,files:e.files,manyLanguages:e.manyLanguages,actualLanguage:e.actualLanguage,profileId:e.prid},on:{reloadElement:function(t){return e.reloadElement(s)},publishUnpublishEvent:function(t){return e.publishUnpublishEvent(s)},updateRequireEvent:function(t){return e.updateRequireEvent(s)},modalClosed:function(t){return e.$emit("modalClosed")},show:e.show}}),a("modalDuplicateElement",{key:e.keyElements["element"+s.id],attrs:{ID:s.id,currentGroup:t.group_id,currentPage:e.object_json.id,id:s.id,prid:e.prid},on:{reloadElement:function(t){return e.reloadElement(s)},modalClosed:function(t){return e.$emit("modalClosed")}}}),a("div",{staticClass:"control-group fabrikElementContainer span12"},[a("div",{staticClass:"em-w-90 em-pointer em-p-8-12 em-transparent-border-2",class:{"element-updating":e.hoverUpdating&&e.indexHighlight==s.id,unpublished:!s.publish,"draggable-item":e.draggable&&e.indexHighlight==s.id,handle:!e.clickUpdatingLabel}},[a("div",{staticClass:"em-flex-row",class:e.clickUpdatingLabel&&e.indexHighlight==s.id?"hidden":""},[s.label_value?a("span",{directives:[{name:"show",rawName:"v-show",value:2!=s.labelsAbove,expression:"element.labelsAbove != 2"}],domProps:{innerHTML:e._s(s.label_value)},on:{click:function(t){return e.enableLabelInput(s.id)}}}):e._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.clickUpdatingLabel&&e.indexHighlight==s.id,expression:"clickUpdatingLabel && indexHighlight == element.id"}],staticClass:"em-flex-row em-flex-space-between"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.label[e.actualLanguage],expression:"element.label[actualLanguage]"}],attrs:{id:"label_"+s.id},domProps:{value:s.label[e.actualLanguage]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLabelElement(s)},input:function(t){t.target.composing||e.$set(s.label,e.actualLanguage,t.target.value)}}}),a("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translations.Validate},on:{click:function(t){return e.updateLabelElement(s)}}},[e._v("done")])]),0==s.labelsAbove?a("div",{staticClass:"controls"},[s.element?a("div",{class:s.errorClass,domProps:{innerHTML:e._s(s.element)}}):e._e(),s.tipSide?a("span",{domProps:{innerHTML:e._s(s.tipSide)}}):e._e()]):a("div",{staticClass:"fabrikElement",class:"plugin-"+s.plugin,domProps:{innerHTML:e._s(s.element)}}),s.tipSide?a("span",{domProps:{innerHTML:e._s(s.tipSide)}}):e._e(),s.tipBelow?a("span",{domProps:{innerHTML:e._s(s.tipBelow)}}):e._e()]),a("div",{staticClass:"em-w-90 em-mt-8 em-flex-row em-flex-space-between",style:e.hoverUpdating&&e.indexHighlight==s.id?"opacity: 1":"opacity: 0"},["display"!=s.plugin?a("a",{staticClass:"em-flex-row em-mr-8",style:e.hoverUpdating&&e.indexHighlight==s.id?"opacity: 1":"opacity: 0"},[a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.FRequire,expression:"element.FRequire"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.FRequire)?e._i(s.FRequire,null)>-1:s.FRequire},on:{click:function(t){return e.updateRequireElement(s)},change:function(t){var a=s.FRequire,i=t.target,n=!!i.checked;if(Array.isArray(a)){var o=null,l=e._i(a,o);i.checked?l<0&&e.$set(s,"FRequire",a.concat([o])):l>-1&&e.$set(s,"FRequire",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(s,"FRequire",n)}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})]),a("span",{staticClass:"em-ml-8",staticStyle:{color:"black"}},[e._v(e._s(e.translations.Required)+" ")])]):e._e(),a("div",{staticClass:"em-flex-row"},[a("div",{staticClass:"em-flex-row em-mr-8 em-pointer",attrs:{title:e.translations.Edit},on:{click:function(t){return e.openParameters(s)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("edit")])]),a("div",{staticClass:"em-flex-row em-mr-8 em-pointer",attrs:{title:e.translations.Delete},on:{click:function(t){return e.deleteElement(s,i)}}},[a("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("delete")])]),e.sysaccess?a("a",{staticClass:"em-flex-row em-mr-8 em-pointer",attrs:{target:"_blank",href:"/administrator/index.php?option=com_fabrik&view=element&layout=edit&id="+s.id}},[a("span",{staticClass:"material-icons-outlined"},[e._v("link")])]):e._e()])])])],1)})),0)],1)],1),t.group_outro?a("div",{staticClass:"groupoutro",domProps:{innerHTML:e._s(e.group_outro)}}):e._e()],2)])})),0),e.object_json.pluginbottom?a("div",{domProps:{innerHTML:e._s(e.object_json.pluginbottom)}}):e._e()],1),a("button",{staticClass:"em-primary-button em-w-auto em-m-center",on:{click:function(t){return e.$emit("createGroup")}}},[e._v(e._s(e.translate("COM_EMUNDUS_ADD_SECTION")))])])},Vl=[],Yl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalDuplicateElement"}},[a("modal",{attrs:{name:"modalDuplicateElement"+e.ID,height:"auto",transition:"little-move-left","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!0},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"fixed-header-modal"},[a("div",{staticClass:"topright"},[a("button",{staticClass:"btnCloseModal",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalDuplicateElement"+e.ID)}}},[a("em",{staticClass:"fas fa-times"})])]),a("div",{staticClass:"update-field-header"},[a("h2",{staticClass:"update-title-header"},[e._v(" "+e._s(e.translations.DuplicateElement)+" ")]),a("p",[e._v(e._s(e.translations.Target))])])]),a("div",{staticClass:"modalC-content"},[a("div",{staticClass:"form-group mb-2"},[a("label",[e._v(e._s(e.translations.Page)+"* :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.page,expression:"page"}],staticClass:"dropdown-toggle",class:{"is-invalid":e.errors.page},attrs:{id:"select_page"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.page=t.target.multiple?a:a[0]}}},e._l(e.pages,(function(t,s){return a("option",{key:s,domProps:{value:t.id}},[e._v(" "+e._s(t.label)+" ")])})),0)]),e.errors.page?a("p",{staticClass:"error col-md-12 mb-2"},[a("span",{staticClass:"error"},[e._v(e._s(e.translations.PageRequired))])]):e._e(),a("transition",{attrs:{name:"slide-down",type:"transition"}},[-1!==e.page&&e.groups.length>1?a("div",{staticClass:"form-group mb-2"},[a("label",[e._v(e._s(e.Group)+"* :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.group,expression:"group"}],staticClass:"dropdown-toggle",class:{"is-invalid":e.errors.group},attrs:{id:"select_group"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.group=t.target.multiple?a:a[0]}}},e._l(e.groups,(function(t,s){return a("option",{key:s,domProps:{value:t.id}},[e._v(" "+e._s(t.label)+" ")])})),0)]):e._e()]),e.errors.group?a("p",{staticClass:"error col-md-12 mb-2"},[a("span",{staticClass:"error"},[e._v(e._s(e.translations.GroupRequired))])]):e._e()],1),a("div",{staticClass:"em-flex-row em-flex-space-between mb-1"},[a("button",{staticClass:"bouton-sauvergarder-et-continuer w-retour",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalDuplicateElement"+e.ID)}}},[e._v(" "+e._s(e.translations.Retour)+" ")]),a("button",{staticClass:"bouton-sauvergarder-et-continuer",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.duplicate()}}},[e._v(e._s(e.translations.Continuer))])])])],1)},ql=[];const Jl=a("bef5");var Wl={name:"modalDuplicateElement",props:{ID:Number,prid:String,currentGroup:Number,currentPage:Number},data(){return{page:-1,group:-1,pages:[],groups:[],errors:{page:!1,group:!1},translations:{DuplicateElement:"COM_EMUNDUS_ONBOARD_DUPLICATE_ELEMENT",Page:"COM_EMUNDUS_ONBOARD_BUILDMENU",Group:"COM_EMUNDUS_ONBOARD_GROUP",Retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Continuer:"COM_EMUNDUS_ONBOARD_SAVE",PageRequired:"COM_EMUNDUS_ONBOARD_REQUIRED_FORM",GroupRequired:"COM_EMUNDUS_ONBOARD_REQUIRED_GROUP",Target:"COM_EMUNDUS_ONBOARD_CHOOSE_TARGET"}}},methods:{beforeClose(e){!0===this.changes&&this.$emit("show","foo-velocity","warn",this.dataSaved,this.informations),this.$emit("modalClosed"),this.changes=!1},beforeOpen(e){this.page=-1,this.group=-1,this.errors={page:!1,group:!1},this.getFormPages()},duplicate(){return this.errors={page:!1,group:!1},-1==this.page?(this.errors.page=!0,0):-1==this.group?(this.errors.group=!0,0):void p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=duplicateelement",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jl.stringify({id:this.ID,group:this.group,old_group:this.currentGroup,form_id:this.page})}).then(e=>{window.location.reload()})},getFormPages(){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getFormsByProfileId",params:{profile_id:this.prid},paramsSerializer:e=>Jl.stringify(e)}).then(e=>{this.pages=e.data.data,this.page=this.currentPage})},getGroupsByForm(){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getgroupsbyform",params:{form_id:this.page},paramsSerializer:e=>Jl.stringify(e)}).then(e=>{this.groups=e.data.data,this.groups.length<=1&&(this.group=this.groups[0].id)})}},watch:{page:function(){this.getGroupsByForm()}}},Kl=Wl,Xl=Object(b["a"])(Kl,Yl,ql,!1,null,"63efefe4",null),Ql=Xl.exports;const Zl=a("bef5");var er={name:"BuilderViewer",props:{object:Object,groups:Array,change:Boolean,changedElement:Array,changedGroup:String,UpdateUx:Boolean,files:Number,eval:Number,prid:String,actualLanguage:String,manyLanguages:String,pid:Number},components:{Editor:Kt,datePicker:Os.a,draggable:qa.a,modalEditElement:Qi,modalDuplicateElement:Ql,Translation:ra},data(){return{object_json:"",sysaccess:!1,updatePage:!1,updateIntroPage:!1,indexPage:-1,openGroup:{},hoverGroup:!1,indexGroup:-1,updateGroup:!1,hoverUpdating:!1,indexHighlight:0,clickUpdatingLabel:!1,draggable:!1,fieldChanges:!1,repeat:!1,keyElements:{},date:new Date,options:{format:"DD/MM/YYYY",useCurrent:!1},can_translate:{label:!1,label_group:!1,label_page:!1,intro_page:!1},elementAssociateDocUpdateForm:{name:{fr:"",en:""},description:{fr:"",en:""},nbmax:1,selectedTypes:{pdf:!1,"jpg;png;gif":!1,"doc;docx;odt":!1,"xls;xlsx;odf":!1}},translations:{update:"COM_EMUNDUS_ONBOARD_BUILDER_UPDATE",updating:"COM_EMUNDUS_ONBOARD_BUILDER_UPDATING",updateSuccess:"COM_EMUNDUS_ONBOARD_BUILDER_UPDATESUCESS",orderSuccess:"COM_EMUNDUS_ONBOARD_BUILDER_ORDERSUCESS",orderFailed:"COM_EMUNDUS_ONBOARD_BUILDER_ORDERFAILED",updateFailed:"COM_EMUNDUS_ONBOARD_BUILDER_UPDATEFAILED",sidemenuhelp:"COM_EMUNDUS_ONBOARD_SIDEMENUHELP",TranslateEnglish:"COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH",Unpublish:"COM_EMUNDUS_ONBOARD_ACTION_UNPUBLISH",Publish:"COM_EMUNDUS_ONBOARD_ACTION_PUBLISH",Required:"COM_EMUNDUS_ONBOARD_ACTIONS_REQUIRED",Settings:"COM_EMUNDUS_ONBOARD_ACTIONS_SETTINGS",Delete:"COM_EMUNDUS_ONBOARD_ACTION_DELETE",Edit:"COM_EMUNDUS_ONBOARD_MODIFY",Cancel:"COM_EMUNDUS_ONBOARD_CANCEL",Validate:"COM_EMUNDUS_ONBOARD_OK",RepeatGroup:"COM_EMUNDUS_ONBOARD_REPEAT_GROUP",RepeatedGroup:"COM_EMUNDUS_ONBOARD_REPEATED_GROUP",Duplicate:"COM_EMUNDUS_ONBOARD_DUPLICATE",NoElementsTips:"COM_EMUNDUS_ONBOARD_NO_ELEMENTS_TIPS",EditName:"COM_EMUNDUS_ONBOARD_BUILDER_EDIT_NAME",EditIntro:"COM_EMUNDUS_ONBOARD_BUILDER_EDIT_INTRO",DisplayHide:"COM_EMUNDUS_ONBOARD_BUILDER_DISPLAY_HIDE",HiddenGroup:"COM_EMUNDUS_ONBOARD_BUILDER_HIDDEN_GROUP"}}},methods:{splitProfileIdFromLabel(e){return e.split(/-(.+)/)[1]},async updateElementsOrder(e,t,a){var s=t.map((e,t)=>({id:e.id,order:t+1}));p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updateOrder",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({elements:s,group_id:e,moved_el:a})}).then(t=>{this.$emit("show","foo-velocity","success",this.translations.orderSuccess,this.translations.update);let s=this.object.link.replace("fabrik","emundus");p.a.get(s+"&format=vue_jsonclean").then(e=>{this.groups.forEach(t=>{this.$set(this.object_json.Groups["group_"+t.group_id],"elements",e.data.Groups["group_"+t.group_id].elements)})}),a.group_id=e}).catch(e=>{})},updateRequireElement(e){this.clickUpdatingLabel&&this.updateLabelElement(e),setTimeout(()=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=changerequire",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({element:e})}).then(()=>{this.updateRequireEvent(e)}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},300)},updateRequireEvent(e){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:e.id,gid:e.group_id},paramsSerializer:e=>Zl.stringify(e)}).then(t=>{e.label_value=t.data.label_value,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update)})},publishUnpublishEvent(e){e.publish=!e.publish,e.publish?(document.getElementById("publish_icon_"+e.id).classList.remove("fa-eye"),document.getElementById("publish_icon_"+e.id).classList.add("fa-eye-slash")):(document.getElementById("publish_icon_"+e.id).classList.add("fa-eye"),document.getElementById("publish_icon_"+e.id).classList.remove("fa-eye-slash"))},deleteAssociateElementDoc(e){p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=deletedocumentdropfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({did:e})}).then(e=>{}),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=removeDocumentFromProfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({did:e})}).then(e=>{}),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=removeDocument",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({did:e,prid:this.prid,cid:this.cid})}).then(e=>{})},deleteElement(e,t){this.clickUpdatingLabel&&this.updateLabelElement(e),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEELEMENT"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(a=>{a.value&&("emundus_fileupload"==e.plugin&&this.deleteAssociateElementDoc(e.params.attachmentId),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=deleteElement",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({element:e.id})}).then(()=>{j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_ELEMENTDELETED"),type:"success",showConfirmButton:!1,timer:2e3}).then(()=>{this.object_json.Groups["group_"+e.group_id].elts.splice(t,1),delete this.object_json.Groups["group_"+e.group_id].elements["element"+e.id],this.$forceUpdate()})}).catch(e=>{}))})},openDuplicate(e){this.clickUpdatingLabel&&this.updateLabelElement(e),this.$emit("modalOpen"),this.$modal.show("modalDuplicateElement"+e.id)},openParameters(e){this.repeat=!1,this.$modal.show("modalEditElement"+e.id),console.log("here")},retrieveAssociateElementDoc(e){p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=retriveElementFormAssociatedDoc",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:2,docid:e})}).then(e=>{this.elementAssociateDocUpdateForm.description[this.actualLanguage]=e.data.description,e.data.allowed_types.includes("pdf")?this.elementAssociateDocUpdateForm.selectedTypes.pdf=!0:this.elementAssociateDocUpdateForm.selectedTypes.pdf=!1,e.data.allowed_types.includes("jpg")||e.data.allowed_types.includes("png")||e.data.allowed_types.includes("gif")?this.elementAssociateDocUpdateForm.selectedTypes["jpg;png;gif"]=!0:this.elementAssociateDocUpdateForm.selectedTypes["jpg;png;gif"]=!1,e.data.allowed_types.includes("xls")||e.data.allowed_types.includes("xlsx")||e.data.allowed_types.includes("odf")?this.elementAssociateDocUpdateForm.selectedTypes["xls;xlsx;odf"]=!0:this.elementAssociateDocUpdateForm.selectedTypes["xls;xlsx;odf"]=!1,this.elementAssociateDocUpdateForm.nbmax=e.data.nbmax})},updateAssociateDocElement(e){p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updatedocument",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify(e)}).then(t=>{p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updateDocumentFalang",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify(e)}).then(e=>{})})},updateLabelElement(e){"emundus_fileupload"==e.plugin&&this.retrieveAssociateElementDoc(e.params.attachmentId);let t=e.label;"Unnamed item"===t.en&&(t.en=t.fr,e.label.en=t.fr),"emundus_fileupload"==e.plugin&&(this.elementAssociateDocUpdateForm.name.en=t.en,this.elementAssociateDocUpdateForm.name.fr=t.fr),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=formsTrad",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({element:e.id,labelTofind:e.label_tag,NewSubLabel:t})}).then(a=>{if(0==a.data.status)p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updateelementlabelwithouttranslation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({eid:e.id,label:e.label[this.actualLanguage]})}).then(()=>{p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:e.id,gid:e.group_id},paramsSerializer:e=>Zl.stringify(e)}).then(t=>{e.label_value=t.data.label_value,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update)})});else{if("emundus_fileupload"==e.plugin){let a=[];Object.keys(this.elementAssociateDocUpdateForm.selectedTypes).forEach(e=>{1==this.elementAssociateDocUpdateForm.selectedTypes[e]&&a.push(e)});let s={document:this.elementAssociateDocUpdateForm,types:a,cid:this.cid,pid:this.prid,did:e.params.attachmentId,text_fr:t.fr,text_en:t.en};this.updateAssociateDocElement(s)}p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:e.id,gid:e.group_id},paramsSerializer:e=>Zl.stringify(e)}).then(t=>{this.$set(e,"element",t.data.element),e.label_value=t.data.label_value,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),this.can_translate.label=!1})}this.clickUpdatingLabel=!1}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},reloadElement(e){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:e.id,gid:e.group_id},paramsSerializer:e=>Zl.stringify(e)}).then(t=>{"databasejoin"===t.data.plugin&&!1===this.repeat?(this.repeat=!0,this.reloadElement(e)):(this.$set(e,"element",t.data.element),e=t.data,this.$set(this.keyElements,"element"+e.id,this.keyElements["element"+e.id]+1))}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},updateLabelGroup(e){let t=e.label;p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=formsTrad",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({group:e.group_id,labelTofind:e.group_tag,NewSubLabel:t})}).then(t=>{0==t.data.status&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updategrouplabelwithouttranslation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:e.group_id,label:e.label[this.actualLanguage]})}),this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),e.group_showLegend=e.label[this.actualLanguage],this.can_translate.label_group=!1,this.updateGroup=!1}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},deleteAGroup(e,t){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGROUP"),text:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGROUPWARNING"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(a=>{a.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=deleteGroup",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:e.group_id})}).then(()=>{j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_GROUPDELETED"),type:"success",showConfirmButton:!1,timer:2e3}).then(()=>{this.groups.splice(t,1),delete this.object_json.Groups["group_"+e.group_id],this.updateGroup=!1,this.$forceUpdate()})}).catch(e=>{})})},updateGroupsOrder(){var e=this.groups.map((e,t)=>(e.ordering=t+2,{id:e.group_id,order:t+2}));p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=reordergroups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({groups:e,fid:this.object_json.id})}).then(e=>{this.$emit("show","foo-velocity","success",this.translations.orderSuccess,this.translations.update)}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.orderFailed,this.translations.updating)})},enableRepatedGroup(e){e.repeat_group?j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_REPEAT_GROUP_DISABLE"),text:this.translate("COM_EMUNDUS_ONBOARD_REPEAT_GROUP_MESSAGE_DISABLE"),type:"info",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&p()({method:"POST",url:"index.php?option=com_emundus&controller=formbuilder&task=disablegrouprepeat",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:e.group_id})}).then(t=>{1==t.data.status&&(e.repeat_group=0,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),e.group_showLegend=e.label[this.actualLanguage],this.can_translate.label_group=!1,this.updateGroup=!1)})}):j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_REPEAT_GROUP"),text:this.translate("COM_EMUNDUS_ONBOARD_REPEAT_GROUP_MESSAGE"),type:"info",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&p()({method:"POST",url:"index.php?option=com_emundus&controller=formbuilder&task=enablegrouprepeat",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:e.group_id})}).then(t=>{1==t.data.status&&(e.repeat_group=1,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),e.group_showLegend=e.label[this.actualLanguage],this.can_translate.label_group=!1,this.updateGroup=!1)})})},displayHideGroup(e){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DISPLAY_HIDE"),text:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DISPLAY_HIDE_MESSAGE"),type:"info",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&p()({method:"POST",url:"index.php?option=com_emundus&controller=formbuilder&task=displayhidegroup",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({gid:e.group_id})}).then(t=>{e.hidden_group=t.data.status,this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update)})})},updateLabelPage(e){let t=e.show_title.label;p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=formsTrad",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({page:e.id,labelTofind:e.show_title.titleraw,NewSubLabel:t})}).then(a=>{0==a.data.status&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updatepagelabelwithouttranslation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({pid:e.id,label:e.show_title.label[this.actualLanguage]})}),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updatemenulabel",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({pid:e.id,label:t})}).then(()=>{this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),e.show_title.value=e.show_title.label[this.actualLanguage],e.label=e.show_title.label[this.actualLanguage],this.updatePage=!1})}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},updateIntroValuePage(e){let t={fr:e.intro.fr,en:e.intro.en};p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=formsTrad",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({labelTofind:e.intro_raw,NewSubLabel:t})}).then(t=>{0==t.data.status&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updatepageintrowithouttranslation",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Zl.stringify({pid:e.id,intro:e.intro.fr})}),this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update),e.intro_value=e.intro[this.actualLanguage],this.updateIntroPage=!1}).catch(e=>{this.$emit("show","foo-velocity","error",this.translations.updateFailed,this.translations.updating)})},getDataObject:Yt.a.debounce((function(){this.object_json=this.object.object,this.getElementsArray()}),500),getApiData:Yt.a.debounce((function(){this.$emit("show","foo-velocity","",this.translations.updating,this.translations.update);let e=this.object.link.replace("fabrik","emundus");p.a.get(e+"&format=vue_jsonclean").then(e=>{this.object_json=e.data,this.$emit("UpdateUxf"),this.$emit("show","foo-velocity","success",this.translations.updateSuccess,this.translations.update)})}),1e3),getElementsArray(){Object.keys(this.object_json.Groups).forEach(e=>{this.object_json.Groups[e].elts=[],this.openGroup[this.object_json.Groups[e].group_id]=!0,Object.keys(this.object_json.Groups[e].elements).forEach(t=>{this.object_json.Groups[e].elts.push(this.object_json.Groups[e].elements[t]),this.keyElements[t]=0})})},enableActionBar(e){this.clickUpdatingLabel||this.updateGroup||this.updateIntroPage||this.updatePage||(this.hoverUpdating=!0,this.indexHighlight=e)},disableActionBar(){this.clickUpdatingLabel||this.updateGroup||this.updateIntroPage||this.updatePage||(this.hoverUpdating=!1,this.clickUpdatingLabel=!1,this.indexHighlight=0,this.can_translate.label=!1)},enableLabelInput(e){this.updateGroup||this.updateIntroPage||this.updatePage||(this.clickUpdatingLabel=!0,setTimeout(()=>{document.getElementById("label_"+e).focus()},100))},enableTranslationLabel(e){this.can_translate.label=!this.can_translate.label,this.can_translate.label||setTimeout(()=>{document.getElementById("label_"+e).focus()},100)},enableUpdatingPage(e){this.clickUpdatingLabel||this.updateGroup||this.updateIntroPage||(this.updatePage=!0,this.indexPage=e.id,setTimeout(()=>{document.getElementById("update_input_"+e.id).focus()},100))},enableUpdatingPageIntro(e){this.clickUpdatingLabel||this.updateGroup||this.updatePage||(this.updateIntroPage=!0,this.indexPage=e.id,setTimeout(()=>{document.getElementById("update_intro_"+e.id).focus()},100))},enableTranslationPage(e){this.can_translate.label_page=!this.can_translate.label_page,this.can_translate.label_page||setTimeout(()=>{document.getElementById("update_input_"+e).focus()},100)},enableTranslationPageIntro(e){this.can_translate.intro_page=!this.can_translate.intro_page,this.can_translate.intro_page||setTimeout(()=>{document.getElementById("update_intro_"+e).focus()},100)},enableUpdatingGroup(e){this.clickUpdatingLabel||this.updateIntroPage||this.updatePage||(this.updateGroup=!0,this.indexGroup=e.group_id,setTimeout(()=>{document.getElementById("update_input_"+e.group_id).focus()},100))},enableTranslationGroup(e){this.can_translate.label_group=!this.can_translate.label_group,this.can_translate.label_group||setTimeout(()=>{document.getElementById("update_input_"+e).focus()},100)},enableGroupHover(e){this.clickUpdatingLabel||this.updateGroup||this.updateIntroPage||this.updatePage||(this.hoverGroup=!0,this.indexGroup=e)},disableGroupHover(){this.clickUpdatingLabel||this.updateGroup||this.updateIntroPage||this.updatePage||(this.hoverGroup=!1,this.updateGroup=!1,this.indexGroup=-1)},handleGroup(e){this.updateGroup||(this.openGroup[e]?this.$set(this.openGroup,e,!1):this.$set(this.openGroup,e,!0))},startGroupDrag(){this.draggable=!0},SomethingChange:function(e){console.log(e);let t=e.item.childNodes[1].id;this.groups.forEach(e=>{e.elts.forEach(a=>{a.id==t&&this.updateElementsOrder(e.group_id,e.elts,a)})}),this.draggable=!1},SomethingChangeInGroup:function(){this.draggable=!1,this.updateGroupsOrder(),Object.keys(this.openGroup).forEach((e,t)=>{this.openGroup[e]=!0})},getAccess(){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getAccess"}).then(e=>{this.sysaccess=e.data.access})},show(e,t,a,s){this.$emit("show",e,t,a,s)}},created(){Yt.a.isEmpty(this.object.object)||(this.getDataObject(),this.getAccess())},watch:{object:function(){this.getDataObject()},UpdateUx:function(){!0===this.UpdateUx&&this.getApiData()}},computed:{orderedGroups:function(){return Yt.a.orderBy(this.groups,"ordering")}}},tr=er,ar=(a("84e7"),Object(b["a"])(tr,zl,Vl,!1,null,null,null)),sr=ar.exports;const ir=a("bef5");var nr={name:"Builder",props:{object:Object,UpdateUx:Boolean,rgt:Number,files:Number,prid:String,eval:Number,actualLanguage:String,manyLanguages:Number},components:{draggable:qa.a,BuilderViewer:sr},data(){return{newlabel:[],dblckickLabel:[],testastos:[],ElementList:[],GroupList:[],object_json:Object,GroupsObject:Object,change:!1,changedElement:"",changedGroup:"",update:!1,builderViewKey:0,addGroup:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_ADDGROUP"),addItem:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_ADDITEM"),editGroup:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_EDITGROUP"),deleteGroup:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGROUP"),deleteMenu:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEMENU")}},methods:{UpdateUXT(){this.UpdateUx=!0},UpdateUXF(){this.UpdateUx=!1},UpdateLabel(e,t){e.label_raw=t},UpdateGroupName(e,t){this.object_json.Groups[e].group_showLegend=t},UpdateBuilderView(){this.$emit("UpdateFormBuilder")},show(e,t,a,s){this.$emit("show",e,t,a,s)},Initialised:function(){for(var e in this.GroupsObject){let t=this.object.rgt+"_"+this.GroupsObject[e].group_id;this.ElementList[t]=Object.values(this.GroupsObject[e].elements)}},deleteAMenu(e){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEMENU"),text:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEMENUWARNING"),type:"warning",showCancelButton:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=deleteMenu",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ir.stringify({mid:e})}).then(()=>{this.$modal.hide("modalSide"+this.ID),j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_MENUDELETED"),type:"success",showConfirmButton:!1,timer:2e3}).then(()=>{this.$emit("UpdateFormBuilder")})}).catch(e=>{console.log(e)})})},async updateOrder(e,t){await this.$refs.builder_viewer.updateElementsOrder(e,t)},getDataObject:function(){this.object_json=this.object.object,this.GroupList=Object.values(this.object_json.Groups),this.GroupsObject=this.object_json.Groups,this.Initialised()}},created(){Yt.a.isEmpty(this.object.object)||this.getDataObject()},watch:{object:function(){this.getDataObject()},update:function(){!0===this.update&&this.getDataObject()},UpdateUx:function(){!0===this.UpdateUx&&this.UpdateUXT()}}},or=nr,lr=(a("2f77"),Object(b["a"])(or,Gl,Hl,!1,null,"1ee4c2b0",null)),rr=lr.exports,cr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalSide"}},[a("modal",{attrs:{name:"modalSide"+e.ID,height:"auto",transition:"little-move-left","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!0},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.translations.editMenu)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalSide"+e.ID)}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",[a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.translations.Name)+" :")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.label[e.actualLanguage],expression:"label[actualLanguage]"}],staticClass:"em-w-100",class:{"is-invalid":e.errors},staticStyle:{margin:"0"},attrs:{type:"text",maxlength:"40"},domProps:{value:e.label[e.actualLanguage]},on:{input:function(t){t.target.composing||e.$set(e.label,e.actualLanguage,t.target.value)}}})]),e.errors?a("p",{staticClass:"em-red-500-color"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.LabelRequired))])]):e._e(),a("div",{staticClass:"em-mb-16",class:{"mb-0":e.can_translate.intro}},[a("label",[e._v(e._s(e.translations.Intro))]),e.intro.hasOwnProperty(e.selectedLanguage)?a("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.intro[e.selectedLanguage],lang:e.actualLanguage,enable_variables:!1,id:"editor_"+e.selectedLanguage},model:{value:e.intro[e.selectedLanguage],callback:function(t){e.$set(e.intro,e.selectedLanguage,t)},expression:"intro[selectedLanguage]"}}):e._e()],1),a("div",{staticClass:"em-mb-16 em-flex-row",attrs:{id:"template_checkbox"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.template,expression:"template"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.template)?e._i(e.template,null)>-1:e.template},on:{change:function(t){var a=e.template,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.template=a.concat([n])):o>-1&&(e.template=a.slice(0,o).concat(a.slice(o+1)))}else e.template=i}}}),a("label",{staticClass:"em-ml-8"},[e._v(e._s(e.translations.SaveAsTemplate))])]),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("div",{staticClass:"em-flex-row"},[a("button",{staticClass:"em-secondary-button em-w-auto",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalSide"+e.ID)}}},[e._v(" "+e._s(e.translations.Retour)+" ")]),e.menus.length>1&&0==e.files?a("button",{staticClass:"em-tertiary-button em-w-auto",on:{click:function(t){return t.preventDefault(),e.deleteMenu()}}},[e._v(" "+e._s(e.translations.Delete)+" ")]):e._e()]),a("button",{staticClass:"em-primary-button em-w-auto",on:{click:function(t){t.preventDefault(),e.$modal.hide("modalSide"+e.ID),e.UpdateParams()}}},[e._v(" "+e._s(e.translations.Continuer)+" ")])])])])],1)},dr=[];const mr=a("bef5");var ur={name:"modalSide",components:{List:It,Editor:Kt,Translation:ra},props:{ID:String,element:Object,index:Number,menus:Array,files:Number,link:String,manyLanguages:String,actualLanguage:String,languages:Array},data(){return{tempEl:[],can_translate:{label:!1,intro:!1},label:{},intro:{},dynamicComponent:0,template:!1,errors:!1,changes:!1,selectedLanguage:this.actualLanguage,translations:{Retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Continuer:"COM_EMUNDUS_ONBOARD_ADD_CONTINUER",dataSaved:"COM_EMUNDUS_ONBOARD_BUILDER_DATASAVED",informations:"COM_EMUNDUS_ONBOARD_BUILDER_INFORMATIONS",orderingMenu:"COM_EMUNDUS_ONBOARD_BUILDER_MENUORDERING",editMenu:"COM_EMUNDUS_ONBOARD_BUILDER_EDITMENU",Name:"COM_EMUNDUS_ONBOARD_FIELD_NAME",Intro:"COM_EMUNDUS_ONBOARD_FIELD_INTRO",Delete:"COM_EMUNDUS_ONBOARD_ACTION_DELETE",TranslateEnglish:"COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH",LabelRequired:"COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME",SaveAsTemplate:"COM_EMUNDUS_ONBOARD_SAVE_AS_TEMPLATE",TranslateIn:"COM_EMUNDUS_ONBOARD_TRANSLATE_IN"}}},methods:{async UpdateParams(){this.changes=!0,await this.axioschange(this.intro,this.tempEl.intro_raw),await this.axioschange(this.label,this.tempEl.show_title.titleraw),await this.updatefalang(this.label),await this.saveAsTemplate(),this.element=JSON.parse(JSON.stringify(this.tempEl)),this.$emit("UpdateName",this.index,this.label[this.actualLanguage]),this.$emit("UpdateIntro",this.index,this.intro[this.actualLanguage])},beforeClose(e){!1!==this.changes&&(this.$emit("show","foo-velocity","success",this.dataSaved,this.informations),this.changes=!1),this.$emit("modalClosed")},beforeOpen(e){this.initialisation()},axioschange(e,t){return new Promise(a=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=formsTrad",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:mr.stringify({labelTofind:t,NewSubLabel:e})}).then(e=>{a(e.data.status)}).catch(e=>{console.log(e)})})},updatefalang(e){return new Promise(t=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updatemenulabel",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:mr.stringify({label:e,pid:this.element.id})}).then(e=>{t(e.data.status)})})},saveAsTemplate(){return new Promise(e=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=savemenuastemplate",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:mr.stringify({menu:this.element,template:this.template})}).then(t=>{e(t.data.scalar)})})},async axiostrad(e){return await p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getalltranslations",params:{toJTEXT:e},paramsSerializer:e=>mr.stringify(e)}).then(e=>e.data)},deleteMenu(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEMENU"),text:this.translate("COM_EMUNDUS_ONBOARD_CANT_REVERT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(e=>{e.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=deletemenu",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:mr.stringify({mid:this.element.id})}).then(e=>{this.$emit("removeMenu",this.element.id),this.$modal.hide("modalSide"+this.ID)})})},checkIfTemplate(){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getPagesModel"}).then(e=>{var t={};try{Object.values(e.data).forEach((e,a)=>{if(e.form_id==this.element.id)throw this.template=!0,t})}catch(a){if(a!==t)throw this.template=!1}})},initialisation(){this.tempEl=JSON.parse(JSON.stringify(this.element)),this.axiostrad(this.tempEl.intro_raw).then(e=>{this.intro=e}).catch((function(e){console.log(e)})),this.axiostrad(this.tempEl.show_title.titleraw).then(e=>{this.label=e}).catch((function(e){console.log(e)})),this.checkIfTemplate()}},watch:{element:function(){this.tempEl=JSON.parse(JSON.stringify(this.element))}},created:function(){}},pr=ur,_r=(a("ca8f"),Object(b["a"])(pr,cr,dr,!1,null,"02a517ac",null)),hr=_r.exports,gr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalMenu"}},[a("modal",{attrs:{name:"modalMenu",height:"auto",transition:"little-move-left","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!0},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.translations.addMenu)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalMenu")}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",[a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"em-w-100"},[e._v(e._s(e.translations.ChooseExistingPageModel)+" :")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.model_id,expression:"model_id"}],staticClass:"em-w-100",attrs:{disabled:Object.keys(e.models).length<=0},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.model_id=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"-1"}}),e._l(e.models,(function(t){return a("option",{key:t.form_id,domProps:{value:t.form_id}},[e._v(" "+e._s(t.label[e.actualLanguage]))])}))],2)]),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.translations.Name)+"* :")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.label[e.actualLanguage],expression:"label[actualLanguage]"}],staticClass:"em-w-100",class:{"is-invalid":e.errors},attrs:{type:"text",maxlength:"40",id:"menu_label"},domProps:{value:e.label[e.actualLanguage]},on:{input:function(t){t.target.composing||e.$set(e.label,e.actualLanguage,t.target.value)}}})]),e.errors&&-1==e.model_id?a("p",{staticClass:"em-red-500-color"},[a("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.LabelRequired))])]):e._e(),a("div",{staticClass:"em-mb-16"},[a("label",[e._v(e._s(e.translations.Intro))]),e._l(e.languages,(function(t,s){return t.sef===e.selectedLanguage?a("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.intro[t.sef],lang:e.actualLanguage,enable_variables:!1,id:"editor_"+t.sef},model:{value:e.intro[t.sef],callback:function(a){e.$set(e.intro,t.sef,a)},expression:"intro[language.sef]"}}):e._e()}))],2)]),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalMenu")}}},[e._v(" "+e._s(e.translations.Retour)+" ")]),a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createMenu()}}},[e._v(" "+e._s(e.translations.Add)+" ")])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])],1)},fr=[];const vr=a("bef5");var br={name:"modalMenu",components:{Editor:Kt,translation:ra},props:{profileId:String,actualLanguage:String,manyLanguages:String,languages:Array},data(){return{can_translate:{label:!1,intro:!1},label:{fr:"",en:""},intro:{fr:"",en:""},dynamicComponent:0,model_id:-1,template:!1,models:[],errors:!1,changes:!1,submitted:!1,selectedLanguage:this.actualLanguage,translations:{Name:"COM_EMUNDUS_ONBOARD_FIELD_NAME",Intro:"COM_EMUNDUS_ONBOARD_FIELD_INTRO",Retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Add:"COM_EMUNDUS_ONBOARD_ADD",dataSaved:"COM_EMUNDUS_ONBOARD_BUILDER_DATASAVED",informations:"COM_EMUNDUS_ONBOARD_BUILDER_INFORMATIONS",addMenu:"COM_EMUNDUS_ONBOARD_BUILDER_ADDMENU",LabelRequired:"COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME",ChooseExistingPageModel:"COM_EMUNDUS_ONBOARD_FORM_CHOOSE_EXISTING_MODEL_PAGE",TranslateEnglish:"COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH",SaveAsTemplate:"COM_EMUNDUS_ONBOARD_SAVE_AS_TEMPLATE"}}},methods:{beforeClose(e){!0===this.changes&&this.$emit("show","foo-velocity","warn",this.dataSaved,this.informations),this.label={fr:"",en:""},this.intro={fr:"",en:""},this.$emit("modalClosed"),this.changes=!1},beforeOpen(e){this.getExistingPages()},getExistingPages(){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getPagesModel"}).then(e=>{this.models=e.data})},createMenu(){this.changes=!0,""!=this.label[this.actualLanguage]||-1!=this.model_id?(this.submitted=!0,"fr"==this.actualLanguage&&""==this.label.en?this.label.en="My new page":"en"==this.actualLanguage&&""==this.label.fr?this.label.fr="Ma nouvelle page":(this.label.en=this.label.en,this.label.fr=this.label.fr),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=createMenu",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:vr.stringify({label:this.label,intro:this.intro,prid:this.profileId,modelid:this.model_id,template:this.template})}).then(e=>{this.submitted=!1,this.$modal.hide("modalMenu"),this.$emit("AddMenu",e.data)}).catch(e=>{console.log(e)})):this.errors=!0}},watch:{model_id:function(e){-1!=e?Object.values(this.models).forEach(e=>{if(e.form_id==this.model_id){this.label.fr=e.label.fr,this.label.en=e.label.en;var t=document.createElement("div"),a=document.createElement("div");t.innerHTML=e.intro.fr,a.innerHTML=e.intro.en,this.intro.fr=t.innerText,this.intro.en=a.innerText}}):(this.label.fr="",this.intro.fr="")}}},Er=br,Or=Object(b["a"])(Er,gr,fr,!1,null,"c3da366a",null),Cr=Or.exports,yr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalAffectCampaign"}},[a("modal",{attrs:{name:"modalAffectCampaign",height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.translations.affectCampaigns)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAffectCampaign")}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",[0===e.campaigns.length?a("p",{staticClass:"em-mb-16"},[e._v(e._s(e.translations.campaignsEmpty))]):e._e(),a("div",{staticClass:"em-mb-16"},e._l(e.campaigns,(function(t,s){return a("div",{key:s,staticClass:"user-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.affectedCampaigns[t.id],expression:"affectedCampaigns[campaign.id]"}],staticClass:"form-check-input bigbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.affectedCampaigns[t.id])?e._i(e.affectedCampaigns[t.id],null)>-1:e.affectedCampaigns[t.id]},on:{change:function(a){var s=e.affectedCampaigns[t.id],i=a.target,n=!!i.checked;if(Array.isArray(s)){var o=null,l=e._i(s,o);i.checked?l<0&&e.$set(e.affectedCampaigns,t.id,s.concat([o])):l>-1&&e.$set(e.affectedCampaigns,t.id,s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.affectedCampaigns,t.id,n)}}}),a("div",{staticClass:"ml-10px"},[a("p",[e._v(e._s(t.label))])])])})),0)]),a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-8"},[a("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return e.redirect("index.php?option=com_emundus&view=form")}}},[e._v(" "+e._s(e.translations.BackWithoutAssociation)+" ")]),a("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.affectToForm.apply(null,arguments)}}},[e._v(" "+e._s(e.translations.Continuer)+" ")])]),a("div",{staticClass:"em-float-right"},[e.testing?e._e():a("button",{staticClass:"em-tertiary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.goAddCampaign.apply(null,arguments)}}},[e._v(" "+e._s(e.translations.addCampaign)+" ")])])])],1)},Dr=[];const Mr=a("bef5");var Nr={name:"modalAffectCampaign",props:{prid:String,testing:Boolean},data(){return{campaigns:[],affectedCampaigns:[],searchTerm:"",translations:{Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),affectCampaigns:this.translate("COM_EMUNDUS_ONBOARD_FORM_AFFECTCAMPAIGNS"),campaignsEmpty:this.translate("COM_EMUNDUS_ONBOARD_FORM_CAMPAIGNSEMPTY"),addCampaign:this.translate("COM_EMUNDUS_ONBOARD_ADD_CAMPAIGN"),BackWithoutAssociation:this.translate("COM_EMUNDUS_ONBOARD_BACK_WITHOUT_ASSOCIATION")}}},methods:{beforeClose(e){},beforeOpen(e){this.getCampaigns()},affectToForm(){let e=[];this.affectedCampaigns.length>0?(this.campaigns.forEach(t=>{this.affectedCampaigns[t.id]&&e.push(t.id)}),p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=affectcampaignstoform",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Mr.stringify({prid:this.prid,campaigns:e})}).then(()=>{this.testing?e.length>0&&(this.$emit("testForm"),this.$modal.hide("modalAffectCampaign")):window.location.href="index.php?option=com_emundus&view=form"})):this.testing?this.$modal.hide("modalAffectCampaign"):window.location.href="index.php?option=com_emundus&view=form"},goAddCampaign(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=redirectjroute",params:{link:"index.php?option=com_emundus&view=campaigns&layout=add&cid="},paramsSerializer:e=>Mr.stringify(e)}).then(e=>{window.location.href=window.location.pathname+e.data.data})},getCampaigns(){p.a.get("index.php?option=com_emundus&controller=campaign&task=getcampaignstoaffect").then(e=>{this.campaigns=e.data.data})},searchCampaignByTerm(){p.a.get("index.php?option=com_emundus&controller=campaign&task=getcampaignstoaffectbyterm&term="+this.searchTerm).then(e=>{this.campaigns=e.data.data})},redirect(e){window.location.href=e}}},Ar=Nr,Sr=(a("ef92"),Object(b["a"])(Ar,yr,Dr,!1,null,"ce2b2d46",null)),wr=Sr.exports;const Ur=a("bef5");var Tr={name:"EvaluationBuilder",props:{prid:String,index:Number,cid:Number,eval:Number,actualLanguage:String,manyLanguages:Number},components:{List:It,ModalAffectCampaign:wr,Builder:rr,ModalSide:hr,ModalMenu:Cr,draggable:qa.a},data(){return{actions_menu:!0,optionsModal:!1,UpdateUx:!1,indexHighlight:0,animation:{enter:{opacity:[1,0],translateX:[0,-300],scale:[1,.2]},leave:{opacity:0,height:0}},loading:!1,first_loading:!1,formObjectArray:[],rgt:0,builderKey:0,files:0,link:"",dragging:!1,draggingIndex:-1,elementDisabled:!1,addingElement:!1,plugins:{field:{id:0,value:"field",icon:"fas fa-font",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_FIELD")},textarea:{id:5,value:"textarea",icon:"far fa-square",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_TEXTAREA")},checkbox:{id:2,value:"checkbox",icon:"far fa-check-square",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_CHECKBOX")},radiobutton:{id:4,value:"radiobutton",icon:"fas fa-list-ul",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_RADIOBUTTON")},dropdown:{id:3,value:"dropdown",icon:"fas fa-th-list",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DROPDOWN")},birthday:{id:1,value:"birthday",icon:"far fa-calendar-alt",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_BIRTHDAY")},display:{id:6,value:"display",icon:"fas fa-paragraph",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DISPLAY")}},translations:{addMenu:"COM_EMUNDUS_ONBOARD_BUILDER_ADDMENU",addGroup:"COM_EMUNDUS_ONBOARD_BUILDER_ADDGROUP",addItem:"COM_EMUNDUS_ONBOARD_BUILDER_ADDITEM",groupCreated:"COM_EMUNDUS_ONBOARD_BUILDER_CREATEDGROUPSUCCES",update:"COM_EMUNDUS_ONBOARD_BUILDER_UPDATE",Back:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Validate:"COM_EMUNDUS_ONBOARD_OK",ExitFormbuilder:"COM_EMUNDUS_ONBOARD_BUILDER_EXIT_FORMBUILDER",BuildYourForm:"COM_EMUNDUS_ONBOARD_BUILDER_BUILD_YOUR_FORM"}}},created(){this.$props.actualLanguage=this.$store.getters["global/shortLang"],this.$props.manyLanguages=this.$store.getters["global/manyLanguages"],this.$props.index=this.$store.getters["global/datas"].index.value,this.$props.prid=this.$store.getters["global/datas"].prid.value,this.$props.cid=this.$store.getters["global/datas"].cid.value,this.$props.eval=this.$store.getters["global/datas"].eval.value,this.link="index.php?option=com_fabrik&view=form&formid="+this.eval,this.getDataObject()},methods:{createElement(e,t,a){Yt.a.isEmpty(this.formObjectArray[this.indexHighlight].object.Groups)||(this.loading=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=createcriteria",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ur.stringify({gid:e,plugin:t})}).then(t=>{p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:t.data.scalar,gid:e},paramsSerializer:e=>Ur.stringify(e)}).then(t=>{this.$set(this.formObjectArray[this.indexHighlight].object.Groups["group_"+e],"elements[element"+t.data.id+"]",t.data),this.formObjectArray[this.indexHighlight].object.Groups["group_"+e].elts.splice(a,0,t.data),this.$refs.builder.updateOrder(e,this.formObjectArray[this.indexHighlight].object.Groups["group_"+e].elts),this.$refs.builder.$refs.builder_viewer.keyElements["element"+t.data.id]=0,this.$refs.builder.$refs.builder_viewer.enableActionBar(t.data.id),this.$refs.builder.$refs.builder_viewer.enableLabelInput(t.data.id),this.loading=!1})}))},addingNewElement:function(e){this.dragging=!1,this.draggingIndex=-1,"undefined"!=typeof document.getElementsByClassName("no-elements-tip")[0]&&(document.getElementsByClassName("no-elements-tip")[0].style.background="#e4e4e9",document.getElementsByClassName("no-elements-tip")[0].style.border="2px dashed #c3c3ce",document.getElementsByClassName("no-elements-tip")[0].innerHTML=this.translate("COM_EMUNDUS_ONBOARD_NO_ELEMENTS_TIPS"));let t=e.clone.id.split("_")[1],a=e.to.parentElement.parentElement.parentElement.id.split("_")[1];"undefined"!=typeof a&&this.createElement(a,t,e.newIndex)},addingNewElementByDblClick:Yt.a.debounce((function(e){let t=Object.keys(this.formObjectArray[this.indexHighlight].object.Groups)[Object.keys(this.formObjectArray[this.indexHighlight].object.Groups).length-1].split("_")[1],a=this.formObjectArray[this.indexHighlight].object.Groups["group_"+t].elts.length;"undefined"!=typeof t&&this.createElement(t,e,a)}),250,{maxWait:1e3}),createGroup(){this.loading=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=createsimplegroup",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ur.stringify({fid:this.formObjectArray[this.indexHighlight].object.id})}).then(e=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=getJTEXT",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ur.stringify({toJTEXT:e.data.group_tag})}).then(t=>{e.data.group_showLegend=t.data,p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=affectgrouptoprogram",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ur.stringify({group:e.data.group_id,pid:this.cid})}).then(e=>{this.show("foo-velocity","success",this.translations.groupCreated,this.translations.update)}),this.loading=!1,this.pushGroup(e.data)})})},UpdateName(e,t){this.formObjectArray[e].object.show_title.value=t},UpdateUXT(){this.UpdateUx=!0},pushGroup(e){this.formObjectArray[this.indexHighlight]["object"]["Groups"]["group_"+e.group_id]={elements:{},elts:[],group_id:e.group_id,group_showLegend:e.group_showLegend,label:{fr:e.label.fr,en:e.label.en},group_tag:e.group_tag,ordering:e.ordering},this.elementDisabled=!1,this.$refs.builder.getDataObject(),this.$refs.builder.$refs.builder_viewer.openGroup[e.group_id]=!0,setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},200)},removeGroup(e,t){this.formObjectArray.forEach((a,s)=>{a.object.id==t&&delete this.formObjectArray[s]["object"]["Groups"]["group_"+e]}),this.builderKey+=1},updateFormObjectAndComponent(){this.formObjectArray=[],this.getDataObject(),this.builderKey+=1},getElement(e,t){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:e,gid:t},paramsSerializer:e=>Ur.stringify(e)}).then(e=>{this.formObjectArray[this.indexHighlight].object.Groups["group_"+t].elements["element"+e.data.id]=e.data,this.formObjectArray[this.indexHighlight].object.Groups["group_"+t].elts.push(e.data),this.builderKey+=1})},tip(){this.showTip("foo-velocity",this.translate("COM_EMUNDUS_ONBOARD_UPDATEFORMTIP")+"<br/>"+this.translate("COM_EMUNDUS_ONBOARD_UPDATEFORMTIP1")+"<br/>"+this.translate("COM_EMUNDUS_ONBOARD_UPDATEFORMTIP2"),this.translate("COM_EMUNDUS_ONBOARD_TIP"))},show(e,t="",a="",s="Information"){this.$notify({group:e,title:""+s,text:a,type:t})},showTip(e,t="",a="Information"){this.$notify({group:e,title:""+a,text:t,duration:2e4})},clean(e){this.$notify({group:e,clean:!0})},async getDataObject(){let e=this.link.replace("fabrik","emundus");await p.a.get(e+"&format=vue_jsonclean").then(e=>{this.formObjectArray.push({object:e.data,link:this.link}),this.loading=!1,this.indexHighlight=0,this.elementDisabled=Yt.a.isEmpty(this.formObjectArray[this.indexHighlight].object.Groups)})},sendForm(){this.redirectJRoute("index.php?option=com_emundus&view=form")},redirectJRoute(e){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=redirectjroute",params:{link:e},paramsSerializer:e=>Ur.stringify(e)}).then(e=>{window.location.href=window.location.pathname+e.data.data})},showElements(){this.elementDisabled?this.addingElement=!1:this.addingElement=!this.addingElement},startDragging(){"undefined"!=typeof document.getElementsByClassName("no-elements-tip")[0]&&(document.getElementsByClassName("no-elements-tip")[0].style.background="#fff",document.getElementsByClassName("no-elements-tip")[0].style.border="2px dashed #16afe1",document.getElementsByClassName("no-elements-tip")[0].innerHTML="")}},computed:{dragOptions(){return{group:{name:"items",pull:"clone",put:!1},sort:!1,disabled:!1,ghostClass:"ghost"}}}},Rr=Tr,xr=(a("049c"),Object(b["a"])(Rr,$l,jl,!1,null,"2cc31cd7",null)),Lr=xr.exports,Br=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-w-100 em-mt-80"},[a("div",[a("transition",{attrs:{name:"slide-right"}},[0===e.menuHighlight?a("div",{staticClass:"em-grid-3"},e._l(e.displayedMenus,(function(t,s){return a("div",{directives:[{name:"wave",rawName:"v-wave"}],key:"menu_"+t.index,staticClass:"em-shadow-cards col-md-3 em-hover-s-scale",on:{click:function(a){return e.changeMenu(t)}}},[a("span",{staticClass:"material-icons-outlined em-gradient-icons em-mb-16"},[e._v(e._s(t.icon))]),a("p",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate(t.title)))]),a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate(t.description)))])])})),0):e._e()]),a("transition",{attrs:{name:"fade"}},[1===e.menuHighlight?a("StyleTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e(),2===e.menuHighlight?a("ContentTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e(),3===e.menuHighlight?a("FilesTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e(),9===e.menuHighlight?a("TranslationTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],ref:"translations",on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e(),5===e.menuHighlight?a("AttachmentStorage",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e()],1)],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Ir=[],kr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-settings-menu"},[a("div",{staticClass:"em-w-80"},[a("div",{staticClass:"em-grid-3 em-mb-16"},[a("button",{staticClass:"em-primary-button em-mb-24",staticStyle:{width:"max-content"},on:{click:e.pushStatus}},[a("div",{staticClass:"add-button-div"},[a("em",{staticClass:"fas fa-plus em-mr-4"}),e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_STATUS"))+" ")])])]),a("draggable",{class:"draggables-list",attrs:{handle:".handle"},on:{end:e.updateStatusOrder},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.status,(function(t,s){return a("div",{key:t.step,staticClass:"em-mb-24",attrs:{title:"step_"+t.step,id:"step_"+t.step},on:{mouseover:function(t){return e.enableGrab(s)},mouseleave:function(t){return e.disableGrab()}}},[a("div",{staticClass:"em-flex-row em-flex-row-start em-w-100"},[a("span",{staticClass:"handle em-grab",style:e.grab&&e.indexGrab==s?"opacity: 1":"opacity: 0"},[a("span",{staticClass:"material-icons-outlined"},[e._v("drag_indicator")])]),a("div",{staticClass:"status-field"},[a("div",[a("p",{staticClass:"em-p-8-12 em-editable-content",attrs:{contenteditable:"true",id:"status_label_"+t.step},on:{focusout:function(a){return e.updateStatus(t)},keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.manageKeyup(t)},keydown:e.checkMaxlength}},[e._v(e._s(t.label[e.actualLanguage]))])]),a("input",{class:"label-"+t.class,attrs:{type:"hidden"}})]),a("div",{staticClass:"em-flex-row"},[a("v-swatches",{attrs:{swatches:e.swatches,shapes:"circles","row-length":"8","show-border":"","popover-x":"left","popover-y":"top"},on:{input:function(a){return e.updateStatus(t)}},model:{value:t.class,callback:function(a){e.$set(t,"class",a)},expression:"statu.class"}}),1==t.edit&&0!=t.step&&1!=t.step?a("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_DELETE_STATUS")},on:{click:function(a){return e.removeStatus(t,s)}}},[a("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("delete_outline")])]):a("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_CANNOT_DELETE_STATUS")}},[a("span",{staticClass:"material-icons-outlined em-text-neutral-600"},[e._v("delete_outline")])])],1)]),a("hr")])})),0)],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Pr=[],Fr=a("b26c"),$r=a.n(Fr);a("afdb");const jr=a("bef5");var Gr={name:"editStatus",components:{VSwatches:$r.a,draggable:qa.a},props:{},mixins:[A],data(){return{index:"",indexGrab:"0",grab:0,loading:!1,status:[],show:!1,actualLanguage:"",swatches:["#DCC6E0","#947CB0","#663399","#6BB9F0","#19B5FE","#013243","#7BEFB2","#3FC380","#1E824C","#FFFD7E","#FFFD54","#F7CA18","#FABE58","#E87E04","#D35400","#EC644B","#CF000F","#E5283B","#E08283","#D2527F","#DB0A5B","#999999"]}},created(){this.getStatus(),this.actualLanguage=this.$store.getters["global/shortLang"]},methods:{getStatus(){p.a.get("index.php?option=com_emundus&controller=settings&task=getstatus").then(e=>{this.status=e.data.data,setTimeout(()=>{this.status.forEach(e=>{this.getHexColors(e)})},100)})},async updateStatus(e){this.$emit("updateSaving",!0);const t=new FormData;t.append("status",e.step),t.append("label",document.getElementById("status_label_"+e.step).textContent),t.append("color",e.class),await h().post("index.php?option=com_emundus&controller=settings&task=updatestatus",t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},async updateStatusOrder(){let e=[];this.status.forEach(t=>{e.push(t.step)}),this.$emit("updateSaving",!0);const t=new FormData;t.append("status",e.join(",")),await h().post("index.php?option=com_emundus&controller=settings&task=updatestatusorder",t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},pushStatus(){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=createstatus",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.status.push(e.data),setTimeout(()=>{this.getHexColors(e.data)},100),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},removeStatus(e,t){1==e.edit&&0!=e.step&&1!=e.step&&(this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=deletestatus",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:jr.stringify({id:e.id,step:e.step})}).then(()=>{this.status.splice(t,1),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))}))},manageKeyup(e){document.getElementById("status_label_"+e.step).textContent=document.getElementById("status_label_"+e.step).textContent.trim(),document.activeElement.blur()},getHexColors(e){e.translate=!1;let t=document.querySelector(".label-"+e.class),a=getComputedStyle(t),s=a.backgroundColor.split("(")[1].split(")")[0].split(",");e.class=this.rgbToHex(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]))},rgbToHex(e,t,a){return"#"+((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1).toUpperCase()},checkMaxlength(e){50===e.target.textContent.length&&8!=e.keyCode&&e.preventDefault()},enableGrab(e){1!==this.status.length&&(this.indexGrab=e,this.grab=!0)},disableGrab(){this.indexGrab=0,this.grab=!1}}},Hr=Gr,zr=(a("de70"),Object(b["a"])(Hr,kr,Pr,!1,null,"04127086",null)),Vr=zr.exports,Yr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-settings-menu"},[a("div",{staticClass:"em-w-80"},[a("div",{staticClass:"em-grid-3 em-mb-16"},[a("button",{staticClass:"em-primary-button em-mb-24",staticStyle:{width:"max-content"},on:{click:e.pushTag}},[a("div",{staticClass:"add-button-div"},[a("em",{staticClass:"fas fa-plus em-mr-4"}),e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_SETTINGS_ADDTAG"))+" ")])])]),e._l(e.tags,(function(t,s){return a("div",{key:"tag_"+t.id,staticClass:"em-mb-24",attrs:{id:"tag_"+t.id},on:{mouseover:function(t){return e.enableGrab(s)},mouseleave:function(t){return e.disableGrab()}}},[a("div",{staticClass:"em-flex-row em-flex-row-start em-w-100"},[a("div",{staticClass:"status-field"},[a("div",{staticStyle:{width:"100%"}},[a("p",{staticClass:"em-p-8-12 em-editable-content",attrs:{contenteditable:"true",id:"tag_label_"+t.id},on:{focusout:function(a){return e.updateTag(t)},keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.manageKeyup(t)},keydown:e.checkMaxlength}},[e._v(e._s(t.label))])]),a("input",{class:t.class,attrs:{type:"hidden"}})]),a("div",{staticClass:"em-flex-row"},[a("v-swatches",{attrs:{swatches:e.swatches,shapes:"circles","row-length":"8","show-border":"","popover-x":"left","popover-y":"top"},on:{input:function(a){return e.updateTag(t)}},model:{value:t.class,callback:function(a){e.$set(t,"class",a)},expression:"tag.class"}}),a("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_DELETE_TAGS")},on:{click:function(a){return e.removeTag(t,s)}}},[a("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("delete_outline")])])],1)]),a("hr")])}))],2)])},qr=[];const Jr=a("bef5");var Wr={name:"editTags",components:{VSwatches:$r.a,draggable:qa.a},props:{},mixins:[A],data(){return{index:"",indexGrab:"0",grab:0,loading:!1,tags:[],show:!1,actualLanguage:"",swatches:["#DCC6E0","#947CB0","#663399","#6BB9F0","#19B5FE","#013243","#7BEFB2","#3FC380","#1E824C","#FFFD7E","#FFFD54","#F7CA18","#FABE58","#E87E04","#D35400","#EC644B","#CF000F","#E5283B","#E08283","#D2527F","#DB0A5B","#999999"]}},created(){this.getTags(),this.actualLanguage=this.$store.getters["global/shortLang"]},methods:{getTags(){p.a.get("index.php?option=com_emundus&controller=settings&task=gettags").then(e=>{this.tags=e.data.data,setTimeout(()=>{this.tags.forEach(e=>{this.getHexColors(e)})},100)})},async updateTag(e){this.$emit("updateSaving",!0);const t=new FormData;t.append("tag",e.id),t.append("label",document.getElementById("tag_label_"+e.id).textContent),t.append("color",e.class),await h().post("index.php?option=com_emundus&controller=settings&task=updatetags",t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},pushTag(){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=createtag",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.tags.push(e.data),setTimeout(()=>{this.getHexColors(e.data)},100),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},removeTag(e,t){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=deletetag",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jr.stringify({id:e.id})}).then(()=>{this.tags.splice(t,1),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},manageKeyup(e){document.getElementById("tag_label_"+e.id).textContent=document.getElementById("tag_label_"+e.id).textContent.trim(),document.activeElement.blur()},getHexColors(e){let t=document.querySelector("."+e.class),a=getComputedStyle(t),s=a.backgroundColor.split("(")[1].split(")")[0].split(",");e.class=this.rgbToHex(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]))},rgbToHex(e,t,a){return"#"+((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1).toUpperCase()},checkMaxlength(e){50===e.target.textContent.length&&8!=e.keyCode&&e.preventDefault()},enableGrab(e){1!==this.tags.length&&(this.indexGrab=e,this.grab=!0)},disableGrab(){this.indexGrab=0,this.grab=!1}}},Kr=Wr,Xr=(a("4a5f"),Object(b["a"])(Kr,Yr,qr,!1,null,"251b4a10",null)),Qr=Xr.exports,Zr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"translationTool"}},[a("modal",{attrs:{name:"translationTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{opened:e.checkSetup,closed:e.beforeClose}},[a("div",{staticClass:"em-modal-header"},[a("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("translationTool")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?a("div",{staticClass:"em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),a("div",{staticClass:"em-modal-content"},[a("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(t,s){return a("div",{key:"menu_"+t.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===t.index?"em-modal-menu__current":"",on:{click:function(a){e.currentMenu=t.index}}},[a("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(t.title)))]),3===t.index&&e.orphelins_count>0?a("div",{staticClass:"em-notifications-yellow"}):e._e()])})),0),a("transition",{attrs:{name:"fade"}},[1===e.currentMenu?a("Global",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component",on:{updateOrphelinsCount:e.updateOrphelinsCount}}):e._e(),2===e.currentMenu?a("Translations",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),3===e.currentMenu?a("Orphelins",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component"}):e._e()],1),e.setup_success?a("img",{staticClass:"em-success-animation",attrs:{alt:"checked-animation",src:"/images/emundus/animations/checked.gif"}}):e._e()],1),e.loading?a("div",[e.setup_success?e._e():a("div",{staticClass:"em-page-loader"}),e.setup_success?e._e():a("p",{staticClass:"em-page-loader-text"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SETUP_PROGRESSING")))]),e.setup_success?a("p",{staticClass:"em-page-loader-text em-fade-loader"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SETUP_SUCCESS")))]):e._e()]):e._e()])],1)},ec=[],tc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_GLOBAL")))]),a("div",{staticClass:"em-mb-24 em-flex-row em-flex-space-between"},[a("div",[a("p",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_DEFAULT")))]),a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_DEFAULT_DESC")))])]),a("div",{staticClass:"em-w-33"},[a("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.allLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!1},on:{select:e.updateDefaultLanguage},model:{value:e.defaultLang,callback:function(t){e.defaultLang=t},expression:"defaultLang"}})],1)]),a("div",{staticClass:"em-mb-24 em-flex-row em-flex-space-between"},[a("div",[a("p",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SECONDARY")))]),a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SECONDARY_DESC")))])]),a("div",{staticClass:"em-w-33"},[a("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.otherLanguages,multiple:!0,taggable:!1,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!1,"clear-on-select":!1,searchable:!1},on:{remove:e.unpublishLanguage,select:e.publishLanguage},model:{value:e.secondaryLanguages,callback:function(t){e.secondaryLanguages=t},expression:"secondaryLanguages"}}),a("a",{staticClass:"em-pointer em-blue-500-color em-mt-16 em-font-size-12 em-hover-blue-500",on:{click:e.purposeLanguage}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_OTHER_LANGUAGE")))])],1)]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},ac=[],sc={name:"global",props:{},components:{Multiselect:ya.a},data(){return{defaultLang:null,secondaryLanguages:[],allLanguages:[],otherLanguages:[],orphelins_count:0,loading:!1}},created(){this.loading=!0,oo.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages(),this.loading=!1})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data,this.allLanguages.forEach(e=>{e.lang_code!==this.defaultLang.lang_code&&(1==e.published&&this.secondaryLanguages.push(e),this.otherLanguages.push(e))}),this.secondaryLanguages.forEach(e=>{oo.getOrphelins(this.defaultLang.lang_code,e.lang_code).then(e=>{this.orphelins_count=e.data.length,this.$emit("updateOrphelinsCount",this.orphelins_count)})})}catch(e){return!1}},unpublishLanguage(e){oo.updateLanguage(e.lang_code,0)},publishLanguage(e){oo.updateLanguage(e.lang_code,1)},updateDefaultLanguage(e){oo.updateLanguage(e.lang_code,1,1).then(()=>{let t=this.secondaryLanguages.findIndex(t=>t.lang_code==e.lang_code);-1!==t&&this.secondaryLanguages.splice(t,1),this.getAllLanguages()})},async purposeLanguage(){const{value:e}=await j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE"),html:'<p class="em-body-16-semibold em-mb-8 em-text-align-left">'+this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_FIELD")+'</p><input id="language_purpose" class="em-input">',showCancelButton:!0,cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SEND"),showLoaderOnConfirm:!0,reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"},preConfirm:()=>{const e=document.getElementById("language_purpose").value;return oo.sendMailToInstallLanguage(e)},allowOutsideClick:()=>!j.a.isLoading()});e&&await j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SENDED"),text:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SENDED_TEXT"),showCancelButton:!1,showConfirmButton:!1,timer:3e3,customClass:{title:"em-swal-title"}})}}},ic=sc,nc=Object(b["a"])(ic,tc,ac,!1,null,"1d9727d8",null),oc=nc.exports,lc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",{staticClass:"em-h4 em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS")))]),a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE")))]),0!==e.availableLanguages.length||e.loading?a("div",{staticClass:"em-grid-4"},[a("div",[a("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},on:{select:e.getObjects},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1),e.lang?a("div",[a("multiselect",{attrs:{label:"name","track-by":"name",options:e.objects,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_OBJECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.object,callback:function(t){e.object=t},expression:"object"}})],1):e._e(),e.object?a("div",[a("multiselect",{attrs:{label:"label","track-by":"id",options:e.datas,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}})],1):e._e(),e.childrens.length>0?a("div",[a("multiselect",{attrs:{label:"label","track-by":"id",options:e.childrens,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.children,callback:function(t){e.children=t},expression:"children"}})],1):e._e()]):a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_NO_LANGUAGES_AVAILABLE")))]),a("hr",{staticClass:"col-md-12",staticStyle:{"z-index":"0"}}),a("div",{staticClass:"col-md-12"},[""===e.lang||null==e.lang||""===e.object||null==e.object||!1===e.init_translations?a("div",{staticClass:"text-center em-mt-80"},[a("p",{staticClass:"em-h5 em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_TRANSLATION_TITLE")))]),a("p",{staticClass:"em-font-size-14 em-text-neutral-600"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_TRANSLATION_TEXT")))])]):a("div",e._l(e.object.fields.Sections,(function(t){return a("div",{staticClass:"em-mb-32"},[a("h4",[e._v(e._s(t.Label))]),a("TranslationRow",{attrs:{section:t,translations:e.translations},on:{saveTranslation:e.saveTranslation}})],1)})),0)]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},rc=[],cc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.translations_rows,(function(t){return a("div",{staticClass:"em-mb-32 em-neutral-100-box em-p-24"},e._l(t,(function(t,s){return a("div",{staticClass:"em-mb-24"},[a("p",[e._v(e._s(t.reference_label?t.reference_label.toUpperCase():t.reference_id))]),a("div",{staticClass:"em-flex-space-between em-mt-16 em-grid-50 em-ml-24"},[a("p",{staticClass:"em-neutral-700-color"},[e._v(e._s(t.default_lang))]),"field"===t.field_type?a("input",{staticClass:"mb-0 em-input em-w-100",attrs:{type:"text"},domProps:{value:t.lang_to},on:{focusout:function(a){return e.saveTranslation(a.target.value,t)}}}):e._e(),"textarea"===t.field_type?a("textarea",{staticClass:"mb-0 em-input",domProps:{value:t.lang_to},on:{focusout:function(a){return e.saveTranslation(a.target.value,t)}}}):e._e()])])})),0)})),0)},dc=[],mc={name:"TranslationRow",components:{Multiselect:ya.a},mixins:[A],props:{section:Object,translations:Array},data(){return{translations_rows:{},key_fields:[]}},created(){this.initTranslations()},methods:{initTranslations(){this.key_fields=Object.keys(this.$props.section.indexedFields),Object.values(this.$props.translations).forEach(e=>{Object.values(e).forEach(e=>{this.key_fields.includes(e.reference_field)&&e.reference_table===this.$props.section.Name&&(e.reference_field_order=this.key_fields.indexOf(e.reference_field),e.reference_label=this.$props.section.indexedFields[e.reference_field].Label,e.field_type=this.$props.section.indexedFields[e.reference_field].Type,e.hasOwnProperty("tag")||(e.tag=e.reference_field),this.translations_rows.hasOwnProperty(e.reference_id)||(this.translations_rows[e.reference_id]=[]),this.translations_rows[e.reference_id].push(e))})}),Object.values(this.translations_rows).forEach(e=>{e.sort((e,t)=>e.reference_field_order>t.reference_field_order?1:-1)})},async saveTranslation(e,t){this.$emit("saveTranslation",{value:e,translation:t})}}},uc=mc,pc=Object(b["a"])(uc,cc,dc,!1,null,"07992dc4",null),_c=pc.exports,hc={name:"Translations",components:{TranslationRow:_c,Multiselect:ya.a},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],objects:[],datas:[],childrens:[],translations:{},lang:null,object:null,data:null,children_type:null,children:null,loading:!1,init_translations:!1}},created(){this.loading=!0,oo.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages().then(()=>{this.loading=!1})})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data;for(const t of this.allLanguages)t.lang_code!==this.defaultLang.lang_code&&1==t.published&&this.availableLanguages.push(t);1===this.availableLanguages.length&&(this.lang=this.availableLanguages[0],await this.getObjects())}catch(e){return this.loading=!1,!1}},async getObjects(){this.loading=!0,this.translations=[],this.childrens=[],this.datas=[],this.objects=[],this.object=null,this.data=null,this.children=null,oo.getObjects().then(e=>{this.objects=e.data,this.loading=!1})},async getDatas(e){this.loading=!0,oo.getDatas(e.table.name,e.table.reference,e.table.label,e.table.filters).then(async t=>{if(this.datas=t.data,console.log(e.table),"true"===e.table.load_all){let e=[];await this.asyncForEach(this.object.fields.Fields,async t=>{e.push(t.Name)}),e=e.join(",");const t=async()=>{for(const t of this.datas)await oo.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,t.id,e,this.object.table.name).then(async e=>{for(const a of Object.values(e.data))this.translations[t.id]={},this.object.fields.Fields.forEach(e=>{this.translations[t.id][e.Name]=a[e.Name]})});this.init_translations=!0,this.loading=!1};await t()}else"true"===e.table.load_first_data?this.data=this.datas[0]:this.loading=!1})},async getTranslations(e){let t=[];this.object.fields.Fields.forEach(e=>{t.push(e.Name)}),t=t.join(","),oo.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,e.id,t,this.object.table.name).then(e=>{this.translations=e.data,this.init_translations=!0,this.loading=!1})},async saveTranslation({value:e,translation:t}){this.$emit("updateSaving",!0),oo.updateTranslations(e,this.object.table.type,this.lang.lang_code,t.reference_id,t.tag,t.reference_table).then(e=>{this.$emit("updateLastSaving",this.formattedDate("","LT")),this.$emit("updateSaving",!1)})}},watch:{object:function(e){this.init_translations=!1,this.translations={},this.childrens=[],this.children=null,this.datas=[],this.data=null,null!=e&&this.getDatas(e)},data:function(e){this.loading=!0,this.init_translations=!1,this.translations={},this.childrens=[],this.children=null,this.children_type=null;var t=!1;null!=e?(this.object.fields.Fields.forEach(e=>{"children"===e.Type&&(this.children_type=e.Label,t=!0,oo.getChildrens(e.Label,this.data.id,e.Name).then(e=>{this.childrens=e.data,"true"===this.object.table.load_first_child&&(this.children=this.childrens[0]),this.loading=!1}))}),t||this.getTranslations(e)):this.getDatas(this.object)},children:function(e){if(this.loading=!0,this.init_translations=!1,this.translations={},null!=e){let t=[];this.object.fields.Sections.forEach(e=>{const a={table:e.Table,join_table:e.TableJoin,join_column:e.TableJoinColumn,reference_column:e.ReferenceColumn,fields:Object.keys(e.indexedFields)};t.push(a)}),oo.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,e.id,"",t).then(e=>{this.translations=e.data,this.init_translations=!0,this.loading=!1})}else this.loading=!1}}},gc=hc,fc=Object(b["a"])(gc,lc,rc,!1,null,"f9367df0",null),vc=fc.exports,bc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",{staticClass:"em-h4 em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELINS")))]),e.saving||null!=e.last_save?e._e():a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE")))]),e.saving?a("div",{staticClass:"em-mb-24 em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))]),0!==e.availableLanguages.length||e.loading?e._e():a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_NO_LANGUAGES_AVAILABLE")))]),0!==e.translations.length||e.loading?a("div",{staticClass:"em-grid-4"},[a("div",[a("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1)]):a("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHANS_CONGRATULATIONS")))]),a("hr",{staticClass:"col-md-12",staticStyle:{"z-index":"0"}}),a("div",{staticClass:"col-md-12"},[""===e.lang||null==e.lang||0===e.translations.length?a("div",{staticClass:"text-center em-mt-80"},[a("p",{staticClass:"em-h5 em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_ORPHELINS_TITLE")))]),""===e.lang||null==e.lang?a("p",{staticClass:"em-font-size-14 em-text-neutral-600"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_ORPHELINS_TEXT")))]):e._e()]):a("div",e._l(e.translations,(function(t){return a("div",{key:t.id},[a("div",{staticClass:"em-mb-32 em-neutral-100-box em-p-24"},[a("div",{staticClass:"em-flex-space-between em-mt-16 em-grid-50"},[a("p",{staticClass:"em-neutral-700-color"},[e._v(e._s(t.override))]),a("div",[a("input",{ref:"translation-"+t.id,refInFor:!0,staticClass:"mb-0 em-input em-w-100",attrs:{type:"text"},domProps:{value:t.override}}),a("a",{staticClass:"em-pointer em-blue-500-color em-mt-16 em-font-size-12 em-hover-blue-500",on:{click:function(a){return e.saveTranslation(t)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELIN_CONFIRM_TRANSLATION")))])])])])])})),0)]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Ec=[],Oc={name:"Orphelins",components:{Multiselect:ya.a},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],translations:[],lang:null,loading:!0,saving:!1,last_save:null}},created(){oo.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages()})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data;for(const t of this.allLanguages)t.lang_code!==this.defaultLang.lang_code&&1==t.published&&this.availableLanguages.push(t);1===this.availableLanguages.length?this.lang=this.availableLanguages[0]:this.loading=!1}catch(e){return this.loading=!1,!1}},async saveTranslation(e){this.saving=!0;const t=this.$refs["translation-"+e.id][0].value;t&&oo.insertTranslation(t,"override",this.lang.lang_code,e.reference_id,e.tag,e.reference_table).then(t=>{this.last_save=this.formattedDate("","LT"),this.saving=!1,this.translations=this.translations.filter((function(t){return t.id!==e.id}))})}},watch:{lang:function(e){null!==e&&void 0!==typeof e&&(this.loading=!0,this.translations=[],oo.getOrphelins(this.defaultLang.lang_code,e.lang_code).then(e=>{this.translations=e.data,this.loading=!1}))}}},Cc=Oc,yc=Object(b["a"])(Cc,bc,Ec,!1,null,"20a38136",null),Dc=yc.exports,Mc={name:"translationTool",props:{},components:{Orphelins:Dc,Translations:vc,Global:oc},data(){return{orphelins_count:0,currentMenu:0,menus:[{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_GLOBAL",index:1},{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS",index:2},{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELINS",index:3}],loading:!1,setup_success:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateOrphelinsCount(e){this.orphelins_count=e},checkSetup(){oo.checkSetup().then(e=>{0===e.data?(this.loading=!0,oo.configureSetup().then(e=>{1===e.data&&(this.loading=!1,this.setup_success=!0,this.currentMenu=1,setTimeout(()=>{this.setup_success=!1},2700))})):this.currentMenu=1})},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},Nc=Mc,Ac=Object(b["a"])(Nc,Zr,ec,!1,null,"44ee664e",null),Sc=Ac.exports,wc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"contentTool"}},[a("modal",{attrs:{name:"contentTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[a("div",{staticClass:"em-modal-header"},[a("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("contentTool")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?a("div",{staticClass:"em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),a("div",{staticClass:"em-modal-content"},[a("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(t){return a("div",{key:"menu_"+t.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===t.index?"em-modal-menu__current":"",on:{click:function(a){e.currentMenu=t.index}}},[a("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(t.title)))])])})),0),a("transition",{attrs:{name:"fade",mode:"out-in"}},["article"===e.selectedMenu.type?a("EditArticle",{key:e.currentMenu,staticClass:"em-modal-component",attrs:{article_id:e.selectedMenu.id,article_alias:e.selectedMenu.alias},on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):"footer"===e.selectedMenu.type?a("EditFooter",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1)],1),e.loading?a("div"):e._e()])],1)},Uc=[],Tc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-settings-menu"},[a("div",{staticClass:"em-w-80"},[a("div",{staticClass:"em-grid-3 em-mb-16"},[a("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!1},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1),a("div",{staticClass:"form-group controls"},[a("editor-quill",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content,enable_variables:!1,id:"editor"},on:{focusout:e.saveContent},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Rc=[],xc={name:"editArticle",components:{EditorQuill:_a,Editor:Kt,Multiselect:ya.a},props:{actualLanguage:{type:String,default:"fr"},article_alias:{type:String,default:null},article_id:{type:Number,default:0}},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],lang:null,loading:!1,dynamicComponent:0,form:{content:""}}},created(){this.loading=!0,oo.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages(),this.loading=!1})},methods:{async getArticle(){let e={article_id:this.$props.article_id,lang:this.lang.lang_code,field:"introtext"};null!==this.$props.article_alias&&(e={article_alias:this.$props.article_alias,lang:this.lang.lang_code,field:"introtext"}),await h().get("index.php?option=com_emundus&controller=settings&task=getarticle",{params:e}).then(e=>{this.form.content=e.data.data.introtext,this.dynamicComponent++})},async saveContent(){this.$emit("updateSaving",!0);const e=new FormData;e.append("content",this.form.content),e.append("lang",this.lang.lang_code),null!==this.$props.article_alias?e.append("article_alias",this.$props.article_alias):e.append("article_id",this.$props.article_id),e.append("field","introtext"),await h().post("index.php?option=com_emundus&controller=settings&task=updatearticle",e,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},async getAllLanguages(){await oo.getAllLanguages().then(e=>{this.availableLanguages=e,this.lang=this.defaultLang})}},watch:{lang:function(){null!==this.lang?this.getArticle():(this.form.content="",this.dynamicComponent++)}}},Lc=xc,Bc=Object(b["a"])(Lc,Tc,Rc,!1,null,"38d360f0",null),Ic=Bc.exports,kc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-settings-menu"},[a("div",{staticClass:"em-w-80"},[a("div",{staticClass:"em-grid-3 em-mb-16"},[a("multiselect",{attrs:{label:"label","track-by":"index",options:e.columns,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_COLUMN"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.selectedColumn,callback:function(t){e.selectedColumn=t},expression:"selectedColumn"}})],1),0===e.selectedColumn.index&&null!=this.form.content.col1?a("div",{staticClass:"form-group controls"},[a("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content.col1,lang:e.actualLanguage,enable_variables:!1,id:"editor_1"},on:{focusout:e.saveFooter},model:{value:e.form.content.col1,callback:function(t){e.$set(e.form.content,"col1",t)},expression:"form.content.col1"}})],1):e._e(),1===e.selectedColumn.index&&null!=this.form.content.col2?a("div",{staticClass:"form-group controls"},[a("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content.col2,lang:e.actualLanguage,enable_variables:!1,id:"editor_2"},on:{focusout:e.saveFooter},model:{value:e.form.content.col2,callback:function(t){e.$set(e.form.content,"col2",t)},expression:"form.content.col2"}})],1):e._e()]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},Pc=[],Fc={name:"EditFooter",components:{Editor:Kt,Multiselect:ya.a},props:{actualLanguage:String},mixins:[A],data(){return{loading:!1,dynamicComponent:0,selectedColumn:0,form:{content:{col1:null,col2:null}},columns:[{index:0,label:this.translate("COM_EMUNDUS_ONBOARD_COLUMN")+" 1"},{index:1,label:this.translate("COM_EMUNDUS_ONBOARD_COLUMN")+" 2"}]}},created(){this.loading=!0,this.getArticles(),this.selectedColumn=this.columns[0]},methods:{async getArticles(){await h().get("index.php?option=com_emundus&controller=settings&task=getfooterarticles").then(e=>{this.form.content.col1=e.data.data.column1,this.form.content.col2=e.data.data.column2,this.loading=!1})},async saveFooter(){this.$emit("updateSaving",!0);const e=new FormData;e.append("col1",this.form.content.col1),e.append("col2",this.form.content.col2),await h().post("index.php?option=com_emundus&controller=settings&task=updatefooter",e,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})}},watch:{selectedColumn:function(){this.dynamicComponent++}}},$c=Fc,jc=Object(b["a"])($c,kc,Pc,!1,null,"73ecf13c",null),Gc=jc.exports,Hc={name:"contentTool",props:{},components:{EditFooter:Gc,EditArticle:Ic},data(){return{currentMenu:1,menus:[{type:"article",id:52,alias:null,title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_HOMEPAGE",index:1},{type:"article",alias:"mentions-legales",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_LEGAL_MENTION",index:2},{type:"article",alias:"politique-de-confidentialite-des-donnees",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_DATAS",index:3},{type:"article",alias:"gestion-de-vos-droits",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_RIGHTS",index:4},{type:"article",alias:"gestion-des-cookies",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_COOKIES",index:5},{type:"footer",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_FOOTER",index:6}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}},computed:{selectedMenu(){return this.menus.find(e=>e.index===this.currentMenu)}}},zc=Hc,Vc=Object(b["a"])(zc,wc,Uc,!1,null,"3c0595c4",null),Yc=Vc.exports,qc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"filesTool"}},[a("modal",{attrs:{name:"filesTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[a("div",{staticClass:"em-modal-header"},[a("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("filesTool")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?a("div",{staticClass:"em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),a("div",{staticClass:"em-modal-content"},[a("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(t){return a("div",{key:"menu_"+t.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===t.index?"em-modal-menu__current":"",on:{click:function(a){e.currentMenu=t.index}}},[a("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(t.title)))])])})),0),a("transition",{attrs:{name:"fade",mode:"out-in"}},[1===e.currentMenu?a("EditStatus",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),2===e.currentMenu?a("EditTags",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),3===e.currentMenu?a("EditApplicants",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1)],1),e.loading?a("div"):e._e()])],1)},Jc=[],Wc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-settings-menu"},[a("div",{staticClass:"em-w-80"},e._l(e.params,(function(t,s){return a("div",{key:s,staticClass:"form-group em-flex-center em-w-100 em-mb-16"},[a("label",{attrs:{for:"param_"+s}},[e._v(e._s(t.label))]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"param.value"}],staticClass:"dropdown-toggle w-select",staticStyle:{"margin-bottom":"0"},attrs:{id:"param_"+s},on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"value",a.target.multiple?s:s[0])},function(a){return e.saveEmundusParam(t)}]}},e._l(t.options,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.label))])})),0)])})),0)])},Kc=[];const Xc=a("bef5");var Qc={name:"EditApplicants",components:{},props:{},mixins:[A],data(){return{params:{applicant_can_renew:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_RENEW"),param:"applicant_can_renew",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1},{label:this.translate("COM_EMUNDUS_APPLICANT_CAN_RENEW_CAMPAIGN"),value:2},{label:this.translate("COM_EMUNDUS_APPLICANT_CAN_RENEW_YEAR"),value:3}],value:0},can_edit_until_deadline:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_EDIT_UNTIL_DEADLINE"),param:"can_edit_until_deadline",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1}],value:0},can_submit_encrypted:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_SUBMIT_ENCRYPTED"),param:"can_submit_encrypted",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1}],value:0}},config:{}}},created(){this.getEmundusParams()},methods:{getEmundusParams(){p.a.get("index.php?option=com_emundus&controller=settings&task=getemundusparams").then(e=>{this.config=e.data.config,this.params.applicant_can_renew.value=parseInt(this.config.applicant_can_renew),this.params.can_edit_until_deadline.value=parseInt(this.config.can_edit_until_deadline),this.params.copy_application_form.value=parseInt(this.config.copy_application_form),this.params.can_submit_encrypted.value=parseInt(this.config.can_submit_encrypted)})},saveEmundusParam(e){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=updateemundusparam",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Xc.stringify({param:e.param,value:e.value})}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})}}},Zc=Qc,ed=(a("0987"),Object(b["a"])(Zc,Wc,Kc,!1,null,"5dd811c8",null)),td=ed.exports,ad={name:"filesTool",props:{},components:{EditApplicants:td,EditTags:Qr,EditStatus:Vr},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STATUS",index:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TAGS",index:2},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_APPLICANTS",index:3}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},sd=ad,id=Object(b["a"])(sd,qc,Jc,!1,null,"07063a76",null),nd=id.exports,od=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{class:"full-width-modal",attrs:{id:"styleTool"}},[a("modal",{attrs:{name:"styleTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[a("div",{staticClass:"em-modal-header"},[a("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("styleTool")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?a("div",{staticClass:"em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),a("div",{staticClass:"em-modal-content"},[a("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(t){return a("div",{key:"menu_"+t.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===t.index?"em-modal-menu__current":"",on:{click:function(a){e.currentMenu=t.index}}},[a("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(t.title)))])])})),0),a("transition",{attrs:{name:"fade"}},[1===e.currentMenu?a("General",{staticClass:"em-modal-component"}):e._e()],1)],1),e.loading?a("div"):e._e()])],1)},ld=[],rd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ModalUpdateColors",{on:{UpdateColors:e.updateColors}}),a("h2",{staticStyle:{"margin-top":"0"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_STYLE_TOOL_GENERAL")))]),a("div",{staticClass:"em-grid-2"},[a("div",{staticClass:"em-h-auto em-flex-col em-mb-32",staticStyle:{"align-items":"start"}},[a("div",{staticClass:"em-flex-row"},[a("div",[a("h3",{staticClass:"em-text-neutral-800",staticStyle:{margin:"0"}},[e._v("Logo")]),a("span",[a("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, png, gif, svg")])])]),e.logo_updating?a("span",{staticClass:"material-icons em-pointer",staticStyle:{"margin-left":"125px"},on:{click:function(t){e.logo_updating=!e.logo_updating}}},[e._v("close")]):e._e()]),e.logo_updating?e._e():a("div",{staticClass:"em-logo-box pointer em-mt-16",on:{click:function(t){e.logo_updating=!e.logo_updating}}},[a("img",{staticClass:"logo-settings",attrs:{src:e.imageLink,srcset:"/"+e.imageLink,alt:e.InsertLogo}})]),a("div",{staticClass:"em-mt-16"},[e.logo_updating?a("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.logoDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])]):e._e()],1)]),a("div",{staticClass:"em-h-auto em-flex-col em-mb-32",staticStyle:{"align-items":"start"}},[a("div",{staticClass:"em-flex-row"},[a("div",[a("h3",{staticClass:"em-text-neutral-800",staticStyle:{margin:"0"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ICON")))]),a("span",[a("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, png")])])]),e.favicon_updating?a("span",{staticClass:"material-icons em-pointer",staticStyle:{"margin-left":"125px"},on:{click:function(t){e.favicon_updating=!e.favicon_updating}}},[e._v("close")]):e._e()]),e.favicon_updating?e._e():a("div",{staticClass:"em-logo-box pointer em-mt-16",on:{click:function(t){e.favicon_updating=!e.favicon_updating}}},[a("img",{staticClass:"logo-settings",attrs:{src:e.iconLink,srcset:"/"+e.iconLink,alt:e.InsertIcon}})]),a("div",{staticClass:"em-mt-16"},[e.favicon_updating?a("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.faviconDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])]):e._e()],1)]),a("div",{staticClass:"em-h-auto em-flex-col em-mb-32",staticStyle:{"align-items":"start"}},[a("div",{staticClass:"em-flex-row",staticStyle:{"margin-bottom":"52px"}},[a("h3",{staticClass:"em-text-neutral-800",staticStyle:{margin:"0"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_COLORS")))])]),a("div",{staticClass:"em-logo-box pointer em-mt-16",on:{click:function(t){return e.$modal.show("modalUpdateColors")}}},[a("div",{staticClass:"color-preset",style:"background-color:"+e.primary+";border-right: 25px solid"+e.secondary})])]),e.bannerLink?a("div",{staticClass:"em-h-auto em-flex-col em-mb-32",staticStyle:{"align-items":"start"}},[a("div",{staticClass:"em-flex-row"},[a("div",[a("h3",{staticClass:"em-text-neutral-800",staticStyle:{margin:"0"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_BANNER")))]),a("span",[a("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, png")])]),a("br"),a("span",[a("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_RECOMMENDED_SIZE"))+" : 1440x200px")])])]),e.banner_updating?a("span",{staticClass:"material-icons em-pointer",staticStyle:{"margin-left":"125px"},on:{click:function(t){e.banner_updating=!e.banner_updating}}},[e._v("close")]):e._e()]),e.banner_updating?e._e():a("div",{staticClass:"em-logo-box pointer em-mt-16",on:{click:function(t){e.banner_updating=!e.banner_updating}}},[a("img",{staticClass:"logo-settings",attrs:{src:e.bannerLink,srcset:"/"+e.bannerLink,alt:e.InsertBanner}})]),a("div",{staticClass:"em-mt-16"},[e.banner_updating?a("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.bannerDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])]):e._e()],1)]):e._e()]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},cd=[],dd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"modalUpdateColors"}},[a("modal",{attrs:{name:"modalUpdateColors",height:"auto","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1}},[a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("span",{staticClass:"em-h4"},[e._v(" "+e._s(e.updateColors)+" ")]),a("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalUpdateColors")}}},[a("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),a("div",{staticClass:"em-grid-3"},e._l(e.presets,(function(t){return a("div",{staticClass:"preset-presentation",style:"background-color:"+t.primary+";border-right: 100px solid"+t.secondary,on:{click:function(a){return e.changeColors(t)}}})})),0)])],1)},md=[];const ud=a("bef5");var pd={name:"modalUpdateColors",props:{},components:{},data(){return{presets:[{primary:"#1b1f3c",secondary:"#de6339"},{primary:"#DA3832",secondary:"#204382"},{primary:"#727378",secondary:"#A0BD51"},{primary:"#727378",secondary:"#000000"},{primary:"#000000",secondary:"#5AA6DC"},{primary:"#A0BD51",secondary:"#204382"}],updateColors:this.translate("COM_EMUNDUS_ONBOARD_UPDATE_COLORS"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),Error:this.translate("COM_EMUNDUS_ONBOARD_ERROR")}},methods:{changeColors(e){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=updatecolor",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ud.stringify({preset:e})}).then(t=>{this.$emit("UpdateColors",e),this.$modal.hide("modalUpdateColors")})}}},_d=pd,hd=(a("c4fa"),Object(b["a"])(_d,dd,md,!1,null,"57d0741a",null)),gd=hd.exports;const fd=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var vd={name:"global",props:{},components:{ModalUpdateColors:gd,Multiselect:ya.a,vueDropzone:Va.a},data(){return{loading:!1,logo_updating:!1,favicon_updating:!1,banner_updating:!1,imageLink:"",iconLink:"images/custom/favicon.png",bannerLink:null,primary:"",secondary:"",changes:!1,InsertLogo:this.translate("COM_EMUNDUS_ONBOARD_INSERT_LOGO"),InsertIcon:this.translate("COM_EMUNDUS_ONBOARD_INSERT_ICON"),InsertBanner:this.translate("COM_EMUNDUS_ONBOARD_INSERT_BANNER"),logoDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updatelogo",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/*",previewTemplate:fd(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" (10Mo).",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")},faviconDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updateicon",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/png,image/jpeg",previewTemplate:fd(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" : 10Mo",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")},bannerDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updatebanner",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/png,image/jpeg",previewTemplate:fd(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" : 10Mo",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")}}},created(){this.loading=!0,this.changes=!1,p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getlogo"}).then(e=>{null==e.data.filename?this.imageLink="images/custom/logo.png":this.imageLink="images/custom/"+e.data.filename,setTimeout(()=>{this.changes=!0},1e3),this.loading=!1}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getbanner"}).then(e=>{null!=e.data.filename&&(this.bannerLink=e.data.filename),setTimeout(()=>{this.changes=!0},1e3),this.loading=!1}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getappcolors"}).then(e=>{this.primary=e.data.primary,this.secondary=e.data.secondary,setTimeout(()=>{this.changes=!0},1e3),this.loading=!1})},methods:{updateView(e="png"){this.imageLink="images/custom/logo_custom."+e+"?"+(new Date).getTime(),this.$forceUpdate()},updateIcon(){this.iconLink="images/custom/favicon.png?"+(new Date).getTime(),this.$forceUpdate()},updateBanner(){this.bannerLink="images/custom/default_banner.png?"+(new Date).getTime(),this.$forceUpdate()},updateColors(e){this.primary=e.primary,this.secondary=e.secondary},removeIcon(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_ICON"),text:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_ICON_TEXT"),type:"warning",showCancelButton:!0,confirmButtonColor:"#12db42",confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0}).then(e=>{e.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=removeicon",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.iconLink="",this.$forceUpdate()})})},imageExists(e,t){var a=new Image;a.onload=function(){t(!0)},a.onerror=function(){t(!1)},a.src=e},beforeClose(e){},beforeOpen(e){},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){const t=e.name.split(".").pop();"success"==e.status&&(this.logo_updating&&(this.logo_updating=!1,this.updateView(t)),this.favicon_updating&&(this.favicon_updating=!1,this.updateIcon()),this.banner_updating&&(this.banner_updating=!1,this.updateBanner()))},catchError:function(e,t,a){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},thumbnail:function(e,t){var a,s,i,n;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),i=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),a=0,s=i.length;a<s;a++)n=i[a],n.alt=e.name,n.style.backgroundImage='url("'+t+'")';return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},uploadNewLogo(){this.$refs.dropzone.processQueue()}}},bd=vd,Ed=(a("966e"),Object(b["a"])(bd,rd,cd,!1,null,"e2be1a2e",null)),Od=Ed.exports,Cd={name:"styleTool",props:{},components:{General:Od},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_STYLE_TOOL_GENERAL",index:1}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}},computed:{selectedMenu(){return this.menus.find(e=>e.index===this.currentMenu)}}},yd=Cd,Dd=Object(b["a"])(yd,od,ld,!1,null,"6929d0b2",null),Md=Dd.exports,Nd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{attrs:{id:"attachmentStorage"}},[a("modal",{attrs:{name:"attachmentStorage",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[a("div",{staticClass:"em-modal-header"},[a("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("attachmentStorage")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?a("div",{staticClass:"em-flex-row em-flex-start"},[a("div",{staticClass:"em-loader em-mr-8"}),a("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():a("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),a("div",{staticClass:"em-modal-content"},[a("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(t){return a("div",{key:"menu_"+t.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between em-pointer",class:e.currentMenu===t.index?"em-modal-menu__current":"",on:{click:function(a){e.currentMenu=t.index}}},[a("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(t.title)))])])})),0),a("transition",{attrs:{name:"fade",mode:"out-in"}},[1===e.currentMenu?a("Configuration",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),2===e.currentMenu?a("Storage",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1)],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])],1)},Ad=[],Sd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_CONFIGURATION")))]),a("div",{staticClass:"em-flex-row"},[a("ul",{staticClass:"nav nav-tabs topnav"},e._l(e.integrations,(function(t,s){return a("li",{key:"integration-"+s},[a("a",{staticClass:"em-neutral-700-color em-pointer",class:e.currentIntegration===s?"w--current":""},[e._v(" "+e._s(e.translate(t))+" ")])])})),0)]),0===e.currentIntegration?a("IntegrationGED",{attrs:{site:e.site,level_max:e.level_max},on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},wd=[],Ud={async getActiveLanguages(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getactivelanguages")}catch(e){return{status:!1,error:e}}},async removeParameter(e){try{const t=await h().post("index.php?option=com_emundus&controller=settings&task=removeparam",{param:e});return t}catch(t){return{status:!1,error:t}}},async checkFirstDatabaseJoin(){try{const e=await h().get("index.php?option=com_emundus&controller=settings&task=checkfirstdatabasejoin");return e}catch(e){return{status:!1,message:e.message}}},async getEmundusParams(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getemundusparams")}catch(e){return!1}}},Td=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-32"},[a("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_CONF_WRITING")))]),a("div",{staticClass:"em-flex-row em-mb-16"},[a("span",{staticClass:"material-icons"},[e._v("folder")]),a("span",{staticClass:"em-ml-8 em-mr-8"},[e._v("/"+e._s(e.site))]),a("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[a("span",{staticClass:"tooltip-target b3 material-icons"},[e._v("more_horiz")]),a("template",{slot:"popover"},[a("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300",on:{click:function(t){return e.addNode(null)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_ADD_MENU")))])])],2)],1),e._l(e.nodes,(function(t){return a("div",[a("Tree",{attrs:{node:t,level_max:e.level_max,emundus_tags:e.emundus_tags},on:{addNode:e.addNode,deleteNode:e.deleteNode,saveConfig:e.saveConfig}})],1)})),a("hr"),e.buildedComponent?a("FilesName",{attrs:{name:e.name},on:{updateName:e.updateName}}):e._e(),a("hr"),a("Aspects",{attrs:{aspects:e.aspects},on:{"update-aspects":e.updateAspects}})],2)},Rd=[],xd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"em-flex-row em-mb-16",class:"em-level-"+e.node.level},[0!==e.node.type?a("span",{staticClass:"material-icons"},[e._v("folder")]):a("span",{staticClass:"material-icons-outlined"},[e._v("folder")]),!e.other_tags.includes(e.node.type)&&0!==e.node.type||""===e.node.type?a("input",{staticClass:"em-ml-8 em-mr-8 em-xs-input em-w-auto tree-branch",attrs:{type:"text"},domProps:{value:e.node.type},on:{focusout:function(t){return e.updateNodeType(t)}}}):a("select",{directives:[{name:"model",rawName:"v-model",value:e.node.type,expression:"node.type"}],staticClass:"em-ml-8 em-mr-8 em-clear-dropdown",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.node,"type",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"0",selected:""}},[e._v("/"+e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SELECT_TYPE")))]),e._l(e.fieldsData,(function(t){return a("option",{domProps:{value:t.value}},[e._v(e._s(e.translate(t.label)))])}))],2),a("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[a("span",{staticClass:"tooltip-target b3 material-icons"},[e._v("more_horiz")]),a("template",{slot:"popover"},[e.node.level<e.level_max?a("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300",on:{click:function(t){return e.$emit("addNode",e.node)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_ADD_MENU")))]):e._e(),a("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300 em-red-500-color",on:{click:function(t){return e.$emit("deleteNode",e.node)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_DELETE")))])])],2)],1),e._l(e.node.childrens,(function(t){return a("div",{staticClass:"em-flex-row",class:"em-level-"+t.level},[a("Tree",{attrs:{node:t,level_max:e.level_max,emundus_tags:e.emundus_tags},on:{addNode:e.addNode,deleteNode:e.deleteNode,saveConfig:function(t){return e.$emit("saveConfig")}}})],1)}))],2)},Ld=[],Bd={level_1:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_CAMPAIGN_TYPE",value:"[CAMPAIGN_LABEL]",field:"none"}],level_2:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_FILE_TYPE",value:"[FNUM]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_USER_TYPE",value:"[APPLICANT_ID]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_YEAR_TYPE",value:"[CAMPAIGN_YEAR]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_OTHER",value:"",field:"text"}],default:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_FILE_TYPE",value:"[FNUM]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_USER_TYPE",value:"[APPLICANT_ID]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_YEAR_TYPE",value:"[CAMPAIGN_YEAR]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_OTHER",value:"",field:"text"}]},Id={name:"Tree",props:{node:Object,level_max:{type:Number,default:3},emundus_tags:Array},data(){return{fieldsData:[],other_tags:[]}},mounted(){this.fieldsData="undefined"!=typeof Bd["level_"+this.node.level]?Bd["level_"+this.node.level]:Bd["default"],this.fieldsData.forEach(e=>{this.other_tags.push(e.value)})},methods:{addNode(e){this.$emit("addNode",e)},deleteNode(e){this.$emit("deleteNode",e)},updateNodeType(e){this.node.type=e.target.value}},watch:{"node.type":function(){this.$emit("saveConfig")}}},kd=Id,Pd=(a("e794"),Object(b["a"])(kd,xd,Ld,!1,null,"e365fb08",null)),Fd=Pd.exports,$d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-16"},[a("div",{staticClass:"em-flex-row em-flex-space-between"},[a("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_WRITING")))]),a("div",{staticClass:"em-flex-row"},[a("a",{staticClass:"em-mr-16 em-pointer em-blue-500-color em-hover-blue-500",attrs:{href:"component/emundus/?view=export_select_columns&format=html&layout=all_programs&Itemid=1173",target:"_blank"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_TAGS_LIST")))]),a("div",{staticClass:"em-pointer em-blue-500-color",on:{click:e.resetName}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_RESET")))])])]),a("div",{staticClass:"em-name-preview em-mb-16 em-flex-row",class:0===e.selectedTags.length?"em-name-preview-error":""},e._l(e.selectedTags,(function(t,s){return a("div",{staticClass:"em-flex-row"},[a("span",[e._v(e._s(t.value))]),s+1!==e.selectedTags.length?a("div",[e._v(e._s(e.selectedSeparator))]):e._e()])})),0),0===e.selectedTags.length?a("div",{staticClass:"em-red-500-color em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_SELECT_A_TAG")))]):e._e(),a("div",{staticClass:"em-flex-row"},[a("multiselect",{attrs:{label:"label","track-by":"value",options:e.tags,multiple:!0,taggable:!0,"tag-placeholder":"Ajouter une balise","select-label":"","selected-label":"","deselect-label":"",placeholder:"Ajouter une balise"},on:{tag:e.addTag},model:{value:e.new_tag,callback:function(t){e.new_tag=t},expression:"new_tag"}}),e._l(e.selectedTags,(function(t,s){return a("div",{key:s,staticClass:"em-ml-16 em-flex-row em-tag-preview"},[a("span",[e._v(e._s(t.label))]),a("span",{staticClass:"material-icons em-pointer em-ml-8",on:{click:function(a){return e.removeTag(t.value)}}},[e._v("close")])])}))],2),a("div",{staticClass:"em-flex-row em-mt-16"},[a("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SEPARATOR"))+" : ")]),e._l(e.separators,(function(t){return a("div",{staticClass:"em-ml-16 em-separator em-pointer",class:e.selectedSeparator===t?"em-selected-separator":"",on:{click:function(a){e.selectedSeparator=t}}},[a("span",[e._v(e._s(t))])])}))],2)])},jd=[],Gd={name:"FilesName",components:{Multiselect:ya.a},props:{name:String},data(){return{loading:!1,new_tag:"",tags:[{label:"N° de dossier",value:"[FNUM]"},{label:"Nom du candidat",value:"[APPLICANT_NAME]"},{label:"Type de document",value:"[DOCUMENT_TYPE]"}],separators:["-","_"],selectedTags:[],selectedSeparator:""}},created(){L.getSetupTags().then(e=>{if(e.status&&e.data.forEach(e=>{this.tags.find(t=>t.value=="["+e.tag+"]")||this.tags.push({label:e.description,value:"["+e.tag+"]"})}),""!==this.name){this.selectedSeparator=-1===this.name.indexOf("-")?"_":"-";let e=[];if("_"==this.selectedSeparator){const t=this.name.split("]_[");t.forEach((t,a)=>{t=t.replace(/\[/g,""),t=t.replace(/]/g,""),""!==t&&e.push(t)})}else this.name=this.name.replace(/\[/g,""),this.name=this.name.replace(/]/g,""),e=this.name.split(this.selectedSeparator);e.forEach((t,a)=>{e[a]="["+t+"]";let s=this.tags.findIndex((function(e,a){if(e.value==="["+t+"]")return!0}));-1!==s&&this.selectedTags.push(this.tags[s])})}else this.selectedSeparator="-",0===this.selectedTags.length&&this.resetName()})},methods:{addTag(e){const t={label:e,value:e};this.tags.push(t),this.selectedTags.push(t),this.updateName()},removeTag(e){let t=this.selectedTags.findIndex((function(t,a){if(t.value===e)return!0}));this.selectedTags.splice(t,1),this.updateName()},resetName(){this.selectedTags=[{label:"N° de dossier",value:"[FNUM]"},{label:"Type de document",value:"[DOCUMENT_TYPE]"}],this.updateName()},updateName(){let e="";this.selectedTags.forEach((t,a)=>{a!=this.selectedTags.length-1?e=e+t.value+this.selectedSeparator:(e+=t.value,this.$emit("updateName",e))})}},watch:{new_tag:function(e){if(""!==e){const t=e[0];this.selectedTags.push(t),this.updateName()}this.new_tag=""},selectedSeparator:function(){this.updateName()}}},Hd=Gd,zd=(a("fdce"),Object(b["a"])(Hd,$d,jd,!1,null,"ec02e80c",null)),Vd=zd.exports,Yd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS")))]),e.aspects.length<1&&e.upload?a("div",{staticClass:"em-flex-row",attrs:{id:"no-aspects"}},[a("input",{staticClass:"em-m-0",attrs:{type:"file",id:"aspect-file",accept:".xml"}}),a("div",{staticClass:"em-primary-button em-w-33 em-ml-16 em-pointer",on:{click:e.uploadAspectFile}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD")))])]):a("div",{attrs:{id:"aspects"}},[a("div",{staticClass:"em-h5 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_MAPPING")))]),e._l(e.aspects,(function(t){return a("div",{key:t.name,staticClass:"em-mb-16"},[a("div",{staticClass:"em-flex-row em-flex-space-between"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.label,expression:"aspect.label"}],attrs:{type:"text",disabled:""},domProps:{value:t.label},on:{input:function(a){a.target.composing||e.$set(t,"label",a.target.value)}}}),a("span",{staticClass:"material-icons"},[e._v("sync_alt")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.mapping,expression:"aspect.mapping"}],on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"mapping",a.target.multiple?s:s[0])},e.updateAspectMapping]}},e._l(e.tags,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.tag))])})),0)])])})),e.upload?a("div",[a("div",{staticClass:"em-h6 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD_ADD_FROM_FILE")))]),a("div",{staticClass:"em-flex-row",attrs:{id:"add-aspects-from-file"}},[a("input",{attrs:{type:"file",id:"update-aspect-file",accept:".xml"}}),a("div",{staticClass:"em-primary-button em-pointer",on:{click:e.updateAspectListFromFile}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD_ADD")))])])]):e._e()],2)])},qd=[],Jd={name:"Aspects",props:{aspects:{type:Array,default:[]},upload:{type:Boolean,default:!0}},data(){return{tags:[]}},mounted(){this.getTags()},methods:{getTags(){L.getSetupTags().then(e=>{this.tags=e.data})},uploadAspectFile(){let e=document.getElementById("aspect-file").files[0];"undefined"!==typeof e&&null!==e?L.uploadAspectFile(e).then(e=>{this.aspects=e.data.data,this.$emit("update-aspects",this.aspects)}):Swal.fire({type:"warning",title:this.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_MISSING_ASPECT_FILE"),timer:5e3,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},updateAspectListFromFile(){let e=document.getElementById("update-aspect-file").files[0];L.updateAspectListFromFile(e).then(e=>{this.aspects=e.data.data,this.$emit("update-aspects",this.aspects)})},updateAspectMapping(e){this.$emit("update-aspects",this.aspects)}}},Wd=Jd,Kd=(a("5561"),Object(b["a"])(Wd,Yd,qd,!1,null,null,null)),Xd=Kd.exports,Qd={name:"IntegrationGED",components:{FilesName:Vd,Tree:Fd,Aspects:Xd},mixins:[A],props:{site:String,level_max:{type:Number,default:3}},data(){return{loading:!1,buildedComponent:!1,emundus_tags:[],nodes:[],aspects:[],name:""}},created(){L.getConfig("ged").then(e=>{null!==e.data.data&&(this.nodes=e.data.data.tree,this.name=e.data.data.name,this.aspects=e.data.data.aspects),this.buildedComponent=!0})},methods:{addNode(e){if(null===e){let e=1;"undefined"!==typeof this.nodes[this.nodes.length-1]&&(e=this.nodes[this.nodes.length-1].id++);let t={id:e,level:1,type:0,parent:0,childrens:[]};this.nodes.push(t)}else{let t=e.level+1,a=e.id+"_1";if("undefined"!==typeof e.childrens[e.childrens.length-1]){let t=e.childrens.length+1;a=e.id+"_"+t}let s={id:a,level:t,type:0,parent:e.id,childrens:[]};e.childrens.push(s)}this.saveConfig()},deleteNode(e){this.deleteNodeById(this.nodes,e.id),this.saveConfig()},deleteNodeById(e,t){for(let a=0;a<e.length;a++){if(e[a].id===t)return void e.splice(a,1);e[a].childrens.length>0&&this.deleteNodeById(e[a].childrens,t)}},updateName(e){this.name=e,this.nodes.length>0&&this.saveConfig()},updateAspects(e){this.aspects=e,this.saveConfig()},saveConfig(){this.$emit("updateSaving",!0);let e={tree:this.nodes,name:this.name,aspects:this.aspects};L.saveConfig(e,"ged").then(()=>{this.$emit("updateLastSaving",this.formattedDate("","LT")),this.$emit("updateSaving",!1)})}}},Zd=Qd,em=Object(b["a"])(Zd,Td,Rd,!1,null,"7442d7a2",null),tm=em.exports,am={name:"Configuration",components:{IntegrationGED:tm},data(){return{loading:!1,em_params:{},integrations:[],currentIntegration:0,site:null,level_max:null}},created(){this.loading=!0,Ud.getEmundusParams().then(e=>{this.em_params=e.data.config,1===parseInt(this.em_params.external_storage_ged_alfresco_integration)&&(this.integrations.push("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO"),this.site=this.em_params.external_storage_ged_alfresco_site,this.level_max=parseInt(this.em_params.external_storage_ged_alfresco_max_level)),this.loading=!1})},methods:{updateSaving(e){this.$emit("updateSaving",e)},updateLastSaving(e){this.$emit("updateLastSaving",e)}}},sm=am,im=(a("2356"),Object(b["a"])(sm,Sd,wd,!1,null,"47f83f82",null)),nm=im.exports,om=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE")))]),a("table",[a("thead",[a("tr",[a("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_DOCTYPE")))]),a("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STATUS")))]),a("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE_TYPE")))]),a("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNCHRO")))])]),e._l(e.documents,(function(t){return a("tr",[a("td",{on:{click:function(a){return e.openAttachmentParameters(t)}}},[e._v(e._s(t.value))]),a("td"),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.sync,expression:"document.sync"}],staticClass:"em-mr-8 em-clear-dropdown",on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"sync",a.target.multiple?s:s[0])},function(a){return e.updateSync(t.id,t.sync)}]}},e._l(e.syncTypes,(function(t){return a("option",{domProps:{value:t.value}},[e._v(e._s(e.translate(t.label)))])})),0)]),a("td",[0!=t.sync?a("select",{directives:[{name:"model",rawName:"v-model",value:t.sync_method,expression:"document.sync_method"}],staticClass:"em-mr-8 em-clear-dropdown",on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"sync_method",a.target.multiple?s:s[0])},function(a){return e.updateSyncMethod(t.id,t.sync_method)}]}},[a("option",{attrs:{selected:""},domProps:{value:"write"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNC_WRITE")))]),a("option",{domProps:{value:"read"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNC_READ")))])]):e._e()])])}))],2)]),a("modal",{staticClass:"em-h-100 em-w-25",attrs:{name:"attachmentParameters",transition:"fade",delay:100,adaptive:!0,id:"modal-attachment-parameters"}},[a("AttachmentParameters",{attrs:{attachment:e.selectedDocument}})],1),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1)},lm=[],rm={sync_type:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SYNC_TYPE_LOCAL",value:"0"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SYNC_TYPE_GED",value:"1"}]},cm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-container"},[a("div",{staticClass:"em-h4"},[e._v(" "+e._s(e.attachment.value)+" ")]),1==e.attachment.sync?a("AttachmentAspectsMapping",{attrs:{attachment:e.attachment}}):e._e()],1)},dm=[],mm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-mt-16",attrs:{id:"attachment-aspects-mapping"}},[a("div",{staticClass:"em-flex-row em-flex-start",attrs:{id:"default-aspects-toggle"}},[a("div",{staticClass:"em-toggle"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.aspectsConfig.default,expression:"aspectsConfig.default"}],staticClass:"em-toggle-check",attrs:{type:"checkbox","true-value":!0,"false-value":!1,id:"default-aspects",name:"'default-aspects'"},domProps:{checked:Array.isArray(e.aspectsConfig.default)?e._i(e.aspectsConfig.default,null)>-1:e.aspectsConfig.default},on:{click:function(t){e.aspectsConfig.default=!e.aspectsConfig.default,e.saveAttachmentAspects()},change:function(t){var a=e.aspectsConfig.default,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&e.$set(e.aspectsConfig,"default",a.concat([n])):o>-1&&e.$set(e.aspectsConfig,"default",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(e.aspectsConfig,"default",i)}}}),a("strong",{staticClass:"b em-toggle-switch"}),a("strong",{staticClass:"b em-toggle-track"})]),a("label",{attrs:{for:"default-aspects"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_DEFAULT_ASPECTS_MAPPING")))])]),0==e.aspectsConfig.default?a("div",[a("Aspects",{attrs:{aspects:e.aspectsConfig.aspects,upload:!1},on:{"update-aspects":e.saveAttachmentAspects}})],1):e._e()])},um=[],pm={name:"AttachmentAspectsMapping",components:{Aspects:Xd},props:{attachment:{type:Object,required:!0}},data(){return{tags:[],aspectsConfig:{default:!0,aspects:[]}}},created(){this.getAttachmentAspectsConfig()},methods:{getAttachmentAspectsConfig(){L.getConfig("ged").then(e=>{e.data.data.aspects&&(this.aspectsConfig.aspects=e.data.data.aspects)}).then(()=>{L.getAttachmentAspectsConfig(this.attachment.id).then(e=>{const t=("string"===typeof e.data||e.data instanceof String)&&JSON.parse(e.data);t&&(this.aspectsConfig=t)})})},saveAttachmentAspects(){L.saveAttachmentAspectsConfig(this.attachment.id,this.aspectsConfig)}}},_m=pm,hm=(a("eb02"),Object(b["a"])(_m,mm,um,!1,null,null,null)),gm=hm.exports,fm={name:"AttachmentParameters",components:{AttachmentAspectsMapping:gm},props:{attachment:{type:Object,required:!0}},data(){return{syncType:""}}},vm=fm,bm=Object(b["a"])(vm,cm,dm,!1,null,null,null),Em=bm.exports,Om={name:"Storage",components:{AttachmentParameters:Em},mixins:[A],data(){return{loading:!1,documents:[],syncTypes:[],selectedDocument:{}}},mounted(){this.syncTypes=rm["sync_type"]},created(){L.getDocuments().then(e=>{this.documents=e.data.data})},methods:{updateSync(e,t){this.$emit("updateSaving",!0),L.updateSync(e,t).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},updateSyncMethod(e,t){this.$emit("updateSaving",!0),L.updateSyncMethod(e,t).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},openAttachmentParameters(e){this.selectedDocument=e,this.$modal.show("attachmentParameters")}}},Cm=Om,ym=(a("e2f4"),Object(b["a"])(Cm,om,lm,!1,null,"5489a6f0",null)),Dm=ym.exports,Mm={name:"attachmentStorage",props:{},components:{Storage:Dm,Configuration:nm},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_CONFIGURATION",index:1},{title:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE",index:2}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},Nm=Mm,Am=Object(b["a"])(Nm,Nd,Ad,!1,null,"c1ae86ac",null),Sm=Am.exports;a("bef5");var wm={name:"globalSettings",components:{StyleTool:Md,AttachmentStorage:Sm,FilesTool:nd,ContentTool:Yc,TranslationTool:Sc,EditStatus:Vr,EditTags:Qr},props:{actualLanguage:String,coordinatorAccess:Number,manyLanguages:Number},data:()=>({menuHighlight:0,currentTitle:"",langue:0,saving:!1,endSaving:!1,loading:!1,em_params:{},menus:[{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STYLE",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STYLE_DESC",icon:"style",index:1,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_CONTENT",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_CONTENT_DESC",icon:"notes",index:2,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_FILES_TOOL",description:"COM_EMUNDUS_ONBOARD_SETTINGS_FILES_TOOL_DESC",icon:"source",index:3,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TRANSLATIONS",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TRANSLATIONS_DESC",icon:"language",index:9,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_ATTACHMENT_STORAGE",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_ATTACHMENT_STORAGE_DESC",icon:"inventory_2",index:5,access:0}],modal_ready:!1}),created(){this.loading=!0,Ud.getEmundusParams().then(e=>{this.em_params=e.data.config,this.menus[0].access=void 0!=this.em_params.style?parseInt(this.em_params.style):1,this.menus[1].access=void 0!=this.em_params.content?parseInt(this.em_params.content):1,this.menus[2].access=1,this.menus[3].access=void 0!=this.em_params.translations?parseInt(this.em_params.translations):1,this.menus[4].access=void 0!=this.em_params.attachment_storage?parseInt(this.em_params.attachment_storage):0,this.loading=!1})},methods:{changeMenu(e){setTimeout(()=>{this.menuHighlight=e.index,this.currentTitle=e.title},200)}},computed:{displayedMenus(){return this.menus.filter(e=>1===e.access)}},watch:{menuHighlight:function(e){this.modal_ready=!1,setTimeout(()=>{switch(e){case 1:this.$modal.show("styleTool"),this.modal_ready=!0;break;case 2:this.$modal.show("contentTool"),this.modal_ready=!0;break;case 3:this.$modal.show("filesTool"),this.modal_ready=!0;break;case 9:this.$modal.show("translationTool"),this.modal_ready=!0;break;case 5:this.$modal.show("attachmentStorage"),this.modal_ready=!0;break;default:break}},500)}}},Um=wm,Tm=(a("23c5"),Object(b["a"])(Um,Br,Ir,!1,null,"65e9060e",null)),Rm=Tm.exports,xm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messages__coordinator_vue em-w-100"},[a("div",{staticClass:"messages__list col-md-12"},[a("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),a("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.dates,(function(t){return a("div",[a("div",{staticClass:"messages__date-section"},[a("hr"),a("p",[e._v(e._s(e.moment(t.dates).format("DD/MM/YYYY")))]),a("hr")]),e._l(e.messages,(function(s){return t.messages.includes(s.message_id)?a("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[a("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(t){e.showDate!=s.message_id?e.showDate=s.message_id:e.showDate=0}}},[a("p",[a("span",{staticClass:"messages__message-item-from"},[e._v(e._s(s.name)+" - "+e._s(e.moment(s.date_time).format("HH:mm")))])]),a("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user",domProps:{innerHTML:e._s(s.message)}}),a("p",[e.showDate==s.message_id?a("span",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(s.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),0),a("transition",{attrs:{name:"slide-up",type:"transition"}},[e.attachOpen?a("AttachDocument",{ref:"attachment",attrs:{user:e.user,fnum:e.fnum,applicant:!1},on:{pushAttachmentMessage:e.pushAttachmentMessage}}):e._e()],1),a("div",{staticClass:"messages__bottom-input"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text",rows:"1",spellcheck:"true",placeholder:e.translations.writeMessage},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.sendMessage(t))},input:function(t){t.target.composing||(e.message=t.target.value)}}})]),a("div",{staticClass:"messages__bottom-input-actions"},[a("div",{staticClass:"messages__actions_bar"},[a("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/attached.svg"},on:{click:e.attachDocument}})]),a("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")])])],1),e.loading?a("div",{staticClass:"loader"}):e._e()])},Lm=[],Bm=(a("367a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messages__vue_attach_document"},[a("span",{attrs:{id:"attach_documents"+e.fnum}},[a("div",{attrs:{name:"attach_documents"+e.fnum,transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"30%",scrollable:!0,delay:100,clickToClose:!0},on:{closed:e.beforeClose,opened:e.getTypesByCampaign}},[a("div",{staticClass:"messages__attach_content"},[e.applicant?e._e():a("ul",{staticClass:"messages__attach_actions_tabs"},[a("li",{staticClass:"messages__attach_action",class:1===e.action?"messages__attach_action__current":"",on:{click:function(t){e.action=1}}},[e._v(e._s(e.translations.sendDocument))]),a("li",{staticClass:"messages__attach_action",class:2===e.action?"messages__attach_action__current":"",on:{click:function(t){e.action=2}}},[e._v(e._s(e.translations.askDocument))])]),1===e.action?a("div",[e.applicant?a("label",[e._v(e._s(e.translations.sendDocument))]):e._e(),e.applicant&&e.types.length>0?a("div",{staticClass:"messages__attach_applicant_doc"},[a("label",{attrs:{for:"applicant_attachment_input"}},[e._v(e._s(e.translations.typeAttachment))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.attachment_input,expression:"attachment_input"}],attrs:{id:"applicant_attachment_input"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachment_input=t.target.multiple?a:a[0]}}},[a("option",{domProps:{value:0}},[e._v(e._s(e.translations.pleaseSelect))]),e._l(e.types,(function(t){return a("option",{domProps:{value:t.id}},[e._v(e._s(t.value))])}))],2)]):e._e(),a("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone_messenger","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError,"vdropzone-sending":e.sendingEvent}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[a("em",{staticClass:"fas fa-file-image"}),e._v(" "+e._s(e.translations.DropHere)+" ")])]),e.applicant?a("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")]):e._e()],1):e._e(),2===e.action?a("div",[a("label",{attrs:{for:"attachment_input"}},[e._v(e._s(e.translations.typeAttachment))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.attachment_input,expression:"attachment_input"}],attrs:{id:"attachment_input"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachment_input=t.target.multiple?a:a[0]}}},[a("option",{domProps:{value:0}},[e._v(e._s(e.translations.pleaseSelect))]),e._l(e.types,(function(t){return a("option",{domProps:{value:t.id}},[e._v(e._s(t.value))])}))],2)]):e._e()])])]),e.loading?a("div",{staticClass:"loader"}):e._e()])}),Im=[];const km=a("bef5"),Pm=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <img src="/images/emundus/messenger/file_download.svg" style="max-width: 50px"/>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var Fm={name:"AttachDocument",props:{user:Number,fnum:String,applicant:Boolean},components:{vueDropzone:Va.a},data(){return{translations:{sendDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND_DOCUMENT"),askDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_ASK_DOCUMENT"),DropHere:Joomla.JText._("COM_EMUNDUS_MESSENGER_DROP_HERE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),typeAttachment:Joomla.JText._("COM_EMUNDUS_MESSENGER_TYPE_ATTACHMENT"),pleaseSelect:Joomla.JText._("COM_EMUNDUS_PLEASE_SELECT")},types:[],message_input:"",attachment_input:0,loading:!1,action:1,dropzoneOptions:{url:"index.php?option=com_emundus&controller=messenger&task=uploaddocument&fnum="+this.fnum+"&applicant="+this.applicant,maxFilesize:10,maxFiles:5,autoProcessQueue:!1,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,previewTemplate:Pm()}}},methods:{beforeClose(){},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){this.message_input="",console.log(e),"success"==e.status&&this.$emit("pushAttachmentMessage",JSON.parse(e.xhr.response).data)},sendingEvent(e,t,a){a.append("message",this.message_input),a.append("attachment",this.attachment_input)},catchError:function(e,t,a){j.a.fire({title:Joomla.JText._("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},thumbnail:function(e,t){var a,s,i,n;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),i=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),a=0,s=i.length;a<s;a++)n=i[a],n.alt=e.name,n.style.backgroundImage='url("'+t+'")';return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},getTypesByCampaign(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getdocumentsbycampaign",params:{fnum:this.fnum,applicant:this.applicant},paramsSerializer:e=>km.stringify(e)}).then(e=>{this.types=e.data.data})},askAttachment(){p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=askattachment",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:km.stringify({fnum:this.fnum,attachment:this.attachment_input,message:this.message_input})}).then(e=>{this.$emit("pushAttachmentMessage",e.data.data)})},sendMessage(e){1===this.action?(this.applicant||(this.message_input=e),this.$refs.dropzone.processQueue()):this.attachment_input&&(this.message_input="Demande de document : ",this.message_input+=e,this.askAttachment())}}},$m=Fm,jm=(a("3d3d"),Object(b["a"])($m,Bm,Im,!1,null,"5b3e8f50",null)),Gm=jm.exports;const Hm=a("bef5");var zm={name:"MessagesCoordinator",props:{},components:{AttachDocument:Gm},data(){return{fnum:String,user:Number,dates:[],messages:[],fileSelected:0,message:"",loading:!1,showDate:0,counter:0,attachOpen:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),writeMessage:Joomla.JText._("COM_EMUNDUS_MESSENGER_WRITE_MESSAGE")}}},methods:{moment(e){return l()(e)},getMessagesByFnum(e=!0,t=!0){this.loading=e,p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getmessagesbyfnum",params:{fnum:this.fileSelected},paramsSerializer:e=>Hm.stringify(e)}).then(e=>{this.messages=e.data.data.messages,this.dates=e.data.data.dates,this.markAsRead(),"undefined"!=typeof document.getElementsByClassName("notifications-counter")[0]&&document.getElementsByClassName("notifications-counter")[0].remove(),t&&this.scrollToBottom(),this.loading=!1})},markAsRead(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=markasread",params:{fnum:this.fileSelected},paramsSerializer:e=>Hm.stringify(e)}).then(e=>{this.$emit("removeNotifications",e.data.data)})},sendMessage(e){"undefined"!=typeof e&&e.stopImmediatePropagation(),this.attachOpen?(this.$refs.attachment.sendMessage(this.message),this.message=""):""!==this.message.trim()&&p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Hm.stringify({message:this.message,fnum:this.fileSelected})}).then(e=>{this.message="",this.pushToDatesArray(e.data),this.scrollToBottom()})},pushToDatesArray(e){var t=!1,a=e.date_time.split(" ")[0];if(this.dates.forEach((s,i)=>{s.dates==a&&(this.dates[i].messages.push(e.message_id),t=!0)}),!t){var s={dates:this.moment().format("YYYY-MM-DD"),messages:[]};s.messages.push(e.message_id),this.dates.push(s)}this.messages.push(e)},scrollToBottom(){setTimeout(()=>{const e=document.getElementsByClassName("messages__list-block")[0];e.scrollTop=e.scrollHeight},500)},attachDocument(){this.attachOpen=!this.attachOpen,setTimeout(()=>{this.attachOpen&&this.$refs.attachment.getTypesByCampaign()},500)},pushAttachmentMessage(e){this.pushToDatesArray(e),this.scrollToBottom(),this.attachDocument()}},created(){this.fnum=this.$store.getters["global/datas"].fnum.value,this.user=this.$store.getters["global/datas"].user.value,"undefined"!=typeof this.fnum&&(this.fileSelected=this.fnum,this.getMessagesByFnum(),setInterval(()=>{this.getMessagesByFnum(!1,!1)},2e4))},watch:{fileSelected:function(){this.getMessagesByFnum(!0)}}},Vm=zm,Ym=(a("11fe"),Object(b["a"])(Vm,xm,Lm,!1,null,null,null)),qm=Ym.exports,Jm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messages__vue"},[a("span",{attrs:{id:"messages"}},[a("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"90%",width:"90%",scrollable:!0,delay:100,clickToClose:!0,draggable:".drag-window"},on:{closed:e.beforeClose,opened:e.getFilesByUser}},[a("div",{staticClass:"em-flex-row em-flex-align-start em-w-100 em-h-100 em-small-flex-column"},[a("div",{staticClass:"messages__campaigns-list"},e._l(e.files,(function(t){return a("div",{staticClass:"messages__block",class:t.fnum==e.fileSelected?"messages__active-campaign":"",on:{click:function(a){e.fileSelected=t.fnum}}},[a("div",{staticClass:"messages__campaign-block em-w-100"},[a("div",{staticClass:"em-w-100"},[a("p",{staticClass:"messages__campaigns_title"},[e._v(e._s(t.label))]),a("p",{staticClass:"messages__campaigns_fnum messages__campaigns_title"},[e._v("N° "+e._s(t.fnum))]),a("p",{staticClass:"messages__campaigns_fnum messages__campaigns_title"},[e._v(e._s(t.year))])])]),a("div")])})),0),a("div",{staticClass:"messages__campaigns-list-select"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.fileSelected,expression:"fileSelected"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.fileSelected=t.target.multiple?a:a[0]}}},e._l(e.files,(function(t){return a("option",{domProps:{value:t.fnum}},[e._v(e._s(t.label)+" - "+e._s(t.fnum))])})),0)]),a("div",{staticClass:"messages__list em-w-100 em-h-100"},[a("div",{staticClass:"message__header"},[a("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),a("i",{staticClass:"fas fa-times pointer",on:{click:function(t){return e.$modal.hide("messages")}}})]),a("div",{staticClass:"messages__list-block em-h-80",attrs:{id:"messages__list"}},[e._l(e.dates,(function(t){return a("div",[a("div",{staticClass:"messages__date-section"},[a("hr"),a("p",[e._v(e._s(e.moment(t.dates).format("DD/MM/YYYY")))]),a("hr")]),e._l(e.messages,(function(s){return t.messages.includes(s.message_id)?a("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[a("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(t){e.showDate!=s.message_id?e.showDate=s.message_id:e.showDate=0}}},[a("p",[a("span",{staticClass:"messages__message-item-from"},[0===e.anonymous&&e.user!=s.user_id_from?a("span",[e._v(e._s(s.name)+" - ")]):e._e(),e.user==s.user_id_from?a("span",[e._v(e._s(s.name)+" - ")]):e._e(),e._v(" "+e._s(e.moment(s.date_time).format("HH:mm"))+" ")])]),a("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user",domProps:{innerHTML:e._s(s.message)}}),a("p",[e.showDate==s.message_id?a("span",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(s.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),a("transition",{attrs:{name:"slide-up",type:"transition"}},[e.attachOpen?a("AttachDocument",{ref:"attachment",attrs:{user:e.user,fnum:e.fileSelected,applicant:!0},on:{pushAttachmentMessage:e.pushAttachmentMessage}}):e._e()],1)],2),a("div",{staticStyle:{position:"sticky",bottom:"15px",padding:"0 15px","margin-right":"15px"}},[a("div",{staticClass:"messages__bottom-input"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text",rows:"1",disabled:e.send_progress,spellcheck:"true",placeholder:e.translations.writeMessage},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.sendMessage(t))},input:function(t){t.target.composing||(e.message=t.target.value)}}})]),a("div",{staticClass:"messages__bottom-input-actions"},[a("div",{staticClass:"messages__actions_bar"},[a("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/attached.svg"},on:{click:e.attachDocument}})]),a("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")])])])])])])],1),e.loading?a("div",{staticClass:"loader"}):e._e()])},Wm=[];const Km=a("bef5");var Xm={name:"Messages",props:{user:Number,fnum:String,notifications:Object},components:{AttachDocument:Gm},data(){return{dates:[],messages:[],anonymous:0,files:[],fileSelected:0,message:"",loading:!1,interval:0,showDate:0,attachOpen:!1,send_progress:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),writeMessage:Joomla.JText._("COM_EMUNDUS_MESSENGER_WRITE_MESSAGE")}}},methods:{moment(e){return l()(e)},beforeClose(){clearInterval(this.interval)},getFilesByUser(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getfilesbyuser"}).then(e=>{this.files=e.data.data,""!=this.fnum?this.fileSelected=this.fnum:this.fileSelected=this.files[0].fnum,this.getMessagesByFnum(!0),this.interval=setInterval(()=>{this.getMessagesByFnum(!1,!1)},2e4)})},getMessagesByFnum(e=!0,t=!0){this.loading=e,p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getmessagesbyfnum",params:{fnum:this.fileSelected},paramsSerializer:e=>Km.stringify(e)}).then(e=>{this.messages=e.data.data.messages,this.dates=e.data.data.dates,this.anonymous=parseInt(e.data.data.anonymous),this.markAsRead(),t&&this.scrollToBottom(),this.loading=!1})},markAsRead(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=markasread",params:{fnum:this.fileSelected},paramsSerializer:e=>Km.stringify(e)}).then(e=>{this.$emit("removeNotifications",e.data.data)})},sendMessage(e){"undefined"!=typeof e&&e.stopImmediatePropagation(),""===this.message.trim()||this.send_progress||(this.send_progress=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Km.stringify({message:this.message,fnum:this.fileSelected})}).then(e=>{this.message="",this.send_progress=!1,this.pushToDatesArray(e.data),this.scrollToBottom()}))},pushToDatesArray(e){var t=!1,a=e.date_time.split(" ")[0];if(this.dates.forEach((s,i)=>{s.dates==a&&(this.dates[i].messages.push(e.message_id),t=!0)}),!t){var s={dates:this.moment().format("YYYY-MM-DD"),messages:[]};s.messages.push(e.message_id),this.dates.push(s)}this.messages.push(e)},scrollToBottom(){setTimeout(()=>{const e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight},500)},attachDocument(){this.attachOpen=!this.attachOpen,this.scrollToBottom(),setTimeout(()=>{this.attachOpen&&this.$refs.attachment.getTypesByCampaign()},500)},pushAttachmentMessage(e){this.pushToDatesArray(e),this.scrollToBottom(),this.attachOpen=!this.attachOpen}},watch:{fileSelected:function(){this.getMessagesByFnum(!0)}}},Qm=Xm,Zm=(a("092e"),Object(b["a"])(Qm,Jm,Wm,!1,null,null,null)),eu=Zm.exports,tu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.user?a("div",{staticClass:"em-w-90 em-container-profile-view em-mt-24"},[1==e.isapplicant?a("div",{staticClass:"em-mb-32",staticStyle:{width:"max-content"}},[a("a",{staticClass:"em-back-button em-pointer",attrs:{title:e.translate("COM_EMUNDUS_USERS_BACK_TO_FILES"),href:"/"}},[a("span",{staticClass:"material-icons em-mr-4"},[e._v("navigate_before")]),e._v(e._s(e.translate("COM_EMUNDUS_USERS_BACK_TO_FILES")))])]):e._e(),a("div",{staticClass:"em-container-profile-view-pict em-flex-row em-flex-space-between em-mb-44 em-small-flex-column em-small-align-items-start"},[a("ProfilePicture",{attrs:{user:e.user},on:{loading:e.updateLoading}})],1),a("div",{staticClass:"em-container-profile-view-intro em-flex-row em-flex-space-between em-mb-24 em-small-flex-column em-small-align-items-start"},[a("span",{staticClass:"em-font-size-14 em-applicant-text-color em-applicant-default-font"},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_TIP")))])]),a("Form",{attrs:{user:e.user},on:{input:e.updateValue}}),a("div",{staticClass:"em-float-right em-w-auto",staticStyle:{"align-items":"unset"}},[a("button",{staticClass:"em-w-auto em-mt-xs-8",class:1==e.isapplicant?"btn btn-primary":"em-primary-button",on:{click:e.saveProfile}},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_SAVE")))])]),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()],1):e._e()},au=[],su=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-flex-row em-small-flex-column em-small-align-items-start"},[a("div",{key:e.dynamicPP,staticClass:"em-profile-picture-big em-pointer",style:e.background_pp,on:{click:function(t){return e.openBrowser()},mouseover:function(t){e.displayEdit=!0},mouseleave:function(t){e.displayEdit=!1}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.displayEdit,expression:"displayEdit"}],staticClass:"em-flex-row"},[a("span",{staticClass:"material-icons-outlined em-mr-8"},[e._v("edit")]),e._v(" "+e._s(e.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE"))+" ")])]),a("div",{staticClass:"em-ml-32 em-m-xs-0 em-flex-column em-flex-col-start em-mt-xs-8"},[a("span",{staticClass:"em-h3"},[e._v(e._s(e.user.lastname.toUpperCase())+" "+e._s(e.user.firstname.charAt(0).toUpperCase()+e.user.firstname.slice(1)))])])])},iu=[],nu={name:"ProfilePicture",props:{user:{type:Object,required:!0}},data:()=>({dynamicPP:0,displayEdit:!1,profile_picture:null,background_pp:"background-image:url("+window.location.origin+"/media/com_emundus/images/profile/default-profile.jpg)"}),created(){this.profile_picture=window.location.origin+"/"+this.$props.user.profile_picture,null!=this.$props.user.profile_picture&&(this.background_pp="background-image:url("+window.location.origin+"/"+this.$props.user.profile_picture+")")},methods:{openBrowser(){let e=document.createElement("input"),t=["image/jpeg","image/png","image/gif","image/jpeg"];e.type="file",e.accept=".png, .jpg, .jpeg, .gif",e.onchange=a=>{let s=Array.from(e.files),i=!1,n="",o="";s[0].size>2097152&&(n="COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_ERROR_TITLE",o="COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_ERROR_TEXT",i=!0),t.includes(s[0].type)||(n="COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_ERROR_TITLE",o="COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_WRONG_TYPE_TEXT",i=!0),i?Swal.fire({title:this.translate(n),text:this.translate(o),type:"error",confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),timer:4e3,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}):this.updateProfilePicture(s[0])},e.click()},updateProfilePicture(e){this.$emit("loading",!0),D.updateProfilePicture(e).then(e=>{if(e.data.status){const t=new Date,a=window.location.origin+"/"+e.data.profile_picture+"?"+t.getTime();this.profile_picture=a,this.background_pp="background-image:url("+a+")",document.getElementById("userDropdownLabel").style.backgroundImage="url("+a+")"}else Swal.fire({title:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_ERROR_TITLE"),text:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PICTURE_ERROR_UPDATE_TEXT"),type:"error",confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),timer:4e3,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}});this.$emit("loading",!1)})}},watch:{profile_picture:function(e){this.dynamicPP++}}},ou=nu,lu=(a("2d28"),Object(b["a"])(ou,su,iu,!1,null,null,null)),ru=lu.exports,cu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?e._e():a("form",{staticClass:"em-form em-container-profile-view-form em-grid-2 em-small-flex-column",attrs:{name:"form_"+e.formId,id:"form_"+e.formId}},[e._l(e.groups,(function(t){return a("Section",{attrs:{group:t,user:e.user},on:{input:e.updateValue}})})),a("Attachments"),"internal"==e.user.login_type?a("div",{staticClass:"fabrikGroup"},[a("legend",[e._v(e._s(e.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PASSWORD_TITLE")))]),a("a",{staticClass:"em-mt-8 em-w-auto btn btn-danger",attrs:{href:"/index.php?option=com_users&view=profile&layout=edit"}},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_PASSWORD")))])]):e._e()],2),e.loading?a("div",{staticClass:"em-page-loader"}):e._e()])},du=[],mu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.attachments_allowed.length>0?a("div",{staticClass:"fabrikGroup em-container-profile-view-attach"},[a("div",{staticClass:"em-flex-row em-flex-space-between em-small-flex-column"},[a("p",{staticClass:"em-h3"},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS")))]),e.allowedAttachmentsICanAdd.length>0?a("button",{staticClass:"em-w-auto",class:1==e.isapplicant?"btn btn-danger":"em-secondary-button",style:e.showform?"opacity: 0":"opacity: 1",attrs:{type:"button"},on:{click:function(t){e.showform=!0}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_ADD"))+" ")]):e._e()]),e.intro.length>0?a("p",{staticClass:"em-mt-8"},[e._v(e._s(e.intro))]):e._e(),a("transition",{attrs:{name:"slide-down",type:"transition"}},[e.showform?a("div",[a("hr"),a("div",{staticClass:"em-flex-col-end"},[a("button",{staticClass:"em-pointer em-transparent-button",attrs:{type:"button"},on:{click:function(t){e.showform=!1}}},[a("span",{staticClass:"material-icons"},[e._v("close")])])]),a("div",{staticClass:"em-mb-16"},[a("label",{staticClass:"fabrikLabel"},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_DOCUMENT_TYPE")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.attachment_id,expression:"form.attachment_id"}],staticClass:"em-w-100 em-mt-8",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"attachment_id",t.target.multiple?a:a[0])}}},[a("option",{domProps:{value:0}},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_PLEASE_SELECT")))]),e._l(e.allowedAttachmentsICanAdd,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.value))])}))],2)]),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.form.attachment_id,expression:"form.attachment_id != 0"}],staticClass:"em-mb-16"},[a("vue-dropzone",{key:e.reloadDropzone,ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError,"vdropzone-sending":e.addAdditionnalParams}},[a("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_DROP_HERE"))+" ")])])],1),a("hr")]):e._e()]),a("div",{staticClass:"em-mt-16"},e._l(e.attachments,(function(t){return a("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[a("div",[a("p",{staticClass:"em-label"},[e._v(e._s(t.value))]),e.isDisplayValidationState&&null==t.expires_date?a("span",{staticClass:"em-help-text"},[e._v(" "+e._s(e.translate(e.displayValidationState(t.validation)))+" ")]):e._e(),a("span",{staticClass:"em-help-text"},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_DROP_DATE"))+e._s(e.formattedDate(t.date_time,"LL")))]),null!=t.expires_date?a("span",{staticClass:"em-expires-text em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_EXPIRES_DATE"))+e._s(e.formattedDate(t.expires_date,"LL")))]):e._e()]),a("div",{staticClass:"em-flew-row em-small-flex-column"},[a("a",{attrs:{href:"/"+t.filename,download:"",target:"_blank"}},[a("span",{staticClass:"material-icons em-material-icons-download"},[e._v("file_download")])]),a("a",{staticClass:"em-ml-8 em-m-xs-0 em-pointer",on:{click:function(a){return e.deleteAttachment(t.default_id,t.filename)}}},[a("span",{staticClass:"material-icons em-material-icons-download em-red-500-color"},[e._v("delete")])])])])})),0)],1):e._e()},uu=[];const pu=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var _u={name:"Attachments",components:{vueDropzone:Va.a},props:{},mixins:[A],data:()=>({showform:!1,reloadDropzone:0,isExpiresDateDisplay:!1,attachments:[],attachments_allowed:[],form:{attachment_id:0,file:null},dropzoneOptions:{url:"/index.php?option=com_emundus&controller=users&task=uploaddefaultattachment",maxFilesize:10,maxFiles:1,acceptedFiles:"application/pdf",autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,previewTemplate:pu()}}),created(){g.getProfileAttachmentsAllowed().then(e=>{this.attachments_allowed=e.attachments,this.attachments_allowed.length>0&&g.getProfileAttachments().then(e=>{this.attachments=e.attachments})}),this.displayExpiresDate()},methods:{afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete(e){"success"===e.status&&(this.showform=!1,g.getProfileAttachments().then(e=>{this.attachments=e.attachments}))},catchError(e,t,a){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},addAdditionnalParams(e,t,a){let s=this.attachments_allowed.find(e=>e.id==this.form.attachment_id);a.append("attachment_id",this.form.attachment_id),a.append("attachment_lbl",s.lbl)},updateDropzoneAcceptedFiles(e){if("undefined"!==typeof e){let t=e.split(";"),a=[];for(let e=0;e<t.length;e++){let s=this.getMimeTypeFromExtension(t[e]);!1!==s&&a.push(s)}this.$refs.dropzone.options.acceptedFiles=a.join(","),this.reloadDropzone++}},deleteAttachment(e,t){j.a.fire({title:this.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_DELETE"),text:this.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_DELETE_CONFIRM"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(a=>{a.value&&g.deleteProfileAttachment(e,t).then(t=>{1==t.deleted&&(j.a.fire({title:this.translate("COM_EMUNDUS_USERS_MY_DOCUMENTS_SUCCESS_DELETED"),type:"success",showCancelButton:!1,showConfirmButton:!1,timer:2e3,customClass:{title:"em-swal-title"}}),this.attachments.splice(this.attachments.findIndex(t=>t.default_id===e),1))})})},displayExpiresDate(){g.isExpiresDateDisplayed().then(e=>{this.isExpiresDateDisplay=e.display_expires_date})},displayValidationState(e){switch(e){case"0":return"COM_EMUNDUS_USERS_MY_DOCUMENTS_STATE_WAITING";case"1":return"COM_EMUNDUS_USERS_MY_DOCUMENTS_STATE_OK";case"-1":return"COM_EMUNDUS_USERS_MY_DOCUMENTS_STATE_INVALID";default:}}},watch:{"form.attachment_id":function(e){if(0!=e){let t=this.attachments_allowed.find(t=>t.id==e);t&&this.updateDropzoneAcceptedFiles(t.allowed_types)}}},computed:{isapplicant(){return this.$store.getters["global/datas"].isapplicant.value},intro(){return this.$store.getters["global/datas"].attachmentintro.value},isDisplayValidationState(){return"0"!=this.$store.getters["global/datas"].displayvalidationstate.value},allowedAttachmentsICanAdd(){if(this.attachments.length<1)return this.attachments_allowed;{let e=[],t={};return this.attachments.forEach(e=>{void 0!==t[e.id]&&null!==t[e.id]?t[e.id]++:t[e.id]=1}),this.attachments_allowed.forEach(a=>{(a.nbmax>t[a.id]||void 0===t[a.id])&&e.push(a)}),e}}}},hu=_u,gu=(a("1353"),Object(b["a"])(hu,mu,uu,!1,null,"5cd3f7f8",null)),fu=gu.exports,vu={name:"Form",components:{Attachments:fu,Section:Ei},props:{user:Object},data:()=>({formId:null,groups:[],noFormFound:!1,loading:!1}),created(){this.loading=!0,D.getProfileForm().then(e=>{this.formId=parseInt(e.form),0===this.formId?(this.noFormFound=!0,this.loading=!1):D.getProfileGroups(this.formId).then(e=>{this.groups=e.groups,this.loading=!1})})},methods:{updateValue(e){this.$emit("input",e)}}},bu=vu,Eu=(a("268f"),Object(b["a"])(bu,cu,du,!1,null,"61a92160",null)),Ou=Eu.exports,Cu={name:"Edit",components:{Form:Ou,ProfilePicture:ru},data:()=>({user:null,loading:!1}),created(){this.getCurrentUser()},methods:{getCurrentUser(){this.loading=!0,D.getUserById().then(e=>{this.user=e.user[0],this.loading=!1})},saveProfile(){let e=document.querySelector("[name^='form_']");e.checkValidity()?(this.loading=!0,D.saveUser(this.user).then(e=>{this.loading=!1,!0===e.data.status?j.a.fire({title:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_SAVE_SUCCESS"),text:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_SAVE_SUCCESS_TEXT"),type:"success",showCancelButton:!1,showConfirmButton:!1,customClass:{title:"em-swal-title"},timer:2e3}):j.a.fire({title:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_SAVE_FAILED"),text:this.translate("COM_EMUNDUS_USERS_EDIT_PROFILE_SAVE_FAILED_TEXT"),type:"error",showCancelButton:!1,showConfirmButton:!1,customClass:{title:"em-swal-title"},timer:3e3})})):e.reportValidity()},updateValue(e){this.user[e.name]=e.value},updateLoading(e){this.loading=e}},computed:{isapplicant(){return this.$store.getters["global/datas"].isapplicant.value}}},yu=Cu,Du=Object(b["a"])(yu,tu,au,!1,null,"70b09011",null),Mu=Du.exports,Nu={props:{datas:NamedNodeMap,currentLanguage:String,shortLang:String,manyLanguages:String,coordinatorAccess:String,sysadminAccess:String,defaultLang:{type:String,default:"fr"},component:{type:String,required:!0},data:{type:Object,default:()=>({})}},components:{Attachments:V,list:It,addcampaign:ba,addformnextcampaign:En,addemail:xa,formbuilder:Fl,evaluationbuilder:Lr,settings:Rm,messagescoordinator:qm,messages:eu,editprofile:Mu,Files:be},created(){"attachments"===this.$props.component&&F.isDataAnonymized().then(e=>{!1!==e.status&&this.$store.dispatch("global/setAnonyme",e.anonyme)}),this.data.attachments&&(this.data.attachments=JSON.parse(atob(this.data.attachments))),"undefined"!=typeof this.$props.datas&&this.$store.commit("global/initDatas",this.$props.datas),"undefined"!=typeof this.$props.currentLanguage?(this.$store.commit("global/initCurrentLanguage",this.$props.currentLanguage),l.a.locale(this.$store.state.global.currentLanguage)):this.$store.commit("global/initCurrentLanguage","fr"),"undefined"!=typeof this.$props.shortLang&&this.$store.commit("global/initShortLang",this.$props.shortLang),"undefined"!=typeof this.$props.manyLanguages&&this.$store.commit("global/initManyLanguages",this.$props.manyLanguages),"undefined"!=typeof this.$props.defaultLang&&this.$store.commit("global/initDefaultLang",this.$props.defaultLang),"undefined"!=typeof this.$props.coordinatorAccess&&this.$store.commit("global/initCoordinatorAccess",this.$props.coordinatorAccess),"undefined"!=typeof this.$props.coordinatorAccess&&this.$store.commit("global/initSysadminAccess",this.$props.sysadminAccess)},mounted(){this.data.base&&this.$store.dispatch("attachment/setAttachmentPath",this.data.base+"/images/emundus/files/")}},Au=Nu,Su=(a("5c0b"),Object(b["a"])(Au,i,n,!1,null,null,null)),wu=Su.exports,Uu=a("209f"),Tu=a.n(Uu),Ru=a("3332"),xu=a("4859"),Lu=(a("9e26"),a("c2ca")),Bu=a("66d6"),Iu=a.n(Bu),ku=a("6db0"),Pu=a.n(ku),Fu=a("7cdb"),$u=a("94ea");const ju={users:{},currentUser:0,displayedUser:0,rights:{}},Gu={},Hu={setUsers({commit:e},t){e("setUser",t)},setCurrentUser({commit:e},t){e("setCurrentUser",t)},setDisplayedUser({commit:e},t){e("setDisplayedUser",t)},setAccessRights({commit:e},t){e("setAccessRights",t)}},zu={setUser(e,t){t&&t.length>0&&t.forEach(t=>{e.users[t.user_id]=t})},setCurrentUser(e,t){e.currentUser=t},setDisplayedUser(e,t){e.displayedUser=t},setAccessRights(e,t){e.rights[t.fnum]=t.rights}};var Vu={namespaced:!0,state:ju,getters:Gu,actions:Hu,mutations:zu};const Yu={attachmentPath:"images/emundus/files/",attachments:{},selectedAttachment:{},previews:{},categories:{},checkedAttachments:[]},qu={},Ju={setAttachments({commit:e},t){e("setAttachments",t)},setAttachmentsOfFnum({commit:e},t){e("setAttachmentsOfFnum",t)},updateAttachmentOfFnum({commit:e},t){e("updateAttachmentOfFnum",t)},setSelectedAttachment({commit:e},t){e("setSelectedAttachment",t)},setPreview({commit:e},t){e("setPreview",t)},setCategories({commit:e},t){e("setCategories",t)},setAttachmentPath({commit:e},t){e("setAttachmentPath",t)},setCheckedAttachments({commit:e},t){e("setCheckedAttachments",t)}},Wu={setAttachments(e,t){e.attachments=t},setAttachmentsOfFnum(e,t){e.attachments[t.fnum]=t.attachments},updateAttachmentOfFnum(e,t){const a=e.attachments[t.fnum].findIndex(e=>e.aid===t.attachment.aid);e.attachments[t.fnum][a]=t.attachment},setSelectedAttachment(e,t){e.selectedAttachment=t},setPreview(e,t){e.previews[t.id]=t.preview},setCategories(e,t){e.categories=t},setAttachmentPath(e,t){e.attachmentPath=t},setCheckedAttachments(e,t){e.checkedAttachments=t}};var Ku={namespaced:!0,state:Yu,getters:qu,actions:Ju,mutations:Wu};const Xu={list:[],selectedItems:[],formsAccess:[]},Qu={list:e=>e.list,formsAccess:e=>e.formsAccess,selectedItems:e=>e.selectedItems,isSelected:e=>t=>e.selectedItems.includes(t),isSomething:e=>Array.isArray(e.selectedItems)&&e.selectedItems.length},Zu={deleteSelected({commit:e,state:t},a){a.forEach(t=>{e("deleteSelected",t)})}},ep={selectItem(e,t){return e.selectedItems.includes(t)?e.selectedItems.splice(e.selectedItems.indexOf(t),1):e.selectedItems.push(t),e.selectedItems},resetSelectedItemsList(e){e.selectedItems=[]},listUpdate(e,t){e.list=t},formsAccessUpdate(e,t){e.formsAccess=t},listInsert(e,t){t.forEach(t=>{e.list.push(t)})},publish(e,t){e.list.forEach((a,s)=>{t.includes(a.id)&&(e.list[s].published=1)})},unpublish(e,t){e.list.forEach((a,s)=>{t.includes(a.id)&&(e.list[s].published=0)})},deleteSelected(e,t){e.list.some((a,s)=>{if(t==a.id)return e.list.splice(s,1),!0})}};var tp={namespaced:!0,state:Xu,getters:Qu,actions:Zu,mutations:ep};const ap={fnums:[]},sp={},ip={},np={};var op={namespaced:!0,state:ap,getters:sp,actions:ip,mutations:np};const lp={lastSave:null,pages:null,documentModels:[]},rp={getLastSave:e=>e.lastSave,getPages:e=>e.pages,getDocumentModels:e=>e.documentModels},cp={updateLastSave({commit:e},t){e("updateLastSave",t)},updateDocumentModels({commit:e},t){e("updateDocumentModels",t)}},dp={updateLastSave(e,t){e.lastSave=t},updateDocumentModels(e,t){e.documentModels=t}};var mp={namespaced:!0,state:lp,getters:rp,actions:cp,mutations:dp};const up={unsavedChanges:!1,allowPinnedCampaign:!1,pinned:0},pp={unsavedChanges:e=>e.unsavedChanges,pinned:e=>e.pinned,allowPinnedCampaign:e=>e.allowPinnedCampaign},_p={setUnsavedChanges({commit:e},t){e("setUnsavedChanges",t)},setPinned({commit:e},t){e("setPinned",t)},setAllowPinnedCampaign({commit:e},t){e("setAllowPinnedCampaign",t)}},hp={setUnsavedChanges(e,t){e.unsavedChanges=t},setPinned(e,t){e.pinned=t},setAllowPinnedCampaign(e,t){e.allowPinnedCampaign=t}};var gp={namespaced:!0,state:up,getters:pp,actions:_p,mutations:hp};s["default"].use($u["a"]);var fp=new $u["a"].Store({modules:{global:Sa,user:Vu,attachment:Ku,file:op,lists:tp,formBuilder:mp,campaign:gp}}),vp={data(){return{shortDefaultLang:"fr"}},beforeMount(){null!==this.$data.translations&&"undefined"!==typeof this.$data.translations&&Object.entries(this.$data.translations).forEach(([e,t])=>{this.$data.translations[e]=this.translate(t)})},mounted(){this.shortDefaultLang=this.$store.getters["global/defaultLang"].substring(0,2)},methods:{translate(e){return void 0!=typeof e&&null!=e?Joomla.JText._(e)?Joomla.JText._(e):e:""}}};const bp=["click"];function Ep({event:e,el:t,handler:a,middleware:s}){const i=e.target!==t&&!t.contains(e.target);return i&&s(e,t)?a(e,t):null}const Op=new Map;function Cp(e){return t=>{e.forEach(({event:e,handler:a})=>{document[t+"EventListener"](e,a,!0)})}}function yp(e){const t="function"===typeof e;if(!t&&"object"!==typeof e)throw new Error(`v-click-outside: Binding value should be a function or an object, ${typeof bindingValue} given`);return{handler:t?e:e.handler,middleware:e.middleware||(()=>!0)}}function Dp(e,{el:t,handler:a,middleware:s}){return e.map(e=>({event:e,handler:e=>Ep({event:e,el:t,handler:a,middleware:s})}))}function Mp(e,{value:t}){const{handler:a,middleware:s}=yp(t),i=Dp(bp,{el:e,handler:a,middleware:s});Op.set(e,i),Cp(i)("add")}function Np(e){const t=Op.get(e);Cp(t)("remove"),Op.delete(e)}const Ap={bind:Mp,unbind:Np};var Sp=Ap;s["default"].config.productionTip=!0,s["default"].config.devtools=!0,s["default"].component("v-popover",Ru["b"]),s["default"].component("table-component",Lu["TableComponent"]),s["default"].component("table-column",Lu["TableColumn"]),s["default"].use(Iu.a,{velocity:Pu.a}),s["default"].use(Tu.a),s["default"].use(xu),s["default"].use(Fu["a"]),s["default"].use($u["a"]),s["default"].mixin(vp),s["default"].directive("tooltip",Ru["c"]),s["default"].directive("close-popover",Ru["a"]),s["default"].directive("click-outside",Sp);let wp="",Up={},Tp="";const Rp=document.getElementById("em-application-attachment"),xp=document.getElementById("em-files");if(Rp||xp){let e=null;Rp?(e=Rp,Tp="attachments",wp="#em-application-attachment"):xp&&(e=xp,Tp="files",wp="#em-files"),null!==e&&(Array.prototype.slice.call(e.attributes).forEach((function(e){Up[e.name]=e.value})),new s["default"]({el:wp,store:fp,render(e){return e(wu,{props:{component:Tp,data:Up}})}}))}else document.getElementById("em-component-vue")&&new s["default"]({el:"#em-component-vue",store:fp,render(e){return e(wu,{props:{component:this.$el.attributes.component.value,datas:this.$el.attributes,currentLanguage:this.$el.attributes.currentLanguage.value,shortLang:this.$el.attributes.shortLang.value,manyLanguages:this.$el.attributes.manyLanguages.value,defaultLang:this.$el.attributes.defaultLang?this.$el.attributes.defaultLang.value:this.$el.attributes.currentLanguage.value,coordinatorAccess:this.$el.attributes.coordinatorAccess.value,sysadminAccess:this.$el.attributes.sysadminAccess.value}})}})},5923:function(e,t,a){"use strict";a("4d24")},"5c0b":function(e,t,a){"use strict";a("4dc7")},"68a2":function(e,t,a){"use strict";a("2bb7")},"6a28":function(e,t,a){"use strict";a("fd2f")},"6c87":function(e,t,a){"use strict";a("c9bb")},"6e07":function(e,t,a){"use strict";a("cef5")},"6e2f":function(e,t,a){},"6eca":function(e,t,a){},7136:function(e,t,a){"use strict";a("b9a4")},"739b":function(e,t,a){},"76e9":function(e,t,a){"use strict";a("49e9")},"7c99":function(e,t,a){},"7de6":function(e,t,a){"use strict";a("2a7e")},"7e56":function(e,t,a){"use strict";a("3ec9")},"7f9a":function(e,t,a){"use strict";a("1024")},"80ea":function(e,t,a){"use strict";a("1106")},8116:function(e,t,a){"use strict";a("c9ca")},"82b5":function(e,t,a){"use strict";a("4f82")},"82f8":function(e,t,a){"use strict";a("2fe3")},"84e7":function(e,t,a){"use strict";a("4f19")},"85a0":function(e,t,a){},8602:function(e,t,a){},8747:function(e,t,a){"use strict";a("4eb7")},"8a9a":function(e,t,a){"use strict";a("c424")},"8ab9":function(e,t,a){},"8b0e":function(e,t,a){},"8d5f":function(e,t,a){},"8dd9":function(e,t,a){},"963a":function(e,t,a){},"966e":function(e,t,a){"use strict";a("a5d8")},"997f":function(e,t,a){},"9ac1":function(e){e.exports=JSON.parse('[{"title":"COM_EMUNDUS_ONBOARD_PDF_DOCUMENTS","value":"pdf"},{"title":"COM_EMUNDUS_ONBOARD_PICTURES_DOCUMENTS","value":"jpeg;jpg;png;gif"},{"title":"COM_EMUNDUS_ONBOARD_OFFICE_DOCUMENTS","value":"doc;docx;odt;ppt;pptx"},{"title":"COM_EMUNDUS_ONBOARD_EXCEL_DOCUMENTS","value":"xls;xlsx;odf"},{"title":"COM_EMUNDUS_FORM_BUILDER_FORMATS_AUDIO","value":"mp3"},{"title":"COM_EMUNDUS_FORM_BUILDER_FORMATS_VIDEO","value":"mp4"}]')},"9d7a":function(e,t,a){},a10b:function(e,t,a){"use strict";a("3923")},a3e0:function(e,t,a){"use strict";a("fcb1")},a4a5:function(e,t,a){"use strict";a("f3b5")},a4bc:function(e,t,a){},a5d8:function(e,t,a){},a92f:function(e,t,a){},adea:function(e,t,a){"use strict";a("d7d4")},aec6:function(e,t,a){},aeea:function(e,t,a){"use strict";a("3d63")},b1bf:function(e,t,a){"use strict";a("8dd9")},b42f:function(e,t,a){"use strict";a("d9b5")},b9a4:function(e,t,a){},bba0:function(e,t,a){},bce3:function(e,t,a){"use strict";a("8b0e")},bcfd:function(e,t,a){},bd91:function(e,t,a){"use strict";a("e217")},bf66:function(e,t,a){},c10e:function(e,t,a){},c185:function(e,t,a){"use strict";a("997f")},c424:function(e,t,a){},c4fa:function(e,t,a){"use strict";a("cf9a")},c9bb:function(e,t,a){},c9ca:function(e,t,a){},ca8f:function(e,t,a){"use strict";a("4298")},cbac:function(e,t,a){},cc04:function(e,t,a){},cc32:function(e,t,a){"use strict";a("aec6")},cef5:function(e,t,a){},cf9a:function(e,t,a){},d17e:function(e,t,a){"use strict";a("0619")},d363:function(e,t,a){"use strict";a("dcaf")},d734:function(e,t,a){"use strict";a("e8d5")},d7d4:function(e,t,a){},d9b5:function(e,t,a){},dbc3:function(e,t,a){"use strict";a("4dec")},dcaf:function(e,t,a){},dcb5:function(e,t,a){},de70:function(e,t,a){"use strict";a("090a")},e1bc:function(e,t,a){"use strict";a("c10e")},e217:function(e,t,a){},e2f4:function(e,t,a){"use strict";a("0a1f")},e794:function(e,t,a){"use strict";a("739b")},e8d5:function(e,t,a){},eb02:function(e,t,a){"use strict";a("0709")},ef92:function(e,t,a){"use strict";a("9d7a")},ef96:function(e){e.exports=JSON.parse('[{"id":0,"value":"field","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_FIELD","published":true},{"id":8,"value":"nom","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_LASTNAME","published":true},{"id":9,"value":"prenom","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_FIRSTNAME","published":true},{"id":10,"value":"email","icon":"mail","name":"COM_EMUNDUS_ONBOARD_TYPE_EMAIL","published":true},{"id":5,"value":"textarea","icon":"notes","name":"COM_EMUNDUS_ONBOARD_TYPE_TEXTAREA","published":true},{"id":2,"value":"checkbox","icon":"check_box","name":"COM_EMUNDUS_ONBOARD_TYPE_CHECKBOX","published":true},{"id":4,"value":"radiobutton","icon":"radio_button_checked","name":"COM_EMUNDUS_ONBOARD_TYPE_RADIOBUTTON","published":true},{"id":3,"value":"dropdown","icon":"arrow_drop_down_circle","name":"COM_EMUNDUS_ONBOARD_TYPE_DROPDOWN","published":true},{"id":1,"value":"birthday","icon":"event","name":"COM_EMUNDUS_ONBOARD_TYPE_BIRTHDAY","published":true},{"id":14,"value":"date","icon":"calendar_month","name":"COM_EMUNDUS_ONBOARD_TYPE_CALENDAR","published":true},{"id":6,"value":"display","icon":"wysiwyg","name":"COM_EMUNDUS_ONBOARD_TYPE_DISPLAY","published":true},{"id":12,"value":"yesno","icon":"toggle_on","name":"COM_EMUNDUS_ONBOARD_TYPE_YESNO","published":true},{"id":13,"value":"databasejoin","icon":"table_rows","name":"COM_EMUNDUS_ONBOARD_TYPE_DATABASEJOIN","published":true},{"id":7,"value":"emundus_fileupload","icon":"file_upload","name":"COM_EMUNDUS_ONBOARD_TYPE_FILE","published":false}]')},f0a4:function(e,t,a){},f3b5:function(e,t,a){},f4cb:function(e,t,a){"use strict";a("8d5f")},f4e2:function(e,t,a){},f6b7:function(e,t,a){"use strict";a("6e2f")},fb04:function(e,t,a){},fcb1:function(e,t,a){},fd2f:function(e,t,a){},fdce:function(e,t,a){"use strict";a("0888")}});
//# sourceMappingURL=app_emundus.js.map