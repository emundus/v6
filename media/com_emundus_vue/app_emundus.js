(function(e){function t(t){for(var s,l,r=t[0],o=t[1],c=t[2],m=0,u=[];m<r.length;m++)l=r[m],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&u.push(i[l][0]),i[l]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);d&&d(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,r=1;r<a.length;r++){var o=a[r];0!==i[o]&&(s=!1)}s&&(n.splice(t--,1),e=l(l.s=a[0]))}return e}var s={},i={app:0},n=[];function l(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=s,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=o;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"05fe":function(e,t,a){},"07df":function(e,t,a){"use strict";a("c6d8")},"0a13":function(e,t,a){"use strict";a("5025")},"0a20":function(e,t,a){},"0fd5":function(e,t,a){var s={"./af":"8206","./af.js":"8206","./ar":"cdac","./ar-dz":"7f26","./ar-dz.js":"7f26","./ar-kw":"8e88","./ar-kw.js":"8e88","./ar-ly":"cd65","./ar-ly.js":"cd65","./ar-ma":"e8d6","./ar-ma.js":"e8d6","./ar-sa":"a284","./ar-sa.js":"a284","./ar-tn":"64f7","./ar-tn.js":"64f7","./ar.js":"cdac","./az":"b139","./az.js":"b139","./be":"98e2","./be.js":"98e2","./bg":"a1a5","./bg.js":"a1a5","./bm":"4d0d","./bm.js":"4d0d","./bn":"e8ae","./bn-bd":"5dd8","./bn-bd.js":"5dd8","./bn.js":"e8ae","./bo":"bcf2","./bo.js":"bcf2","./br":"69f1","./br.js":"69f1","./bs":"24d1","./bs.js":"24d1","./ca":"3507","./ca.js":"3507","./cs":"d15f","./cs.js":"d15f","./cv":"7bfe","./cv.js":"7bfe","./cy":"1d35","./cy.js":"1d35","./da":"a019","./da.js":"a019","./de":"0cfa","./de-at":"edea","./de-at.js":"edea","./de-ch":"9aae","./de-ch.js":"9aae","./de.js":"0cfa","./dv":"1722","./dv.js":"1722","./el":"5390","./el.js":"5390","./en-au":"dad9","./en-au.js":"dad9","./en-ca":"6f13","./en-ca.js":"6f13","./en-gb":"6267","./en-gb.js":"6267","./en-ie":"80b1","./en-ie.js":"80b1","./en-il":"ad38","./en-il.js":"ad38","./en-in":"eb60","./en-in.js":"eb60","./en-nz":"39db","./en-nz.js":"39db","./en-sg":"c30d","./en-sg.js":"c30d","./eo":"1a30","./eo.js":"1a30","./es":"48a3","./es-do":"f306","./es-do.js":"f306","./es-mx":"56d9","./es-mx.js":"56d9","./es-us":"60bf","./es-us.js":"60bf","./es.js":"48a3","./et":"f891","./et.js":"f891","./eu":"a403","./eu.js":"a403","./fa":"ce14","./fa.js":"ce14","./fi":"fc14","./fi.js":"fc14","./fil":"f46e","./fil.js":"f46e","./fo":"2bf2","./fo.js":"2bf2","./fr":"c1e8","./fr-ca":"50a2","./fr-ca.js":"50a2","./fr-ch":"b087","./fr-ch.js":"b087","./fr.js":"c1e8","./fy":"4665","./fy.js":"4665","./ga":"b396","./ga.js":"b396","./gd":"056c","./gd.js":"056c","./gl":"efde","./gl.js":"efde","./gom-deva":"12ea","./gom-deva.js":"12ea","./gom-latn":"8e2c","./gom-latn.js":"8e2c","./gu":"533d","./gu.js":"533d","./he":"7520","./he.js":"7520","./hi":"d2f3","./hi.js":"d2f3","./hr":"7e79","./hr.js":"7e79","./hu":"148f","./hu.js":"148f","./hy-am":"6711","./hy-am.js":"6711","./id":"2b10","./id.js":"2b10","./is":"1feb","./is.js":"1feb","./it":"1b21","./it-ch":"8d2c","./it-ch.js":"8d2c","./it.js":"1b21","./ja":"926e","./ja.js":"926e","./jv":"5a78","./jv.js":"5a78","./ka":"5975","./ka.js":"5975","./kk":"cc93","./kk.js":"cc93","./km":"66e1","./km.js":"66e1","./kn":"5421","./kn.js":"5421","./ko":"1297","./ko.js":"1297","./ku":"16f8","./ku.js":"16f8","./ky":"3df9","./ky.js":"3df9","./lb":"c124","./lb.js":"c124","./lo":"20a5","./lo.js":"20a5","./lt":"c14a","./lt.js":"c14a","./lv":"c553","./lv.js":"c553","./me":"ae25","./me.js":"ae25","./mi":"6f56","./mi.js":"6f56","./mk":"c8fc","./mk.js":"c8fc","./ml":"752d","./ml.js":"752d","./mn":"f09e","./mn.js":"f09e","./mr":"0a56","./mr.js":"0a56","./ms":"55b6","./ms-my":"a9e9","./ms-my.js":"a9e9","./ms.js":"55b6","./mt":"624b","./mt.js":"624b","./my":"e256","./my.js":"e256","./nb":"e1d5","./nb.js":"e1d5","./ne":"761a","./ne.js":"761a","./nl":"a0f2","./nl-be":"5cb2","./nl-be.js":"5cb2","./nl.js":"a0f2","./nn":"4fda","./nn.js":"4fda","./oc-lnc":"ec3d","./oc-lnc.js":"ec3d","./pa-in":"2f2f","./pa-in.js":"2f2f","./pl":"317f","./pl.js":"317f","./pt":"5553","./pt-br":"a9ab","./pt-br.js":"a9ab","./pt.js":"5553","./ro":"db12","./ro.js":"db12","./ru":"7aa4","./ru.js":"7aa4","./sd":"e87b","./sd.js":"e87b","./se":"a296","./se.js":"a296","./si":"51ec","./si.js":"51ec","./sk":"608b","./sk.js":"608b","./sl":"b367","./sl.js":"b367","./sq":"f68f","./sq.js":"f68f","./sr":"0991","./sr-cyrl":"c577","./sr-cyrl.js":"c577","./sr.js":"0991","./ss":"cf76","./ss.js":"cf76","./sv":"0153","./sv.js":"0153","./sw":"cb6f","./sw.js":"cb6f","./ta":"8bfa","./ta.js":"8bfa","./te":"668b","./te.js":"668b","./tet":"eae7","./tet.js":"eae7","./tg":"70b1","./tg.js":"70b1","./th":"7180","./th.js":"7180","./tk":"4912","./tk.js":"4912","./tl-ph":"f8bb","./tl-ph.js":"f8bb","./tlh":"b026","./tlh.js":"b026","./tr":"371d","./tr.js":"371d","./tzl":"c744","./tzl.js":"c744","./tzm":"787a","./tzm-latn":"71e0","./tzm-latn.js":"71e0","./tzm.js":"787a","./ug-cn":"6b5c","./ug-cn.js":"6b5c","./uk":"8c0c","./uk.js":"8c0c","./ur":"519e","./ur.js":"519e","./uz":"7982","./uz-latn":"3137","./uz-latn.js":"3137","./uz.js":"7982","./vi":"ae22","./vi.js":"ae22","./x-pseudo":"1129","./x-pseudo.js":"1129","./yo":"b4bf","./yo.js":"b4bf","./zh-cn":"fdc4","./zh-cn.js":"fdc4","./zh-hk":"747d","./zh-hk.js":"747d","./zh-mo":"fe39","./zh-mo.js":"fe39","./zh-tw":"d3e0","./zh-tw.js":"d3e0"};function i(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id="0fd5"},1:function(e,t){},1284:function(e,t,a){"use strict";a("1cd5")},"13e3":function(e,t,a){"use strict";a("a671")},1492:function(e,t,a){},"1a8e":function(e,t,a){"use strict";a("fc50")},"1cd5":function(e,t,a){},"1fd0":function(e,t,a){"use strict";a("8e0b")},2051:function(e,t,a){e.exports={"row-fluid":"formbuilder_row-fluid_1_FRK","control-group":"formbuilder_control-group_25KA8",fabrikElementContainer:"formbuilder_fabrikElementContainer_3Urmr",fabrikLabel:"formbuilder_fabrikLabel_GywiO","control-label":"formbuilder_control-label_7ELCw",fabrikTip:"formbuilder_fabrikTip_2Sgca","icon-star":"formbuilder_icon-star_ZpyzP",small:"formbuilder_small_31_V_"}},"230d":function(e,t,a){},"236e":function(e,t,a){"use strict";a("3b76")},2567:function(e,t,a){"use strict";a("31c0")},2631:function(e,t,a){},"29d4":function(e,t,a){"use strict";a("d709")},"2a23":function(e,t,a){},"2da3":function(e,t,a){"use strict";a("bb4c")},3073:function(e,t,a){"use strict";a("7ca2")},"31c0":function(e,t,a){},3208:function(e){e.exports=JSON.parse('{"field":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE","name":"password","type":"dropdown","options":[{"value":0,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_TEXT"},{"value":3,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_EMAIL"},{"value":5,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_LINK"},{"value":6,"label":"COM_EMUNDUS_ONBOARD_BUILDER_FIELD_TYPE_NUMBER"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_PLACEHOLDER","name":"placeholder","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_HELPTEXT","name":"rollover","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_MAXLENGTH","name":"maxlength","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_TITLE","name":"text_input_mask","type":"text","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_HINT","placeholder":"COM_EMUNDUS_ONBOARD_BUILDER_INPUT_MASK_PLACEHOLDER","published":true,"sysadmin_only":false}],"textarea":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_DISPLAY_LABEL","name":"textarea_showlabel","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":false,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_PLACEHOLDER","name":"textarea_placeholder","type":"text","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_WYSIWIG","name":"use_wysiwyg","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT","name":"textarea-maxlength","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_SHOWMAX_LIMIT","name":"textarea-showmax","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE","name":"textarea_limit_type","type":"dropdown","options":[{"value":"char","label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE_CHARACTERS"},{"value":"word","label":"COM_EMUNDUS_ONBOARD_BUILDER_TEXTAREA_LIMIT_TYPE_WORDS"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"checkbox":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CHECKBOX_OPTIONS_PER_ROW","name":"ck_options_per_row","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"radiobutton":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_RADIOBUTTON_OPTIONS_PER_ROW","name":"options_per_row","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"birthday":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_ADVANCED","name":"advanced_behavior","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":false,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD","name":"birthday_yearopt","type":"dropdown","options":[{"value":"number","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_YEARS_NUMBER"},{"value":"since","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_SINCE_YEAR"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_NUMBER","name":"birthday_yearstart","type":"number","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_LIST_METHOD_NUMBER_TIP","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_YEARS_FUTURE_PAST","name":"birthday_forward","type":"number","helptext":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_YEARS_FUTURE_PAST_TIP","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_FORMAT","name":"list_date_format","type":"dropdown","options":[{"value":"d.m.Y","label":"21.12.2022"},{"value":"m.d.Y","label":"12.21.2022"},{"value":"d/m/Y","label":"21/12/2022"},{"value":"d m","label":"COM_EMUNDUS_ONBOARD_BUILDER_BIRTHDAY_FORMAT_D_M"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"yesno":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_YESNO_DEFAULT_VALUE","name":"yesno_default","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"calc":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALC_VALUE","name":"calc_calculation","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"databasejoin":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE","name":"database_join_display_type","type":"dropdown","options":[{"value":"dropdown","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_DROPDOWN"},{"value":"radio","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_RADIO"},{"value":"auto-complete","label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_DISPLAY_TYPE_AUTOCOMPLETE"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_TABLE","name":"join_db_name","type":"databasejoin","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_VALUE","name":"join_key_column","type":"databasejoin_cascade","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_LABEL","name":"join_val_column","type":"databasejoin_cascade","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_LABEL_CONCAT","name":"join_val_column_concat","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_SHOW_PLEASE_SELECT","name":"database_join_show_please_select","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_WHERE","name":"database_join_where_sql","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":true},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_DATABASEJOIN_WHERE_AJAX","name":"databasejoin_where_ajax","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":true}],"date":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_DEFAULT_TODAY","name":"date_defaulttotoday","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_FIRST_DAY","name":"date_firstday","type":"dropdown","options":[{"value":0,"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_SUNDAY"},{"value":1,"label":"COM_EMUNDUS_ONBOARD_BUILDER_CALENDAR_MONDAY"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false}],"currency":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CURRENCY_ALL_OPTIONS","name":"all_currencies_options","type":"subform","min":1,"helptext":"","placeholder":"","published":true,"sysadmin_only":false,"subparams":[{"name":"iso3","type":"sql","label":"COM_EMUNDUS_ONBOARD_BUILDER_CURRENCY_CURRENCY","value_field":"label","key_field":"iso3","plugin_name":"currency","placeholder":"","helptext":"","published":true,"sysadmin_only":false},{"name":"minimal_value","type":"number","label":"COM_EMUNDUS_ONBOARD_MIN_RESOLUTION_PLACEHOLDER","required":true,"min":0,"max":99999999.98,"default":0,"step":1,"placeholder":"","helptext":"","published":true,"sysadmin_only":false},{"name":"maximal_value","type":"number","label":"COM_EMUNDUS_ONBOARD_MAX_RESOLUTION_PLACEHOLDER","required":true,"min":0,"max":99999999.99,"default":10000,"step":1,"placeholder":"","helptext":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CURRENCY_THOUSAND_SEPARATOR","name":"thousand_separator","type":"text","maxlength":1,"size":3,"default":" ","placeholder":"","helptext":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_CURRENCY_DECIMAL_SEPARATOR","name":"decimal_separator","type":"text","required":true,"maxlength":1,"size":1,"default":",","placeholder":"","helptext":"","published":true,"sysadmin_only":false},{"name":"decimal_numbers","type":"number","label":"COM_EMUNDUS_ONBOARD_BUILDER_CURRENCY_DECIMAL_NUMBERS","filter":"number","required":1,"max":10,"min":0,"default":2,"placeholder":"","helptext":"","published":true,"sysadmin_only":false}]}]}')},"33a8":function(e,t,a){},"354f":function(e,t,a){},3616:function(e,t,a){"use strict";a("d234")},"367a":function(e,t,a){e.exports={app:"messenger_app_1_wpb",messages__vue:"messenger_messages__vue_wc18U","vm--container":"messenger_vm--container_1-Y1-",scrollable:"messenger_scrollable_1lv4s","vm--modal":"messenger_vm--modal_YInqZ","messages__campaigns-list-select":"messenger_messages__campaigns-list-select_2s7nD","messages__campaigns-list":"messenger_messages__campaigns-list_1WqUA","drag-window":"messenger_drag-window_LsA3E",messages__block:"messenger_messages__block_1fPjJ","messages__campaign-block":"messenger_messages__campaign-block_2gRfr","messages__active-campaign":"messenger_messages__active-campaign_1q1D4",messages__list:"messenger_messages__list_3Pvcg","messages__list-block":"messenger_messages__list-block_1ldNN","messages__bottom-input":"messenger_messages__bottom-input_2unUJ","messages__bottom-input-actions":"messenger_messages__bottom-input-actions_2YlSw",messages__input_text:"messenger_messages__input_text_5cjRs","messages__send-icon":"messenger_messages__send-icon_QYqff",messages__current_user:"messenger_messages__current_user_1v2DR",messages__other_user:"messenger_messages__other_user_FC20o","messages__message-item":"messenger_messages__message-item_2znU8","messages__message-item-block":"messenger_messages__message-item-block_1OiIb","messages__message-item-span":"messenger_messages__message-item-span_1Uaw3","messages__message-item-span_current-user":"messenger_messages__message-item-span_current-user_iYFdF","messages__message-item-span_other-user":"messenger_messages__message-item-span_other-user_3vS4G","messages__message-item-from":"messenger_messages__message-item-from_3Fd7t",messages__campaigns_title:"messenger_messages__campaigns_title_2OFiR",messages__campaigns_fnum:"messenger_messages__campaigns_fnum_1SjD1","messages__campaigns_folder-icon":"messenger_messages__campaigns_folder-icon_3ZWHH","messages__text-align-right":"messenger_messages__text-align-right_2NZ1L","messages__text-align-left":"messenger_messages__text-align-left_2VyzM",message__header:"messenger_message__header_1NcqQ",messages__send_button:"messenger_messages__send_button_3PsfC",loader:"messenger_loader_2s1lH",spin:"messenger_spin_3BMjc",pointer:"messenger_pointer_1Vxlz","messages__date-section":"messenger_messages__date-section_dI2fV",messages__actions_bar:"messenger_messages__actions_bar_eS_Ia",messages__attach_content:"messenger_messages__attach_content_1jCCU",messages__attach_actions_tabs:"messenger_messages__attach_actions_tabs_3qEDY",messages__attach_action:"messenger_messages__attach_action_3j70e",messages__attach_action__current:"messenger_messages__attach_action__current_22fvD",messages__button_send:"messenger_messages__button_send_lHsB5",messages__download_icon:"messenger_messages__download_icon_2ICtv",messages__attach_applicant_doc:"messenger_messages__attach_applicant_doc_1_Kkl",customdropzone_messenger:"messenger_customdropzone_messenger_p3pr1","dz-preview":"messenger_dz-preview_2tFq3","dz-image":"messenger_dz-image_fsVk4","dz-details":"messenger_dz-details_3Y3u9","dz-success-mark":"messenger_dz-success-mark_3nxKc","dz-default":"messenger_dz-default_1Ztvs","dz-message":"messenger_dz-message_p7095","dz-error-mark":"messenger_dz-error-mark_3jKgf","slide-fade-enter-active":"messenger_slide-fade-enter-active_2G13G","slide-fade-leave-active":"messenger_slide-fade-leave-active__OQGC","slide-fade-enter":"messenger_slide-fade-enter_xhzOu","slide-right-enter-active":"messenger_slide-right-enter-active_2vzUN","slide-right-leave-active":"messenger_slide-right-leave-active_rnJdy","slide-right-enter":"messenger_slide-right-enter_4FLGS","slide-right-leave-to":"messenger_slide-right-leave-to_6cMAc","slide-down-enter-active":"messenger_slide-down-enter-active_2baMB","slide-down-leave-active":"messenger_slide-down-leave-active_3m48j","slide-down-enter":"messenger_slide-down-enter_NVuAn","slide-down-leave-to":"messenger_slide-down-leave-to_2I3cK","slide-up-enter-active":"messenger_slide-up-enter-active_3FLho","slide-up-leave-active":"messenger_slide-up-leave-active_1W0jE","slide-up-enter":"messenger_slide-up-enter_346xg","slide-up-leave-to":"messenger_slide-up-leave-to_3yqPj","move-right-enter-active":"messenger_move-right-enter-active_3YPOY","move-right-leave-active":"messenger_move-right-leave-active_f3kNx","move-right-enter":"messenger_move-right-enter_35zVk","move-right-leave-to":"messenger_move-right-leave-to_3Wmlg","move-left-enter-active":"messenger_move-left-enter-active_3-Muk","move-left-leave-active":"messenger_move-left-leave-active_1l_j1","move-left-enter":"messenger_move-left-enter_2ioo-","move-left-leave-to":"messenger_move-left-leave-to_2Mfsb","little-move-right-enter-active":"messenger_little-move-right-enter-active_guPN7","little-move-right-leave-active":"messenger_little-move-right-leave-active_3RHqI","little-move-right-enter":"messenger_little-move-right-enter_CynDI","little-move-right-leave-to":"messenger_little-move-right-leave-to_1dwJw","little-move-left-enter-active":"messenger_little-move-left-enter-active_fGMd_","little-move-left-leave-active":"messenger_little-move-left-leave-active_2CE77","little-move-left-enter":"messenger_little-move-left-enter_DbHzM","little-move-left-leave-to":"messenger_little-move-left-leave-to_1ZwJR"}},3907:function(e,t,a){"use strict";a("eea2")},"3b76":function(e,t,a){},"3d34":function(e,t,a){},"41c0":function(e,t,a){},"45bc":function(e,t,a){},"468d":function(e,t,a){"use strict";a("869a")},4779:function(e,t,a){"use strict";a("539f")},"47d1":function(e,t,a){"use strict";a("05fe")},"4c13":function(e){e.exports=JSON.parse('{"parameters":[{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_INTRO","name":"intro","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_OUTRO","name":"outro","type":"textarea","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT","name":"repeat_group_button","type":"dropdown","options":[{"value":0,"label":"JNO"},{"value":1,"label":"JYES"}],"helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT_MIN","name":"repeat_min","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false},{"label":"COM_EMUNDUS_ONBOARD_BUILDER_SECTIONS_REPEAT_MAX","name":"repeat_max","type":"number","helptext":"","placeholder":"","published":true,"sysadmin_only":false}]}')},"4daa":function(e,t,a){"use strict";a("5c31")},5025:function(e,t,a){},"539f":function(e,t,a){},5573:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("e832"),i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"com_emundus_vue em-flex-col-center"},["attachments"===e.component?t("Attachments",{attrs:{fnum:e.data.fnum,user:e.data.user,defaultAttachments:e.data.attachments?e.data.attachments:null}}):"files"===e.component?t("Files",{attrs:{type:e.data.type,user:e.data.user,ratio:e.data.ratio}}):t("transition",{attrs:{name:"slide-right"}},[t(e.$props.component,{tag:"component"})],1)],1)},n=[],l=a("4e22"),r=a.n(l),o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-w-100",attrs:{id:"em-attachments"}},[t("div",{staticClass:"wrapper",class:{loading:e.loading}},[t("section",{staticClass:"em-flex-row em-flex-space-between",attrs:{id:"filters"}},[t("div",{staticClass:"em-flex-row"},[t("div",{staticClass:"em-flex-row searchbar-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],ref:"searchbar",attrs:{id:"searchbar",type:"text",placeholder:e.translate("COM_EMUNDUS_ACTIONS_SEARCH")},domProps:{value:e.search},on:{input:[function(t){t.target.composing||(e.search=t.target.value)},e.onSearch],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearchKeyup.apply(null,arguments)}}}),t("span",{staticClass:"material-icons-outlined search"},[e._v("search")]),t("span",{staticClass:"material-icons-outlined clear em-pointer",on:{click:function(t){e.search=""}}},[e._v("clear")])]),Object.entries(e.displayedAttachmentCategories).length>0?t("select",{directives:[{name:"model",rawName:"v-model",value:e.category,expression:"category"}],staticClass:"category-select em-ml-16",attrs:{name:"category"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.category=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SELECT_CATEGORY")))]),e._l(e.displayedAttachmentCategories,(function(a,s){return t("option",{key:s,domProps:{value:s}},[e._v(e._s(a))])}))],2):e._e()]),t("div",{staticClass:"actions em-flex-row"},[e.canExport?t("div",{staticClass:"btn-icon-text",class:{disabled:e.checkedAttachments.length<1},on:{click:e.exportAttachments}},[t("span",{staticClass:"material-icons-outlined export em-mr-8"},[e._v("file_upload")]),t("span",[e._v(e._s(e.translate("COM_EMUNDUS_EXPORTS_EXPORT")))])]):e._e(),e.sync&&e.canSync?t("div",{staticClass:"btn-icon-text",class:{disabled:e.checkedAttachments.length<1},on:{click:function(t){return e.synchronizeAttachments(e.checkedAttachments)}}},[t("span",{staticClass:"material-icons cloud_sync",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_TITLE")}},[e._v(" cloud_sync ")]),t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_TITLE")))])]):e._e(),t("span",{staticClass:"material-icons-outlined refresh em-pointer",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_REFRESH_TITLE")},on:{click:function(t){return e.refreshAttachments(!0)}}},[e._v(" autorenew ")]),e.canDelete?t("span",{staticClass:"material-icons-outlined delete",class:{disabled:e.checkedAttachments.length<1},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_DELETE_TITLE")},on:{click:e.confirmDeleteAttachments}},[e._v(" delete_outlined ")]):e._e()])]),e.exportLink?t("div",{staticClass:"em-mt-16 em-mb-16"},[t("a",{attrs:{href:e.exportLink,target:"_blank"},on:{click:function(t){e.exportLink=""}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_EXPORT_LINK"))+" ")])]):e._e(),e.attachments.length?t("section",{staticClass:"table-wrapper em-w-100"},[t("table",{class:{loading:e.loading},attrs:{"aria-describedby":"Table of attachments information"}},[t("thead",[t("tr",[t("th",{attrs:{id:"check-th"}},[t("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},on:{change:e.updateAllCheckedAttachments}})]),e.columns.includes("name")?t("th",{attrs:{id:"name"},on:{click:function(t){return e.orderBy("value")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_NAME")))]),"value"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"value"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("date")?t("th",{staticClass:"date",attrs:{id:"date"},on:{click:function(t){return e.orderBy("timedate")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE")))]),"timedate"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"timedate"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("desc")?t("th",{staticClass:"desc",attrs:{id:"desc"},on:{click:function(t){return e.orderBy("upload_description")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_DESCRIPTION")))]),"upload_description"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"upload_description"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("category")?t("th",{staticClass:"category",attrs:{id:"category"},on:{click:function(t){return e.orderBy("category")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY")))]),"category"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"category"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("status")?t("th",{staticClass:"status",attrs:{id:"status"},on:{click:function(t){return e.orderBy("is_validated")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CHECK")))]),"is_validated"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"is_validated"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.canSee&&e.columns.includes("user")?t("th",{attrs:{id:"user"},on:{click:function(t){return e.orderBy("user_id")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY")))]),"user_id"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"user_id"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.canSee&&e.columns.includes("modified_by")?t("th",{attrs:{id:"modified_by"},on:{click:function(t){return e.orderBy("modified_by")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY")))]),"modified_by"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"modified_by"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("modified")?t("th",{staticClass:"date",attrs:{id:"modified"},on:{click:function(t){return e.orderBy("modified")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE")))]),"modified"===e.sort.orderBy&&"asc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_upward")]):e._e(),"modified"===e.sort.orderBy&&"desc"===e.sort.order?t("span",{staticClass:"material-icons-outlined em-font-size-16"},[e._v("arrow_downward")]):e._e()]):e._e(),e.columns.includes("permissions")?t("th",{staticClass:"permissions",attrs:{id:"permissions"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSIONS")))]):e._e(),e.sync&&e.columns.includes("sync")?t("th",{staticClass:"sync",attrs:{id:"sync"},on:{click:function(t){return e.orderBy("sync")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC")))])]):e._e()])]),t("tbody",e._l(e.displayedAttachments,(function(a){return t("AttachmentRow",{key:a.aid,attrs:{attachment:a,checkedAttachmentsProp:e.checkedAttachments,canUpdate:e.canUpdate,sync:e.sync,canSee:e.canSee,columns:e.$props.columns},on:{"open-modal":function(t){return e.openModal(a)},"update-checked-attachments":e.updateCheckedAttachments,"update-status":e.updateStatus,"change-permission":e.changePermission}})})),1)])]):t("p",[e._v(" "+e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_NO_ATTACHMENTS_FOUND"))+" ")])]),t("modal",{attrs:{id:"edit-modal",name:"edit",resizable:!0,draggable:!0,styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"}},[t("div",{staticClass:"modal-head em-w-100 em-flex-row em-flex-space-between"},[t("div",{staticClass:"em-flex-row em-flex-start",attrs:{id:"actions-left"}},[t("span",[e._v(e._s(e.selectedAttachment.filename))])]),t("div",{staticClass:"em-flex-row",attrs:{id:"actions-right"}},[e.sync&&e.syncSelectedPreview?t("a",{staticClass:"download btn-icon-text em-mr-24",attrs:{href:e.syncSelectedPreview,target:"_blank"}},[t("span",{staticClass:"material-icons-outlined"},[e._v("open_in_new")]),t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_OPEN_IN_GED")))])]):e._e(),e.canDownload?t("a",{staticClass:"download btn-icon-text em-mr-24",attrs:{download:"",href:e.attachmentPath}},[t("span",{staticClass:"material-icons"},[e._v(" file_download ")]),t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_LINK_TO_DOWNLOAD")))])]):e._e(),t("div",{staticClass:"prev-next-attachments em-flex-row em-flex-space-between em-mr-8"},[t("div",{staticClass:"prev em-flex-row em-mr-4",class:{active:e.selectedAttachmentPosition>0},on:{click:function(t){return e.changeAttachment(e.selectedAttachmentPosition-1,!0)}}},[t("span",{staticClass:"material-icons"},[e._v(" navigate_before ")])]),t("span",{staticClass:"lvl"},[e._v(e._s(e.selectedAttachmentPosition+1)+" /"+e._s(e.displayedAttachments.length))]),t("div",{staticClass:"next em-flex-row em-ml-4",class:{active:e.selectedAttachmentPosition<e.displayedAttachments.length-1},on:{click:function(t){return e.changeAttachment(e.selectedAttachmentPosition+1)}}},[t("span",{staticClass:"material-icons"},[e._v(" navigate_next ")])])]),t("span",{staticClass:"material-icons em-pointer",on:{click:e.closeModal}},[e._v("close")])])]),t("transition",{attrs:{name:e.slideTransition},on:{"before-leave":e.beforeLeaveSlide}},[!e.modalLoading&&e.displayedUser.user_id&&e.displayedFnum?t("div",{staticClass:"modal-body em-flex-row",class:{"only-preview":e.onlyPreview}},[t("AttachmentPreview",{attrs:{user:e.displayedUser.user_id},on:{fileNotFound:function(t){e.canDownload=!1},canDownload:function(t){e.canDownload=!0}}}),e.displayEdit?t("AttachmentEdit",{attrs:{fnum:e.displayedFnum,"is-displayed":!e.onlyPreview},on:{closeModal:e.closeModal,saveChanges:e.updateAttachment,"update-displayed":e.toggleOnlyPreview}}):e._e()],1):e._e()])],1),e.loading?t("div",{staticClass:"vue-em-loader em-loader"}):e._e()],1)},c=[],d=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"em-attachment-preview"}},[t("div",{ref:"a-preview",staticClass:"attachment-preview",class:{"overflow-x":e.overflowX,"overflow-y":e.overflowY,hidden:!e.needShadowDOM}}),e.needShadowDOM?e._e():t("div",{staticClass:"attachment-preview",domProps:{innerHTML:e._s(e.preview)}}),t("div",{class:{active:e.msg&&e.openMsg},attrs:{id:"msg"}},[t("p",[e._v(e._s(e.msg))])])])},m=[],u=a("7338"),p=a.n(u);const _="undefined"!=typeof Joomla&&null!==Joomla?Joomla.getOptions("system.paths"):{base:""};p.a.defaults.baseURL=void 0!==_.base&&""!==_.base?_.base:"/";var h=(e={"Content-Type":"application/json","Cache-Control":"no-cache"})=>p.a.create({timeout:3e4,headers:e,responseType:"json",withCredentials:!0}),g={async getAttachmentProgress(e){try{const t=await h().get("index.php?option=com_emundus&controller=files&task=getattachmentprogress",{params:{fnum:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentsByUser(e){try{const t=await h().get("index.php?option=com_emundus&controller=application&task=getuserattachments",{params:{user_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentsByFnum(e){try{const t=await h().get("index.php?option=com_emundus&controller=application&task=getattachmentsbyfnum",{params:{fnum:e}});return t.data.status&&("string"===typeof t.data.attachments&&(t.data.attachments=JSON.parse(t.data.attachments)),"object"===typeof t.data.attachments&&(t.data.attachments=Object.values(t.data.attachments)),t.data.attachments.forEach(e=>{null===e.is_validated&&(e.is_validated=-2),null!==e.upload_description&&"string"===typeof e.upload_description||(e.upload_description=""),e.show=!0})),t.data}catch(t){return{status:!1,msg:t.message}}},async getAttachmentCategories(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=getattachmentcategories");return e.data}catch(e){return{status:!1,msg:e.message}}},async deleteAttachments(e,t,a){try{const s=new FormData;return s.append("ids",JSON.stringify(a)),await h().post(`index.php?option=com_emundus&controller=application&task=deleteattachement&fnum=${e}&student_id=${t}`,s,{headers:{"Content-Type":"multipart/form-data"}})}catch(s){return{status:!1,msg:s.message}}},async updateAttachment(e){try{const t=await h().post("index.php?option=com_emundus&controller=application&task=updateattachment",e,{headers:{"Content-Type":"multipart/form-data"}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getPreview(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=application&task=getattachmentpreview",{params:{user:e,filename:t}});return a.data}catch(a){return{status:!1,msg:a.message}}},exportAttachments(e,t,a){const s=new FormData;return s.append("attachments_only",!0),s.append("student_id",e),s.append("fnum",t),a.forEach(e=>{s.append("ids[]",e)}),h().post("index.php?option=com_emundus&controller=application&task=exportpdf",s,{headers:{"Content-Type":"multipart/form-data"}})},async getProfileAttachments(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getprofileattachments");return e.data}catch(e){return{status:!1,msg:e.message}}},async getProfileAttachmentsAllowed(){try{const e=await h().get("index.php?option=com_emundus&controller=users&task=getprofileattachmentsallowed");return e.data}catch(e){return{status:!1,msg:e.message}}},async deleteProfileAttachment(e,t){try{const a=await h().delete("index.php?option=com_emundus&controller=users&task=deleteprofileattachment",{params:{id:e,filename:t}});return a.data}catch(a){return{status:!1,msg:a.message}}},async isExpiresDateDisplayed(){try{const e=await h().get("index.php?option=com_emundus&controller=settings&task=isexpiresdatedisplayed");return e.data}catch(e){return{status:!1,msg:e.message}}}},f={props:{user:{type:Number,required:!0}},data(){return{attachment:this.$store.state.attachment.selectedAttachment,preview:"",overflowX:!1,overflowY:!1,style:"",msg:"",openMsg:!1,needShadowDOM:!1}},mounted(){"function"===typeof this.$refs["a-preview"].attachShadow&&this.$refs["a-preview"].attachShadow({mode:"open"}),this.attachment=this.$store.state.attachment.selectedAttachment,this.getPreview()},methods:{async getPreview(){let e;switch(this.$store.state.attachment.previews[this.attachment.aid]?e=this.$store.state.attachment.previews[this.attachment.aid]:(e=await g.getPreview(this.user,this.attachment.filename),e.status&&this.$store.commit("attachment/setPreview",{preview:e,id:this.attachment.aid})),this.$emit("canDownload"),e.status?(this.preview=e.content,this.overflowX=e.overflowX,this.overflowY=e.overflowY,this.style=e.style,e.msg&&(this.msg=e.msg,this.openMsg=!0,setTimeout(()=>{this.openMsg=!1},3e3))):("file_not_found"===e.error&&this.$emit("fileNotFound"),this.overflowX=!1,this.overflowY=!1,this.preview=e.content,this.msg=""),this.style){case"sheet":case"presentation":case"word":this.needShadowDOM=!0;break;default:this.needShadowDOM=!1;break}this.needShadowDOM?(this.$refs["a-preview"].shadowRoot.innerHTML=null!=this.preview?this.preview:"","sheet"==this.style?this.addSheetStyles():"presentation"==this.style?this.addPresentationStyles():"word"==this.style&&this.addWordStyles()):this.$refs["a-preview"].shadowRoot.innerHTML=""},addSheetStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelectorAll("div");e.forEach((e,t)=>{e.style.width="fit-content",e.style.margin="20px auto",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",t>0&&(e.style.display="none")});const t=this.$refs["a-preview"].shadowRoot.querySelector(".navigation");t&&(t.style.display="flex",t.style.flexDirection="row",t.style.justifyContent="flex-start",t.style.alignItems="center",t.querySelectorAll("li").forEach((t,a)=>{t.style.listStyleType="none",t.style.margin="0 10px",t.addEventListener("click",()=>{e.forEach((e,t)=>{e.style.display=t==a?"block":"none"})})}))},addPresentationStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelectorAll(".slide");e.forEach(e=>{e.style.padding="16px",e.style.margin="20px",e.style.width="calc(100% - 72px)",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",e.style.borderRadius="8px",e.style.backgroundColor="white"})},addWordStyles(){const e=this.$refs["a-preview"].shadowRoot.querySelector(".wrapper");e&&(e.style.border="var(--border-color)",e.style.boxShadow="var(--box-shadow)",e.style.backgroundColor="white",e.style.padding="20px",e.style.margin="16px",e.style.overflow="hidden")}},watch:{"$store.state.attachment.selectedAttachment":function(){const e=Object.keys(this.$store.state.attachment.selectedAttachment);0!==e.length&&(this.attachment=this.$store.state.attachment.selectedAttachment,this.openMsg=!1,this.getPreview())}}},v=f,b=(a("b252"),a("17e1")),C=Object(b["a"])(v,d,m,!1,null,null,null),O=C.exports,y=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"attachment-edit"}},[t("div",{staticClass:"wrapper"},[t("h2",{staticClass:"title"},[e._v(e._s(e.attachment.value))]),t("div",{staticClass:"editable-data"},[t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"description"}},[e._v(e._s(e.translate("DESCRIPTION")))]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.attachmentDescription,expression:"attachmentDescription"}],attrs:{name:"description",id:"description",type:"text",disabled:!e.canUpdate},domProps:{value:e.attachmentDescription},on:{focusout:e.saveChanges,input:function(t){t.target.composing||(e.attachmentDescription=t.target.value)}}})]),t("div",{staticClass:"input-group valid-state",class:{success:1==e.attachmentIsValidated,warning:2==e.attachmentIsValidated,error:0==e.attachmentIsValidated}},[t("label",{attrs:{for:"status"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CHECK")))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.attachmentIsValidated,expression:"attachmentIsValidated"}],attrs:{name:"status",disabled:!e.canUpdate},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachmentIsValidated=t.target.multiple?a:a[0]},e.updateAttachmentStatus]}},[t("option",{attrs:{value:"1"}},[e._v(e._s(e.translate("VALID")))]),t("option",{attrs:{value:"0"}},[e._v(e._s(e.translate("INVALID")))]),t("option",{attrs:{value:"2"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WARNING")))]),t("option",{attrs:{value:"-2"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WAITING")))])])]),e.canUpdate?t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"replace"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_REPLACE")))]),t("input",{attrs:{type:"file",name:"replace",accept:e.allowedType},on:{change:e.updateFile}})]):e._e(),e.attachment.profiles&&e.attachment.profiles.length>0?t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"can_be_viewed"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_VIEWED")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.attachmentCanBeViewed,expression:"attachmentCanBeViewed"}],attrs:{type:"checkbox",name:"can_be_viewed",disabled:!e.canUpdate},domProps:{checked:Array.isArray(e.attachmentCanBeViewed)?e._i(e.attachmentCanBeViewed,null)>-1:e.attachmentCanBeViewed},on:{click:e.saveChanges,change:function(t){var a=e.attachmentCanBeViewed,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.attachmentCanBeViewed=a.concat([n])):l>-1&&(e.attachmentCanBeViewed=a.slice(0,l).concat(a.slice(l+1)))}else e.attachmentCanBeViewed=i}}})]):e._e(),e.attachment.profiles&&e.attachment.profiles.length>0?t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"can_be_deleted"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_DELETED")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.attachmentCanBeDeleted,expression:"attachmentCanBeDeleted"}],attrs:{type:"checkbox",name:"can_be_deleted",disabled:!e.canUpdate},domProps:{checked:Array.isArray(e.attachmentCanBeDeleted)?e._i(e.attachmentCanBeDeleted,null)>-1:e.attachmentCanBeDeleted},on:{click:e.saveChanges,change:function(t){var a=e.attachmentCanBeDeleted,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.attachmentCanBeDeleted=a.concat([n])):l>-1&&(e.attachmentCanBeDeleted=a.slice(0,l).concat(a.slice(l+1)))}else e.attachmentCanBeDeleted=i}}})]):e._e()]),t("div",{staticClass:"non-editable-data"},[t("div",[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE")))]),t("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.formattedDate(e.attachment.timedate)))])]),e.attachment.user_id&&e.canSee?t("div",[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY")))]),t("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.getUserNameById(e.attachment.user_id)))])]):e._e(),e.attachment.category?t("div",[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY")))]),t("span",{staticClass:"em-text-align-right"},[e._v(e._s(this.categories[e.attachment.category]))])]):e._e(),e.attachment.modified_by&&e.canSee?t("div",[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY")))]),t("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.getUserNameById(e.attachment.modified_by)))])]):e._e(),e.attachment.modified?t("div",[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE")))]),t("span",{staticClass:"em-text-align-right"},[e._v(e._s(e.formattedDate(e.attachment.modified)))])]):e._e()])]),t("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[t("div",{attrs:{id:"toggle-display"}},[e.displayed?t("span",{staticClass:"material-icons-outlined displayed em-pointer",on:{click:function(t){return e.toggleDisplay(!1)}}},[e._v(" chevron_right ")]):t("span",{staticClass:"material-icons-outlined not-displayed em-pointer",on:{click:function(t){return e.toggleDisplay(!0)}}},[e._v(" menu_open ")])])]),e.error?t("div",{staticClass:"error-msg"},[e._v(e._s(e.errorMessage))]):e._e()])},E=[],D={async getUserById(e){try{const t=await h().get("index.php?option=com_emundus&controller=users&task=getuserbyid",{params:{id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getUserNameById(e){try{const t=await h().get("index.php?option=com_emundus&controller=users&task=getUserNameById",{params:{id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getAccessRights(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=users&task=getattachmentaccessrights",{params:{id:e,fnum:t}});return a.data}catch(a){return{status:!1,msg:a.message}}}},M={mimeTypes:{aac:"audio/aac",abw:"application/x-abiword",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip",mp4:"video/mp4",mov:"video/mov"}},S={methods:{formattedDate:function(e="",t="LLLL",a=null){let s="";if(null!==e)if(null===a&&(a=this.$store.state.global.offset),""!==e){let i=e.substring(0,4),n=e.substring(5,7),l=e.substring(8,10),o=e.substring(11,13),c=e.substring(14,16),d=e.substring(17,19);const m=i+"-"+n+"-"+l+"T"+o+":"+c+":"+d+"+00:00";s=r()(m).utcOffset(a).format(t)}else s=r()().utcOffset(a).format(t);return s},strippedHtml:function(e){return null===e||void 0===e?"":e.replace(/<(?:.|\n)*?>/gm,"")},getUserNameById:function(e){let t="";if(e=parseInt(e),e>0){const a=this.$store.state.user.users[e];a?t=a.firstname+" "+a.lastname:D.getUserNameById(e).then(a=>{a.status&&a.user.user_id==e&&(t=a.user.firstname+" "+a.user.lastname,this.$store.dispatch("user/setUsers",[a.user]))})}return t},async getAttachmentCategories(){const e=await g.getAttachmentCategories();return!0===e.status?(Object.entries(e.categories).forEach(([t,a])=>{e.categories[t]=this.translate(a)}),delete e.categories[""],this.$store.dispatch("attachment/setCategories",e.categories),e.categories):{}},async asyncForEach(e,t){for(let a=0;a<e.length;a++)await t(e[a],a,e)},getMimeTypeFromExtension(e){return!!M.mimeTypes.hasOwnProperty(e)&&M.mimeTypes[e]},checkMaxMinlength(e,t,a=null){e.target.textContent.length>=t&&8!=e.keyCode&&e.preventDefault(),null!==a&&e.target.textContent.length<=a&&8==e.keyCode&&e.preventDefault()},differencesBetweenObjetcs(e,t,a=null){let s=[];if(null===a){const s=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);a=Array.from(new Set(s.concat(i)))}return a=a.filter(e=>"__ob__"!==e),a.forEach(a=>{(void 0===typeof e[a]||void 0===typeof t[a]||e[a]!=t[a]&&("object"!=typeof e[a]||"object"==typeof e[a]&&JSON.stringify(e[a])!==JSON.stringify(t[a])))&&s.push(a)}),s},tip(e,t="",a="Information"){this.$notify({group:e,title:""+a,text:t,duration:3e3})}}},A=S,N={name:"AttachmentEdit",props:{fnum:{type:String,required:!0},isDisplayed:{type:Boolean,default:!0}},mixins:[A],data(){return{displayed:!0,attachment:{},categories:{},file:null,canUpdate:!1,canSee:!0,error:!1,errorMessage:"",attachmentIsValidated:"-2",attachmentCanBeViewed:!1,attachmentCanBeDeleted:!1,attachmentDescription:""}},mounted(){this.displayed=this.isDisplayed,this.canUpdate=!!this.$store.state.user.rights[this.fnum]&&this.$store.state.user.rights[this.fnum].canUpdate,this.canSee=!this.$store.state.global.anonyme,this.attachment=this.$store.state.attachment.selectedAttachment,this.categories=this.$store.state.attachment.categories,this.attachmentCanBeViewed="1"==this.attachment.can_be_viewed,this.attachmentCanBeDeleted="1"==this.attachment.can_be_deleted,this.attachmentDescription=null!=this.attachment.upload_description?this.attachment.upload_description:"",this.attachmentIsValidated=this.attachment.is_validated},methods:{async saveChanges(){let e=new FormData;const t=this.attachmentCanBeViewed?"1":"0",a=this.attachmentCanBeDeleted?"1":"0";e.append("fnum",this.fnum),e.append("user",this.$store.state.user.currentUser),e.append("id",this.attachment.aid),e.append("description",this.attachmentDescription),e.append("is_validated",this.attachmentIsValidated),e.append("can_be_viewed",t),e.append("can_be_deleted",a),this.file&&e.append("file",this.file);const s=await g.updateAttachment(e);if(s.status.update){if(this.attachment.modified_by=this.$store.state.user.currentUser,this.attachment.upload_description=null!=this.attachmentDescription?this.attachmentDescription:"",this.attachment.is_validated=this.attachmentIsValidated,this.attachment.can_be_viewed=this.attachmentCanBeViewed,this.attachment.can_be_deleted=this.attachmentCanBeDeleted,this.$store.dispatch("attachment/updateAttachmentOfFnum",{fnum:this.fnum,attachment:this.attachment}),s.status.file_update){const e=await g.getPreview(this.$store.state.user.displayedUser,this.attachment.filename);this.$store.dispatch("attachment/setPreview",{preview:e,id:this.attachment.aid})}}else this.showError(s.msg)},updateFile(e){this.file=e.target.files[0],this.saveChanges()},updateAttachmentStatus(e){this.attachmentIsValidated=e.target.value,this.saveChanges()},showError(e){this.error=!0,this.errorMessage=e,setTimeout(()=>{this.error=!1,this.errorMessage=""},3e3)},toggleDisplay(e){this.displayed=e,this.$emit("update-displayed",this.displayed)}},computed:{allowedType(){let e="";return this.attachment.filename&&(e="."+this.attachment.filename.split(".").pop()),e}},watch:{"$store.state.attachment.selectedAttachment":function(){const e=Object.keys(this.$store.state.attachment.selectedAttachment);e.length>0&&(this.attachment=this.$store.state.attachment.selectedAttachment)}}},w=N,T=(a("6f1d"),Object(b["a"])(w,y,E,!1,null,null,null)),U=T.exports,R=function(){var e=this,t=e._self._c;return t("tr",{key:e.attachment.aid,staticClass:"attachment-row",class:{checked:e.checkedAttachments.includes(e.attachment.aid)}},[t("td",[t("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},domProps:{checked:e.checkedAttachments.includes(e.attachment.aid)},on:{change:function(t){return e.updateCheckedAttachments(e.attachment.aid)}}})]),e.columns.includes("name")?t("td",{staticClass:"td-document",on:{click:e.openModal}},[e.attachment.existsOnServer?e._e():t("span",{staticClass:"material-icons-outlined warning file-not-found em-mr-16",attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_FILE_NOT_FOUND")}},[e._v("warning")]),t("span",{attrs:{title:e.attachment.value}},[e._v(e._s(e.attachment.value))])]):e._e(),e.columns.includes("date")?t("td",{staticClass:"date"},[e._v(e._s(e.formattedDate(e.attachment.timedate)))]):e._e(),e.columns.includes("desc")?t("td",{staticClass:"desc"},[e._v(" "+e._s(e.strippedHtml(e.attachment.upload_description)))]):e._e(),e.columns.includes("category")?t("td",{staticClass:"category"},[e._v(" "+e._s(e.category)+" ")]):e._e(),e.columns.includes("status")?t("td",{staticClass:"status valid-state",class:{success:1==e.attachment.is_validated,warning:2==e.attachment.is_validated,error:0==e.attachment.is_validated}},[t("select",{attrs:{disabled:!1===e.canUpdate},on:{change:t=>e.updateStatus(t)}},[t("option",{attrs:{value:"1"},domProps:{selected:1==e.attachment.is_validated}},[e._v(e._s(e.translate("VALID")))]),t("option",{attrs:{value:"0"},domProps:{selected:0==e.attachment.is_validated}},[e._v(e._s(e.translate("INVALID")))]),t("option",{attrs:{value:"2"},domProps:{selected:2==e.attachment.is_validated}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WARNING")))]),t("option",{attrs:{value:"-2"},domProps:{selected:-2==e.attachment.is_validated||null===e.attachment.is_validated}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENTS_WAITING")))])])]):e._e(),e.canSee&&e.columns.includes("user")?t("td",[e._v(e._s(e.getUserNameById(e.attachment.user_id)))]):e._e(),e.canSee&&e.columns.includes("modified_by")?t("td",[e._v(e._s(e.getUserNameById(e.attachment.modified_by)))]):e._e(),e.columns.includes("modified")?t("td",{staticClass:"date"},[e._v(e._s(e.formattedDate(e.attachment.modified)))]):e._e(),e.columns.includes("permissions")?t("td",{staticClass:"permissions"},[e.attachment.profiles.length>0?t("span",{staticClass:"material-icons-outlined visibility-permission em-pointer",class:{active:"1"==e.attachment.can_be_viewed},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_VIEW")},on:{click:function(t){return e.changePermission("can_be_viewed",e.attachment)}}},[e._v("visibility")]):e._e(),e.attachment.profiles.length>0?t("span",{staticClass:"material-icons-outlined delete-permission em-pointer",class:{active:"1"==e.attachment.can_be_deleted},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_DELETE")},on:{click:function(t){return e.changePermission("can_be_deleted",e.attachment)}}},[e._v("delete_outlined")]):e._e()]):e._e(),e.sync&&e.columns.includes("sync")?t("td",[e.attachment.sync>0?t("div",["write"!=e.attachment.sync_method||e.syncLoading?"read"!=e.attachment.sync_method||e.syncLoading?e._e():t("span",{staticClass:"material-icons sync em-pointer",class:{success:1==e.synchronizeState,error:1!=e.synchronizeState},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_READ")},on:{click:function(t){return e.synchronizeAttachments(e.attachment.aid)}}},[e._v(" cloud_download ")]):t("span",{staticClass:"material-icons sync em-pointer",class:{success:1==e.synchronizeState,error:1!=e.synchronizeState},attrs:{title:e.translate("COM_EMUNDUS_ATTACHMENTS_SYNC_WRITE")},on:{click:function(t){return e.synchronizeAttachments(e.attachment.aid)}}},[e._v(" cloud_upload ")]),e.syncLoading?t("div",{staticClass:"sync-loader em-loader"}):e._e()]):e._e()]):e._e()])},x=[],L={async isSyncModuleActive(){try{const e=await h().get("index.php?option=com_emundus&controller=sync&task=issyncmoduleactive");return e.data}catch(e){return{status:!1,msg:e.message}}},async getSyncType(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getsynctype",{params:{upload_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async getSynchronizeState(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getsynchronizestate",{params:{upload_id:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},async synchronizeAttachments(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=synchronizeattachments",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async deleteAttachments(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=deleteattachments",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async checkAttachmentsExists(e){try{const t=new FormData;t.append("upload_ids",JSON.stringify(e));const a=await h().post("index.php?option=com_emundus&controller=sync&task=checkattachmentsexists",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data}catch(t){return{status:!1,msg:t.message}}},async saveConfig(e,t){try{const a=new FormData;return a.append("config",JSON.stringify(e)),a.append("type",t),await h().post("index.php?option=com_emundus&controller=sync&task=saveconfig",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getConfig(e){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getconfig",{params:{type:e}})}catch(t){return{status:!1,msg:t.message}}},async getAttachmentAspectsConfig(e){try{const t=await h().get("index.php?option=com_emundus&controller=sync&task=getattachmentaspectsconfig",{params:{attachmentId:e}});return t.data}catch(t){return{status:!1,msg:t.message}}},saveAttachmentAspectsConfig(e,t){try{const a=new FormData;return a.append("attachmentId",e),a.append("config",JSON.stringify(t)),h().post("index.php?option=com_emundus&controller=sync&task=saveattachmentaspectsconfig",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getAspects(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getaspects")}catch(e){return{status:!1,msg:e.message}}},async uploadAspectFile(e){try{const t=new FormData;return t.append("file",e),await h().post("index.php?option=com_emundus&controller=sync&task=uploadaspectfile",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async updateAspectListFromFile(e){try{const t=new FormData;return t.append("file",e),await h().post("index.php?option=com_emundus&controller=sync&task=updateaspectlistfromfile",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async getDocuments(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getdocuments")}catch(e){return{status:!1,msg:e.message}}},async getEmundusTags(){try{return await h().get("index.php?option=com_emundus&controller=sync&task=getemundustags")}catch(e){return{status:!1,msg:e.message}}},async updateSync(e,t){try{const a=new FormData;return a.append("did",e),a.append("sync",t),await h().post("index.php?option=com_emundus&controller=sync&task=updatedocumentsync",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async updateSyncMethod(e,t){try{const a=new FormData;return a.append("did",e),a.append("sync_method",t),await h().post("index.php?option=com_emundus&controller=sync&task=updatedocumentsyncmethod",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getSetupTags(){try{const e=await h().get("index.php?option=com_emundus&controller=sync&task=getsetuptags");return e.data}catch(e){return{status:!1,msg:e.message}}},async getAttachmentSyncNodeId(e){let t=null;if("undefined"!=typeof e&&null!==e)try{const a=await h().get("index.php?option=com_emundus&controller=sync&task=getnodeid",{params:{uploadId:e}});a.status&&a.data.status&&(t=a.data.data)}catch(a){console.log("Error occurred trying to get upload sync node id "+e)}return t}},k={name:"AttachmentRow",props:{attachment:{type:Object,required:!0},checkedAttachmentsProp:{type:Array,required:!0},canUpdate:{type:Boolean,default:!1},sync:{type:Boolean,default:!1},canSee:{type:Boolean,default:!0},columns:{type:Array,default(){return["name","date","desc","category","status","user","modified_by","modified","permissions","sync"]}}},mixins:[A],data(){return{categories:{},category:"",checkedAttachments:[],synchronizeState:!1,syncLoading:!1}},mounted(){this.categories=this.$store.state.attachment.categories,Object.entries(this.categories).length>0&&(this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:""),this.checkedAttachments=this.checkedAttachmentsProp,this.sync&&this.getSynchronizeState(this.attachment.aid).then(e=>{this.synchronizeState=e}).catch(e=>{this.synchronizeState=!1})},methods:{updateCheckedAttachments(e){this.checkedAttachments.includes(e)?this.checkedAttachments.splice(this.checkedAttachments.indexOf(e),1):this.checkedAttachments.push(e),this.$emit("update-checked-attachments",this.checkedAttachments)},openModal(){this.$emit("open-modal",this.attachment)},updateStatus(e){this.canUpdate&&this.$emit("update-status",e,this.attachment)},changePermission(e,t){this.canUpdate&&this.$emit("change-permission",e,t)},async getSynchronizeState(e){const t=await L.checkAttachmentsExists([e]);return!!t.status&&t.data[0]},synchronizeAttachments(e){e.length>0&&(this.syncLoading=!0,L.synchronizeAttachments([e]).then(t=>{t&&!1===t.status||this.getSynchronizeState(e).then(e=>{this.synchronizeState=e,this.syncLoading=!1}).catch(e=>{this.synchronizeState=!1,this.syncLoading=!1})}))}},watch:{"$store.state.attachment.checkedAttachments":function(){this.checkedAttachments=this.$store.state.attachment.checkedAttachments},"$store.state.attachment.categories":function(){this.categories=this.$store.state.attachment.categories,this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:""}}},I=k,B=(a("85db"),Object(b["a"])(I,R,x,!1,null,null,null)),P=B.exports,F={async getFnums(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=getallfnums");return e.data}catch(e){return!1}},async getFnumInfos(e){try{const t=await h().get("index.php?option=com_emundus&controller=files&task=getfnuminfos",{params:{fnum:e}});return t.data}catch(t){return!1}},async isDataAnonymized(){try{const e=await h().get("index.php?option=com_emundus&controller=files&task=isdataanonymized");return e.data}catch(e){return{status:!1,message:e.message}}}},$=a("ac68"),j=a.n($),G={name:"Attachments",components:{AttachmentPreview:O,AttachmentEdit:U,AttachmentRow:P},props:{user:{type:String,required:!0},fnum:{type:String,required:!0},defaultAttachments:{type:Array,default:null},defaultRights:{type:Object,default:null},columns:{type:Array,default(){return["name","date","desc","category","status","user","modified_by","modified","permissions","sync"]}},displayEdit:{type:Boolean,default:!0}},mixins:[A],data(){return{loading:!0,attachments:[],categories:{},fnums:[],users:[],displayedUser:{},displayedFnum:this.fnum,checkedAttachments:[],selectedAttachment:{},progress:"",sort:{last:"",order:"",orderBy:""},canSee:!0,canExport:!1,canDelete:!1,canDownload:!0,canUpdate:!1,canSync:!1,modalLoading:!1,slideTransition:"slide-fade",onlyPreview:!1,changeFileEvent:null,sync:!1,syncSelectedPreview:null,exportLink:"",search:"",category:"all"}},created(){this.canSee=!this.$store.state.global.anonyme,this.$store.dispatch("user/setCurrentUser",this.user),L.isSyncModuleActive().then(e=>{this.sync=e.data}).catch(e=>{console.log(e),this.sync=!1})},mounted(){this.loading=!0,this.setDisplayedUser().then(()=>{null!==this.defaultAttachments?this.getAttachmentCategories().then(e=>{this.categories=e||{},this.attachments=this.defaultAttachments,this.$store.dispatch("attachment/setAttachmentsOfFnum",{fnum:[this.displayedFnum],attachments:this.attachments}),this.setAccessRights().then(()=>{this.loading=!1})}):this.getAttachments().then(()=>{this.setAccessRights().then(()=>{this.loading=!1})}).catch(e=>{this.loading=!1,this.displayErrorMessage(e)})})},methods:{async setDisplayedUser(){const e=await F.getFnumInfos(this.displayedFnum);if(e&&e.fnumInfos){const t=!(!this.users||!this.users.length)&&this.users.find(t=>t.user_id==e.fnumInfos.applicant_id);if(t)this.displayedUser=t,this.$store.dispatch("user/setDisplayedUser",this.displayedUser.user_id),this.$store.dispatch("user/setUsers",[t]);else{const t=await D.getUserNameById(e.fnumInfos.applicant_id);t.status?(this.users.push(t.user),this.displayedUser=t.user,this.$store.dispatch("user/setDisplayedUser",this.displayedUser.user_id),this.$store.dispatch("user/setUsers",[t.user])):this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND"))}}else this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND"))},async getAttachments(){this.$store.state.attachment.attachments[this.displayedFnum]?(this.attachments=this.$store.state.attachment.attachments[this.displayedFnum],this.categories=this.$store.state.attachment.categories):await this.refreshAttachments()},async refreshAttachments(e=!1){!0===e&&(this.loading=!0),this.resetOrder(),this.checkedAttachments=[],this.$refs["searchbar"].value="";const t=await g.getAttachmentsByFnum(this.displayedFnum);if(t.status){this.attachments=t.attachments,this.$store.dispatch("attachment/setAttachmentsOfFnum",{fnum:[this.displayedFnum],attachments:this.attachments});const e=await this.getAttachmentCategories();this.categories=e||{}}else this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_ERROR_GETTING_ATTACHMENTS"));!0===e&&(this.loading=!1)},updateAttachment(){this.resetOrder(),this.getAttachments(),this.selectedAttachment={},this.checkedAttachments=[]},updateStatus(e,t){if(this.canUpdate){if(this.attachments.length<1)return;this.attachments.forEach((a,s)=>{if(a.aid==t.aid){this.resetOrder(),this.attachments[s].is_validated=e.target.value;let t=new FormData;t.append("fnum",this.displayedFnum),t.append("user",this.$store.state.user.currentUser),t.append("id",this.attachments[s].aid),t.append("is_validated",this.attachments[s].is_validated),g.updateAttachment(t).then(e=>{e&&!1===e.status&&this.displayErrorMessage(e.msg)}).catch(e=>{this.displayErrorMessage(e)})}})}},changePermission(e,t){this.canUpdate?this.attachments.forEach((a,s)=>{if(a.aid==t.aid){this.resetOrder(),this.attachments[s][e]="1"===this.attachments[s][e]?"0":"1";let t=new FormData;t.append("fnum",this.displayedFnum),t.append("user",this.$store.state.user.currentUser),t.append("id",this.attachments[s].aid),t.append(e,this.attachments[s][e]),g.updateAttachment(t).then(e=>{e.status||this.displayErrorMessage(e.msg)})}}):this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_UNAUTHORIZED_ACTION"))},synchronizeAttachments(e){let t=!1;return this.sync&&e.length>0&&L.synchronizeAttachments(e).then(e=>{e&&!1===e.status?this.displayErrorMessage(e.msg):(this.refreshAttachments(!0),t=!0)}),t},async setAccessRights(){if(!this.$store.state.user.rights[this.displayedFnum]){const e=await D.getAccessRights(this.$store.state.user.currentUser,this.displayedFnum);!0===e.status&&this.$store.dispatch("user/setAccessRights",{fnum:this.displayedFnum,rights:e.rights})}this.canExport=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canExport,this.canDelete=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canDelete,this.canUpdate=!!this.$store.state.user.rights[this.displayedFnum]&&this.$store.state.user.rights[this.displayedFnum].canUpdate},async exportAttachments(){this.canExport&&g.exportAttachments(this.displayedUser.user_id,this.displayedFnum,this.checkedAttachments).then(e=>{!0===e.data.status?(window.open(e.data.link,"_blank"),this.exportLink=e.data.link):this.displayErrorMessage(e.data.msg)})},confirmDeleteAttachments(){if(this.canDelete){let e="<p>"+this.translate("CONFIRM_DELETE_SELETED_ATTACHMENTS")+"</p><br>",t="";this.checkedAttachments.forEach(e=>{this.attachments.forEach(a=>{a.aid==e&&(t+=a.value+", ")})}),t=t.substring(0,t.length-2),e+="<p>"+t+"</p>",j.a.fire({title:this.translate("DELETE_SELECTED_ATTACHMENTS"),html:e,type:"warning",showCancelButton:!0,confirmButtonText:this.translate("JYES"),cancelButtonText:this.translate("JNO"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(e=>{e.value&&this.deleteAttachments()})}else this.displayErrorMessage(this.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"))},async deleteAttachments(){if(this.canDelete){this.attachments=this.attachments.filter(e=>!this.checkedAttachments.includes(e.aid));let e=null;this.sync?L.deleteAttachments(this.checkedAttachments).then(async t=>{!1===t.status&&""!==t.msg&&this.displayErrorMessage(t.msg),e=await g.deleteAttachments(this.displayedFnum,this.displayedUser.user_id,this.checkedAttachments)}):e=await g.deleteAttachments(this.displayedFnum,this.displayedUser.user_id,this.checkedAttachments),!1===e.status&&""!==e.msg&&this.displayErrorMessage(e.msg)}else this.displayErrorMessage(this.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"))},changeAttachment(e,t=!1){this.slideTransition=t?"slide-fade-reverse":"slide-fade",this.modalLoading=!0,this.selectedAttachment=this.displayedAttachments[e],this.$store.dispatch("attachment/setSelectedAttachment",this.selectedAttachment),setTimeout(()=>{this.modalLoading=!1},500)},resetOrder(){this.sort={last:"",order:"",orderBy:""}},orderBy(e){this.sort.last===e?(this.sort.order="asc"===this.sort.order?"desc":"asc",this.attachments.reverse()):(this.attachments.sort((t,a)=>t[e]<a[e]?-1:t[e]>a[e]?1:0),this.sort.order="asc"),this.sort.orderBy=e,this.sort.last=e},updateAllCheckedAttachments(e){e.target.checked?this.checkedAttachments=this.displayedAttachments.map(e=>e.aid):this.checkedAttachments=[]},updateCheckedAttachments(e){Array.isArray(e)?this.checkedAttachments=e:(console.warn("updateCheckedAttachments() expects an array as argument"),this.displayErrorMessage("Something went wrong while updating the checked attachments"),this.checkedAttachments=[])},filterCheckedAttachments(){this.checkedAttachments=this.checkedAttachments.filter(e=>this.displayedAttachments.some(t=>t.aid==e))},onSearch(){this.filterCheckedAttachments()},onSearchKeyup(e){e.stopPropagation(),e.preventDefault(),this.onSearch()},openModal(e){this.displayedUser.user_id&&this.displayedFnum&&(this.$modal.show("edit"),this.selectedAttachment=e,this.$store.dispatch("attachment/setSelectedAttachment",e))},closeModal(){this.$modal.hide("edit"),this.selectedAttachment={},this.$store.dispatch("attachment/setSelectedAttachment",{})},displayErrorMessage(e){j.a.fire({title:this.translate("ERROR"),text:e,type:"error",confirmButtonColor:"#3085d6",confirmButtonText:this.translate("COM_EMUNDUS_ATTACHMENTS_CLOSE")})},beforeLeaveSlide(e){"slide-fade"===this.slideTransition&&(e.style.transform="translateX(-100%)"),e.setAttribute("class","modal-body "+this.slideTransition+"-leave-active "+this.slideTransition+"-leave-to")},toggleOnlyPreview(e){this.onlyPreview=!e}},computed:{fnumPosition(){return this.fnums.indexOf(this.displayedFnum)},selectedAttachmentPosition(){return this.displayedAttachments.indexOf(this.selectedAttachment)},attachmentPath(){return this.$store.state.attachment.attachmentPath+this.displayedUser.user_id+"/"+this.selectedAttachment.filename},displayedAttachmentCategories(){let e={};if(Object.entries(this.categories).length>0)for(let t in this.categories)for(let a in this.attachments)this.attachments[a].category==t&&(e[t]=this.categories[t]);return e},displayedAttachments(){const e=this.search.toLowerCase();return"undefined"!==typeof this.attachments&&null!==this.attachments?this.attachments.filter(t=>(null===t.upload_description&&(t.upload_description=""),(t.upload_description.toLowerCase().includes(e)||t.value.toLowerCase().includes(e))&&("all"===this.category||t.category===this.category))):[]}},watch:{"$store.state.global.anonyme":function(){this.canSee=!this.$store.state.global.anonyme},selectedAttachment:function(){this.syncSelectedPreview=null,L.getAttachmentSyncNodeId(this.selectedAttachment.aid).then(e=>{this.syncSelectedPreview=e})},checkedAttachments:function(){this.$store.dispatch("attachment/setCheckedAttachments",this.checkedAttachments)},categories:function(){const e=localStorage.getItem("vue-attachment-category");e&&this.displayedAttachmentCategories[e]&&(this.category=e)},category:function(){"all"!==this.category?localStorage.setItem("vue-attachment-category",this.category):localStorage.removeItem("vue-attachment-category"),this.filterCheckedAttachments()}}},H=G,z=(a("68e9"),Object(b["a"])(H,o,c,!1,null,null,null)),V=z.exports,Y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-ml-32 em-files"},[e.currentFile?t("Application",{attrs:{file:e.currentFile,type:e.$props.type,user:e.$props.user,ratio:e.$props.ratio},on:{getFiles:function(t){return e.getFiles(!0)}}}):e._e(),t("div",{staticClass:"em-mb-12 em-flex-row em-flex-space-between"},[t("h4",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_"+e.type.toUpperCase())))])]),e.files?t("div",[t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("div",{staticClass:"em-flex-row"},[t("div",{staticClass:"em-flex-row"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_TOTAL")))]),t("span",{staticClass:"em-ml-4"},[e._v(e._s(e.total_count))])]),t("span",{staticClass:"em-ml-8 em-mr-8"},[e._v("|")]),t("div",{staticClass:"em-flex-row"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_DISPLAY_PAGE")))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.limit,expression:"limit"}],staticClass:"em-select-no-border em-ml-8",staticStyle:{width:"50px",height:"20px"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.limit=t.target.multiple?a:a[0]}}},[t("option",[e._v("10")]),t("option",[e._v("25")]),t("option",[e._v("50")]),t("option",[e._v("100")])])])]),null!==e.pages?[e.pages.length>1?t("div",{staticClass:"em-flex-row"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_PAGE")))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.page,expression:"page"}],staticClass:"em-select-no-border em-ml-8",staticStyle:{width:"40px",height:"20px"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.page=t.target.multiple?a:a[0]}}},e._l(e.pages,(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(e.displayPage(a)))])})),0),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_PAGE_ON")))]),t("span",{staticClass:"em-ml-8 em-mr-8"},[e._v(e._s(e.pages.length))])]):e._e()]:e._e()],2)]):e._e(),e.files?t("div",["evaluation"===e.$props.type?t("tabs",{attrs:{tabs:e.tabs},on:{updateTab:e.updateTab}}):e._e(),t("hr"),e.filtersLoading?t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("skeleton",{staticClass:"em-border-radius-8",attrs:{height:"40px",width:"96px"}}),t("skeleton",{staticClass:"em-border-radius-8",attrs:{height:"40px",width:"120px"}})],1):t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("div",{staticClass:"em-flex-row-start",attrs:{id:"filters"}},[e.defaultFilters.length>0?t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onDefaultFiltersClickOutside,expression:"onDefaultFiltersClickOutside"}],attrs:{id:"default-filters"}},[t("div",{staticClass:"em-tabs em-pointer em-flex-row em-s-justify-content-center",on:{click:function(t){e.openedFilters=!e.openedFilters}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FILES_FILTER")))]),t("span",{staticClass:"material-icons-outlined"},[e._v("filter_list")])]),t("ul",{class:{hidden:!e.openedFilters,"em-input":!0}},e._l(e.defaultFilters,(function(a){return t("li",{key:a.id,staticClass:"em-pointer",on:{click:function(t){return e.addFilter(a)}}},[e._v(e._s(a.label))])})),0)]):e._e(),e.filters.length>0?t("div",{staticClass:"em-flex-row",attrs:{id:"applied-filters"}},e._l(e.filters,(function(a){return t("div",{key:a.key,staticClass:"applied-filter em-ml-8 em-flex-row"},[t("label",{staticClass:"filter-label em-mr-8",attrs:{for:a.id+"-"+a.key,title:a.label}},[e._v(e._s(a.label))]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.selectedOperator,expression:"filter.selectedOperator"}],staticClass:"em-mr-8",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"selectedOperator",t.target.multiple?s:s[0])}}},e._l(a.operators,(function(a){return t("option",{key:a.value,domProps:{value:a.value}},[e._v(e._s(a.label))])})),0),"field"==a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:a.selectedValue,expression:"filter.selectedValue"}],attrs:{name:a.id+"-"+a.key,type:"text",placeholder:a.label},domProps:{value:a.selectedValue},on:{input:function(t){t.target.composing||e.$set(a,"selectedValue",t.target.value)}}}):"date"==a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:a.selectedValue,expression:"filter.selectedValue"}],attrs:{name:a.id+"-"+a.key,type:"date"},domProps:{value:a.selectedValue},on:{input:function(t){t.target.composing||e.$set(a,"selectedValue",t.target.value)}}}):"select"==a.type?t("multiselect",{attrs:{label:"label","track-by":"value",options:a.values,multiple:!0,taggable:!1,"select-label":"",placeholder:a.label,"selected-label":"","deselect-label":"","close-on-select":!0,"clear-on-select":!1,searchable:!0,"allow-empty":!0,width:"250px"},model:{value:a.selectedValue,callback:function(t){e.$set(a,"selectedValue",t)},expression:"filter.selectedValue"}}):e._e(),t("span",{staticClass:"material-icons-outlined em-pointer em-red-500-color",on:{click:function(t){return e.removeFilter(a)}}},[e._v("close")])],1)})),0):e._e()]),e.defaultFilters.length>0?t("div",{staticClass:"em-flex-row"},[t("span",{staticClass:"material-icons-outlined em-mr-16 em-red-500-color",class:{"em-pointer":e.filters.length>0,"em-pointer-disbabled":e.filters.length<1},attrs:{alt:e.translate("COM_EMUNDUS_FILES_RESET_FILTERS")},on:{click:e.resetFilters}},[e._v("filter_list_off")]),t("button",{staticClass:"em-primary-button em-pointer",on:{click:e.applyFilters}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_APPLY_FILTER")))])]):e._e()])],1):e._e(),e.files&&e.columns&&e.files.length>0?t("div",{key:e.reloadFiles,staticClass:"em-flex-row em-align-start"},[t("div",{staticClass:"table-columns-move em-flex-column em-mr-4",class:e.moveRight?"":"em-disabled-state",attrs:{id:"table_columns_move_right"},on:{click:e.scrollToRight}},[t("span",{staticClass:"material-icons-outlined em-pointer",staticStyle:{"font-size":"16px"}},[e._v("arrow_back")])]),t("el-table",{ref:"tableFiles",staticStyle:{width:"100%"},attrs:{height:"calc(100vh - 250px)",data:e.files},on:{"select-all":e.selectRow,select:e.selectRow}},[t("el-table-column",{attrs:{fixed:"",type:"selection",width:"55"}}),t("el-table-column",{attrs:{fixed:"",label:e.translate("COM_EMUNDUS_ONBOARD_FILE"),width:"270"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"em-pointer",on:{click:function(t){return e.openApplication(a.row)}}},[t("p",{staticClass:"em-font-weight-500"},[e._v(e._s(a.row.applicant_name))]),t("span",{staticClass:"em-text-neutral-500 em-font-size-14"},[e._v(e._s(a.row.fnum))])])]}}],null,!1,3192032070)}),e._l(e.columns,(function(a){return 1==a.show_in_list_summary?["status"===a.name?t("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{staticClass:"em-neutral-700-color",attrs:{title:e.translate("COM_EMUNDUS_ONBOARD_STATUS")}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_STATUS")))])]}},{key:"default",fn:function(a){return[t("p",{staticClass:"em-status",class:"label-text-"+a.row.status_color+" label-"+a.row.status_color},[e._v(e._s(a.row.status))])]}}],null,!0)}):"assocs"===a.name?t("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{staticClass:"em-neutral-700-color",attrs:{title:e.translate("COM_EMUNDUS_FILES_ASSOCS")}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_ASSOCS")))])]}},{key:"default",fn:function(a){return[t("div",{staticClass:"em-group-assoc-column"},e._l(a.row.assocs,(function(a){return t("span",{staticClass:"em-status em-mb-4",class:a.class},[e._v(e._s(a.label))])})),0)]}}],null,!0)}):t("el-table-column",{attrs:{"min-width":"180"},scopedSlots:e._u([{key:"header",fn:function(s){return[t("span",{staticClass:"em-neutral-700-color",attrs:{title:a.label}},[e._v(e._s(a.label))])]}},{key:"default",fn:function(s){return[t("p",{domProps:{innerHTML:e._s(s.row[a.name])}})]}}],null,!0)})]:e._e()}))],2),e.moveLeft?t("div",{staticClass:"table-columns-move em-flex-column em-ml-4",attrs:{id:"table_columns_move_left"},on:{click:e.scrollToLeft}},[t("span",{staticClass:"material-icons-outlined em-pointer",staticStyle:{"font-size":"16px"}},[e._v("arrow_forward")])]):e._e()],1):e._e(),e.files&&e.columns&&0===e.files.length?t("div",[t("h6",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_NOFILES")))])]):e._e(),e.rows_selected.length>0?t("div",{staticClass:"selected-rows-tip"},[t("div",{staticClass:"selected-rows-tip__content em-flex-row"},[1===e.rows_selected.length?t("span",[e._v(e._s(e.rows_selected.length)+" "+e._s(e.translate("COM_EMUNDUS_FILES_ELEMENT_SELECTED"))+" :")]):e.rows_selected.length>1?t("span",[e._v(e._s(e.rows_selected.length)+" "+e._s(e.translate("COM_EMUNDUS_FILES_ELEMENTS_SELECTED"))+" :")]):e._e(),t("a",{staticClass:"em-pointer em-ml-16",on:{click:function(t){return e.toggleSelection()}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_UNSELECT")))]),t("a",{staticClass:"em-pointer em-ml-16",on:{click:function(t){return e.openInNewTab()}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_OPEN_IN_NEW_TAB")))])])]):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},q=[],J=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-flex-row em-gap-8"},e._l(e.$props.tabs,(function(a){return t("div",{staticClass:"em-tabs em-pointer",class:e.selected===a.name?"em-selected-tab":"",on:{click:function(t){e.selected=a.name,e.$emit("updateTab",a.name)}}},[t("p",[e._v(e._s(e.translate(a.label))+" ("+e._s(a.total)+")")])])})),0)},W=[],K={name:"Tabs",props:{tabs:Array},data:()=>({selected:""}),created(){this.$props.tabs.forEach(e=>{e.selected&&(this.selected=e.name)})}},X=K,Q=Object(b["a"])(X,J,W,!1,null,"0ba22308",null),Z=Q.exports,ee=a("cca1"),te={async getFiles(e="default",t=!1,a=25,s=0){try{const a=await h().get("index.php?option=com_emundus&controller=file&task=getfiles",{params:{type:e,refresh:t}});return a.data}catch(i){return!1}},async getColumns(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getcolumns",{params:{type:e}});return t.data}catch(t){return!1}},async getEvaluationFormByFnum(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getevaluationformbyfnum",{params:{fnum:e}});return t.data}catch(t){return!1}},async getMyEvaluation(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getmyevaluation",{params:{fnum:e}});return t.data}catch(t){return!1}},async checkAccess(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=checkaccess",{params:{fnum:e}});return t.data}catch(t){return!1}},async getLimit(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getlimit",{params:{type:e}});return t.data}catch(t){return!1}},async getPage(e="default"){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getpage",{params:{type:e}});return t.data}catch(t){return!1}},async updateLimit(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=updatelimit",{params:{limit:e}});return t.data}catch(t){return!1}},async updatePage(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=updatepage",{params:{page:e}});return t.data}catch(t){return!1}},async getSelectedTab(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getselectedtab",{params:{type:e}});return t.data}catch(t){return!1}},async setSelectedTab(e,t="evaluation"){try{const a=await h().get("index.php?option=com_emundus&controller=file&task=setselectedtab",{params:{tab:e,type:t}});return a.data}catch(a){return!1}},async getFile(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getfile",{params:{fnum:e}});return t.data}catch(t){return!1}},async getFilters(){try{const e=await h().get("index.php?option=com_emundus&controller=file&task=getfilters");return e.data}catch(e){return!1}},async applyFilters(e){const t=new FormData;t.append("filters",JSON.stringify(e));try{const e=await h().post("index.php?option=com_emundus&controller=file&task=applyfilters",t);return e.data}catch(a){return!1}},async getComments(e){try{const t=await h().get("index.php?option=com_emundus&controller=file&task=getcomments",{params:{fnum:e}});if(Array.isArray(t.data.data)){const e=t.data.data.every(e=>!!e.hasOwnProperty("id"));return e?t.data:{data:[],status:!1,msg:"Invalid response"}}return{data:[],status:!1,msg:"Invalid response"}}catch(t){return{status:!1,msg:t.message}}},async saveComment(e,t){const a=new FormData;a.append("fnum",e),Object.keys(t).forEach(e=>{a.append(e,t[e])});try{const e=await h().post("index.php?option=com_emundus&controller=file&task=savecomment",a);return e.data}catch(s){return{status:!1,msg:s.message}}},async deleteComment(e){try{const t=await h().delete("index.php?option=com_emundus&controller=file&task=deletecomment",{params:{cid:e}});return t.data}catch(t){return{status:!1,msg:t.message}}}},ae={methods:{async displayError(e,t,a="error",s=!1,i="COM_EMUNDUS_OK",n="COM_EMUNDUS_ACTIONS_CANCEL",l=!1,r=null){let o={title:this.translate(e),text:this.translate(t),type:a,showCancelButton:s,confirmButtonText:this.translate(i),cancelButtonText:this.translate(n),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}};return l?o.html=t:o.text=this.translate(t),j.a.fire(o).then(e=>!!e.value&&(null!=r&&r(),!0))}}},se=ae,ie=function(){var e=this,t=e._self._c;return t("modal",{attrs:{id:"application-modal",name:"application-modal",height:"100vh",width:"100vw",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"},on:{"before-open":e.beforeOpen,"before-close":function(t){return e.updateURL()},closed:function(t){return e.$emit("getFiles")}}},[t("div",{staticClass:"em-modal-header em-w-100 em-h-50 em-p-12-16 em-bg-main-900 em-flex-row"},[t("div",{staticClass:"em-flex-row em-pointer em-gap-8",attrs:{id:"evaluation-modal-close"}},[t("div",{staticClass:"em-w-max-content em-flex-row",on:{click:function(t){return e.$modal.hide("application-modal")}}},[t("span",{staticClass:"material-icons-outlined em-font-size-16",staticStyle:{color:"white"}},[e._v("arrow_back")])]),t("span",{staticClass:"em-text-neutral-500"},[e._v("|")]),""!=e.file.applicant_name?t("p",{staticClass:"em-font-size-14",staticStyle:{color:"white"}},[e._v(" "+e._s(e.file.applicant_name)+" - "+e._s(e.file.fnum)+" ")]):t("p",{staticClass:"em-font-size-14",staticStyle:{color:"white"}},[e._v(" "+e._s(e.file.fnum)+" ")])])]),e.access?t("div",{staticClass:"modal-grid",style:"grid-template-columns:"+this.ratioStyle},[t("div",{attrs:{id:"modal-applicationform"}},[t("div",{staticClass:"scrollable"},[t("div",{staticClass:"em-flex-row em-flex-center em-gap-16 em-border-bottom-neutral-300 sticky-tab"},e._l(e.tabs,(function(a){return e.access[a.access].r?t("div",{staticClass:"em-light-tabs em-pointer",class:e.selected===a.name?"em-light-selected-tab":"",on:{click:function(t){e.selected=a.name}}},[t("span",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate(a.label)))])]):e._e()})),0),"application"===e.selected?t("div",{domProps:{innerHTML:e._s(e.applicationform)}}):e._e(),"attachments"===e.selected?t("Attachments",{attrs:{fnum:e.file.fnum,user:e.$props.user,columns:["name","date","category","status"],displayEdit:!1}}):e._e(),"comments"===e.selected?t("Comments",{attrs:{fnum:e.file.fnum,user:e.$props.user,access:e.access["10"]}}):e._e()],1)]),t("div",{attrs:{id:"modal-evaluationgrid"}},[e.loading?e._e():t("div",{staticClass:"em-flex-column",staticStyle:{width:"40px",height:"40px",margin:"24px 0 12px 24px"}},[t("div",{staticClass:"em-circle-main-100 em-flex-column",staticStyle:{width:"40px"}},[t("div",{staticClass:"em-circle-main-200 em-flex-column",staticStyle:{width:"24px"}},[t("span",{staticClass:"material-icons-outlined em-main-400-color",staticStyle:{"font-size":"14px"}},[e._v("troubleshoot")])])])]),e.url?t("iframe",{staticClass:"iframe-evaluation",attrs:{src:e.url,id:"iframe-evaluation",title:"Evaluation form"},on:{load:function(t){return e.iframeLoaded(t)}}}):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])]):e._e()])},ne=[],le=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"comments"}},[t("div",{staticClass:"em-flex-column em-flex-center em-mt-24"},e._l(e.comments,(function(a){return t("div",{key:a.id,staticClass:"em-input-card em-w-50 em-mb-16"},[t("div",{staticClass:"em-flex-row em-flex-space-between"},[t("div",[t("p",[e._v(e._s(a.user))]),t("span",{staticClass:"em-text-neutral-500"},[e._v(e._s(e.formattedDate(a.date,"LLLL","+0200")))])]),t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hideOptions,expression:"hideOptions"}]},[t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){e.show_options=a.id}}},[e._v("more_vert")]),e.show_options===a.id?t("div",{staticClass:"em-comment-option"},[e.$props.access.d||e.$props.access.c&&a.user_id==e.$props.user?t("span",{staticClass:"em-pointer comment-delete",on:{click:function(t){return e.deleteComment(a.id)}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_DELETE")))]):e._e()]):e._e()])]),t("hr"),t("div",{staticClass:"comment-content"},[t("strong",{staticClass:"em-mb-8"},[e._v(e._s(a.reason))]),t("p",{staticStyle:{"word-break":"break-all"}},[e._v(e._s(a.comment_body))])])])})),0),e.adding_comment?t("div",{staticClass:"em-flex-row em-flex-center em-mt-24"},[t("div",{staticClass:"em-input-card em-w-50"},[t("div",[t("span",{staticClass:"material-icons-outlined em-pointer em-float-right em-mb-4",on:{click:function(t){e.adding_comment=!1}}},[e._v("close")])]),t("div",{staticClass:"em-mb-8"},[t("label",{attrs:{for:"reason"}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_TITLE")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.comment.reason,expression:"comment.reason"}],staticClass:"em-w-100",attrs:{id:"reason",type:"text"},domProps:{value:e.comment.reason},on:{input:function(t){t.target.composing||e.$set(e.comment,"reason",t.target.value)}}})]),t("div",[t("label",{staticClass:"em-mb-4",attrs:{for:"body"}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_COMMENT_BODY")))]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment.comment_body,expression:"comment.comment_body"}],attrs:{id:"body"},domProps:{value:e.comment.comment_body},on:{input:function(t){t.target.composing||e.$set(e.comment,"comment_body",t.target.value)}}})]),t("div",{staticClass:"em-mt-8"},[t("button",{staticClass:"em-primary-button em-w-auto em-float-right",on:{click:e.saveComment}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_VALIDATE_COMMENT")))])])])]):e._e(),e.$props.access.c&&!e.adding_comment?t("div",{staticClass:"em-flex-row em-flex-center em-mt-32"},[t("button",{staticClass:"em-primary-button em-w-auto",on:{click:function(t){e.adding_comment=!0}}},[e._v(e._s(e.translate("COM_EMUNDUS_FILES_ADD_COMMENT")))])]):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},re=[],oe={name:"Comments",props:{user:{type:String,required:!0},fnum:{type:String,required:!0},access:{type:Object,required:!0}},mixins:[A,se],data:()=>({comments:[],comment:{reason:"",comment_body:""},loading:!1,adding_comment:!1,show_options:!1}),created(){this.getComments()},methods:{getComments(){this.loading=!0,te.getComments(this.$props.fnum).then(e=>{1==e.status?(this.comments=e.data,this.loading=!1):(this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC"),this.loading=!1)})},saveComment(){this.loading=!0,te.saveComment(this.$props.fnum,this.comment).then(e=>{1==e.status?(this.comments.push(e.data),this.comment={reason:"",comment_body:""},this.adding_comment=!1,this.loading=!1):(this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC"),this.loading=!1)})},deleteComment(e){let t=!1;return(this.access.d||this.access.c&&comment.user_id==this.user)&&null!==e&&e>0&&(this.loading=!0,te.deleteComment(e).then(a=>{1==a.status?(t=!0,this.comments.splice(this.comments.findIndex(t=>t.id===e),1),this.loading=!1):(this.displayError("COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS","COM_EMUNDUS_FILES_CANNOT_GET_COMMENTS_DESC"),this.loading=!1)})),t},hideOptions(){this.show_options=!1}}},ce=oe,de=(a("f15d"),Object(b["a"])(ce,le,re,!1,null,"b06f4eda",null)),me=de.exports,ue={name:"Application",components:{Comments:me,Attachments:V},props:{file:Object|String,type:String,user:{type:String,required:!0},ratio:{type:String,default:"66/33"}},mixins:[se],data:()=>({applicationform:"",selected:"application",tabs:[{label:"COM_EMUNDUS_FILES_APPLICANT_FILE",name:"application",access:"1"},{label:"COM_EMUNDUS_FILES_ATTACHMENTS",name:"attachments",access:"4"},{label:"COM_EMUNDUS_FILES_COMMENTS",name:"comments",access:"10"}],evaluation_form:0,url:null,access:null,student_id:null,loading:!1}),methods:{beforeOpen(){var e=document.querySelector(":root");let t=this.$props.ratio.split("/");e.style.setProperty("--attachment-width",t[0]+"%"),this.loading=!0;let a="";a="string"==typeof this.$props.file?this.$props.file:this.$props.file.fnum,"string"==typeof this.$props.file?te.getFile(a).then(e=>{1==e.status?(this.$props.file=e.data,this.access=e.rights,this.updateURL(this.$props.file.fnum),this.getApplicationForm(),"evaluation"===this.$props.type&&this.getEvaluationForm()):this.displayError("COM_EMUNDUS_FILES_CANNOT_ACCESS","COM_EMUNDUS_FILES_CANNOT_ACCESS_DESC").then(e=>{!0===e&&this.$modal.hide("application-modal")})}):te.checkAccess(a).then(e=>{1==e.status?(this.access=e.data,this.updateURL(this.$props.file.fnum),this.access["1"].r?this.getApplicationForm():this.access["4"].r?this.selected="attachments":this.access["10"].r&&(this.selected="comments"),"evaluation"===this.$props.type&&this.getEvaluationForm()):this.displayError("COM_EMUNDUS_FILES_CANNOT_ACCESS","COM_EMUNDUS_FILES_CANNOT_ACCESS_DESC").then(e=>{!0===e&&this.$modal.hide("application-modal")})})},getApplicationForm(){p()({method:"get",url:"index.php?option=com_emundus&view=application&format=raw&layout=form&fnum="+this.file.fnum}).then(e=>{this.applicationform=e.data,"evaluation"!==this.$props.type&&(this.loading=!1)})},getEvaluationForm(){null!=this.$props.file.id&&(this.rowid=this.$props.file.id),"undefined"!=typeof this.$props.file.applicant_id?this.student_id=this.$props.file.applicant_id:this.student_id=this.$props.file.student_id;let e="form";te.getEvaluationFormByFnum(this.$props.file.fnum).then(t=>{0!==t.data&&("undefined"===typeof this.$props.file.id?te.getMyEvaluation(this.$props.file.fnum).then(a=>{this.rowid=a.data,null==this.rowid&&(this.rowid=""),this.url="index.php?option=com_fabrik&c=form&view="+e+"&formid="+t.data+"&rowid="+this.rowid+"&jos_emundus_evaluations___student_id[value]="+this.student_id+"&jos_emundus_evaluations___campaign_id[value]="+this.$props.file.campaign+"&jos_emundus_evaluations___fnum[value]="+this.$props.file.fnum+"&student_id="+this.student_id+"&tmpl=component&iframe=1"}):this.url="index.php?option=com_fabrik&c=form&view="+e+"&formid="+t.data+"&rowid="+this.rowid+"&jos_emundus_evaluations___student_id[value]="+this.student_id+"&jos_emundus_evaluations___campaign_id[value]="+this.$props.file.campaign+"&jos_emundus_evaluations___fnum[value]="+this.$props.file.fnum+"&student_id="+this.student_id+"&tmpl=component&iframe=1")})},iframeLoaded(e){this.loading=!1},updateURL(e=""){let t=window.location.href;t=t.split("#"),""===e?window.history.pushState("","",t[0]):window.history.pushState("","",t[0]+"#"+e)}},computed:{ratioStyle(){let e=this.$props.ratio.split("/");return e[0]+"% "+e[1]+"%"}}},pe=ue,_e=(a("8353"),Object(b["a"])(pe,ie,ne,!1,null,null,null)),he=_e.exports,ge=a("e191"),fe=a.n(ge),ve=function(){var e=this,t=e._self._c;return t("span",{staticClass:"em-skeleton",class:e.classes,style:{height:e.height,width:e.width}})},be=[],Ce={name:"Skeleton.vue",props:{height:{type:String,default:"auto"},width:{type:String,default:"auto"},classes:{type:String,default:""}}},Oe=Ce,ye=(a("cd95"),Object(b["a"])(Oe,ve,be,!1,null,"59286d38",null)),Ee=ye.exports,De={name:"Files",components:{Skeleton:Ee,Application:he,Tabs:Z,"el-table":ee["Table"],"el-table-column":ee["TableColumn"],multiselect:fe.a},props:{type:{String:String,default:""},ratio:{type:String,default:"66/33"},user:{type:String,required:!0}},mixins:[se],data:()=>({loading:!1,filtersLoading:!1,moveRight:!1,moveLeft:!0,scrolling:null,reloadFiles:0,total_count:0,tabs:[{label:"COM_EMUNDUS_FILES_TO_EVALUATE",name:"to_evaluate",total:0,selected:!1},{label:"COM_EMUNDUS_FILES_EVALUATED",name:"evaluated",total:0,selected:!1},{label:"COM_EMUNDUS_FILES_ALL",name:"all",total:0,selected:!1}],selected_tab:0,files:null,columns:null,page:null,pages:null,limit:null,defaultFilters:[],filters:[],openedFilters:!1,currentFile:null,rows_selected:[]}),created(){this.addKeyupEnterEventlistener(),this.getLimit(),this.getPage(),"evaluation"===this.$props.type&&te.getSelectedTab(this.$props.type).then(e=>{this.tabs.forEach((t,a)=>{t.name===e.data&&(this.tabs[a].selected=!0,this.selected_tab=a)}),this.getFiles()})},methods:{addKeyupEnterEventlistener(){window.document.addEventListener("keyup",e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())})},getLimit(){te.getLimit(this.$props.type).then(e=>{1==e.status?this.limit=e.data:this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg)})},getPage(){te.getPage(this.$props.type).then(e=>{1==e.status?this.page=e.data:this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg)})},getFiles(e=!1){this.loading=!0;let t=window.location.href.split("#")[1];"undefined"==typeof t&&(t=""),"evaluation"===this.$props.type&&te.getFiles(this.$props.type,e,this.limit,this.page).then(e=>{1==e.status?(this.total_count=e.total,"undefined"!==typeof e.data.all?this.files=e.data.all:this.files=[],this.tabs.forEach((t,a)=>{e[t.name]&&(this.tabs[a].total=e[t.name].total)}),te.getColumns(this.$props.type).then(e=>{this.columns=e.data,""!==t&&this.openModal(t),this.getFilters(),this.loading=!1,this.reloadFiles++;let a=Math.ceil(this.tabs[this.selected_tab].total/this.limit);this.pages=Array.from(Array(a).keys())})):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg))})},getFilters(){this.filtersLoading=!0,te.getFilters().then(e=>{1==e.status?(0==this.filters.length&&e.data.applied_filters.length>0&&e.data.applied_filters.forEach(t=>{const a=e.data.default_filters.find(e=>e.id==t.id);this.addFilter(a,t.selectedValue,t.selectedOperator)}),this.defaultFilters=e.data.default_filters,this.filtersLoading=!1):(this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg),this.filtersLoading=!1)})},addFilter(e,t=null,a=null){this.filters.push({id:e.id,key:Math.random(),type:e.type,values:e.values,label:e.label,selectedValue:t,operators:e.operators,selectedOperator:null===a?e.operators[0].value:a})},removeFilter(e){this.filters.find((t,a)=>{t.key==e.key&&this.filters.splice(a,1)})},resetFilters(){this.filters.length>0&&(this.filters=[],te.applyFilters(this.filters).then(e=>{this.getFiles(!0)}))},applyFilters(){const e=this.filters.map(e=>{if(null!==e.selectedValue)return{id:e.id,type:e.type,selectedValue:e.selectedValue,selectedOperator:e.selectedOperator}});te.applyFilters(e).then(e=>{this.getFiles(!0)})},updateLimit(e){this.loading=!0,te.updateLimit(e).then(e=>{1==e.status?(this.page=0,this.getFiles(!0)):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg))})},prevPage(){this.page--,this.updatePage()},nextPage(){this.page++,this.updatePage()},updatePage(e){te.updatePage(e).then(e=>{1==e.status?this.getFiles(!0):(this.loading=!1,this.displayError("COM_EMUNDUS_ERROR_OCCURED",e.msg))})},openModal(e){this.currentFile=e,setTimeout(()=>{this.$modal.show("application-modal")},500)},updateTab(e){this.selected_tab=this.tabs.map(e=>e.name).indexOf(e),te.setSelectedTab(e).then(()=>{this.getLimit(),this.getPage(),this.getFiles(!0)})},openApplication(e){this.openModal(e)},selectRow(e,t){this.rows_selected=e},toggleSelection(){this.$refs.tableFiles.clearSelection(),this.rows_selected=[]},openInNewTab(){this.rows_selected.forEach(e=>{window.open(window.location.href+"#"+e.fnum,"_blank")})},scrollToLeft(){this.moveRight=!0;let e=document.getElementsByClassName("el-table__body-wrapper")[0];e.scrollLeft+=180},scrollToRight(){let e=document.getElementsByClassName("el-table__body-wrapper")[0];e.scrollLeft-=180,0==e.scrollLeft&&(this.moveRight=!1)},stopScrolling(){clearInterval(this.scrolling),this.scrolling=null},displayPage(e){return e+1},onDefaultFiltersClickOutside(){this.openedFilters&&(this.openedFilters=!1)}},watch:{limit:function(e,t){null===t||this.loading||this.updateLimit(e)},page:function(e,t){null===t||this.loading||this.updatePage(e)}}},Me=De,Se=(a("64c2"),Object(b["a"])(Me,Y,q,!1,null,"70e6d937",null)),Ae=Se.exports,Ne=function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full",attrs:{id:"onboarding_list"}},[e.loading.lists?t("skeleton",{staticClass:"mb-4 mt-4 rounded-lg",attrs:{height:"40px",width:"100%"}}):t("div",{staticClass:"head flex justify-between mb-4 mt-4"},[t("h2",[e._v(e._s(e.translate(e.currentList.title)))]),e.addAction?t("a",{staticClass:"em-primary-button em-w-auto cursor-pointer",attrs:{id:"add-action-btn"},on:{click:function(t){return e.onClickAction(e.addAction)}}},[e._v(e._s(e.translate(e.addAction.label)))]):e._e()]),t("hr",{staticClass:"w-full mt-1.5 mb-1.5"}),e.loading.tabs?t("div",{attrs:{id:"tabs-loading"}},[t("div",{staticClass:"flex justify-between"},[t("skeleton",{staticClass:"mb-4 rounded-lg",attrs:{height:"40px",width:"20%"}}),t("skeleton",{staticClass:"mb-4 rounded-lg",attrs:{height:"40px",width:"5%"}})],1),t("div",{class:{"skeleton-grid":"blocs"===e.viewType,"em-flex-column":"list"===e.viewType},staticStyle:{"flex-wrap":"wrap"}},e._l(9,(function(e){return t("skeleton",{key:e,staticClass:"rounded-lg skeleton-item"})})),1)]):t("div",{staticClass:"list mt-4"},[t("section",{staticClass:"flex justify-between items-center",attrs:{id:"pagination-wrapper"}},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.numberOfItemsToDisplay,expression:"numberOfItemsToDisplay"}],attrs:{name:"numberOfItemsToDisplay"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.numberOfItemsToDisplay=t.target.multiple?a:a[0]},function(t){return e.getListItems()}]}},[t("option",{attrs:{value:"10"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 10")]),t("option",{attrs:{value:"25"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 25")]),t("option",{attrs:{value:"50"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_RESULTS"))+" 50")]),t("option",{attrs:{value:"all"}},[e._v(e._s(e.translate("ALL")))])]),void 0!==typeof e.currentTab.pagination&&e.currentTab.pagination&&e.currentTab.pagination.total>1?t("div",{staticClass:"text-center",attrs:{id:"pagination"}},[t("ul",{staticClass:"flex list-none"},[t("span",{staticClass:"material-icons-outlined cursor-pointer mr-2",class:{"em-text-neutral-600 em-disabled-events":1===e.currentTab.pagination.current},on:{click:function(t){return e.getListItems(e.currentTab.pagination.current-1,e.selectedListTab)}}},[e._v(" chevron_left ")]),e._l(e.currentTab.pagination.total,(function(a){return t("li",{key:a,staticClass:"cursor-pointer em-square-button",class:{active:a===e.currentTab.pagination.current},on:{click:function(t){return e.getListItems(a,e.selectedListTab)}}},[e._v(" "+e._s(a)+" ")])})),t("span",{staticClass:"material-icons-outlined cursor-pointer ml-2",class:{"em-text-neutral-600 em-disabled-events":e.currentTab.pagination.current===e.currentTab.pagination.total},on:{click:function(t){return e.getListItems(e.currentTab.pagination.current+1,e.selectedListTab)}}},[e._v(" chevron_right ")])],2)]):e._e()]),e.currentList.tabs.length>1?t("nav",{attrs:{id:"list-nav"}},[t("ul",{staticClass:"flex",staticStyle:{"list-style-type":"none","margin-left":"0"}},e._l(e.currentList.tabs,(function(a){return t("li",{key:a.key,staticClass:"cursor-pointer font-normal p-4",class:{"em-neutral-900-color em-border-bottom-coordinator":e.selectedListTab===a.key,"em-neutral-700-color em-border-bottom-neutral-300":e.selectedListTab!==a.key},on:{click:function(t){return e.onSelectTab(a.key)}}},[e._v(" "+e._s(e.translate(a.title))+" ")])})),0)]):e._e(),t("section",{staticClass:"flex justify-between mt-4 mb-4",attrs:{id:"actions"}},[t("section",{attrs:{id:"tab-actions"}},e._l(e.filters[e.selectedListTab],(function(a){return t("select",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"filter.value"}],key:e.selectedListTab+"-"+a.key,staticClass:"mr-2",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"value",t.target.multiple?s:s[0])},function(t){return e.onChangeFilter(a)}]}},e._l(a.options,(function(a){return t("option",{key:a.value,domProps:{value:a.value}},[e._v(e._s(e.translate(a.label)))])})),0)})),0),t("section",{staticClass:"flex",attrs:{id:"default-actions"}},[t("div",{staticClass:"flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searches[e.selectedListTab].search,expression:"searches[selectedListTab].search"}],staticClass:"rounded-lg",class:{"em-disabled-events":e.items[this.selectedListTab].length<1&&""===e.searches[e.selectedListTab].search},staticStyle:{margin:"0"},attrs:{name:"search",type:"text",placeholder:e.translate("COM_EMUNDUS_ONBOARD_SEARCH"),disabled:e.items[this.selectedListTab].length<1&&""===e.searches[e.selectedListTab].search},domProps:{value:e.searches[e.selectedListTab].search},on:{change:e.searchItems,keyup:e.searchItems,input:function(t){t.target.composing||e.$set(e.searches[e.selectedListTab],"search",t.target.value)}}}),t("span",{staticClass:"material-icons-outlined mr-2 cursor-pointer",staticStyle:{"margin-left":"-32px"},on:{click:e.searchItems}},[e._v(" search ")])]),t("div",{staticClass:"view-type flex items-center"},e._l(e.viewTypeOptions,(function(a){return t("span",{key:a.value,staticClass:"material-icons-outlined ml-2 cursor-pointer",class:{"active em-main-500-color em-border-main-500":a.value===e.viewType,"em-neutral-600-color em-border-neutral-600":a.value!==e.viewType},staticStyle:{padding:"4px","border-radius":"calc(var(--em-default-br)/2)",display:"flex",height:"38px",width:"38px","align-items":"center","justify-content":"center"},on:{click:function(t){return e.changeViewType(a)}}},[e._v(e._s(a.icon))])})),0)])]),e.loading.items?t("div",{class:{"skeleton-grid":"blocs"===e.viewType,"em-flex-column mb-4":"list"===e.viewType},staticStyle:{"flex-wrap":"wrap"},attrs:{id:"items-loading"}},e._l(9,(function(e){return t("skeleton",{key:e,staticClass:"rounded-lg skeleton-item"})})),1):t("div",[e.displayedItems.length>0?t("div",{attrs:{id:"list-items"}},[t("table",{class:{blocs:"blocs"===e.viewType},attrs:{id:"list-table"}},[t("thead",[t("tr",[t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_LABEL")))]),e._l(e.additionalColumns,(function(a){return t("th",{key:a},[e._v(" "+e._s(a))])})),e.tabActionsPopover&&e.tabActionsPopover.length>0?t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ACTIONS")))]):e._e()],2)]),t("tbody",e._l(e.displayedItems,(function(a){return t("tr",{key:a.id,staticClass:"em-border-cards",class:{"em-card-neutral-100 em-card-shadow em-p-24":"blocs"===e.viewType}},[t("td",{staticClass:"cursor-pointer",on:{click:function(t){return e.onClickAction(e.editAction,a.id)}}},[t("span",{class:{"em-font-weight-600 mb-4":"blocs"===e.viewType}},[e._v(e._s(a.label[e.params.shortlang]))])]),e._l(a.additional_columns,(function(a){return a.display===e.viewType||"all"===a.display?t("td",{key:a.key,staticClass:"columns"},["tags"===a.type?t("div",{staticClass:"flex flex-wrap",class:a.classes},e._l(a.values,(function(a){return t("span",{key:a.key,staticClass:"mr-2 h-max",class:a.classes},[e._v(e._s(a.value))])})),0):t("span",{staticClass:"mt-2 mb-2",class:a.classes},[e._v(" "+e._s(a.value)+" ")])]):e._e()})),t("div",["blocs"===e.viewType?t("hr",{staticClass:"w-full mt-1.5 mb-3"}):e._e(),t("td",{staticClass:"actions"},["blocs"===e.viewType&&e.editAction?t("a",{staticClass:"em-primary-button text-sm cursor-pointer em-w-auto",on:{click:function(t){return e.onClickAction(e.editAction,a.id)}}},[e._v(" "+e._s(e.translate(e.editAction.label))+" ")]):e._e(),t("div",{staticClass:"flex items-center"},[e.previewAction?t("span",{staticClass:"material-icons-outlined cursor-pointer",on:{click:function(t){return e.onClickPreview(a)}}},[e._v("visibility")]):e._e(),e._l(e.iconActions,(function(s){return t("span",{key:s.name,staticClass:"cursor-pointer",class:{"material-icons-outlined":s.iconOutlined,"material-icons":!s.iconOutlined,hidden:!("undefined"===typeof s.showon||e.evaluateShowOn(a,s.showon))},on:{click:function(t){return e.onClickAction(s,a.id)}}},[e._v(" "+e._s(s.icon)+" ")])})),e.tabActionsPopover&&e.tabActionsPopover.length>0&&e.filterShowOnActions(e.tabActionsPopover,a).length?t("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[t("span",{staticClass:"tooltip-target b3 material-icons"},[e._v("more_vert")]),t("template",{slot:"popover"},[t("ul",{staticStyle:{"list-style-type":"none",margin:"0"}},e._l(e.tabActionsPopover,(function(s){return t("li",{key:s.name,staticClass:"cursor-pointer p-2 em-font-size-12",class:{hidden:!("undefined"===typeof s.showon||e.evaluateShowOn(a,s.showon))},on:{click:function(t){return e.onClickAction(s,a.id)}}},[e._v(" "+e._s(e.translate(s.label))+" ")])})),0)])],2):e._e()],2)])])],2)})),0)])]):t("div",{staticClass:"noneDiscover",attrs:{id:"empty-list"},domProps:{innerHTML:e._s(e.noneDiscoverTranslation)}})])])],1)},we=[],Te={async getActiveLanguages(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getactivelanguages")}catch(e){return{status:!1,error:e}}},async removeParameter(e){try{const t=await h().post("index.php?option=com_emundus&controller=settings&task=removeparam",{param:e});return t}catch(t){return{status:!1,error:t}}},async checkFirstDatabaseJoin(){try{const e=await h().get("index.php?option=com_emundus&controller=settings&task=checkfirstdatabasejoin");return e}catch(e){return{status:!1,message:e.message}}},async getEmundusParams(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getemundusparams")}catch(e){return!1}},async getOnboardingLists(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getonboardinglists")}catch(e){return!1}},async getOffset(){try{return await h().get("index.php?option=com_emundus&controller=settings&task=getOffset")}catch(e){return!1}}},Ue={name:"list_v2",components:{Skeleton:Ee},props:{defaultLists:{type:String,default:null},defaultType:{type:String,default:null}},data(){return{loading:{lists:!1,tabs:!1,items:!1},numberOfItemsToDisplay:25,lists:{},type:"forms",params:{},currentList:{title:"",tabs:[]},selectedListTab:0,items:{},title:"",viewType:"table",viewTypeOptions:[{value:"table",icon:"dehaze"},{value:"blocs",icon:"grid_view"}],searches:{},filters:{}}},created(){if(this.loading.lists=!0,this.loading.tabs=!0,null!==this.defaultType)this.params={type:this.defaultType};else{const e=this.$store.getters["global/datas"];this.params=Object.assign({},...Array.from(e).map(({name:e,value:t})=>({[e]:t})))}this.type=this.params.type,this.viewType=localStorage.getItem("tchooz_view_type/"+document.location.hostname),(null===this.viewType||"undefined"===typeof this.viewType||"blocs"!==this.viewType&&"table"!==this.viewType)&&(this.viewType="blocs",localStorage.setItem("tchooz_view_type/"+document.location.hostname,"blocs"));const e=localStorage.getItem("tchooz_number_of_items_to_display/"+document.location.hostname);null!==e&&(this.numberOfItemsToDisplay=parseInt(e)),this.initList()},methods:{initList(){if(null!==this.defaultLists){if(this.lists=JSON.parse(atob(this.defaultLists)),"undefined"===typeof this.lists[this.type]&&(console.error("List type "+this.type+" does not exist"),window.location.href="/"),this.currentList=this.lists[this.type],this.params.hasOwnProperty("tab"))this.onSelectTab(this.params.tab);else{const e=sessionStorage.getItem("tchooz_selected_tab/"+document.location.hostname);null!==e&&"undefined"!==typeof this.currentList.tabs.find(t=>t.key===e)?this.onSelectTab(e):this.onSelectTab(this.currentList.tabs[0].key)}this.loading.lists=!1,this.getListItems()}else this.getLists()},getLists(){Te.getOnboardingLists().then(e=>{if(e.data.status){if(this.lists=e.data.data,"undefined"===typeof this.lists[this.type]&&(console.error("List type "+this.type+" does not exist"),window.location.href="/"),this.currentList=this.lists[this.type],this.params.hasOwnProperty("tab"))this.onSelectTab(this.params.tab);else{const e=sessionStorage.getItem("tchooz_selected_tab/"+document.location.hostname);null!==e&&"undefined"!==typeof this.currentList.tabs.find(t=>t.key===e)?this.onSelectTab(e):this.onSelectTab(this.currentList.tabs[0].key)}this.loading.lists=!1,this.getListItems()}else console.error("Error while getting onboarding lists"),this.loading.lists=!1})},getListItems(e=1,t=null){null===t?(this.loading.tabs=!0,this.items=s["default"].observable(Object.assign({},...this.currentList.tabs.map(e=>({[e.key]:[]}))))):this.loading.items=!0;const a=null===t?this.currentList.tabs:[this.currentTab];a.length>0?a.forEach(t=>{if("undefined"===typeof this.searches[t.key]&&(this.searches[t.key]={search:"",lastSearch:"",debounce:null}),this.setTabFilters(t),"undefined"!==typeof t.getter){let s="index.php?option=com_emundus&controller="+t.controller+"&task="+t.getter+"&lim="+this.numberOfItemsToDisplay+"&page="+e;""!==this.searches[t.key].search&&(s+="&recherche="+this.searches[t.key].search),"undefined"!==typeof this.filters[t.key]&&this.filters[t.key].forEach(e=>{""!==e.value&&"all"!==e.value&&(s+="&"+e.key+"="+e.value)});try{h().get(s).then(a=>{!0===a.data.status?"undefined"!==typeof a.data.data.datas&&(this.items[t.key]=a.data.data.datas,t.pagination={current:e,total:Math.ceil(a.data.data.count/this.numberOfItemsToDisplay)}):console.error("Failed to get data : "+a.data.data.msg),this.loading.tabs=!1,this.loading.items=!1}).catch(e=>{console.error(e),this.loading.tabs=!1,this.loading.items=!1})}catch(a){console.error(a),this.loading.tabs=!1,this.loading.items=!1}}else this.loading.tabs=!1,this.loading.items=!1}):(this.loading.tabs=!1,this.loading.items=!1)},setTabFilters(e){"undefined"!==typeof e.filters&&e.filters.length>0&&"undefined"===typeof this.filters[e.key]&&(this.filters[e.key]=[],e.filters.forEach(t=>{if(null===t.values){if(t.getter){const a="undefined"!==typeof t.controller?t.controller:e.controller;h().get("index.php?option=com_emundus&controller="+a+"&task="+t.getter).then(a=>{if(!0===a.data.status){let s=a.data.data;"string"===typeof s[0]&&(s=s.map(e=>({value:e,label:e}))),s.unshift({value:"all",label:this.translate(t.label)}),this.filters[e.key].push({key:t.key,value:t.default?t.default:"all",options:s})}})}}else this.filters[e.key].push({key:t.key,value:t.default?t.default:"all",options:t.values})}))},searchItems(){null!==this.searches[this.selectedListTab].searchDebounce&&clearTimeout(this.searches[this.selectedListTab].searchDebounce),this.searches[this.selectedListTab].searchDebounce=setTimeout(()=>{this.searches[this.selectedListTab].search!==this.searches[this.selectedListTab].lastSearch&&(this.searches[this.selectedListTab].lastSearch=this.searches[this.selectedListTab].search,this.getListItems(1,this.selectedListTab))},500)},onClickAction(e,t=null){if(null===e||"object"!==typeof e)return!1;let a=null;if(null!==t&&(a=this.items[this.selectedListTab].find(e=>e.id===t)),"redirect"===e.type){let t=e.action;null!==a&&Object.keys(a).forEach(e=>{t=t.replace("%"+e+"%",a[e])}),window.location.href=t}else{let s="index.php?option=com_emundus&controller="+e.controller+"&task="+e.action;if(null!==t)if(e.parameters){let t=e.parameters;null!==a&&Object.keys(a).forEach(e=>{t=t.replace("%"+e+"%",a[e])}),s+=t}else s+="&id="+t;e.hasOwnProperty("confirm")?j.a.fire({type:"warning",title:e.label,text:e.confirm,showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",cancelButton:"em-swal-cancel-button",actions:"em-swal-double-action"}}).then(e=>{e.value&&this.executeAction(s)}):this.executeAction(s)}},executeAction(e){h().get(e).then(e=>{!0===e.data.status||1===e.data.status?(e.data.redirect&&(window.location.href=e.data.redirect),this.getListItems()):e.data.msg&&j.a.fire({type:"error",title:this.translate(e.data.msg),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})}).catch(e=>{console.error(e)})},onClickPreview(e){this.previewAction&&(this.previewAction.title||this.previewAction.content)&&j.a.fire({title:e[this.previewAction.title],html:'<div style="text-align: left;">'+e[this.previewAction.content]+"</div>",reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},onChangeFilter(){this.getListItems(1,this.selectedListTab)},onSelectTab(e){let t=!1;return this.selectedListTab!==e&&"undefined"!==typeof this.currentList.tabs.find(t=>t.key===e)&&(this.selectedListTab=e,sessionStorage.setItem("tchooz_selected_tab/"+document.location.hostname,e),t=!0),t},changeViewType(e){this.viewType=e.value,localStorage.setItem("tchooz_view_type/"+document.location.hostname,e.value)},filterShowOnActions(e,t){return e.filter(e=>!e.hasOwnProperty("showon")||this.evaluateShowOn(t,e.showon))},evaluateShowOn(e,t){let a=!0;switch(t.operator){case"==":case"=":a=e[t.key]==t.value;break;case"!=":a=e[t.key]!=t.value;break;case">":a=e[t.key]>t.value;break;case"<":a=e[t.key]<t.value;break;case">=":a=e[t.key]>=t.value;break;case"<=":a=e[t.key]<=t.value;break;default:a=!0}return a}},computed:{currentTab(){return this.currentList.tabs.find(e=>e.key===this.selectedListTab)},tabActionsPopover(){return"undefined"!==typeof this.currentTab.actions?this.currentTab.actions.filter(e=>!["add","edit","preview"].includes(e.name)&&!e.hasOwnProperty("icon")):[]},editAction(){return"undefined"!==typeof this.currentTab&&"undefined"!==typeof this.currentTab.actions&&this.currentTab.actions.find(e=>"edit"===e.name)},addAction(){return"undefined"!==typeof this.currentTab&&"undefined"!==typeof this.currentTab.actions&&this.currentTab.actions.find(e=>"add"===e.name)},previewAction(){return"undefined"!==typeof this.currentTab&&"undefined"!==typeof this.currentTab.actions&&this.currentTab.actions.find(e=>"preview"===e.name)},iconActions(){return"undefined"!==typeof this.currentTab.actions?this.currentTab.actions.filter(e=>!["add","edit","preview"].includes(e.name)&&e.hasOwnProperty("icon")):[]},displayedItems(){let e="undefined"!==typeof this.items[this.selectedListTab]?this.items[this.selectedListTab]:[];return e.filter(e=>e.label[this.params.shortlang].toLowerCase().includes(this.searches[this.selectedListTab].search.toLowerCase()))},additionalColumns(){let e=[],t="undefined"!==typeof this.items[this.selectedListTab]?this.items[this.selectedListTab]:[];return t.length>0&&"undefined"!==typeof t[0].additional_columns&&t[0].additional_columns.forEach(t=>{"all"!==t.display&&t.display!==this.viewType||e.push(t.key)}),e},noneDiscoverTranslation(){return"campaigns"===this.type?"programs"===this.currentTab.key?this.translate("COM_EMUNDUS_ONBOARD_NOPROGRAM"):this.translate("COM_EMUNDUS_ONBOARD_NOCAMPAIGN"):"emails"===this.type?this.translate("COM_EMUNDUS_ONBOARD_NOEMAIL"):"forms"===this.type?this.translate("COM_EMUNDUS_ONBOARD_NOFORM"):void 0}},watch:{numberOfItemsToDisplay(){localStorage.setItem("tchooz_number_of_items_to_display/"+document.location.hostname,this.numberOfItemsToDisplay)}}},Re=Ue,xe=(a("7fa3"),Object(b["a"])(Re,Ne,we,!1,null,null,null)),Le=xe.exports,ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"campaigns__add-campaign"},["undefined"==typeof e.campaignId||0==e.campaignId?t("div",[t("div",{staticClass:"flex items-center mt-4 cursor-pointer",on:{click:function(t){return e.redirectJRoute("index.php?option=com_emundus&view=campaigns")}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("p",{staticClass:"ml-2"},[e._v(e._s(e.translate("BACK")))])]),t("h1",{staticClass:"mt-4"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CAMPAIGN")))]),t("p",{staticClass:"mt-4"},[e._v(e._s(e.translate("COM_EMUNDUS_GLOBAL_INFORMATIONS_DESC")))]),t("hr",{staticClass:"mt-1.5 mb-1.5"})]):e._e(),t("div",[e.ready?t("form",{staticClass:"emundus-form fabrikForm",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[t("div",[t("div",{staticClass:"em-red-500-color mb-2"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_REQUIRED_FIELDS_INDICATE")))]),t("div",{staticClass:"mb-4"},[t("label",{attrs:{for:"campLabel"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_CAMPNAME"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.label[e.actualLanguage],expression:"form.label[actualLanguage]"}],staticClass:"form-control fabrikinput w-full",class:{"is-invalid":e.errors.label},attrs:{id:"campLabel",type:"text",required:""},domProps:{value:e.form.label[e.actualLanguage]},on:{focusout:function(t){return e.onFormChange()},input:function(t){t.target.composing||e.$set(e.form.label,e.actualLanguage,t.target.value)}}}),e.errors.label?t("span",{staticClass:"em-red-500-color mb-2"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME")))])]):e._e()]),t("div",{staticClass:"grid grid-cols-2 mb-4 gap-1.5"},[t("div",[t("div",[t("label",{attrs:{for:"startDate"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_STARTDATE"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("datetime",{staticClass:"w-full",attrs:{id:"startDate",type:"datetime",format:"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_STARTDATE"),"input-id":"start_date",phrases:{ok:e.translate("COM_EMUNDUS_ONBOARD_OK"),cancel:e.translate("COM_EMUNDUS_ONBOARD_CANCEL")}},on:{focusout:function(t){return e.onFormChange()}},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}})],1)]),t("div",[t("div",[t("label",{attrs:{for:"endDate"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_ENDDATE"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("datetime",{staticClass:"w-full",attrs:{id:"endDate",type:"datetime",format:"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_ENDDATE")+" *","input-id":"end_date","min-datetime":e.minDate,phrases:{ok:e.translate("COM_EMUNDUS_ONBOARD_OK"),cancel:e.translate("COM_EMUNDUS_ONBOARD_CANCEL")}},on:{focusout:function(t){return e.onFormChange()}},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1)])]),t("div",{staticClass:"mb-4"},[t("label",{attrs:{for:"year"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_PICKYEAR"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("autocomplete",{attrs:{id:"year",items:this.session,year:e.form.year,name:"2020 - 2021"},on:{searched:e.onSearchYear}})],1),t("div",{staticClass:"mb-4 flex items-center"},[t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.published,expression:"form.published"}],staticClass:"em-toggle-check",attrs:{type:"checkbox","true-value":"1","false-value":"0",id:"published",name:"published"},domProps:{checked:Array.isArray(e.form.published)?e._i(e.form.published,null)>-1:e._q(e.form.published,"1")},on:{click:function(t){return e.onFormChange()},change:function(t){var a=e.form.published,s=t.target,i=s.checked?"1":"0";if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&e.$set(e.form,"published",a.concat([n])):l>-1&&e.$set(e.form,"published",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(e.form,"published",i)}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})]),t("span",{staticClass:"ml-2",attrs:{for:"published"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILTER_PUBLISH")))])])]),t("hr"),t("div",{staticClass:"mb-4"},[t("div",{staticClass:"mb-4"},[t("h3",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_INFORMATION")))])]),t("div",{staticClass:"mb-4"},[t("label",{staticStyle:{top:"5em"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_RESUME"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("editor-quill",{key:e.editorResumeKey,staticStyle:{height:"25em"},attrs:{text:e.form.short_description,enable_variables:!1,placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_RESUME"),id:"campResume",limit:500,toolbar:"light"},on:{focusout:e.onFormChange},model:{value:e.form.short_description,callback:function(t){e.$set(e.form,"short_description",t)},expression:"form.short_description"}})],1),t("label",{staticClass:"mt-4"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_DESCRIPTION")))]),"undefined"!=typeof e.form.description?t("div",{staticClass:"mb-4"},[t("editor-quill",{key:e.editorKey,staticStyle:{height:"25em"},attrs:{text:e.form.description,enable_variables:!1,placeholder:e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_DESCRIPTION"),id:"campaign_description"},on:{focusout:e.onFormChange},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1):e._e()]),t("hr",{staticClass:"mt-16"}),t("div",{staticClass:"mt-8"},[t("div",{staticClass:"mb-4"},[t("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_PROGRAM")))])]),t("div",{staticClass:"mb-4"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGRAM_INTRO_DESC"))),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("div",{staticClass:"flex items-center mb-4"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.form.training,expression:"form.training"}],staticClass:"form-control fabrikinput w-full",attrs:{id:"select_prog",disabled:this.programs.length<=0},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"training",t.target.multiple?a:a[0])},e.setCategory]}},[t("option",{attrs:{value:""}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDCAMP_CHOOSEPROG")))]),e._l(e.programs,(function(a,s){return t("option",{key:s,attrs:{"data-category":a.programmes},domProps:{value:a.code}},[e._v(" "+e._s(a.label&&null!==a.label[e.actualLanguage]&&"undefined"!=typeof a.label[e.actualLanguage]?a.label[e.actualLanguage]:a.label)+" ")])}))],2),0!=e.coordinatorAccess?t("button",{staticClass:"ml-2 em-transparent-button",attrs:{title:e.translate("COM_EMUNDUS_ONBOARD_ADDPROGRAM"),type:"button",id:"add-program"},on:{click:e.displayProgram}},[t("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("add_circle_outline")])]):e._e()]),t("transition",{attrs:{name:"slide-fade"}},[e.isHiddenProgram?t("div",[t("div",[t("div",{staticClass:"mb-4"},[t("label",{attrs:{for:"prog_label"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGNAME"))+" "),t("span",{staticClass:"em-red-500-color"},[e._v("*")])]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.programForm.label,expression:"programForm.label"}],staticClass:"form-control fabrikinput w-full",class:{"is-invalid":e.errors.progLabel},attrs:{type:"text",id:"prog_label",placeholder:" "},domProps:{value:e.programForm.label},on:{input:function(t){t.target.composing||e.$set(e.programForm,"label",t.target.value)}}})]),e.errors.progLabel?t("p",{staticClass:"em-red-500-color mb-2"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROG_REQUIRED_LABEL")))])]):e._e(),t("div",{staticClass:"mb-4",staticStyle:{display:"none"}},[t("label",{attrs:{for:"prog_color"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_PROGCOLOR")))]),t("div",{staticClass:"flex"},e._l(e.colors,(function(a,s){return t("div",[t("div",{staticClass:"em-color-round cursor-pointer flex justify-center",class:0!=s?"ml-2":"",style:e.selectedColor==a.text?"background-color:"+a.text+";border: 2px solid "+a.background:"background-color:"+a.text,on:{click:function(t){e.programForm.color=a.text,e.selectedColor=a.text}}},[e.selectedColor==a.text?t("span",{staticClass:"material-icons-outlined",staticStyle:{"font-weight":"bold",color:"black",filter:"invert(1)"}},[e._v("done")]):e._e()])])})),0)])])]):e._e()])],1),t("hr",{staticClass:"mt-1.5 mb-1.5"}),t("div",{staticClass:"flex justify-between float-right em-mb-16"},[t("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){e.quit=1,e.submit()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"))+" ")])])]):e._e()]),e.submitted||!e.ready?t("div",{staticClass:"em-page-loader"}):e._e()])},Ie=[],Be=a("0065"),Pe=a("aaac"),Fe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"autocomplete"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-w-100",class:""!==e.year?"":"placeholder",attrs:{type:"text",id:e.id,placeholder:""!==e.year?e.year:e.name},domProps:{value:e.search},on:{input:[function(t){t.target.composing||(e.search=t.target.value)},e.onChange],keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onArrowDown.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onArrowUp.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter.apply(null,arguments)}]}}),t("ul",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"autocomplete-results"},e._l(e.results,(function(a,s){return t("li",{key:s,staticClass:"autocomplete-result",class:{"is-active":s===e.arrowCounter},on:{click:function(t){return e.setResult(a)}}},[e._v(" "+e._s(a)+" ")])})),0)])},$e=[],je={name:"autocomplete",props:{items:{type:Array,required:!1,default:()=>[]},name:String,year:String,id:String},data(){return{search:"",results:[],isOpen:!1,sLoading:!1,arrowCounter:-1}},created(){const e=e=>new Promise(t=>setTimeout(t,e));e(2e3).then(()=>{this.search=this.year})},methods:{onSearching(e){this.$emit("searched",this.search)},onChange(){this.isOpen=!0,this.filterResults(),this.onSearching()},filterResults(){this.results=this.items.filter(e=>e.toLowerCase().indexOf(this.search.toLowerCase())>-1)},setResult(e){this.search=e,this.isOpen=!1,this.onSearching()},onArrowDown(){this.arrowCounter<this.results.length&&(this.arrowCounter=this.arrowCounter+1)},onArrowUp(){this.arrowCounter>0&&(this.arrowCounter=this.arrowCounter-1)},onEnter(){this.search=this.results[this.arrowCounter],this.isOpen=!1,this.arrowCounter=-1,this.onSearching()},handleClickOutside(e){this.$el.contains(e.target)||(this.isOpen=!1,this.arrowCounter=-1)}},mounted(){document.addEventListener("click",this.handleClickOutside)},destroyed(){document.removeEventListener("click",this.handleClickOutside)}},Ge=je,He=(a("47d1"),Object(b["a"])(Ge,Fe,$e,!1,null,"3e536dd0",null)),ze=He.exports,Ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"translation"},[t("transition",{attrs:{name:"slide-down",type:"transition"}},[t("div",{staticClass:"inlineflex",staticStyle:{margin:"25px"}},[t("label",{staticClass:"translate-label"},[e._v(e._s(e.TranslateIn))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.currentLangTranslation,expression:"currentLangTranslation"}],staticClass:"dropdown-toggle ml-10px",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.currentLangTranslation=t.target.multiple?a:a[0]}}},e._l(e.languages,(function(a){return t("option",{key:a.sef,domProps:{value:a.sef}},[e._v(e._s(a.title_native))])})),0)])]),t("transition",{attrs:{name:"slide-down",type:"transition"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.label[e.currentLangTranslation],expression:"label[currentLangTranslation]"}],staticClass:"form__input field-general w-input",attrs:{type:"text",id:"label_"+e.currentLangTranslation},domProps:{value:e.label[e.currentLangTranslation]},on:{input:function(t){t.target.composing||e.$set(e.label,e.currentLangTranslation,t.target.value)}}})])],1)},Ye=[],qe={name:"translation",props:{label:Object,actualLanguage:String},data(){return{currentLangTranslation:"en",languages:[],TranslateIn:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATE_IN")}},created(){this.getLanguages()},methods:{getLanguages(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getactivelanguages"}).then(e=>{this.languages=e.data.data,this.languages.forEach((e,t)=>{e.sef==this.actualLanguage&&this.languages.splice(t,1)}),this.currentLangTranslation=this.languages[0].sef})}},mounted(){document.addEventListener("click",this.handleClickOutside)},destroyed(){document.removeEventListener("click",this.handleClickOutside)}},Je=qe,We=Object(b["a"])(Je,Ve,Ye,!1,null,"3122308b",null),Ke=We.exports,Xe={async updateDocument(e,t=!1){const a=new FormData;Object.keys(e).forEach(t=>{a.append(t,e[t])});const s=t?"createdocument":"updatedocument";try{const e=await h().post("index.php?option=com_emundus&controller=campaign&task="+s,a);return e.data}catch(i){return{status:!1,msg:i.message}}},async setDocumentMandatory(e){const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});try{const e=await h().post("index.php?option=com_emundus&controller=campaign&task=updatedocumentmandatory",t);return e.data}catch(a){return{status:!1,msg:a.message}}},async getAllCampaigns(e="",t="DESC",a="",s=9999,i=0,n="all"){try{const l=await h().get("index.php?option=com_emundus&controller=campaign&task=getallcampaign",{params:{filter:e,sort:t,recherche:a,lim:s,page:i,program:n}});return l.data}catch(l){return{status:!1,msg:l.message}}},async createCampaign(e){try{const t=new FormData;return t.append("label",JSON.stringify(e.label)),t.append("start_date",e.start_date),t.append("end_date",e.end_date),t.append("short_description",e.short_description),t.append("description",e.description),t.append("training",e.training),t.append("year",e.year),t.append("published",e.published),t.append("is_limited",e.is_limited),t.append("profile_id",e.profile_id),t.append("limit",e.limit),t.append("limit_status",e.limit_status),await h().post("index.php?option=com_emundus&controller=campaign&task=createcampaign",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}},async pinCampaign(e){try{const t=new FormData;return t.append("cid",e),await h().post("index.php?option=com_emundus&controller=campaign&task=pincampaign",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(t){return{status:!1,msg:t.message}}}},Qe=function(){var e=this,t=e._self._c;return t("div",[t("div",{class:"editor_"+this.$attrs.id})])},Ze=[],et=a("8e5c"),tt=a.n(et),at={name:"editorQuill",components:{},props:{placeholder:String,text:String,enable_variables:{type:Boolean,default:!1},limit:{type:Number,default:null},toolbar:{type:String,default:"complete"}},data:()=>({editor:null,toolbarOptions:{complete:[["bold","italic","underline","strike"],["blockquote"],["image","link"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{color:[]}],[{font:[]}],[{align:[]}]],light:[["bold","italic","underline","strike"]]}}),mounted(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=geteditorvariables"}).then(e=>{this.variables=e.data.data});var e={modules:{toolbar:this.toolbarOptions[this.$props.toolbar],imageResize:{},mention:null},placeholder:this.$props.placeholder,theme:"snow"};if(this.$props.enable_variables&&(e.modules.mention={allowedChars:/^[A-Za-z\s]*$/,mentionDenotationChars:["/"],source:(e,t,a)=>{let s;if("/"===a&&(s=this.variables),0===e.length)t(s,e);else{const a=[];for(let t=0;t<s.length;t++)~s[t].value.toLowerCase().indexOf(e.toLowerCase())&&a.push(s[t]);t(a,e)}},onSelect:(e,t)=>{t({denotationChar:"",id:e.id,value:"["+e.value+"]"},!0)},renderItem:(e,t)=>`<div><p>${e.value}</p><p class="em-font-size-12">${e.description}</p></div>`}),this.editor=new Quill(".editor_"+this.$attrs.id,e),""!==this.text&&null!==this.text&&"undefined"!==typeof this.text){let e=this.editor.clipboard.convert(this.text);this.editor.setContents(e)}this.editor.on("editor-change",(e,...t)=>{"text-change"===e&&(this.$props.limit&&this.editor.getLength()>this.$props.limit&&this.editor.deleteText(this.$props.limit,this.editor.getLength()),null===this.editor.root.innerHTML&&(this.editor.root.innerHTML=""),this.$emit("input",this.editor.root.innerHTML))}),this.editor.on("selection-change",(e,t,a)=>{e&&(e.length||this.$emit("focusout"))});var t=this.editor.getModule("toolbar");t.addHandler("image",this.imageHandler)},methods:{async imageHandler(){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{var t=e.files[0],a=new FormData;a.append("image",t);var s=t.name;await this.uploadFiles(t,s)}},async uploadFiles(e,t){try{const t=new FormData;t.append("image",e),await h().post("index.php?option=com_emundus&controller=settings&task=uploadimagetocustomfolder",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{const t=this.editor.getSelection();this.editor.insertEmbed(t.index,"image",e.data.file)})}catch(a){return{status:!1,msg:a.message}}}}},st=at,it=(a("4daa"),Object(b["a"])(st,Qe,Ze,!1,null,null,null)),nt=it.exports;const lt=a("bef5");var rt={name:"addCampaign",components:{EditorQuill:nt,Datetime:Be["Datetime"],Autocomplete:ze,Translation:Ke},directives:{focus:{inserted:function(e){e.focus()}}},props:{campaign:Number},data:()=>({campaignId:0,actualLanguage:"",coordinatorAccess:0,quit:1,isHiddenProgram:!1,minDate:"",programs:[],years:[],status:[],languages:[],session:[],old_training:"",old_program_form:"",editorKey:0,editorResumeKey:0,form:{label:{},start_date:"",end_date:"",short_description:"",description:null,training:"",year:"",published:1,is_limited:0,profile_id:9,limit:50,limit_status:[]},programForm:{code:"",label:"",notes:"",programmes:"",published:1,apply_online:1,color:"#1C6EF2"},year:{label:"",code:"",schoolyear:"",published:1,profile_id:"",programmes:""},errors:{label:!1,progCode:!1,progLabel:!1,short_description:!1,limit_files_number:!1,limit_status:!1},colors:[{text:"#1C6EF2",background:"#79B6FB"},{text:"#20835F",background:"#87D4B8"},{text:"#DB333E",background:"#FBABAB"},{text:"#FFC633",background:"#FEEBA1"}],selectedColor:"#1C6EF2",submitted:!1,ready:!1}),created(){""==this.$props.campaign?this.campaignId=this.$store.getters["global/datas"].campaign?this.$store.getters["global/datas"].campaign.value:0:this.campaignId=this.$props.campaign?this.$props.campaign:0,this.actualLanguage=this.$store.getters["global/shortLang"],this.coordinatorAccess=this.$store.getters["global/coordinatorAccess"],Pe["Settings"].defaultLocale=this.actualLanguage;let e=new Date;this.form.start_date=Pe["DateTime"].local(e.getFullYear(),e.getMonth()+1,e.getDate(),0,0,0).toISO(),this.getLanguages().then(()=>{this.getCampaignById()})},methods:{getCampaignById(){"undefined"!==typeof this.campaignId&&""!==this.campaignId&&this.campaignId>0?p.a.get("index.php?option=com_emundus&controller=campaign&task=getcampaignbyid&id="+this.campaignId).then(e=>{let t=e.data.data.campaign.label;this.form=e.data.data.campaign,this.$emit("getInformations",this.form),this.programForm=e.data.data.program,this.form.label=e.data.data.label,this.languages.forEach(e=>{""!==this.form.label[e.sef]&&null!=this.form.label[e.sef]||(this.form.label[e.sef]=t)}),this.form.start_date=Pe["DateTime"].fromSQL(this.form.start_date).toISO(),this.form.end_date=Pe["DateTime"].fromSQL(this.form.end_date).toISO(),"0000-00-00T00:00:00.000Z"===this.form.end_date&&(this.form.end_date=""),"undefined"!=typeof e.data.data.campaign.status?(this.form.limit_status=[],this.form.is_limited=1,Object.values(e.data.data.campaign.status).forEach(e=>{this.form.limit_status[parseInt(e.limit_status)]=!0})):this.form.limit_status=[],this.ready=!0}).catch(e=>{console.log(e)}):this.ready=!0,this.getAllPrograms()},getAllPrograms(){p.a.get("index.php?option=com_emundus&controller=programme&task=getallprogram").then(e=>{e.data.status?(this.programs=e.data.data.datas,0!==Object.keys(this.programs).length&&this.programs.sort((e,t)=>e.id-t.id)):this.programs=[]}).catch(e=>{console.log(e)}),this.getYears()},getYears(){p.a.get("index.php?option=com_emundus&controller=campaign&task=getyears").then(e=>{this.years=e.data.data,this.years.forEach(e=>{this.session.push(e.schoolyear)})}).catch(e=>{console.log(e)}),this.getStatus()},async getLanguages(){const e=await p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getactivelanguages"});return e&&(this.languages=e.data.data),e},setCategory(e){this.year.programmes=e.target.options[e.target.options.selectedIndex].dataset.category,this.programForm=this.programs.find(e=>e.code==this.form.training)},getStatus(){p.a.get("index.php?option=com_emundus&controller=settings&task=getstatus").then(e=>{this.status=e.data.data})},createCampaign(e){Xe.createCampaign(e).then(e=>{this.campaignId=e.data.data,this.quitFunnelOrContinue(this.quit)})},createCampaignWithNoExistingProgram(e){p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=createprogram",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:lt.stringify({body:e})}).then(e=>{e.data.status?(this.form.progid=e.data.data.programme_id,this.form.training=e.data.data.programme_code,this.form.start_date=Pe["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=Pe["DateTime"].fromISO(this.form.end_date).toISO(),this.createCampaign(this.form)):(j.a.fire({title:this.translate(e.data.msg),text:e.data.data,type:"error",confirmButtonText:this.translate("OK"),customClass:{title:"em-swal-title",confirmButton:"em-flex-center"}}),this.submitted=!1)})},submit(){if(this.$store.dispatch("campaign/setUnsavedChanges",!0),this.errors={label:!1,progCode:!1,progLabel:!1,short_description:!1,limit_files_number:!1,limit_status:!1},""===this.form.label[this.actualLanguage]||null==this.form.label[this.actualLanguage]||"undefined"===typeof this.form.label[this.actualLanguage])return window.scrollTo({top:0,behavior:"smooth"}),this.errors.label=!0,0;if(""==this.form.end_date||"0000-00-00 00:00:00"==this.form.end_date){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("end_date");return e&&e.focus(),0}if(""==this.form.start_date||"0000-00-00 00:00:00"==this.form.start_date){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("start_date");return e&&e.focus(),0}if(""==this.form.year){window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("year");return e&&e.focus(),0}if(1==this.form.is_limited){let e=this.form.limit_status.every(e=>!1===e);if(""==this.form.limit)return window.scrollTo({top:0,behavior:"smooth"}),this.errors.limit_files_number=!0,0;if(0==this.form.limit_status.length||e)return window.scrollTo({top:0,behavior:"smooth"}),this.errors.limit_status=!0,0}if(""==this.form.training){if(!this.isHiddenProgram)return document.getElementById("select_prog").focus(),0;if(""==this.programForm.label)return this.errors.progLabel=!0,document.getElementById("prog_label").focus(),0;{const e=this.programs.find(e=>e.label==this.programForm.label);if(void 0!=e)return this.errors.progLabel=!0,document.getElementById("prog_label").focus(),0}}this.year.label=this.form.label,this.year.code=this.form.training,this.year.schoolyear=this.form.year,this.year.published=this.form.published,this.year.profile_id=this.form.profile_id,""!=this.form.label.en&&null!=this.form.label.en&&"undefined"!=typeof this.form.label.en||(this.form.label.en=this.form.label.fr),this.submitted=!0,"undefined"!==typeof this.campaignId&&null!==this.campaignId&&""!==this.campaignId&&0!==this.campaignId?""!=this.form.training?this.updateCampaign():p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=createprogram",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:lt.stringify({body:this.programForm})}).then(e=>{this.programForm.code=e.data.data.programme_code,this.form.progid=e.data.data.programme_id,this.updateCampaign()}).catch(e=>{console.log(e)}):""!==this.form.training?(this.programForm=this.programs.find(e=>e.code==this.form.training),this.form.training=this.programForm.code,this.form.start_date=Pe["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=Pe["DateTime"].fromISO(this.form.end_date).toISO(),this.createCampaign(this.form)):this.createCampaignWithNoExistingProgram(this.programForm)},updateCampaign(){this.form.training=this.programForm.code,this.form.start_date=Pe["DateTime"].fromISO(this.form.start_date).toISO(),this.form.end_date=Pe["DateTime"].fromISO(this.form.end_date).toISO(),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updatecampaign",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:lt.stringify({body:this.form,cid:this.campaignId})}).then(e=>{if(!e.status)return j.a.fire({type:"error",title:this.translate("COM_EMUNDUS_ADD_CAMPAIGN_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.submitted=!1,0;this.$emit("nextSection"),this.$emit("updateHeader",this.form)}).catch(e=>{console.log(e)})},quitFunnelOrContinue(e){0===e?this.redirectJRoute("index.php?option=com_emundus&view=campaign"):1===e&&(document.cookie="campaign_"+this.campaignId+"_menu = 1; expires=Session; path=/",this.redirectJRoute("index.php?option=com_emundus&view=campaigns&layout=addnextcampaign&cid="+this.campaignId+"&index=0"))},redirectJRoute(e){window.location.href=e},onSearchYear(e){this.form.year=e},onFormChange(){this.$store.dispatch("campaign/setUnsavedChanges",!0)},displayProgram(){this.isHiddenProgram?(document.getElementById("add-program").style="transform: rotate(0)",this.form.training=this.old_training,this.programForm=this.old_program_form,document.getElementById("select_prog").removeAttribute("disabled")):(this.old_training=this.form.training,this.old_program_form=this.programForm,this.form.training="",this.programForm={code:"",label:"",notes:"",programmes:"",published:1,apply_online:1},document.getElementById("add-program").style="transform: rotate(135deg)",document.getElementById("select_prog").setAttribute("disabled","disabled")),this.isHiddenProgram=!this.isHiddenProgram}},watch:{"form.start_date":function(e){this.minDate=Pe["DateTime"].fromISO(e).plus({days:1}).toISO(),""==this.form.end_date&&(this.form.end_date=Pe["DateTime"].fromISO(e).plus({days:1}).toISO())}}},ot=rt,ct=(a("13e3"),Object(b["a"])(ot,ke,Ie,!1,null,"c3fd5e92",null)),dt=ct.exports,mt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"emails__add-email em-mt-24"},[t("notifications",{attrs:{group:"foo-velocity",position:"bottom left","animation-type":"velocity",speed:500,classes:"vue-notification-custom"}}),t("div",[t("form",{staticClass:"fabrikForm emundus-form",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[t("div",[t("div",{staticClass:"mb-4"},[t("h1",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_EMAIL")))]),t("span",{staticClass:"em-red-500-color em-mb-8"},[e._v(e._s(e.translations.RequiredFieldsIndicate))])]),t("div",[t("div",{staticClass:"em-mb-16"},[t("label",[e._v(e._s(e.translations.emailName)+" "),t("span",{staticStyle:{color:"#E5283B"}},[e._v("*")])]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.subject,expression:"form.subject"}],staticClass:"w-full",class:{"is-invalid":e.errors.subject},attrs:{type:"text"},domProps:{value:e.form.subject},on:{input:function(t){t.target.composing||e.$set(e.form,"subject",t.target.value)}}})]),e.errors.subject?t("span",{staticClass:"em-red-500-color mb-2"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.SubjectRequired))])]):e._e(),t("div",{staticClass:"mb-4"},[t("label",[e._v(e._s(e.translations.emailBody)+" "),t("span",{staticStyle:{color:"#E5283B"}},[e._v("*")])]),t("editor-quill",{key:e.dynamicComponent,class:{"is-invalid":e.errors.message},staticStyle:{height:"30em"},attrs:{text:e.form.message,enable_variables:!0,placeholder:e.translations.EmailResume,id:"email"},model:{value:e.form.message,callback:function(t){e.$set(e.form,"message",t)},expression:"form.message"}}),t("div",{staticClass:"mt-12"},[t("a",{staticClass:"em-main-500-color em-hover-main-600",attrs:{href:"component/emundus/?view=export_select_columns&format=html&layout=all_programs&Itemid=1173",target:"_blank"}},[e._v(e._s(e.translate("COM_EMUNDUS_EMAIL_SHOW_TAGS")))])])],1),e.errors.message?t("p",{staticClass:"em-red-500-color mb-2"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.translations.BodyRequired))])]):e._e(),t("div",{staticClass:"form-group"},[t("label",[e._v(e._s(e.translations.emailCategory))]),e.categories.length>0?t("incremental-select",{attrs:{options:this.categoriesList,defaultValue:e.incSelectDefaultValue,locked:"create"!=e.mode},on:{"update-value":e.updateCategorySelectedValue}}):e._e()],1)])]),t("hr"),t("div",[t("div",{staticClass:"flex items-center mb-4 gap-1"},[t("h3",{staticClass:"cursor-pointer em-mb-0-important",on:{click:e.displayAdvanced}},[e._v(e._s(e.translations.Advanced))]),t("button",{directives:[{name:"show",rawName:"v-show",value:!e.displayAdvancedParameters,expression:"!displayAdvancedParameters"}],staticClass:"em-transparent-button flex flex-col",attrs:{title:e.translations.Advanced,type:"button"},on:{click:e.displayAdvanced}},[t("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("add_circle_outline")])]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.displayAdvancedParameters,expression:"displayAdvancedParameters"}],staticClass:"em-transparent-button flex flex-col",attrs:{title:e.translations.Advanced,type:"button"},on:{click:e.displayAdvanced}},[t("span",{staticClass:"material-icons-outlined em-main-500-color"},[e._v("remove_circle_outline")])])]),e.displayAdvancedParameters?t("div",{attrs:{id:"email-advanced-parameters"}},[t("div",{staticClass:"form-group mb-4"},[t("label",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDEMAIL_SENDER_EMAIL")))]),t("span",[e._v(e._s(e.email_sender))])]),t("div",{staticClass:"form-group mb-4"},[t("label",[e._v(e._s(e.translations.receiverName))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"w-full fabrikinput",attrs:{type:"text"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}})]),t("div",{staticClass:"form-group mb-4"},[t("label",[e._v(e._s(e.translations.emailAddress))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.emailfrom,expression:"form.emailfrom"}],staticClass:"w-full fabrikinput",attrs:{type:"text",placeholder:"reply-to@tchooz.io"},domProps:{value:e.form.emailfrom},on:{input:function(t){t.target.composing||e.$set(e.form,"emailfrom",t.target.value)}}}),t("p",{staticClass:"em-font-size-12 em-neutral-700-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADDEMAIL_ADDRESTIP")))])]),t("div",{staticClass:"form-group mb-4",attrs:{id:"receivers_cc"}},[t("label",[e._v(e._s(e.translations.ReceiversCC))]),t("multiselect",{attrs:{label:"email","track-by":"email",options:e.receivers_cc,multiple:!0,searchable:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!1,"clear-on-select":!1},on:{tag:e.addNewCC},model:{value:e.selectedReceiversCC,callback:function(t){e.selectedReceiversCC=t},expression:"selectedReceiversCC"}})],1),t("div",{staticClass:"form-group mb-4",attrs:{id:"receivers_bcc"}},[t("label",[e._v(e._s(e.translations.ReceiversBCC))]),t("multiselect",{attrs:{label:"email","track-by":"email",options:e.receivers_bcc,multiple:!0,searchable:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!1,"clear-on-select":!1},on:{tag:e.addNewBCC},model:{value:e.selectedReceiversBCC,callback:function(t){e.selectedReceiversBCC=t},expression:"selectedReceiversBCC"}})],1),e.attached_letters?t("div",{staticClass:"form-group mb-4",attrs:{id:"attached_letters"}},[t("label",[e._v(e._s(e.translations.Letters))]),t("multiselect",{attrs:{label:"value","track-by":"id",options:e.attached_letters,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.LettersPlaceHolder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedLetterAttachments,callback:function(t){e.selectedLetterAttachments=t},expression:"selectedLetterAttachments"}})],1):e._e(),e.tags?t("div",{staticClass:"form-group mb-4"},[t("label",[e._v(e._s(e.translations.Tags))]),t("multiselect",{attrs:{label:"label","track-by":"id",options:e.action_tags,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.TagsPlaceHolder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1):e._e(),t("div",{staticClass:"form-group mb-4"},[t("label",[e._v(e._s(e.translations.CandidateAttachments))]),t("multiselect",{attrs:{label:"value","track-by":"id",options:e.candidate_attachments,multiple:!0,taggable:!0,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translations.CandidateAttachmentsPlaceholder,"close-on-select":!1,"clear-on-select":!1},model:{value:e.selectedCandidateAttachments,callback:function(t){e.selectedCandidateAttachments=t},expression:"selectedCandidateAttachments"}})],1)]):e._e()]),t("div",{staticClass:"flex justify-between mt-4"},[t("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button",onclick:"history.back()"}},[e._v(" "+e._s(e.translations.retour)+" ")]),t("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"submit"}},[e._v(" "+e._s(e.translations.continuer)+" ")])])])]),e.loading||e.submitted?t("div",{staticClass:"em-page-loader"}):e._e()],1)},ut=[],pt=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"incremental-selector"}},[t("div",{staticClass:"em-w-100 em-flex-row em-mb-16"},[e.isNewVal?t("div",{staticClass:"em-w-100",attrs:{id:"new-value"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.newValue.label,expression:"newValue.label"}],staticClass:"em-w-100 em-mb-0-important",attrs:{type:"text"},domProps:{value:e.newValue.label},on:{focusin:function(t){e.showOptions=!0},focusout:e.emitValueChanges,input:function(t){t.target.composing||e.$set(e.newValue,"label",t.target.value)}}}),t("i",{staticClass:"em-main-500-color"},[e._v("("+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_NEW_VALUE"))+")")])]):e._e(),e.isNewVal?e._e():t("div",{staticClass:"em-w-100",attrs:{id:"existing-value"}},[t("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.newExistingLabel,expression:"newExistingLabel"}],staticClass:"em-w-100 em-mb-0-important em-border-main-500 important",attrs:{type:"text"},domProps:{value:e.newExistingLabel},on:{focusout:e.emitValueChanges,input:function(t){t.target.composing||(e.newExistingLabel=t.target.value)}}}),e.locked?e._e():t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:e.unselectExistingValue,mouseenter:function(t){e.hoverUnselect=!0},mouseleave:function(t){e.hoverUnselect=!1}}},[e._v("close")])]),t("i",{staticClass:"em-main-500-color"},[e._v("("+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EXISTING_VALUE"))+")")])])]),e.existingValues&&e.showOptions?t("ul",{staticClass:"em-custom-selector em-border-neutral-300 em-w-100",on:{mouseenter:function(t){e.hoverOptions=!0},mouseleave:function(t){e.hoverOptions=!1}}},e._l(e.displayedOptions,(function(a){return t("li",{key:a.id,staticClass:"em-custom-selector-option em-pointer em-p-8",attrs:{value:a.id,selected:e.selectedExistingValue==a.id},on:{click:function(t){return e.onSelectValue(a.id)}}},[e._v(" "+e._s(a.label)+" ")])})),0):e._e()])},_t=[],ht={props:{options:{type:Array,required:!0},defaultValue:{type:Number,required:!1},locked:{type:Boolean,default:!1}},data(){return{originalOptions:[],newValue:{id:0,label:""},existingValues:[],newExistingLabel:"",selectedExistingValue:-1,isNewVal:!0,showOptions:!1,hoverOptions:!1,hoverUnselect:!1}},beforeMount(){this.originalOptions=JSON.parse(JSON.stringify(this.options)),this.existingValues=this.options},mounted(){null!=this.defaultValue&&this.onSelectValue(this.defaultValue)},methods:{updateDefaultValue(){this.onSelectValue(this.defaultValue)},onSelectValue(e){if(this.selectedExistingValue=e,-1===this.selectedExistingValue)this.unselectExistingValue();else{this.isNewVal=!1;let e=this.existingValues.find(e=>e.id===this.selectedExistingValue);e?(e=JSON.parse(JSON.stringify(e)),this.newExistingLabel=e.label,this.newValue=e,this.emitValueChanges()):this.unselectExistingValue()}this.showOptions=!1},unselectExistingValue(){this.isNewVal=!0;let e=this.existingValues.find(e=>e.id==this.selectedExistingValue);this.newExistingLabel=e?e.label:"",this.selectedExistingValue=-1,this.newValue.label="",this.newValue.id=0,this.existingValues=JSON.parse(JSON.stringify(this.originalOptions)),this.showOptions=!1,this.hoverOptions=!1,this.hoverUnselect=!1,this.emitValueChanges()},emitValueChanges(e=null){if(!this.hoverUnselect)if(this.showOptions&&!this.hoverOptions&&(this.showOptions=!1),this.isNewVal)this.$emit("update-value",this.newValue);else{const e=this.existingValues.find(e=>e.id===this.selectedExistingValue);e.label!==this.newExistingLabel&&(e.label=this.newExistingLabel),this.$emit("update-value",e)}}},computed:{displayedOptions(){return this.isNewVal?this.existingValues.filter(e=>-1===e.id||e.label.toLowerCase().includes(this.newValue.label.toLowerCase())):this.existingValues}},watch:{defaultValue:{handler(e){this.updateDefaultValue()}}}},gt=ht,ft=(a("4779"),Object(b["a"])(gt,pt,_t,!1,null,null,null)),vt=ft.exports;const bt=a("bef5");var Ct={name:"addEmail",components:{IncrementalSelect:vt,EditorQuill:nt,Autocomplete:ze,Multiselect:fe.a},props:{mode:{type:String,default:"create"}},data:()=>({email:0,actualLanguage:"",langue:0,dynamicComponent:!1,displayAdvancedParameters:!1,translations:{AddEmail:"COM_EMUNDUS_ONBOARD_ADD_EMAIL",Advanced:"COM_EMUNDUS_ONBOARD_ADVANCED_CUSTOMING",Informations:"COM_EMUNDUS_ONBOARD_ADDCAMP_INFORMATION",Trigger:"COM_EMUNDUS_ONBOARD_EMAIL_TRIGGER",emailType:"COM_EMUNDUS_ONBOARD_ADDEMAIL_CHOOSETYPE",emailCategory:"COM_EMUNDUS_ONBOARD_CHOOSECATEGORY",retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",continuer:"COM_EMUNDUS_ONBOARD_ADD_CONTINUER",emailName:"COM_EMUNDUS_ONBOARD_ADDEMAIL_NAME",emailBody:"COM_EMUNDUS_ONBOARD_ADDEMAIL_BODY",receiverName:"COM_EMUNDUS_ONBOARD_ADDEMAIL_RECEIVER",emailAddress:"COM_EMUNDUS_ONBOARD_ADDEMAIL_ADDRESS",EmailResume:"COM_EMUNDUS_ONBOARD_ADDEMAIL_RESUME",RequiredFieldsIndicate:"COM_EMUNDUS_ONBOARD_REQUIRED_FIELDS_INDICATE",EmailType:"COM_EMUNDUS_ONBOARD_EMAILTYPE",SubjectRequired:"COM_EMUNDUS_ONBOARD_SUBJECT_REQUIRED",BodyRequired:"COM_EMUNDUS_ONBOARD_BODY_REQUIRED",Program:"COM_EMUNDUS_ONBOARD_ADDCAMP_PROGRAM",Model:"COM_EMUNDUS_ONBOARD_TRIGGERMODEL",ModelRequired:"COM_EMUNDUS_ONBOARD_TRIGGERMODEL_REQUIRED",Status:"COM_EMUNDUS_ONBOARD_TRIGGERSTATUS",StatusRequired:"COM_EMUNDUS_ONBOARD_TRIGGERSTATUS_REQUIRED",Target:"COM_EMUNDUS_ONBOARD_TRIGGERTARGET",TargetRequired:"COM_EMUNDUS_ONBOARD_TRIGGERTARGET_REQUIRED",Administrators:"COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS",Evaluators:"COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS",Candidates:"COM_EMUNDUS_ONBOARD_PROGRAM_CANDIDATES",DefinedUsers:"COM_EMUNDUS_ONBOARD_PROGRAM_DEFINED_USERS",ChooseUsers:"COM_EMUNDUS_ONBOARD_TRIGGER_CHOOSE_USERS",UsersRequired:"COM_EMUNDUS_ONBOARD_TRIGGER_USERS_REQUIRED",Search:"COM_EMUNDUS_ONBOARD_SEARCH_USERS",TheCandidate:"COM_EMUNDUS_ONBOARD_THE_CANDIDATE",Manual:"COM_EMUNDUS_ONBOARD_MANUAL",Actions:"COM_EMUNDUS_ONBOARD_TRIGGER_ACTIONS",Tags:"COM_EMUNDUS_ONBOARD_EMAIL_TAGS",DocumentType:"COM_EMUNDUS_ONBOARD_EMAIL_DOCUMENT",Letters:"COM_EMUNDUS_ONBOARD_EMAIL_DOCUMENT",LettersPlaceHolder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_EMAIL_DOCUMENT",ReceiversCC:"COM_EMUNDUS_ONBOARD_RECEIVER_CC_TAGS",ReceiversCCPlaceHolder:"COM_EMUNDUS_ONBOARD_RECEIVER_CC_TAGS_PLACEHOLDER",ReceiversBCC:"COM_EMUNDUS_ONBOARD_RECEIVER_BCC_TAGS",ReceiversBCCPlaceHolder:"COM_EMUNDUS_ONBOARD_RECEIVER_BCC_TAGS_PLACEHOLDER",CopiesTooltips:"COM_EMUNDUS_ONBOARD_CC_BCC_TOOLTIPS",TagsPlaceHolder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_EMAIL_TAGS",CandidateAttachments:"COM_EMUNDUS_ONBOARD_CANDIDAT_ATTACHMENTS",CandidateAttachmentsPlaceholder:"COM_EMUNDUS_ONBOARD_PLACEHOLDER_CANDIDAT_ATTACHMENTS"},categories:[],programs:[],status:[],users:[],selectedUsers:[],enableTip:!1,searchTerm:"",selectall:!1,tags:[],documents:[],selectedTags:[],selectedCandidateAttachments:[],selectedCategory:0,form:{lbl:"",subject:"",name:"",emailfrom:"",message:"",type:2,category:"",published:1},trigger:{model:null,status:null,action_status:null,target:null,program:null},triggered:!1,errors:{subject:!1,message:!1,trigger:{model:!1,status:!1,target:!1,selectedUsers:!1,action_status:!1}},submitted:!1,loading:!1,selectedReceiversCC:[],selectedReceiversBCC:[],selectedLetterAttachments:[],receivers_cc:[],receivers_bcc:[],attached_letters:[],action_tags:[],candidate_attachments:[],email_sender:""}),created(){this.loading=!0,this.getEmailSender(),this.getAllAttachments(),this.getAllTags(),this.getAllDocumentLetter(),this.actualLanguage=this.$store.getters["global/shortLang"],p.a.get("index.php?option=com_emundus&controller=email&task=getemailcategories").then(e=>{this.categories=e.data.data,this.email=this.$store.getters["global/datas"].email.value,"undefined"!==typeof this.email&&0!==this.email&&""!==this.email?this.getEmailById(this.email):(this.dynamicComponent=!0,this.loading=!1)}).catch(e=>{console.log(e)}),setTimeout(()=>{this.enableVariablesTip()},2e3),this.getProgramsList(),this.getStatus(),this.getUsers()},mounted(){"en"===this.actualLanguage&&(this.langue=1)},methods:{getEmailById(){p.a.get("index.php?option=com_emundus&controller=email&task=getemailbyid&id="+this.email).then(e=>{!1!==e.data.data&&0!=e.data.status?(this.form=e.data.data.email,this.dynamicComponent=!0,this.selectedLetterAttachments=e.data.data.letter_attachment?e.data.data.letter_attachment:[],this.selectedCandidateAttachments=e.data.data.candidate_attachment?e.data.data.candidate_attachment:[],this.selectedTags=e.data.data.tags?e.data.data.tags:[],null!==e.data.data.receivers&&void 0!==e.data.data.receivers&&""!==e.data.data.receivers&&this.setEmailReceivers(e.data.data.receivers),this.loading=!1):this.runError(void 0,e.data.msg)}).catch(e=>{console.log(e),this.runError(void 0,e.data.msg)})},setEmailReceivers(e){let t=[],a=[];for(let n=0;n<e.length;n++)t[n]={},a[n]={},"receiver_cc_email"===e[n].type||"receiver_cc_fabrik"===e[n].type?(t[n]["id"]=e[n].id,t[n]["email"]=e[n].receivers):"receiver_bcc_email"!==e[n].type&&"receiver_bcc_fabrik"!==e[n].type||(a[n]["id"]=e[n].id,a[n]["email"]=e[n].receivers);const s=t.filter(e=>null!==e["id"]&&void 0!==e["id"]),i=a.filter(e=>null!==e["id"]&&void 0!==e["id"]);this.selectedReceiversCC=s,this.selectedReceiversBCC=i},displayAdvanced(){this.displayAdvancedParameters=!this.displayAdvancedParameters},addNewCC(e){const t={email:e,id:e.substring(0,2)+Math.floor(1e7*Math.random())};this.receivers_cc.push(t),this.selectedReceiversCC.push(t)},addNewBCC(e){const t={email:e,id:e.substring(0,2)+Math.floor(1e7*Math.random())};this.receivers_bcc.push(t),this.selectedReceiversBCC.push(t)},getAllUsers:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=getallusers",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.receivers_cc=e.data.users,this.receivers_bcc=e.data.users}).catch(e=>{console.log(e)})},getProgramsList(){p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getallprogram",params:{filter:"",sort:"",recherche:"",lim:100,page:1},paramsSerializer:e=>bt.stringify(e)}).then(e=>{this.programs=e.data.data})},getStatus(){p.a.get("index.php?option=com_emundus&controller=email&task=getstatus").then(e=>{this.status=e.data.data})},getUsers(){p.a.get("index.php?option=com_emundus&controller=programme&task=getuserswithoutapplicants").then(e=>{this.users=e.data.data})},searchUserByTerm(){p.a.get("index.php?option=com_emundus&controller=programme&task=searchuserbytermwithoutapplicants&term="+this.searchTerm).then(e=>{this.users=e.data.data})},getEmailSender(){p.a.get("index.php?option=com_emundus&controller=settings&task=getemailsender").then(e=>{this.email_sender=e.data.data})},addTrigger(){null!=this.trigger.program?this.triggered=!0:this.triggered=!1},selectAllUsers(){this.users.forEach(e=>{this.selectall?this.selectedUsers[e.id]=!1:this.selectedUsers[e.id]=!0}),this.$forceUpdate()},submit(){if(this.errors={subject:!1,message:!1,trigger:{model:!1,status:!1,target:!1,selectedUsers:!1}},""==this.form.subject)return this.errors.subject=!0,0;if(""==this.form.message)return this.errors.message=!0,0;if(null!=this.trigger.program){if(null==this.trigger.action_status)return this.errors.trigger.action_status=!0,0;if(null==this.trigger.status)return this.errors.trigger.status=!0,0;if(null==this.trigger.target)return this.errors.trigger.target=!0,0;if(0==this.trigger.target&&0===this.selectedUsers.length)return this.errors.trigger.selectedUsers=!0,0}this.submitted=!0,""!==this.email?p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=updateemail",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:bt.stringify({body:this.form,code:this.email,selectedReceiversCC:this.selectedReceiversCC,selectedReceiversBCC:this.selectedReceiversBCC,selectedLetterAttachments:this.selectedLetterAttachments,selectedCandidateAttachments:this.selectedCandidateAttachments,selectedTags:this.selectedTags})}).then(()=>{this.redirectJRoute("index.php?option=com_emundus&view=emails")}).catch(e=>{console.log(e)}):p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createemail",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:bt.stringify({body:this.form,selectedReceiversCC:this.selectedReceiversCC,selectedReceiversBCC:this.selectedReceiversBCC,selectedLetterAttachments:this.selectedLetterAttachments,selectedCandidateAttachments:this.selectedCandidateAttachments,selectedTags:this.selectedTags})}).then(e=>{this.trigger.model=e.data.data,p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createtrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:bt.stringify({trigger:this.trigger,users:this.selectedUsers})}).then(()=>{this.redirectJRoute("index.php?option=com_emundus&view=emails")})}).catch(e=>{console.log(e)})},onSearchCategory(e){this.form.category=e},enableVariablesTip(){this.enableTip||(this.enableTip=!0,this.tip())},redirectJRoute(e){window.location.href=e},tip:function(){this.show("foo-velocity",this.translate("COM_EMUNDUS_ONBOARD_VARIABLESTIP")+' <strong style="font-size: 16px">/</strong>',this.translate("COM_EMUNDUS_ONBOARD_TIP"))},show(e,t="",a="Information"){this.$notify({group:e,title:""+a,text:t,duration:1e4})},clean(e){this.$notify({group:e,clean:!0})},getAllTags:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=gettags",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.action_tags=e.data.data}).catch(e=>{console.log(e)})},getAllDocumentLetter:function(){p()({method:"post",url:"index.php?option=com_emundus&controller=messages&task=getalldocumentsletters",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.attached_letters=e.data.documents}).catch(e=>{console.log(e)})},getAllAttachments:function(){p()({method:"get",url:"index.php?option=com_emundus&controller=messages&task=getallattachments",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.candidate_attachments=e.data.attachments}).catch(e=>{console.log(e)})},updateCategorySelectedValue(e){e.label?this.form.category=e.label:(this.selectedCategory=null,this.form.category="")}},computed:{categoriesList(){return this.categories.map((e,t)=>({id:t+1,label:e}))},incSelectDefaultValue(){let e=null;return this.form&&this.form.category&&this.categories.forEach((t,a)=>{t===this.form.category&&(e=a+1)}),e}}},Ot=Ct,yt=(a("c7c3"),Object(b["a"])(Ot,mt,ut,!1,null,"7d8bfd38",null)),Et=yt.exports,Dt=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"add-form-next-campaign"}},[t("div",{staticClass:"em-w-custom"}),t("div",[t("ModalWarningFormBuilder",{attrs:{pid:e.getProfileId,cid:e.campaignId}}),t("div",[t("div",{staticClass:"em-flex-row em-mt-16 em-pointer",on:{click:function(t){return e.redirectJRoute("index.php?option=com_emundus&view=campaigns")}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("p",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("BACK")))])]),t("div",{staticClass:"em-flex-row em-mt-16"},[-1!=e.menuHighlight?t("h1",[e._v(e._s(this.translate(e.formCategories[e.menuHighlight])))]):e._e(),-1!=e.menuHighlightProg?t("h1",[e._v(e._s(this.translate(e.formPrograms[e.menuHighlightProg])))]):e._e()]),-1!=e.menuHighlight?t("p",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:e._s(this.translate(e.formCategoriesDesc[e.menuHighlight]))}}):e._e(),-1!=e.menuHighlightProg?t("p",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:e._s(this.translate(e.formProgramsDesc[e.menuHighlightProg]))}}):e._e(),t("hr"),t("div",{staticClass:"em-flex-row em-mb-32"},[t("p",[t("b",{staticStyle:{color:"var(--em-coordinator-primary-color)","font-weight":"700 !important"}},[e._v(" "+e._s(e.form.label))]),e._v(" "+e._s(e.translations.From)+" "),t("strong",[e._v(e._s(e.form.start_date))]),e._v(" "+e._s(e.translations.To)+" "),t("strong",[e._v(e._s(e.form.end_date))])])]),t("div",{staticClass:"em-flex-row"},[t("ul",{staticClass:"nav nav-tabs topnav"},[e._l(e.formCategories,(function(a,s){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.closeSubmenu,expression:"closeSubmenu"}],key:"category-"+s},[t("a",{staticClass:"em-neutral-700-color em-pointer",class:[e.menuHighlight==s?"w--current":"",null==e.profileId?"grey-link":""],on:{click:function(t){null!=e.profileId&&e.changeToCampMenu(s)}}},[e._v(" "+e._s(e.translate(a))+" ")])])})),e._l(e.formPrograms,(function(a,s){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.closeSubmenu,expression:"closeSubmenu"}],key:"program-"+s},[t("a",{staticClass:"em-neutral-700-color em-pointer",class:[e.menuHighlightProg==s?"w--current":"",null==e.profileId?"grey-link":""],on:{click:function(t){null!=e.profileId&&e.changeToProgMenu(s)}}},[e._v(" "+e._s(e.translate(a))+" ")])])}))],2)]),t("br"),-1!=e.menuHighlightProg?t("div",{staticClass:"warning-message-program mb-1"},[t("p",{staticClass:"em-red-500-color em-flex-row"},[t("span",{staticClass:"material-icons-outlined em-mr-8 em-red-500-color"},[e._v("warning_amber")]),e._v(e._s(e.translations.ProgramWarning))]),e.campaignsByProgram.length>0?t("ul",{staticClass:"em-mt-8 em-mb-32 em-pl-16"},e._l(e.campaignsByProgram,(function(a,s){return t("li",{key:"camp_progs_"+s},[e._v(e._s(a.label))])})),0):e._e()]):e._e(),t("transition",{attrs:{name:"fade"}},[0==e.menuHighlight&&""!==e.campaignId?t("add-campaign",{attrs:{campaign:e.campaignId,coordinatorAccess:!0,actualLanguage:e.actualLanguage,manyLanguages:e.manyLanguages},on:{nextSection:function(t){e.menuHighlight++},getInformations:e.initInformations,updateHeader:e.updateHeader}}):e._e(),2==e.menuHighlight?t("addFormulaire",{key:e.formReload,attrs:{profileId:e.profileId,campaignId:e.campaignId,profiles:e.profiles,visibility:null},on:{profileId:e.setProfileId}}):e._e(),1==e.menuHighlight?t("add-documents-dropfiles",{attrs:{funnelCategorie:e.formCategories[e.langue][e.menuHighlight],profileId:e.getProfileId,campaignId:e.campaignId,menuHighlight:e.menuHighlight,langue:e.actualLanguage,manyLanguages:e.manyLanguages}}):e._e(),0==e.menuHighlightProg&&0!=e.program.id?t("add-email",{attrs:{prog:Number(e.program.id)}}):e._e()],1)],1),0!==e.menuHighlight&&0!==e.menuHighlightProg?t("div",{staticClass:"em-flex-row em-flex-space-between em-float-right"},[t("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:e.next}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"))+" ")])]):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)])},Mt=[],St=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalWarningFormBuilder"}},[t("modal",{attrs:{name:"modalWarningFormBuilder",height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[t("div",{staticClass:"fixed-header-modal"},[t("div",{staticClass:"topright"},[t("button",{staticClass:"btnCloseModal",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalWarningFormBuilder")}}},[t("em",{staticClass:"fas fa-times"})])]),t("div",{staticClass:"update-field-header"},[t("h2",{staticClass:"update-title-header"},[e._v(" "+e._s(e.Warning)+" ")]),t("p",[e._v(" "+e._s(e.FormAffectedToFiles)+" ")])]),t("div",{staticClass:"modalC-content"},[t("div",{staticClass:"em-flex-row em-flex-space-between mb-1"},[t("button",{staticClass:"bouton-sauvergarder-et-continuer w-retour",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalWarningFormBuilder")}}},[e._v(" "+e._s(e.Retour)+" ")]),t("button",{staticClass:"bouton-sauvergarder-et-continuer em-mr-4",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.formbuilder()}}},[e._v(" "+e._s(e.Update)+" ")])])])])])],1)},At=[];a("bef5");var Nt={name:"modalWarningFormBuilder",props:{pid:Number,cid:Number},data(){return{Warning:this.translate("COM_EMUNDUS_ONBOARD_WARNING"),FormAffectedToFiles:this.translate("COM_EMUNDUS_ONBOARD_FORM_AFFECTEDFILES"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Duplicate:this.translate("COM_EMUNDUS_ONBOARD_DUPLICATE"),Update:this.translate("COM_EMUNDUS_ONBOARD_MODIFY")}},methods:{beforeClose(e){},beforeOpen(e){},formbuilder(){window.location.replace("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.pid+"&index=0&cid="+this.cid)}}},wt=Nt,Tt=(a("9142"),Object(b["a"])(wt,St,At,!1,null,"f0d240c8",null)),Ut=Tt.exports,Rt=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"documents-dropfiles"}},[t("div",{staticClass:"w-form"},[t("vue-dropzone",{ref:"dropzone",staticStyle:{width:"100%"},attrs:{id:"customdropzone","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-removed-file":e.afterRemoved,"vdropzone-success":e.onComplete,"vdropzone-error":e.catchError}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.DropHere)+" ")])]),t("hr"),t("draggable",e._b({staticClass:"em-flex-row",staticStyle:{margin:"0"},attrs:{handle:".handle","chosen-class":"em-grabbing"},on:{end:e.updateDocumentsOrder},model:{value:e.documents,callback:function(t){e.documents=t},expression:"documents"}},"draggable",e.dragOptions,!1),[t("transition-group",{staticClass:"em-grid-3 em-w-100 handle",attrs:{type:"transition",value:e.drag?null:"flip-list"}},e._l(e.documents,(function(a,s){return t("div",{key:a.id,staticClass:"em-document-dropzone-card em-grab",attrs:{id:"itemDoc"+a.id}},[t("button",{staticClass:"em-float-right em-transparent-button",attrs:{type:"button"},on:{click:function(t){return e.deleteDoc(s,a.id)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])]),t("div",{staticClass:"em-flex-row em-w-100 em-flex-center"},[t("div",{staticClass:"em-flex-column em-edit-cursor",on:{click:function(t){return e.editName(a)}}},["pdf"===a.ext?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/pdf.png",alt:"filetype"}}):["docx","doc","odf"].includes(a.ext)?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/doc.png",alt:"filetype"}}):["xls","xlsx","csv"].includes(a.ext)?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/excel.png",alt:"filetype"}}):["png","gif","jpg","jpeg"].includes(a.ext)?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/image.png",alt:"filetype"}}):["zip","rar"].includes(a.ext)?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/zip.png",alt:"filetype"}}):["svg"].includes(a.ext)?t("img",{staticClass:"em-filetype-icon",attrs:{src:"media/com_emundus/images/icones/filetype/svg.png",alt:"filetype"}}):e._e(),t("div",{staticClass:"em-mt-8"},[t("span",{staticClass:"em-overflow-ellipsis em-max-width-250 em-mr-4"},[e._v(e._s(a.title))])])])]),t("hr"),t("div",[t("span",[t("strong",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_FILE_SIZE"))+" : ")])]),t("span",[e._v(e._s(e.formatBytes(a.size)))])])])})),0)],1)],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},xt=[],Lt=a("d9b7"),kt=a.n(Lt),It=a("ca98"),Bt=a.n(It);const Pt=a("bef5"),Ft=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var $t={name:"addDocumentsDropfiles",components:{vueDropzone:kt.a,draggable:Bt.a},props:{funnelCategorie:String,profileId:Number,campaignId:Number,langue:String,menuHighlight:Number,manyLanguages:Number},data(){return{dropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=uploaddropfiledoc&cid="+this.campaignId,maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,acceptedFiles:"image/*,application/pdf,.doc,.csv,.xls,.xlsx,.docx,.odf,.zip",previewTemplate:Ft(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG"),dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED"),uploadMultiple:!1},documents:[],Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),DropHere:this.translate("COM_EMUNDUS_ONBOARD_DROP_FILE_HERE"),Error:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),DocumentName:this.translate("COM_EMUNDUS_ONBOARD_DOCUMENT_NAME"),drag:!1,loading:!1}},methods:{getDocumentsDropfiles(){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=campaign&task=getdocumentsdropfiles",params:{cid:this.campaignId},paramsSerializer:e=>Pt.stringify(e)}).then(e=>{this.loading=!1,this.documents=e.data.documents})},updateDocumentsOrder(){this.documents.forEach((e,t)=>{e.ordering=t}),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updateorderdropfiledocuments",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Pt.stringify({documents:this.documents})})},editName(e){j.a.fire({title:"",html:'<div class="form-group campaign-label"><label for="campLabel">'+this.DocumentName+'</label><input type="text" maxlength="200" id="label_'+e.id+'" value="'+e.title+'"/></div>',showCloseButton:!0,allowOutsideClick:!1,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}).then(t=>{if(t){let t=document.getElementById("label_"+e.id).value;t.length>200&&(t=t.substring(0,200)),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=editdocumentdropfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Pt.stringify({did:e.id,name:t})}).then(()=>{e.title=t})}})},deleteDoc(e,t){this.documents.splice(e,1),p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=deletedocumentdropfile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Pt.stringify({did:t})})},formatBytes(e,t=2){if(0===e)return"0 Bytes";const a=1024,s=t<0?0:t,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,n)).toFixed(s))+" "+i[n]},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){this.documents.push(JSON.parse(e.xhr.response)),this.$refs.dropzone.removeFile(e)},catchError:function(e,t){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)}},computed:{dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},created(){this.getDocumentsDropfiles()}},jt=$t,Gt=(a("3073"),Object(b["a"])(jt,Rt,xt,!1,null,"417075a0",null)),Ht=Gt.exports,zt=function(){var e=this,t=e._self._c;return t("div",[t("ModalAddTrigger",{key:"candidate"+e.candidate_trigger,attrs:{prog:this.prog,trigger:this.triggerSelected,triggerAction:"candidate"},on:{UpdateTriggers:e.getTriggers}}),t("ModalAddTrigger",{key:"manual-"+e.manual_trigger,attrs:{prog:this.prog,trigger:this.triggerSelected,triggerAction:"manual"},on:{UpdateTriggers:e.getTriggers}}),t("div",{staticClass:"em-flex-row"},[t("h4",[e._v(e._s(e.CandidateAction))])]),t("p",[e._v(e._s(e.TheCandidateDescription))]),t("button",{staticClass:"em-primary-button em-w-auto em-mt-8",on:{click:function(t){e.$modal.show("modalAddTriggercandidate"),e.triggerSelected=null}}},[e._v(" "+e._s(e.addTrigger)+" ")]),t("transition-group",{staticClass:"em-grid-2 em-m-16",staticStyle:{"margin-left":"0"},attrs:{name:"slide-down",type:"transition"}},e._l(e.candidateTriggers,(function(a){return t("div",{key:a.trigger_id,staticClass:"em-email-card"},[t("div",{staticClass:"em-flex-row em-align-start em-flex-space-between em-w-100"},[t("div",[t("span",{staticClass:"em-mb-8"},[e._v(e._s(a.subject))]),t("div",{staticClass:"em-mt-8 em-mb-8"},[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.Target)+" : ")]),e._l(e.triggerUsersWithProfile(a),(function(s,i){return t("span",{key:"user_"+i},[e._v(" "+e._s(s.firstname)+" "+e._s(s.lastname)+" "),i!=Object.keys(a.users).length-1?t("span",[e._v(", ")]):e._e()])})),0==a.users.length&&5!=a.profile&&6!=a.profile?t("span",[e._v(e._s(e.TheCandidate))]):e._e(),5==a.profile?t("span",[e._v(e._s(e.Administrators))]):e._e(),6==a.profile?t("span",[e._v(e._s(e.Evaluators))]):e._e()],2),t("span",[e._v(e._s(e.Status)+" "+e._s(a.status))])]),t("div",{staticClass:"em-flex-row em-flex-end"},[t("a",{staticClass:"em-mr-8 em-pointer",on:{click:function(t){return e.editTrigger(a)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("edit")])]),t("a",{staticClass:"em-pointer",attrs:{title:e.removeTrig},on:{click:function(t){return e.removeTrigger(a.trigger_id)}}},[t("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("close")])])])])])})),0),t("div",{staticClass:"em-flex-row"},[t("h4",{staticClass:"em-mt-16"},[e._v(e._s(e.ManagerAction))])]),t("p",[e._v(e._s(e.ManualDescription))]),t("button",{staticClass:"em-primary-button em-w-auto em-mt-8",on:{click:function(t){e.$modal.show("modalAddTriggermanual"),e.triggerSelected=null}}},[e._v(" "+e._s(e.addTrigger)+" ")]),t("transition-group",{staticClass:"em-grid-2 em-m-16",staticStyle:{"margin-left":"0"},attrs:{name:"slide-down",type:"transition"}},e._l(e.manualTriggers,(function(a){return t("div",{key:a.trigger_id,staticClass:"em-email-card"},[t("div",{staticClass:"em-flex-row em-align-start em-flex-space-between em-w-100"},[t("div",[t("span",{staticClass:"em-mb-8"},[e._v(e._s(a.subject))]),t("div",{staticClass:"em-mt-8 em-mb-8"},[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.Target)+" : ")]),e._l(e.triggerUsersNoProfile(a),(function(s,i){return t("span",{key:"user_manual_"+i},[e._v(" "+e._s(s.firstname)+" "+e._s(s.lastname)+" "),i!=Object.keys(a.users).length-1?t("span",[e._v(", ")]):e._e()])})),0==a.users.length&&5!=a.profile&&6!=a.profile?t("span",[e._v(e._s(e.TheCandidate))]):e._e(),5==a.profile?t("span",[e._v(e._s(e.Administrators))]):e._e(),6==a.profile?t("span",[e._v(e._s(e.Evaluators))]):e._e()],2),t("p",[e._v(e._s(e.Status)+" "+e._s(a.status))])]),t("div",{staticClass:"em-flex-row em-flex-end"},[t("a",{staticClass:"em-pointer em-mr-8",on:{click:function(t){return e.editTrigger(a)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("edit")])]),t("a",{staticClass:"em-pointer",on:{click:function(t){return e.removeTrigger(a.trigger_id)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])])])])])})),0),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},Vt=[],Yt=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalAddTrigger"+e.triggerAction}},[t("modal",{attrs:{name:"modalAddTrigger"+e.triggerAction,height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[t("ModalEmailPreview",{attrs:{model:this.form.model,models:this.models}}),t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("h4",[e._v(" "+e._s(e.addTrigger)+" ")]),t("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddTrigger"+e.triggerAction)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),t("div",[t("div",{staticClass:"em-mb-16"},[t("label",[e._v(e._s(e.Model)+"* :")]),t("div",{staticClass:"em-flex-row"},[e.models.length>0?t("select",{directives:[{name:"model",rawName:"v-model",value:e.form.model,expression:"form.model"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.model},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"model",t.target.multiple?a:a[0])}}},e._l(e.models,(function(a,s){return t("option",{key:s,domProps:{value:a.id}},[e._v(e._s(a.subject))])})),0):t("p",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_ADD_TRIGGER_MISSING_EMAIL_MODELS")))])]),e.errors.model?t("span",{staticClass:"em-red-500-color em-mb-8"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.ModelRequired))])]):e._e()]),t("div",{staticClass:"em-mb-16"},[t("label",[e._v(e._s(e.Status)+"* :")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.form.status,expression:"form.status"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.status},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"status",t.target.multiple?a:a[0])}}},e._l(e.status,(function(a,s){return t("option",{key:s,domProps:{value:a.step}},[e._v(e._s(a.value))])})),0),e.errors.status?t("span",{staticClass:"em-red-500-color em-mb-8"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.StatusRequired))])]):e._e()]),t("div",{staticClass:"em-mb-16"},[t("label",[e._v(e._s(e.Target)+"* :")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.form.target,expression:"form.target"}],staticClass:"em-w-100",class:{"is-invalid":e.errors.target},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"target",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"5"}},[e._v(e._s(e.Administrators))]),t("option",{attrs:{value:"6"}},[e._v(e._s(e.Evaluators))]),t("option",{attrs:{value:"1000"}},[e._v(e._s(e.Candidates))])]),e.errors.target?t("span",{staticClass:"em-red-500-color em-mb-8"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.TargetRequired))])]):e._e()]),0==e.form.target?t("div",{staticClass:"em-mb-16",staticStyle:{"align-items":"baseline"}},[t("label",[e._v(e._s(e.ChooseUsers)+"* :")]),t("div",{staticClass:"em-flex-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],staticClass:"em-w-100",attrs:{type:"text",placeholder:e.Search},domProps:{value:e.searchTerm},on:{keyup:e.searchUserByTerm,input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}}),t("button",{staticClass:"em-transparent-button em-ml-8",attrs:{type:"button"},on:{click:e.searchUserByTerm}},[t("span",{staticClass:"material-icons-outlined"},[e._v("search")])])]),t("div",{staticClass:"em-flex-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectall,expression:"selectall"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selectall)?e._i(e.selectall,null)>-1:e.selectall},on:{click:e.selectAllUsers,change:function(t){var a=e.selectall,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.selectall=a.concat([n])):l>-1&&(e.selectall=a.slice(0,l).concat(a.slice(l+1)))}else e.selectall=i}}}),t("label",{staticClass:"em-ml-8"},[e._v(" "+e._s(e.SelectAll)+" ")])]),t("div",{class:{"is-invalid":e.errors.selectedUsers}},e._l(e.users,(function(a,s){return t("div",{key:s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedUsers[a.id],expression:"selectedUsers[user.id]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selectedUsers[a.id])?e._i(e.selectedUsers[a.id],null)>-1:e.selectedUsers[a.id]},on:{change:function(t){var s=e.selectedUsers[a.id],i=t.target,n=!!i.checked;if(Array.isArray(s)){var l=null,r=e._i(s,l);i.checked?r<0&&e.$set(e.selectedUsers,a.id,s.concat([l])):r>-1&&e.$set(e.selectedUsers,a.id,s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.selectedUsers,a.id,n)}}}),t("div",{staticClass:"em-ml-8"},[t("p",[e._v(e._s(a.name))]),t("p",[e._v(e._s(a.email))])])])})),0),e.errors.selectedUsers?t("span",{staticClass:"em-red-500-color em-mb-8"},[t("span",{staticClass:"em-red-500-color"},[e._v(e._s(e.UsersRequired))])]):e._e()]):e._e()]),t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-8"},[t("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddTrigger"+e.triggerAction)}}},[e._v(e._s(e.Retour))]),t("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createTrigger()}}},[e._v(e._s(e.Continuer))])])],1)],1)},qt=[],Jt=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalEmailPreview_"+e.model}},[t("modal",{attrs:{name:"modalEmailPreview_"+e.model,height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{"before-open":e.beforeOpen}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("h4",[e._v(" "+e._s(e.ModelPreview)+" ")]),t("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEmailPreview_"+e.model)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),t("div",{staticClass:"em-mb-16"},[null!=e.email?t("p",[t("span",{domProps:{innerHTML:e._s(e.email.message)}})]):e._e()])])],1)},Wt=[];a("bef5");var Kt={name:"modalEmailPreview",props:{model:String,models:Array},data(){return{email:null,ModelPreview:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_PREVIEWMODEL")}},methods:{beforeOpen(){this.models.forEach(e=>{e.id==this.model&&(this.email=e)})}}},Xt=Kt,Qt=Object(b["a"])(Xt,Jt,Wt,!1,null,"421f0fff",null),Zt=Qt.exports;const ea=a("bef5");var ta={name:"modalAddTrigger",components:{ModalEmailPreview:Zt},props:{prog:Number,trigger:Number,triggerAction:String},data(){return{errors:{model:!1,status:!1,action_status:!1,target:!1,selectedUsers:!1},form:{model:-1,status:null,action_status:null,target:null,program:this.prog},users:[],selectedUsers:[],models:[],status:[],searchTerm:"",changes:!1,selectall:!1,addTrigger:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_ADDTRIGGER"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),Model:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERMODEL"),ModelRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERMODEL_REQUIRED"),Status:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS"),StatusRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS_REQUIRED"),Target:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET"),TargetRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET_REQUIRED"),Administrators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS"),Evaluators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS"),Candidates:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_CANDIDATES"),DefinedUsers:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_DEFINED_USERS"),ChooseUsers:this.translate("COM_EMUNDUS_ONBOARD_TRIGGER_CHOOSE_USERS"),UsersRequired:this.translate("COM_EMUNDUS_ONBOARD_TRIGGER_USERS_REQUIRED"),Search:this.translate("COM_EMUNDUS_ONBOARD_SEARCH_USERS"),ChangedActionStatus:this.translate("COM_EMUNDUS_ONBOARD_CHANGED_ACTION_STATUS"),TheCandidate:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE"),Manual:this.translate("COM_EMUNDUS_ONBOARD_MANUAL"),SelectAll:this.translate("COM_EMUNDUS_ONBOARD_SELECT_ALL")}},methods:{beforeClose(e){this.trigger=null,this.form={model:-1,status:null,action_status:null,target:null,program:this.prog}},beforeOpen(e){this.searchTerm="",this.getUsers(),this.getEmailModels(),this.getStatus(),setTimeout(()=>{null!=this.trigger&&this.getTrigger()},200),"candidate"===this.triggerAction?this.form.action_status="to_current_user":this.form.action_status="to_applicant"},createTrigger(){return this.errors={model:!1,status:!1,action_status:!1,target:!1,selectedUsers:!1},-1===this.form.model?(this.errors.model=!0,0):null==this.form.status?(this.errors.status=!0,0):null==this.form.action_status?(this.errors.action_status=!0,0):null==this.form.target?(this.errors.target=!0,0):0==this.form.target&&0===this.selectedUsers.length?(this.errors.selectedUsers=!0,0):void(null!=this.trigger?p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=updatetrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ea.stringify({tid:this.trigger,trigger:this.form,users:this.selectedUsers})}).then(e=>{this.selectedUsers=[],this.$emit("UpdateTriggers"),this.$modal.hide("modalAddTrigger"+this.triggerAction)}):p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=createtrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ea.stringify({trigger:this.form,users:this.selectedUsers})}).then(e=>{this.selectedUsers=[],this.$emit("UpdateTriggers"),this.$modal.hide("modalAddTrigger"+this.triggerAction)}))},getUsers(){p.a.get("index.php?option=com_emundus&controller=programme&task=getuserswithoutapplicants").then(e=>{this.users=e.data.data})},searchUserByTerm(){p.a.get("index.php?option=com_emundus&controller=programme&task=searchuserbytermwithoutapplicants&term="+this.searchTerm).then(e=>{this.users=e.data.data})},getEmailModels(){p.a.get("index.php?option=com_emundus&controller=email&task=getallemail").then(e=>{e.data.status&&(this.models=e.data.data.datas)})},getStatus(){p.a.get("index.php?option=com_emundus&controller=email&task=getstatus").then(e=>{this.status=e.data.data})},getTrigger(){p.a.get("index.php?option=com_emundus&controller=email&task=gettriggerbyid&tid="+this.trigger).then(e=>{this.form.model=e.data.data.model,this.form.status=e.data.data.status,null==e.data.data.target&&0===e.data.data.to_current_user&&0===e.data.data.to_applicant?(this.form.target=0,e.data.data.users.forEach(e=>{this.selectedUsers[e.user_id]=!0})):5!=e.data.data.target&&6!=e.data.data.target||1===e.data.data.to_current_user?this.form.target=1e3:this.form.target=e.data.data.target})},selectAllUsers(){this.users.forEach(e=>{this.selectall?this.selectedUsers[e.id]=!1:this.selectedUsers[e.id]=!0}),this.$forceUpdate()}}},aa=ta,sa=(a("9a53"),Object(b["a"])(aa,Yt,qt,!1,null,"5af21808",null)),ia=sa.exports;const na=a("bef5");var la={name:"addEmail",components:{ModalAddTrigger:ia},props:{funnelCategorie:String,prog:Number},data(){return{triggers:[],triggerSelected:null,manual_trigger:0,candidate_trigger:0,loading:!1,addTrigger:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_ADDTRIGGER"),removeTrig:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_REMOVETRIGGER"),affectTriggers:this.translate("COM_EMUNDUS_ONBOARD_EMAIL_AFFECTTRIGGERS"),ChooseEmailTrigger:this.translate("COM_EMUNDUS_ONBOARD_CHOOSE_EMAIL_TRIGGER"),Target:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERTARGET"),Status:this.translate("COM_EMUNDUS_ONBOARD_TRIGGERSTATUS"),Administrators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_ADMINISTRATORS"),Evaluators:this.translate("COM_EMUNDUS_ONBOARD_PROGRAM_EVALUATORS"),TheCandidate:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE"),Manual:this.translate("COM_EMUNDUS_ONBOARD_MANUAL"),TheCandidateDescription:this.translate("COM_EMUNDUS_ONBOARD_THE_CANDIDATE_DESCRIPTION"),ManualDescription:this.translate("COM_EMUNDUS_ONBOARD_MANUAL_DESCRIPTION"),CandidateAction:this.translate("COM_EMUNDUS_ONBOARD_CANDIDATE_ACTION"),ManagerAction:this.translate("COM_EMUNDUS_ONBOARD_MANAGER_ACTION")}},methods:{editTrigger(e){this.triggerSelected=e.trigger_id,this.manual_trigger+=1,this.candidate_trigger+=1,setTimeout(()=>{1==e.candidate?this.$modal.show("modalAddTriggercandidate"):this.$modal.show("modalAddTriggermanual")},500)},removeTrigger(e){p()({method:"post",url:"index.php?option=com_emundus&controller=email&task=removetrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:na.stringify({tid:e})}).then(()=>{this.getTriggers()})},getTriggers(){p.a.get("index.php?option=com_emundus&controller=email&task=gettriggersbyprogram&pid="+this.prog).then(e=>{this.triggers=e.data.data,this.loading=!1})},triggerUsersWithProfile(e){return null!==e.profile?e.users:[]},triggerUsersNoProfile(e){return null===e.profile&&e.users.length>0?e.users:[]}},computed:{candidateTriggers(){return this.triggers.filter(e=>1==e.candidate)},manualTriggers(){return this.triggers.filter(e=>1==e.manual)}},created(){this.loading=!0,this.getTriggers()}},ra=la,oa=(a("832d"),Object(b["a"])(ra,zt,Vt,!1,null,"6103bfd1",null)),ca=oa.exports,da=function(){var e=this,t=e._self._c;return t("div",[t("a",{staticClass:"em-pointer",on:{click:e.addNewForm}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_NO_FORM_FOUND_ADD_FORM")))]),t("div",{staticClass:"em-mb-4 em-mt-16 em-text-color"},[e._v(e._s(e.ChooseForm)+" : ")]),t("div",{staticClass:"em-mb-4"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.$props.profileId,expression:"$props.profileId"}],attrs:{id:"select_profile"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.$props,"profileId",t.target.multiple?a:a[0])},e.updateProfileCampaign]}},e._l(e.profiles,(function(a,s){return t("option",{key:s,domProps:{value:a.id}},[e._v(" "+e._s(a.form_label)+" ")])})),0)]),t("a",{staticClass:"em-pointer",on:{click:e.formbuilder}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_EDIT_FORM")))]),t("hr"),t("h5",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_PAGES_PREVIEW")))]),t("div",{staticClass:"em-flex-row em-flex-wrap"},e._l(e.fabrikFormList,(function(e){return t("div",{key:e.id,staticClass:"card-wrapper em-mr-32",attrs:{title:e.label}},[t("form-builder-preview-form",{staticClass:"card em-shadow-cards model-preview",attrs:{form_id:Number(e.id),form_label:e.label}})],1)})),0),e.documentsList.length>0?t("div",[t("h5",{staticClass:"em-mt-12"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_ATTACHMENTS_PREVIEW")))]),t("div",{staticClass:"em-flex-row"},e._l(e.documentsList,(function(e){return t("div",{key:e.id,staticClass:"card-wrapper em-mr-32",attrs:{title:e.label}},[t("form-builder-preview-attachments",{staticClass:"card em-shadow-cards model-preview",attrs:{document_id:Number(e.id),document_label:e.label}})],1)})),0)]):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},ma=[],ua=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"em-flex-row em-flex-space-between em-align-start"},[t("div",{staticClass:"em-w-100"},[e.formLinkArray[e.indexHighlight]?t("FormViewer",{attrs:{link:e.formLinkArray[e.indexHighlight],visibility:this.visibility},on:{editPage:e.EditPage}}):e._e()],1),t("hr",{staticClass:"vertical-divider"}),t("div",{staticClass:"em-flex-column em-align-start em-mt-48"},[t("div",{staticClass:"em-mb-16"},[t("h4",[t("span",{staticClass:"material-icons-outlined"},[e._v("article")]),e._v(" "+e._s(e.Form)+" ")]),e._l(e.formNameArray,(function(a,s){return t("div",{key:s,staticClass:"MenuForm em-mb-8"},[t("a",{staticClass:"em-pointer em-text-neutral-900",class:e.indexHighlight==s?"MenuFormItem_current":"",domProps:{innerHTML:e._s(a.value)},on:{click:function(t){return e.ChangeIndex(s)}}},[e._v(e._s(a.value))])])}))],2),t("div",[t("h4",[t("span",{staticClass:"material-icons-outlined"},[e._v("folder")]),e._v(" "+e._s(e.Documents)+" ")]),e._l(e.documentsList,(function(a,s){return t("div",{key:s,staticClass:"MenuForm em-mb-8"},[t("p",{staticClass:"em-text-neutral-900"},[e._v(e._s(a.label))])])}))],2)])])])},pa=[],_a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-mt-16 applicant-form",attrs:{id:"FormViewer"}},[e.object_json.show_page_heading?t("div",{class:e.object_json.show_page_heading.class,domProps:{innerHTML:e._s(e.object_json.show_page_heading.page_heading)}}):e._e(),t("div",{staticClass:"em-flex-row em-flex-space-between page-header"},[e.object_json.show_title?t("h1",{staticClass:"em-mt-0",domProps:{innerHTML:e._s(e.object_json.show_title.value)}}):e._e()]),e.object_json.intro_value?t("p",{staticClass:"em-mt-16",domProps:{innerHTML:e._s(e.object_json.intro_value)}}):e._e(),t("form",{staticClass:"fabrikForm",attrs:{method:"post","object_json.attribs":"",id:"form_"+e.object_json.id}},[e.object_json.plugintop?t("div",{domProps:{innerHTML:e._s(e.object_json.plugintop)}}):e._e(),e._l(e.object_json.Groups,(function(a){return t("fieldset",{key:a.index,staticClass:"fabrikGroup",class:a.group_class,style:a.group_css,attrs:{id:"group"+a.group_id}},[a.group_showLegend?t("legend",{staticClass:"legend"},[e._v(" "+e._s(a.group_showLegend)+" ")]):e._e(),a.group_intro?t("div",{domProps:{innerHTML:e._s(a.group_intro)}}):e._e(),e._l(a.elements,(function(a){return t("div",{directives:[{name:"show",rawName:"v-show",value:!1===a.hidden,expression:"element.hidden === false"}],key:a.index,staticClass:"row-fluid",class:{unpublished:!a.publish}},[t("div",{staticClass:"control-group fabrikElementContainer span12",class:"plg-"+a.plugin},[t("span",{domProps:{innerHTML:e._s(a.label_value)}}),a.params.date_table_format?t("div",[t("date-picker",{attrs:{config:e.options},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):0==a.labelsAbove?t("div",{staticClass:"controls"},[a.element?t("div",{class:a.errorClass,domProps:{innerHTML:e._s(a.element)}}):e._e(),a.tipSide?t("span",{domProps:{innerHTML:e._s(a.tipSide)}}):e._e()]):t("div",{staticClass:"fabrikElement",class:a.errorClass,domProps:{innerHTML:e._s(a.element)}}),a.tipSide?t("span",{domProps:{innerHTML:e._s(a.tipSide)}}):e._e(),a.tipBelow?t("span",{domProps:{innerHTML:e._s(a.tipBelow)}}):e._e()])])})),a.group_outro?t("div",{staticClass:"groupoutro",domProps:{innerHTML:e._s(e.group_outro)}}):e._e()],2)})),e.object_json.pluginbottom?t("div",{domProps:{innerHTML:e._s(e.object_json.pluginbottom)}}):e._e()],2),e.submitted?t("div",{staticClass:"em-page-loader"}):e._e()])},ha=[],ga=a("f6f6"),fa=a.n(ga),va=a("daef"),ba=a.n(va);const Ca=a("bef5");var Oa={name:"FormViewer",props:{link:{type:Object,default:{link:""}},visibility:Number},components:{datePicker:ba.a},data(){return{object_json:"",date:new Date,submitted:!1,options:{format:"DD/MM/YYYY",useCurrent:!1}}},methods:{splitProfileIdfromLabel(e){return e.split(/-(.+)/)[1]},formbuilder(){this.$emit("editPage")},getDataObject:fa.a.debounce((function(){this.submitted=!0;let e=this.link.link.replace("fabrik","emundus");p.a.get(e+"&format=vue_jsonclean").then(e=>{this.object_json=e.data,null!=this.visibility&&p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=checkconstraintgroup",params:{cid:this.visibility},paramsSerializer:e=>Ca.stringify(e)}).then(e=>{Object.keys(this.object_json.Groups).forEach(t=>{null!=e.data.data?p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=checkvisibility",params:{group:this.object_json.Groups[t]["group_id"],cid:this.visibility},paramsSerializer:e=>Ca.stringify(e)}).then(e=>{parseInt(e.data.data)>0?this.object_json.Groups[t].visibility=!0:this.object_json.Groups[t].visibility=!1}):this.object_json.Groups[t].visibility=!0}),this.$forceUpdate()}),this.submitted=!1}).catch(e=>{console.log(e)})}),150),updateVisibility(e){this.object_json.Groups["group_"+e]["visibility"]=!this.object_json.Groups["group_"+e]["visibility"],p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=updatevisibility",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ca.stringify({visibility:this.object_json.Groups["group_"+e]["visibility"],gid:e,cid:this.visibility})}).then(e=>{this.$forceUpdate()})}},created(){this.getDataObject()},watch:{link:function(){this.getDataObject()}}},ya=Oa,Ea=(a("236e"),Object(b["a"])(ya,_a,ha,!1,null,"45f26282",null)),Da=Ea.exports,Ma=(a("2051"),{name:"FormCarrousel",props:{formList:Array,documentsList:Array,visibility:Number},components:{FormViewer:Da},data(){return{indexHighlight:"0",formNameArray:[],formLinkArray:[],formArray:[],FormPage:this.translate("COM_EMUNDUS_ONBOARD_FORM_PAGE"),Form:this.translate("COM_EMUNDUS_ONBOARD_FORM"),Documents:this.translate("COM_EMUNDUS_ONBOARD_DOCUMENTS")}},methods:{splitProfileIdfromLabel(e){return e.split(/-(.+)/)[1]},ChangeIndex(e){this.indexHighlight=e},EditPage(){this.$emit("formbuilder",this.indexHighlight)},getDataObject:function(){this.formList.forEach(e=>{let t=e.link.replace("fabrik","emundus");p.a.get(t+"&format=vue_jsonclean").then(t=>{this.formNameArray.push({value:t.data.show_title.value,rgt:e.rgt}),this.formLinkArray.push({link:e.link,rgt:e.rgt})}).then(e=>{this.formNameArray.sort((e,t)=>e.rgt-t.rgt),this.formLinkArray.sort((e,t)=>e.rgt-t.rgt)}).catch(e=>{console.log(e)})})}},created(){this.getDataObject()}}),Sa=Ma,Aa=(a("bd9d"),Object(b["a"])(Sa,ua,pa,!1,null,"1c8379c0",null)),Na=Aa.exports,wa=(a("d22c"),a("2b9c"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-h-100 em-w-100",class:{loading:e.loading},attrs:{id:"form-builder-preview-form"}},[e.loading?t("skeleton",{attrs:{height:"100%",width:"100%"}}):t("div",[t("p",{staticClass:"em-font-size-12 em-w-100 em-text-align-left em-mb-16"},[e._v(e._s(e.form_label))]),t("div",{staticClass:"preview-groups em-flex-column"},e._l(e.formData.groups,(function(a,s){return t("section",{key:a.id,staticClass:"em-mb-8 form-builder-page-section"},[t("div",{staticClass:"section-card em-flex-column"},[t("div",{staticClass:"section-identifier em-bg-main-500 em-flex-row"},[t("span",{staticClass:"text-xxs"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION"))+" "+e._s(s+1)+" / "+e._s(e.formData.groups.length))])]),t("div",{staticClass:"section-content em-w-100"},[t("p",{staticClass:"em-font-size-8 em-w-100 em-text-align-left"},[e._v(e._s(a.label.replace("Model - ","")))])])])])})),0)])],1)}),Ta=[];const Ua="index.php?option=com_emundus&controller=form";var Ra={async updateFormLabel(e){const t=new FormData;Object.keys(e).forEach(a=>t.append(a,e[a]));try{const e=await h().post(Ua+"&task=updateformlabel",t);return e}catch(a){return{status:!1,error:a}}},async getFilesByForm(e){try{const t=await h().get(Ua+"&task=getfilesbyform&pid="+e);return t}catch(t){return{status:!1,error:t}}},async getSubmissionPage(e){try{const t=await h().get(Ua+"&task=getsubmittionpage",{params:{prid:e}});return t}catch(t){return{status:!1,error:t}}},async getFormsByProfileId(e){try{const t=await h().get(Ua+"&task=getFormsByProfileId",{params:{profile_id:e}});return t}catch(t){return{status:!1,error:t}}},async getFormByFabrikId(e){try{const t=await h().get(Ua+"&task=getFormByFabrikId",{params:{form_id:e}});return t}catch(t){return{status:!1,error:t}}},async getProfileLabelByProfileId(e){const t=new FormData;t.append("profile_id",e);try{const e=await h().post(Ua+"&task=getProfileLabelByProfileId",t);return e}catch(a){return{status:!1,error:a}}},async getDocuments(e){if(!(e>0))return{status:!1,msg:"Missing parameter"};try{const t=await h().get(Ua+"&task=getDocuments",{params:{pid:e}});return t.data}catch(t){return{status:!1,msg:t}}},async getDocumentModels(e=null){try{let t={status:!1};const a=await h().get(Ua+"&task=getAttachments");if(a.data.status)if(null!==e){const s=a.data.data.filter(t=>t.id===e);t=s.length>0?{status:!0,data:s[0]}:{status:!1,error:"Document not found"}}else t=a.data;return t}catch(t){return{status:!1,error:t}}},async getDocumentModelsUsage(e){const t=new FormData;t.append("documentIds",e);try{const e=await h().post(Ua+"&task=getdocumentsusage",t);return e.data}catch(a){return{status:!1,error:a}}},async getPageGroups(e){if(!("number"==typeof e&&e>0))return{status:!1,msg:"MISSING_PARAMS"};try{const t=await h().get(Ua+"&task=getpagegroups&form_id="+e);return t.data}catch(t){return{status:!1,error:t}}},async reorderDocuments(e){try{const t=new FormData;t.append("documents",JSON.stringify(e));const a=await h().post(Ua+"&task=reorderDocuments",t);return a}catch(t){return{status:!1,error:t}}},async addDocument(e){const t=new FormData;Object.keys(e).forEach(a=>t.append(a,e[a]));try{const e=await h().post(Ua+"&task=addDocument",t);return e}catch(a){return{status:!1,error:a}}},async getAssociatedCampaigns(e){try{const t=h().get(Ua+"&task=getassociatedcampaign",{params:{pid:e}});return t}catch(t){return{status:!1,error:t}}},async removeDocumentFromProfile(e){try{const t=await h().get(Ua+"&task=removeDocumentFromProfile",{params:{did:e}});return t}catch(t){return{status:!1,error:t}}},async getPageObject(e){try{const t=await h().get("index.php?option=com_emundus&view=form&formid="+e+"&format=vue_jsonclean");return t}catch(t){return{status:!1,error:t}}},async checkIfDocumentCanBeDeletedForProfile(e,t){try{const a=await h().get(Ua+"&task=checkcandocbedeleted&docid="+e+"&prid="+t);return a.data}catch(a){return{status:!1,error:a}}}},xa={name:"FormBuilderPreviewForm",components:{Skeleton:Ee},props:{form_id:{type:Number,required:!0},form_label:{type:String,default:""}},data(){return{loading:!0,formData:{}}},created(){Ra.getPageGroups(this.form_id).then(e=>{e.status&&(e.data.groups=e.data.groups.filter(e=>1===Number(e.published)),this.formData=e.data),this.loading=!1})},methods:{}},La=xa,ka=(a("ed97"),Object(b["a"])(La,wa,Ta,!1,null,null,null)),Ia=ka.exports,Ba=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-h-100 em-w-100",class:{loading:e.loading},attrs:{id:"form-builder-preview-attachment"}},[e.loading?t("skeleton",{attrs:{height:"100%",width:"100%"}}):t("div",{staticClass:"em-text-align-center"},[t("img",{staticStyle:{width:"50px"},attrs:{src:"media/com_emundus/images/icones/filetype/doc.png",alt:"filetype"}}),t("p",{staticClass:"em-font-size-12 em-w-100 em-mt-16"},[e._v(e._s(e.document_label))])])],1)},Pa=[],Fa={name:"FormBuilderPreviewAttachments",components:{Skeleton:Ee},props:{document_id:{type:Number,required:!0},document_label:{type:String,default:""}},data(){return{loading:!1}},created(){},methods:{}},$a=Fa,ja=(a("7f86"),Object(b["a"])($a,Ba,Pa,!1,null,null,null)),Ga=ja.exports;const Ha=a("bef5");var za={name:"addFormulaire",props:{profileId:String,campaignId:Number,profiles:Array,formulaireEmundus:Number,visibility:Number},components:{FormBuilderPreviewAttachments:Ga,FormBuilderPreviewForm:Ia,FormCarrousel:Na},data(){return{ChooseForm:this.translate("COM_EMUNDUS_ONBOARD_CHOOSE_FORM"),AddForm:this.translate("COM_EMUNDUS_ONBOARD_ADD_FORM"),EmitIndex:"0",formList:[],documentsList:[],loading:!1,form:{label:"Nouveau formulaire",description:"",published:1},formdescription:this.translate("COM_EMUNDUS_ONBOARD_FORMDESCRIPTION")}},created(){this.getForms(this.profileId),this.getDocuments(this.profileId)},methods:{getEmitIndex(e){this.EmitIndex=e},getForms(e){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getFormsByProfileId",params:{profile_id:e},paramsSerializer:e=>Ha.stringify(e)}).then(e=>{this.formList=e.data.data,this.loading=!1}).catch(e=>{console.log(e)})},getDocuments(e){p()({method:"get",url:"index.php?option=com_emundus&controller=form&task=getDocuments",params:{pid:e},paramsSerializer:e=>Ha.stringify(e)}).then(e=>{this.documentsList=e.data.data})},redirectJRoute(e){window.location.href=e},addNewForm(){this.loading=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=form&task=createform",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ha.stringify({body:this.form})}).then(e=>{this.loading=!1,this.$props.profileId=e.data.data,this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.profileId+"&index=0&cid="+this.campaignId)}).catch(e=>{console.log(e)})},updateProfileCampaign(){p()({method:"post",url:"index.php?option=com_emundus&controller=campaign&task=updateprofile",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Ha.stringify({profile:this.profileId,campaign:this.campaignId})}).then(()=>{this.getForms(this.profileId),this.getDocuments(this.profileId),this.$emit("profileId",this.profileId)})},formbuilder(e){e=0,this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid="+this.profileId+"&index="+e+"&cid="+this.campaignId)}},computed:{fabrikFormList(){return this.formList.filter(e=>e.link.includes("fabrik"))}}},Va=za,Ya=(a("e3f8"),Object(b["a"])(Va,da,ma,!1,null,"c80d495e",null)),qa=Ya.exports,Ja=function(){var e=this,t=e._self._c;return t("div",[t("ModalAddEvaluation",{attrs:{prog:e.prog,grid:e.grid},on:{updateGrid:function(t){return e.getEvaluationGridByProgram(1)}}}),t("div",{staticClass:"container-evaluation"},[null==e.grid?t("div",{staticClass:"text-center"},[t("button",{staticClass:"bouton-sauvergarder-et-continuer",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:function(t){return e.$modal.show("modalAddEvaluation")}}},[e._v(e._s(e.translations.addGrid))])]):e._e(),null!=e.grid?t("div",{staticClass:"em-flex-row"},[t("button",{staticClass:"bouton-sauvergarder-et-continuer em-mr-4",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:e.evaluationBuilder}},[e._v(e._s(e.translations.editGrid))]),t("button",{staticClass:"bouton-sauvergarder-et-continuer w-delete",staticStyle:{float:"none"},attrs:{type:"button"},on:{click:e.deleteGrid}},[e._v(" "+e._s(e.translations.deleteGrid))])]):e._e(),null!=e.grid?t("FormViewerEvaluation",{key:e.viewer,attrs:{link:e.link,prog:e.prog}}):e._e()],1)],1)},Wa=[],Ka=function(){var e=this,t=e._self._c;return t("div",{staticClass:"FormViewer container-fluid",attrs:{id:"FormViewerEvaluation"}},[t("link",{attrs:{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css"}}),t("notifications",{attrs:{group:"foo-velocity",position:"top right","animation-type":"velocity",speed:500}}),e.object_json.show_page_heading?t("div",{class:e.object_json.show_page_heading.class,domProps:{innerHTML:e._s(e.object_json.show_page_heading.page_heading)}}):e._e(),t("form",{attrs:{method:"post","object_json.attribs":""},on:{submit:function(e){e.preventDefault()}}},[e.object_json.plugintop?t("div",{domProps:{innerHTML:e._s(e.object_json.plugintop)}}):e._e(),e._l(e.object_json.Groups,(function(a,s){return t("div",{key:a.index},[t("fieldset",{class:a.group_class,style:a.group_css,attrs:{id:"group_"+a.group_id}},[t("div",{staticClass:"em-flex-row"},[a.group_showLegend?t("legend",{staticClass:"legend ViewerLegend"},[e._v(e._s(a.group_showLegend))]):e._e()]),a.group_intro?t("div",{staticClass:"groupintro",domProps:{innerHTML:e._s(a.group_intro)}}):e._e(),t("div",{staticClass:"elements-block"},[t("transition-group",{attrs:{name:"slide-down",type:"transition"}},e._l(a.elts,(function(a,s){return t("div",{directives:[{name:"show",rawName:"v-show",value:!1===a.hidden,expression:"element.hidden === false"}],key:a.id,staticClass:"builder-item-element",class:{unpublished:!a.publish}},[t("div",{staticClass:"em-flex-row builder-item-element__properties"},[t("div",{staticClass:"w-100"},[t("div",{staticClass:"em-flex-row",staticStyle:{"align-items":"baseline"}},[a.label_value?t("span",{directives:[{name:"show",rawName:"v-show",value:2!=a.labelsAbove,expression:"element.labelsAbove != 2"}],domProps:{innerHTML:e._s(a.label_value)}}):e._e()]),a.params.date_table_format?t("div",[t("date-picker",{attrs:{config:e.options},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1):0==a.labelsAbove?t("div",{staticClass:"controls"},[a.error?t("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(a.error)}}):e._e(),a.element?t("div",{class:a.errorClass,domProps:{innerHTML:e._s(a.element)}}):e._e(),a.tipSide?t("span",{domProps:{innerHTML:e._s(a.tipSide)}}):e._e()]):t("span",{staticClass:"em-flex-row w-100"},[a.element?t("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(a.error)}}):e._e(),a.element?t("div",{staticClass:"w-100",class:a.errorClass,domProps:{innerHTML:e._s(a.element)}}):e._e(),a.tipSide?t("span",{domProps:{innerHTML:e._s(a.tipSide)}}):e._e()]),a.tipBelow?t("span",{domProps:{innerHTML:e._s(a.tipBelow)}}):e._e()])])])})),0)],1),a.group_outro?t("div",{staticClass:"groupoutro",domProps:{innerHTML:e._s(e.group_outro)}}):e._e()])])})),e.object_json.pluginbottom?t("div",{domProps:{innerHTML:e._s(e.object_json.pluginbottom)}}):e._e()],2),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},Xa=[],Qa=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalEditElement"+e.elementId}},[t("modal",{attrs:{name:"modalEditElement"+e.elementId,transition:"little-move-left","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!0},on:{closed:e.beforeClose,"before-open":e.beforeOpen}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("h4",[e._v(" "+e._s(e.ElementOptions)+" ")]),t("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEditElement"+e.elementId)}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),null!=e.element?t("div",[t("div",{staticClass:"em-mb-16"},[t("div",{staticClass:"em-flex-row em-mb-16 em-pointer",on:{click:function(t){return e.publishUnpublishElement()}}},[t("em",{class:[e.element.publish?"fa-eye-slash":"fa-eye","far"],staticStyle:{width:"45px"},attrs:{id:"publish_icon_"+e.element.id}}),e.element.publish?t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.Unpublish))]):e._e(),e.element.publish?e._e():t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.Publish))])]),"display"!=e.plugin?t("div",{staticClass:"em-mb-16 em-flex-row"},[t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.FRequire,expression:"element.FRequire"}],staticClass:"em-toggle-check",attrs:{type:"checkbox",id:"require",name:"require"},domProps:{checked:Array.isArray(e.element.FRequire)?e._i(e.element.FRequire,null)>-1:e.element.FRequire},on:{click:function(t){return e.updateRequireElement()},change:function(t){var a=e.element.FRequire,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&e.$set(e.element,"FRequire",a.concat([n])):l>-1&&e.$set(e.element,"FRequire",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(e.element,"FRequire",i)}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})]),t("span",{staticClass:"em-ml-8 em-pointer",attrs:{for:"require"},on:{click:function(t){return e.updateRequireElement()}}},[e._v(e._s(e.Required))])]):e._e()]),t("div",{staticClass:"em-mb-16"},[t("label",[e._v(e._s(e.fieldType)+" :")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.plugin,expression:"plugin"}],staticClass:"em-w-100",attrs:{id:"select_type",disabled:0!=e.files&&"birthday"==e.element.plugin||0!=e.files&&6==e.element.params.password},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.plugin=t.target.multiple?a:a[0]}}},e._l(e.plugins,(function(a,s){return t("option",{key:s,domProps:{value:a.value}},[e._v(" "+e._s(a.name)+" ")])})),0)]),t("hr"),t("div",{staticClass:"em-mb-16"},["field"==e.plugin?t("fieldF",{attrs:{files:e.files,element:e.element}}):e._e(),"birthday"==e.plugin?t("birthdayF",{attrs:{element:e.element}}):e._e(),"checkbox"==e.plugin?t("checkboxF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"dropdown"==e.plugin?t("dropdownF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"radiobutton"==e.plugin?t("radiobtnF",{attrs:{element:e.element,databases:e.databases},on:{subOptions:e.subOptions}}):e._e(),"textarea"==e.plugin?t("textareaF",{attrs:{element:e.element}}):e._e(),"display"==e.plugin?t("displayF",{attrs:{element:e.element}}):e._e(),"yesno"==e.plugin?t("yesnoF",{attrs:{element:e.element}}):e._e()],1)]):e._e(),t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("button",{staticClass:"em-secondary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalEditElement"+e.elementId)}}},[e._v(" "+e._s(e.Retour)+" ")]),t("button",{staticClass:"em-primary-button em-w-auto",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.UpdateParams.apply(null,arguments)}}},[e._v(e._s(e.Continuer))])]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])],1)},Za=[];const es=a("bef5");var ts={name:"modalEditElement",props:{elementId:{type:Number,required:!0},gid:Number,files:Number,manyLanguages:Number,actualLanguage:String,profileId:Number},components:{},data(){return{label:{fr:"",en:""},done:!1,changes:!1,loading:!1,sublabel:"",plugin:"",element:null,plugins:{field:{value:"field",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_FIELD")},birthday:{value:"birthday",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_BIRTHDAY")},checkbox:{value:"checkbox",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_CHECKBOX")},dropdown:{value:"dropdown",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DROPDOWN")},radiobutton:{value:"radiobutton",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_RADIOBUTTON")},textarea:{value:"textarea",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_TEXTAREA")},display:{value:"display",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_DISPLAY")},yesno:{value:"yesno",name:this.translate("COM_EMUNDUS_ONBOARD_TYPE_YESNO")}},databases:[],Name:this.translate("COM_EMUNDUS_ONBOARD_FIELD_NAME"),Require:this.translate("COM_EMUNDUS_ONBOARD_FIELD_REQUIRED"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_SAVE"),dataSaved:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DATASAVED"),informations:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_INFORMATIONS"),fieldType:this.translate("COM_EMUNDUS_ONBOARD_FIELD_TYPE"),Delete:this.translate("COM_EMUNDUS_ONBOARD_ACTION_DELETE"),LabelRequired:this.translate("COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME"),TranslateEnglish:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH"),ElementOptions:this.translate("COM_EMUNDUS_ONBOARD_ELEMENT_OPTIONS"),Unpublish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_UNPUBLISH"),Publish:this.translate("COM_EMUNDUS_ONBOARD_ACTION_PUBLISH"),Required:this.translate("COM_EMUNDUS_ONBOARD_ACTIONS_REQUIRED"),update:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATE"),updating:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATING"),updateSuccess:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATESUCESS"),updateFailed:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_UPDATEFAILED")}},methods:{subOptions(e){this.sublabel=e},UpdateParams(){this.changes=!0,"undefined"!==typeof this.element.params.sub_options&&(this.element.params.sub_options.sub_labels=this.sublabel.map(e=>e.sub_label),this.element.params.sub_options.sub_values=this.sublabel.map(e=>e.sub_value)),p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:es.stringify({element:this.element})}).then(e=>{setTimeout(()=>{this.$emit("reloadElement")},200),this.$modal.hide("modalEditElement"+this.elementId)}).catch(e=>{console.log(e)})},axiostrad:function(e){return p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=getalltranslations",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:es.stringify({toJTEXT:e})})},getElement(){this.loading=!0,p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getElement",params:{element:this.elementId,gid:this.gid},paramsSerializer:e=>es.stringify(e)}).then(e=>{this.element=e.data,"databasejoin"==this.element.plugin?"radio"==this.element.params.database_join_display_type?this.plugin="radiobutton":this.plugin=this.element.params.database_join_display_type:"date"==this.element.plugin||"years"==this.element.plugin?this.plugin="birthday":this.plugin=this.element.plugin,this.axiostrad(this.element.label_tag).then(e=>{this.label.fr=e.data.fr,this.label.en=e.data.en}),0!=this.files&&"birthday"!=this.element.plugin&&delete this.plugins.birthday,this.loading=!1})},getDatabases(){p()({method:"get",url:"index.php?option=com_emundus&controller=formbuilder&task=getdatabasesjoin"}).then(e=>{this.databases=e.data.data})},beforeClose(e){!0===this.changes&&(this.changes=!1,this.$emit("show","foo-velocity","warn",this.dataSaved,this.informations)),this.$emit("modalClosed")},beforeOpen(e){this.initialisation()},initialisation(){this.getElement(),this.getDatabases()},publishUnpublishElement(){p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=publishunpublishelement",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:es.stringify({element:this.element.id})}).then(e=>{this.element.publish=!this.element.publish,this.$emit("publishUnpublishEvent"),this.$emit("show","foo-velocity","success",this.updateSuccess,this.update)}).catch(e=>{this.$emit("show","foo-velocity","error",this.updateFailed,this.updating),console.log(e)})},updateRequireElement(){setTimeout(()=>{p()({method:"post",url:"index.php?option=com_emundus&controller=formbuilder&task=changerequire",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:es.stringify({element:this.element})}).then(()=>{this.$emit("updateRequireEvent")}).catch(e=>{this.$emit("show","foo-velocity","error",this.updateFailed,this.updating),console.log(e)})},300)}},watch:{element:function(){this.tempEl=JSON.parse(JSON.stringify(this.element))},plugin:function(e){switch(e){case"dropdown":"databasejoin"!==this.element.plugin&&(this.element.plugin=e);break;case"radiobutton":"databasejoin"!==this.element.plugin&&(this.element.plugin=e);break;case"birthday":"date"!==this.element.plugin&&"years"!==this.element.plugin&&(this.element.plugin=e);break;default:this.element.plugin=e}}}},as=ts,ss=(a("468d"),Object(b["a"])(as,Qa,Za,!1,null,"3d8dc823",null)),is=ss.exports;a("bef5");var ns={name:"FormViewerEvaluation",props:{link:String,prog:Number},components:{datePicker:ba.a,modalEditElement:is},data(){return{object_json:"",date:new Date,groups:[],loading:!1,options:{format:"DD/MM/YYYY",useCurrent:!1}}},methods:{getDataObject:fa.a.debounce((function(){this.loading=!0;let e=this.link.link.replace("fabrik","emundus");p.a.get(e+"&format=vue_jsonclean").then(e=>{this.object_json=e.data,this.convertGroupElementsToArray(),this.loading=!1}).catch(e=>{this.loading=!1,console.log(e)})}),150),convertGroupElementsToArray(){Object.keys(this.object_json.Groups).forEach(e=>{this.groups.push(this.object_json.Groups[e]),this.object_json.Groups[e].elts=[],Object.keys(this.object_json.Groups[e].elements).forEach(t=>{this.object_json.Groups[e].elts.push(this.object_json.Groups[e].elements[t])})})}},created(){this.getDataObject()},computed:{dragOptions(){return{group:{name:"items",pull:"clone",put:!1},sort:!1,disabled:!1,ghostClass:"ghost"}}},watch:{}},ls=ns,rs=(a("0a13"),Object(b["a"])(ls,Ka,Xa,!1,null,"16207d30",null)),os=rs.exports,cs=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalAddEvaluation"}},[t("modal",{attrs:{name:"modalAddEvaluation",height:"auto",transition:"nice-modal-fade","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1},on:{"before-open":e.beforeOpen}},[t("div",{staticClass:"fixed-header-modal"},[t("div",{staticClass:"topright"},[t("button",{staticClass:"btnCloseModal",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddEvaluation")}}},[t("em",{staticClass:"fas fa-times"})])]),t("div",{staticClass:"update-field-header"},[t("h2",{staticClass:"update-title-header"},[e._v(" "+e._s(e.translations.addGrid)+" ")])])]),t("div",{staticClass:"modalC-content"},[t("div",{staticClass:"form-group"},[t("label",[e._v(e._s(e.translations.ChooseExistingGridModel)+" :")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.model_id,expression:"model_id"}],staticClass:"dropdown-toggle",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.model_id=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"-1"}}),e._l(e.models,(function(a){return t("option",{key:a.form_id,domProps:{value:a.form_id}},[e._v(e._s(a.label))])}))],2)]),t("div",{staticClass:"form-group",class:{"mb-0":e.can_translate.label}},[t("label",[e._v(e._s(e.translations.Name)),t("span",{staticClass:"em-red-500-color"},[e._v("*")]),e._v(" :")]),t("div",{staticClass:"input-can-translate"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.label.fr,expression:"label.fr"}],staticClass:"form__input field-general w-input",class:{"is-invalid":e.errors},staticStyle:{margin:"0"},attrs:{type:"text",maxlength:"40",id:"menu_label"},domProps:{value:e.label.fr},on:{input:function(t){t.target.composing||e.$set(e.label,"fr",t.target.value)}}}),t("button",{staticClass:"translate-icon",class:{"translate-icon-selected":e.can_translate.label},attrs:{type:"button"},on:{click:function(t){e.can_translate.label=!e.can_translate.label}}})])]),t("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.label?t("div",{staticClass:"inlineflex"},[t("label",{staticClass:"translate-label"},[e._v(" "+e._s(e.translations.TranslateEnglish)+" ")]),t("i",{staticClass:"fas fa-sort-down"})]):e._e()]),t("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.label?t("div",{staticClass:"form-group mb-1"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.label.en,expression:"label.en"}],staticClass:"form__input field-general w-input",attrs:{type:"text",maxlength:"40"},domProps:{value:e.label.en},on:{input:function(t){t.target.composing||e.$set(e.label,"en",t.target.value)}}})]):e._e()]),e.errors&&-1==e.model_id?t("p",{staticClass:"error col-md-12 mb-2"},[t("span",{staticClass:"error"},[e._v(e._s(e.translations.LabelRequired))])]):e._e(),t("div",{staticClass:"form-group mt-1",class:{"mb-0":e.can_translate.intro}},[t("label",[e._v(e._s(e.translations.Intro)+" :")]),t("div",{staticClass:"input-can-translate"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.intro.fr,expression:"intro.fr"}],staticClass:"form__input field-general w-input",staticStyle:{margin:"0"},attrs:{rows:"3",maxlength:"300"},domProps:{value:e.intro.fr},on:{input:function(t){t.target.composing||e.$set(e.intro,"fr",t.target.value)}}}),t("button",{staticClass:"translate-icon",class:{"translate-icon-selected":e.can_translate.intro},attrs:{type:"button"},on:{click:function(t){e.can_translate.intro=!e.can_translate.intro}}})])]),t("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.intro?t("div",{staticClass:"inlineflex"},[t("label",{staticClass:"translate-label"},[e._v(" "+e._s(e.translations.TranslateEnglish)+" ")]),t("em",{staticClass:"fas fa-sort-down"})]):e._e()]),t("transition",{attrs:{name:"slide-down",type:"transition"}},[e.can_translate.intro?t("div",{staticClass:"form-group mb-1"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.intro.en,expression:"intro.en"}],staticClass:"form__input field-general w-input",attrs:{rows:"3",maxlength:"300"},domProps:{value:e.intro.en},on:{input:function(t){t.target.composing||e.$set(e.intro,"en",t.target.value)}}})]):e._e()]),-1==e.model_id?t("div",{staticClass:"col-md-12 em-flex-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.template,expression:"template"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.template)?e._i(e.template,null)>-1:e.template},on:{change:function(t){var a=e.template,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.template=a.concat([n])):l>-1&&(e.template=a.slice(0,l).concat(a.slice(l+1)))}else e.template=i}}}),t("label",{staticClass:"ml-10px"},[e._v(e._s(e.translations.SaveAsTemplate)+" :")])]):e._e()],1),t("div",{staticClass:"em-flex-row em-flex-space-between mb-1"},[t("button",{staticClass:"bouton-sauvergarder-et-continuer w-retour",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalAddEvaluation")}}},[e._v(e._s(e.translations.Retour))]),t("button",{staticClass:"bouton-sauvergarder-et-continuer",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createGrid()}}},[e._v(e._s(e.translations.Continuer))])]),e.submitted?t("div",{staticClass:"em-page-loader"}):e._e()])],1)},ds=[];const ms=a("bef5");var us={name:"modalAddEvaluation",components:{},props:{prog:Number,grid:Number},data(){return{can_translate:{label:!1,intro:!1},label:{fr:"",en:""},intro:{fr:"",en:""},model_id:-1,template:0,models:[],errors:!1,changes:!1,submitted:!1,translations:{addGrid:"COM_EMUNDUS_ONBOARD_BUILDER_ADDGRID",ChooseExistingGridModel:"COM_EMUNDUS_ONBOARD_GRIDMODEL",Name:"COM_EMUNDUS_ONBOARD_FIELD_NAME",Intro:"COM_EMUNDUS_ONBOARD_FIELD_INTRO",Retour:"COM_EMUNDUS_ONBOARD_ADD_RETOUR",Continuer:"COM_EMUNDUS_ONBOARD_ADD_CONTINUER",LabelRequired:"COM_EMUNDUS_ONBOARD_FORM_REQUIRED_NAME",TranslateEnglish:"COM_EMUNDUS_ONBOARD_TRANSLATE_ENGLISH",SaveAsTemplate:"COM_EMUNDUS_ONBOARD_SAVE_AS_TEMPLATE"}}},methods:{beforeOpen(e){this.getExistingGrids()},getExistingGrids(){p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getgridsmodel"}).then(e=>{this.models=e.data.data})},createGrid(){this.changes=!0,""!=this.label.fr||-1!=this.model_id?(this.can_translate.label||(this.label.en=this.label.fr),this.can_translate.intro||(this.intro.en=this.intro.fr),this.submitted=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=creategrid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ms.stringify({label:this.label,intro:this.intro,modelid:this.model_id,template:this.template,pid:this.prog})}).then(e=>{this.submitted=!1,this.$emit("updateGrid"),this.$modal.hide("modalAddEvaluation")}).catch(e=>{console.log(e)})):this.errors=!0}},watch:{model_id:function(e){-1!=e?this.models.forEach(e=>{e.form_id==this.model_id&&(this.label.fr=e.label,this.intro.fr=e.intro)}):(this.label.fr="",this.intro.fr="")}}},ps=us,_s=Object(b["a"])(ps,cs,ds,!1,null,"636bdac5",null),hs=_s.exports;const gs=a("bef5");var fs={name:"addEvaluationGrid",components:{ModalAddEvaluation:hs,Datetime:Be["Datetime"],FormViewerEvaluation:os},props:{prog:{type:Number,default:""}},data(){return{link:{link:""},visibility:null,viewer:0,grid:null,translations:{addGrid:"COM_EMUNDUS_ONBOARD_BUILDER_ADDGRID",editGrid:"COM_EMUNDUS_ONBOARD_BUILDER_EDITGRID",deleteGrid:"COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID"}}},methods:{getEvaluationGridByProgram(e){p.a.get("index.php?option=com_emundus&controller=programme&task=getevaluationgrid&pid="+this.prog).then(t=>{this.grid=t.data.data,null!=this.grid&&(this.link.link="index.php?option=com_fabrik&view=form&formid="+t.data.data,this.viewer++,e&&this.evaluationBuilder())})},evaluationBuilder(){this.redirectJRoute("index.php?option=com_emundus&view=form&layout=formbuilder&prid=&index=0&cid="+this.prog+"&evaluation="+this.grid)},deleteGrid(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID"),text:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_DELETEGRID_QUESTION"),type:"warning",showCancelButton:!0}).then(e=>{e.value&&p()({method:"post",url:"index.php?option=com_emundus&controller=programme&task=deletegrid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:gs.stringify({grid:this.grid,pid:this.prog})}).then(()=>{j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BUILDER_GRIDDELETED"),type:"success",showConfirmButton:!1,timer:2e3}).then(()=>{this.getEvaluationGridByProgram(0)})}).catch(e=>{console.log(e)})})},redirectJRoute(e){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=redirectjroute",params:{link:e},paramsSerializer:e=>gs.stringify(e)}).then(e=>{window.location.href=window.location.pathname+e.data.data})}},created(){this.getEvaluationGridByProgram(0)}},vs=fs,bs=Object(b["a"])(vs,Ja,Wa,!1,null,null,null),Cs=bs.exports;const Os=a("bef5");var ys={name:"addFormNextCampaign",components:{AddEvaluationGrid:Cs,AddDocumentsDropfiles:Ht,addCampaign:dt,ModalWarningFormBuilder:Ut,addFormulaire:qa,addEmail:ca},props:{index:Number},mixins:[A],data:()=>({campaignId:0,actualLanguage:"",manyLanguages:0,prid:"",menuHighlight:0,menuHighlightProg:-1,formReload:0,prog:0,loading:!1,closeSubmenu:!0,profileId:null,profiles:[],campaignsByProgram:[],langue:0,formCategoriesDesc:["COM_EMUNDUS_GLOBAL_INFORMATIONS_DESC","COM_EMUNDUS_DOCUMENTS_CAMPAIGNS_DESC","COM_EMUNDUS_FORM_CAMPAIGN_DESC"],formCategories:["COM_EMUNDUS_GLOBAL_INFORMATIONS","COM_EMUNDUS_DOCUMENTS_CAMPAIGNS","COM_EMUNDUS_FORM_CAMPAIGN"],formPrograms:["COM_EMUNDUS_EMAILS"],formProgramsDesc:["COM_EMUNDUS_EMAILS_DESC"],form:{},program:{id:0,label:"",code:"",programmes:"",notes:"",synthesis:'<ul><li><strong>[APPLICANT_NAME]</strong></li><li><a href="mailto:[EMAIL]">[EMAIL]</a></li></ul>',tmpl_trombinoscope:'<table cellpadding="2" style="width: 100%;"><tbody><tr style="border-collapse: collapse;"><td align="center" valign="top" style="text-align: center;"><p style="text-align: center;"><img src="[PHOTO]" alt="Photo" height="100" /> </p><p style="text-align: center;"><b>[NAME]</b><br /></p></td></tr></tbody></table>',tmpl_badge:'<table width="100%"><tbody><tr><td style="vertical-align: top; width: 100px;" align="left" valign="middle" width="30%"><img src="[LOGO]" alt="Logo" height="50" /></td><td style="vertical-align: top;" align="left" valign="top" width="70%"><b>[NAME]</b></td></tr></tbody></table>\n',published:1,apply_online:1},prog_group:{prog:null,evaluator:null,manager:null},translations:{DATE_FORMAT:"DATE_FORMAT_JS_LC2",From:"COM_EMUNDUS_ONBOARD_FROM",To:"COM_EMUNDUS_ONBOARD_TO",chooseProfileWarning:"COM_EMUNDUS_ONBOARD_CHOOSE_PROFILE_WARNING",ProgramWarning:"COM_EMUNDUS_ONBOARD_PROGRAM_WARNING"}}),created(){this.campaignId=Number(this.$store.getters["global/datas"].campaignId.value),this.actualLanguage=this.$store.getters["global/shortLang"],this.manyLanguages=Number(this.$store.getters["global/manyLanguages"]),"en"===this.actualLanguage&&(this.langue=1)},methods:{initInformations(e){this.form.label=e.label,this.form.profile_id=e.profile_id,this.form.program_id=e.progid,this.initDates(e),p.a.get("index.php?option=com_emundus&controller=form&task=getallformpublished").then(e=>{this.profiles=e.data.data,null==this.form.profile_id?(0!=this.profiles.length?this.profileId=this.profiles[0].id:this.profileId=null,null!=this.profileId&&(this.formReload+=1)):(this.formReload+=1,this.profileId=this.form.profile_id),this.loading=!1;let t=this.getCookie("campaign_"+this.campaignId+"_menu");t&&(this.menuHighlight=t,document.cookie="campaign_"+this.campaignId+"_menu =; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")})},updateHeader(e){this.form.label=e.label[this.actualLanguage],this.initDates(e)},initDates(e){this.form.start_date=e.start_date,this.form.end_date=e.end_date;let t=this.$store.getters["global/currentLanguage"];""!==t&&void 0!==t||(t="fr-FR");const a={dateStyle:"long",timeStyle:"short"},s=new Date(e.start_date);if(this.form.start_date=new Intl.DateTimeFormat(t,a).format(s),"0000-00-00 00:00:00"===this.form.end_date)this.form.end_date=null;else{const s=new Date(e.end_date);this.form.end_date=new Intl.DateTimeFormat(t,a).format(s)}},changeToProgMenu(e){p.a.get("index.php?option=com_emundus&controller=programme&task=getprogrambyid&id="+this.form.program_id).then(e=>{this.program.id=e.data.data.id,this.program.code=e.data.data.code,this.program.label=e.data.data.label,this.program.notes=e.data.data.notes,this.program.programmes=e.data.data.programmes,this.program.tmpl_badge=e.data.data.tmpl_badge,this.program.published=e.data.data.published,this.program.apply_online=e.data.data.apply_online,null!=e.data.data.synthesis&&(this.program.synthesis=e.data.data.synthesis.replace(/>\s+</g,"><")),null!=e.data.data.tmpl_trombinoscope&&(this.program.tmpl_trombinoscope=e.data.data.tmpl_trombinoscope.replace(/>\s+</g,"><")),this.prog_group.prog=e.data.data.group,this.prog_group.evaluator=e.data.data.evaluator_group,this.prog_group.manager=e.data.data.manager_group,p()({method:"get",url:"index.php?option=com_emundus&controller=programme&task=getcampaignsbyprogram",params:{pid:this.program.id},paramsSerializer:e=>Os.stringify(e)}).then(e=>{this.campaignsByProgram=e.data.campaigns})}).catch(e=>{console.log(e)}),this.menuHighlightProg=e,this.menuHighlight=-1},changeToCampMenu(e){"COM_EMUNDUS_GLOBAL_INFORMATIONS"==this.formCategories[this.menuHighlight]&&!0===this.$store.getters["campaign/unsavedChanges"]?j.a.fire({title:this.translate("COM_EMUNDUS_CAMPAIGN_UNSAVED_CHANGES"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("JYES"),cancelButtonText:this.translate("JNO"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then(t=>{t.value&&(this.menuHighlight=e,this.menuHighlightProg=-1,this.$store.dispatch("campaign/setUnsavedChanges",!1))}):(this.menuHighlight=e,this.menuHighlightProg=-1)},setProfileId(e){this.profileId=e},next(){if(this.menuHighlight<2){let e=this.menuHighlight+1;this.changeToCampMenu(e)}else this.menuHighlightProg<1&&this.changeToProgMenu(0)},previous(){this.menuHighlight>0?this.menuHighlight--:this.redirectJRoute("index.php?option=com_emundus&view=campaign")},redirectJRoute(e){window.location.href=e},getCookie(e){var t=e+"=",a=decodeURIComponent(document.cookie),s=a.split(";");for(let i of s){while(" "==i.charAt(0))i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}},computed:{console:()=>console,getProfileId(){return Number(this.profileId)}}},Es=ys,Ds=(a("9c1c"),Object(b["a"])(Es,Dt,Mt,!1,null,"7f15cd6e",null)),Ms=Ds.exports,Ss=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-w-100 em-h-100",attrs:{id:"formBuilder"}},[t("modal",{attrs:{name:"formBuilder",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1}},[t("notifications",{attrs:{group:"foo-velocity","animation-type":"velocity",speed:500,position:"bottom left",classes:"vue-notification-custom"}}),t("header",{staticClass:"em-flex-row em-flex-space-between"},[t("div",{staticClass:"right-actions"},[t("span",{staticClass:"material-icons-outlined em-p-12-16 em-pointer",attrs:{id:"go-back"},on:{click:e.clickGoBack}},[e._v(" navigate_before ")])]),t("span",{ref:"formTitle",staticClass:"em-font-size-14 em-font-weight-600 editable-data",attrs:{contenteditable:"true"},on:{focusout:e.updateFormTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateFormTitleKeyup.apply(null,arguments)}}},[e._v(" "+e._s(e.title)+" ")]),t("div",{staticClass:"left-actions em-flex-row em-flex-space-between em-p-12-16"},[e.lastSave?t("p",{staticClass:"em-font-size-14 em-main-500-color",attrs:{id:"saved-at"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SAVED_AT"))+" "+e._s(e.lastSave)+" ")]):e._e()])]),"default"===e.principalContainer?t("div",{staticClass:"body em-flex-row em-flex-space-between"},[t("aside",{staticClass:"left-panel em-flex-row em-flex-start em-h-100"},[t("div",{staticClass:"tabs em-flex-column em-flex-start em-h-100"},e._l(e.displayedLeftPanels,(function(a,s){return t("div",{key:e.title+"_"+s,staticClass:"tab",class:{active:a.active}},[t("span",{staticClass:"material-icons-outlined em-p-16",on:{click:function(t){a.url?e.goTo(a.url,"blank"):e.selectTab(a.title)}}},[e._v(" "+e._s(a.icon)+" ")])])})),0),t("div",{staticClass:"tab-content em-flex-start"},["Elements"===e.leftPanelActiveTab?t("form-builder-elements",{on:{"element-created":e.onElementCreated}}):"Documents"===e.leftPanelActiveTab?t("form-builder-document-formats",{attrs:{profile_id:e.profile_id},on:{"open-create-document":e.onEditDocument}}):e._e()],1)]),t("section",{staticClass:"em-flex-column em-w-100 em-h-100"},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[e.currentPage&&"page"===e.showInSection?t("form-builder-page",{key:e.currentPage.id,ref:"formBuilderPage",attrs:{profile_id:parseInt(e.profile_id),page:e.currentPage},on:{"open-element-properties":e.onOpenElementProperties,"open-section-properties":e.onOpenSectionProperties,"open-create-model":e.onOpenCreateModel,"update-page-title":function(t){return e.getPages(e.currentPage.id)}}}):"documents"===e.showInSection?t("form-builder-document-list",{ref:"formBuilderDocumentList",attrs:{profile_id:parseInt(e.profile_id),campaign_id:parseInt(e.campaign_id)},on:{"add-document":e.onOpenCreateDocument,"edit-document":e.onEditDocument,"delete-document":e.onDeleteDocument}}):e._e()],1)],1),t("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[e.rightPanel.tabs.includes(e.showInRightPanel)?t("aside",{staticClass:"right-panel em-flex-column em-h-100"},[t("transition",{attrs:{name:"fade",mode:"out-in"}},["hierarchy"===e.showInRightPanel&&e.rightPanel.tabs.includes("hierarchy")?t("div",{staticClass:"em-w-100",attrs:{id:"form-hierarchy"}},[t("form-builder-pages",{attrs:{pages:e.pages,selected:parseInt(e.selectedPage),profile_id:parseInt(e.profile_id)},on:{"select-page":function(t){return e.selectPage(t)},"add-page":function(t){return e.getPages(e.currentPage.id)},"delete-page":function(t){e.selectedPage=e.pages[0].id},"open-page-create":function(t){e.principalContainer="create-page"},"reorder-pages":e.onReorderedPages,"open-create-model":e.onOpenCreateModel}}),t("hr"),t("form-builder-documents",{ref:"formBuilderDocuments",attrs:{profile_id:parseInt(e.profile_id),campaign_id:parseInt(e.campaign_id)},on:{"show-documents":function(t){return e.setSectionShown("documents")},"open-create-document":e.onOpenCreateDocument}})],1):e._e(),"element-properties"===e.showInRightPanel?t("form-builder-element-properties",{attrs:{element:e.selectedElement,profile_id:parseInt(e.profile_id)},on:{close:e.onCloseElementProperties}}):e._e(),"section-properties"===e.showInRightPanel?t("form-builder-section-properties",{attrs:{section_id:e.selectedSection.group_id,profile_id:parseInt(e.profile_id)},on:{close:e.onCloseSectionProperties}}):e._e(),"create-model"===e.showInRightPanel?t("form-builder-create-model",{attrs:{page:e.selectedPage},on:{close:function(t){e.showInRightPanel="hierarchy"}}}):e._e(),"create-document"===e.showInRightPanel&&e.rightPanel.tabs.includes("create-document")?t("form-builder-create-document",{key:e.formBuilderCreateDocumentKey,ref:"formBuilderCreateDocument",attrs:{profile_id:parseInt(e.profile_id),current_document:e.selectedDocument?e.selectedDocument:null,mandatory:e.createDocumentMandatory,mode:e.createDocumentMode},on:{close:function(t){e.showInRightPanel="hierarchy"},"documents-updated":e.onUpdateDocument}}):e._e()],1)],1):e._e()])],1):"create-page"===e.principalContainer?t("div",[t("form-builder-create-page",{attrs:{profile_id:parseInt(e.profile_id)},on:{close:e.onCloseCreatePage}})],1):e._e()],1)],1)},As=[],Ns=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-elements"}},[t("p",{staticClass:"em-text-align-center em-w-100 em-p-16",attrs:{id:"form-builder-elements-title"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENTS"))+" ")]),t("draggable",{staticClass:"draggables-list",attrs:{group:{name:"form-builder-section-elements",pull:"clone",put:!1},sort:!1,clone:e.setCloneElement},on:{end:e.onDragEnd},model:{value:e.elements,callback:function(t){e.elements=t},expression:"elements"}},[t("transition-group",e._l(e.publishedElements,(function(a){return t("div",{key:a.id,staticClass:"form-builder-element em-flex-row em-flex-space-between"},[t("span",{staticClass:"material-icons-outlined"},[e._v(e._s(a.icon))]),t("span",{staticClass:"em-w-100 em-p-16"},[e._v(e._s(e.translate(a.name)))]),t("span",{staticClass:"material-icons-outlined"},[e._v(" drag_indicator")])])})),0)],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},ws=[],Ts={async createSimpleElement(e){try{const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsimpleelement",t);return a.data}catch(t){return{status:!1,msg:t.message}}},async createSectionSimpleElements(e){try{const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,e[a])});const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsectionsimpleelements",t);return a}catch(t){return{status:!1,message:t.message}}},async createSimpleGroup(e,t){try{const a=new FormData;a.append("fid",e),a.append("label",JSON.stringify(t));const s=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createsimplegroup",a);return"object"!==typeof s.data?{status:!1,msg:"COM_EMUNDUS_FORM_BUILDER_REQUEST_ERROR"}:s.data}catch(a){return{status:!1,msg:a.message}}},async createTestingFile(e){try{const t=new FormData;t.append("cid",e);const a=await h().post("index.php?option=com_emundus&controller=formbuilder&task=createtestingfile",t);return a}catch(t){return{status:!1,message:t.message}}},async getElement(e,t){try{const a=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getElement",{params:{gid:e,element:t}});return a}catch(a){return{status:!1,message:a.message}}},async getJTEXT(e){const t=new FormData;t.append("toJTEXT",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getJTEXT",t);return e}catch(a){return{status:!1,message:a.message}}},async getJTEXTA(e){const t=new FormData;e.forEach((e,a)=>{t.append("toJTEXT["+a+"]",e)});try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getJTEXTA",t);return e}catch(a){return{status:!1,message:a.message}}},async getAllTranslations(e){const t=new FormData;t.append("toJTEXT",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=getalltranslations",t);return e}catch(a){return{status:!1,message:a.message}}},async getTestingParams(e){try{const t=await h().get("index.php?option=com_emundus&controller=formbuilder&task=gettestingparams",{params:{prid:e}});return t}catch(t){return{status:!1,message:t.message}}},async getDatabases(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getdatabasesjoin");return e}catch(e){return{status:!1,message:e.message}}},getDatabaseJoinOrderColumns(e){try{const t=h().get("index.php?option=com_emundus&controller=formbuilder&task=getDatabaseJoinOrderColumns",{params:{database_name:e}});return t}catch(t){return{status:!1,message:t.message}}},async updateParams(e){const t=new FormData,a=JSON.stringify(e);t.append("element",a);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updateparams",t);return e}catch(s){return{status:!1,message:s.message}}},async updateGroupParams(e,t,a=null){const s=new FormData;s.append("group_id",e),s.append("params",JSON.stringify(t)),null!=a&&s.append("lang",a);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updategroupparams",s);return e}catch(i){return{status:!1,message:i.message}}},async updateOrder(e,t,a){const s=new FormData;if(s.append("elements",JSON.stringify(e)),s.append("group_id",t),s.append("moved_el",JSON.stringify(a)),0==a.length)return{status:!1,message:"No elements to update"};try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updateOrder",s);return e}catch(i){return{status:!1,message:i.message}}},updateElementOrder(e,t,a){const s=new FormData;s.append("group_id",e),s.append("element_id",t),s.append("new_index",a);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateelementorder",s);return e}catch(i){return{status:!1,message:i.message}}},async updateDocument(e){if(void 0==e.document_id||void 0==e.profile_id||void 0==e.document)return{status:!1,msg:"Missing data"};const t=new FormData;t.append("document_id",e.document_id),t.append("profile_id",e.profile_id),t.append("document",e.document),t.append("types",e.types),t.append("file",e.sample),t.append("has_sample",e.has_sample);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=updatedocument",t);return e}catch(a){return{status:!1,msg:a}}},async toggleElementPublishValue(e){const t=new FormData;t.append("element",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=publishunpublishelement",t);return e}catch(a){return{status:!1,message:a.message}}},async toggleElementHiddenValue(e){const t=new FormData;t.append("element",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=hiddenunhiddenelement",t);return e}catch(a){return{status:!1,message:a.message}}},async reorderMenu(e,t){const a=new FormData;a.append("menus",JSON.stringify(e)),a.append("profile",t);try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=reordermenu",a)}catch(s){return{status:!1,message:s.message}}},async reorderSections(e,t){const a=new FormData;a.append("groups",JSON.stringify(t)),a.append("fid",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=reordergroups",a);return e}catch(s){return{status:!1,message:s.message}}},async addPage(e){if(!e.prid)return{status:!1,msg:"Missing prid"};const t=new FormData;Object.keys(e).forEach(a=>{t.append(a,JSON.stringify(e[a]))});try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=createMenu",t)}catch(a){return{status:!1,msg:a.message}}},async deletePage(e){if(!e)return{status:!1,message:"Missing page id"};const t=new FormData;t.append("mid",e);try{return await h().post("index.php?option=com_emundus&controller=formbuilder&task=deletemenu",t)}catch(a){return{status:!1,message:a.message}}},async updateTranslation(e,t,a){const s=new FormData;null!==e&&s.append(e.key,e.value),s.append("labelTofind",t),Object.keys(a).forEach(e=>{s.append("NewSubLabel["+e+"]",a[e])});try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=formsTrad",s);return e}catch(i){return{status:!1,message:i.message}}},async updateOption(e,t,a,s,i){const n=new FormData;n.append("element",e),n.append("options",JSON.stringify(t)),n.append("index",a),n.append("newTranslation",s),n.append("lang",i);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateElementOption",n);return e}catch(l){return{status:!1,message:l.message}}},addOption(e,t,a){const s=new FormData;s.append("element",e),s.append("newOption",t),s.append("lang",a);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=addElementSubOption",s);return e}catch(i){return{status:!1,message:i.message}}},deleteElementSubOption(e,t){const a=new FormData;a.append("element",e),a.append("index",t);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteElementSubOption",a);return e}catch(s){return{status:!1,message:s.message}}},updateElementSubOptionsOrder(e,t,a){const s=new FormData;s.append("element",e),s.append("options_old_order",JSON.stringify(t)),s.append("options_new_order",JSON.stringify(a));try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=updateElementSubOptionsOrder",s);return e}catch(i){return{status:!1,message:i.message}}},getElementSubOptions(e){try{const t=h().get("index.php?option=com_emundus&controller=formbuilder&task=getelementsuboptions",{params:{element:e}});return t}catch(t){return{status:!1,message:t.message}}},deleteElement(e){const t=new FormData;t.append("element",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteElement",t);return e}catch(a){return{status:!1,message:a.message}}},deleteGroup(e){const t=new FormData;t.append("gid",e);try{const e=h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteGroup",t);return e}catch(a){return{status:!1,message:a.message}}},async updateDefaultValue(e,t){const a=new FormData;a.append("eid",e),a.append("value",t);try{return h().post("index.php?option=com_emundus&controller=formbuilder&task=updatedefaultvalue",a)}catch(s){return{status:!1,message:s.message}}},async getAllDatabases(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getalldatabases");return e}catch(e){return{status:!1,message:e.message}}},async getSection(e){try{const t=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getsection",{params:{section:e}});return t}catch(t){return{status:!1,message:t.message}}},async getModels(){try{const e=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getpagemodels");return e.data}catch(e){return{status:!1,message:e.message}}},async addFormModel(e,t){if(!(e>0))return{status:!1,message:"MISSING_PARAMS"};{const s=new FormData;s.append("form_id",e),s.append("label",t);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=addformmodel",s);return e.data}catch(a){return{status:!1,message:a.message}}}},async deleteFormModel(e){if(!(e>0))return{status:!1,message:"MISSING_PARAMS"};{const a=new FormData;a.append("form_id",e);try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteformmodel",a);return e.data}catch(t){return{status:!1,message:t.message}}}},async deleteFormModelFromId(e){if(!(e.length>0))return{status:!1,message:"MISSING_PARAMS"};{const a=new FormData;a.append("model_ids",JSON.stringify(e));try{const e=await h().post("index.php?option=com_emundus&controller=formbuilder&task=deleteformmodelfromids",a);return e.data}catch(t){return{status:!1,message:t.message}}}},async getDocumentSample(e,t){if(!(e>0&&t>0))return{status:!1,message:"MISSING_PARAMS"};try{const a=await h().get("index.php?option=com_emundus&controller=formbuilder&task=getdocumentsample",{params:{document_id:e,profile_id:t}});return a.data}catch(a){return{status:!1,message:a.message}}},async checkIfModelTableIsUsedInForm(e,t){let a={status:!1,msg:"MISSING_PARAMS"};if(e>0&&t>0)try{const s=await h().get("index.php?option=com_emundus&controller=formbuilder&task=checkifmodeltableisusedinform",{params:{model_id:e,profile_id:t}});a=s.data}catch(s){a.msg=s.message}return a}},Us={methods:{updateLastSave(){r.a.locale("fr"),this.$store.dispatch("formBuilder/updateLastSave",r()().format("LT"))},async swalConfirm(e,t,a,s,i=null,n=!0,l=!1){let r={title:e,text:t,type:"warning",showCancelButton:n,confirmButtonText:a,cancelButtonText:s,reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}};return l?r.html=t:r.text=t,j.a.fire(r).then(e=>!!e.value&&(null!=i&&i(),!0))}}},Rs={components:{draggable:Bt.a},mixins:[Us,se],data(){return{elements:[],cloneElement:{},loading:!1}},created(){this.elements=this.getElements()},methods:{getElements(){return a("ef96")},setCloneElement(e){this.cloneElement=e},onDragEnd(e){this.loading=!0;const t=e.to;if(null===t)return void(this.loading=!1);const a=t.dataset.sid;if(!a)return void(this.loading=!1);const s=this.$store.getters["global/datas"],i="undefined"!==typeof s.mode?s.mode.value:"forms";Ts.createSimpleElement({gid:a,plugin:this.cloneElement.value,mode:i}).then(t=>{t.status&&t.data>0?Ts.updateElementOrder(a,t.data,e.newDraggableIndex).then(e=>{this.$emit("element-created"),this.updateLastSave(),this.loading=!1}):(this.displayError(t.msg),this.loading=!1)}).catch(e=>{console.warn(e),this.loading=!1})}},computed:{publishedElements(){return this.elements.filter(e=>e.published)}}},xs=Rs,Ls=(a("a93c"),Object(b["a"])(xs,Ns,ws,!1,null,null,null)),ks=Ls.exports,Is=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-element-properties"}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-flex-align-start"},[t("div",[t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES")))]),t("span",{staticClass:"em-font-size-14 em-neutral-700-color"},[e._v(e._s(e.element.label[e.shortDefaultLang]))])]),t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),t("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.publishedTabs,(function(a){return t("li",{key:a.id,staticClass:"em-p-16 em-pointer",class:{"is-active":a.active,"em-w-50":2==e.publishedTabs.length,"em-w-100":1==e.publishedTabs.length},on:{click:function(t){return e.selectTab(a)}}},[e._v(" "+e._s(e.translate(a.label))+" ")])})),0),t("div",{attrs:{id:"properties"}},[e.tabs[0].active?t("div",{staticClass:"em-p-16",attrs:{id:"element-parameters"}},[t("label",{attrs:{for:"element-label"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_LABEL")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.label[e.shortDefaultLang],expression:"element.label[shortDefaultLang]"}],staticClass:"em-w-100",attrs:{id:"element-label",name:"element-label",type:"text"},domProps:{value:e.element.label[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.element.label,e.shortDefaultLang,t.target.value)}}}),t("div",{staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_UNPUBLISH")))]),t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isPublished,expression:"isPublished"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isPublished)?e._i(e.isPublished,null)>-1:e.isPublished},on:{click:e.togglePublish,change:function(t){var a=e.isPublished,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.isPublished=a.concat([n])):l>-1&&(e.isPublished=a.slice(0,l).concat(a.slice(l+1)))}else e.isPublished=i}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"display"!==this.element.plugin,expression:"this.element.plugin !== 'display'"}],staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_REQUIRED")))]),t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.FRequire,expression:"element.FRequire"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.element.FRequire)?e._i(e.element.FRequire,null)>-1:e.element.FRequire},on:{click:function(t){e.element.FRequire=!e.element.FRequire},change:function(t){var a=e.element.FRequire,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&e.$set(e.element,"FRequire",a.concat([n])):l>-1&&e.$set(e.element,"FRequire",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(e.element,"FRequire",i)}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})])]),e.sysadmin?t("div",{staticClass:"em-flex-row em-flex-space-between em-w-100 em-pt-16 em-pb-16"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_HIDDEN")))]),t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isHidden,expression:"isHidden"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isHidden)?e._i(e.isHidden,null)>-1:e.isHidden},on:{click:e.toggleHidden,change:function(t){var a=e.isHidden,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.isHidden=a.concat([n])):l>-1&&(e.isHidden=a.slice(0,l).concat(a.slice(l+1)))}else e.isHidden=i}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})])]):e._e()]):e._e(),e.tabs[1].active?t("div",{staticClass:"em-p-16"},[t("FormBuilderElementParams",{key:e.element.id,attrs:{element:e.element,params:e.params,databases:e.databases}})],1):e._e()]),t("div",{staticClass:"em-flex-row em-flex-space-between actions em-m-16"},[t("button",{staticClass:"em-primary-button",on:{click:function(t){return e.saveProperties()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_SAVE"))+" ")])]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},Bs=[],Ps=a("3208"),Fs=function(){var e=this,t=e._self._c;return t("div",[e._l(e.params,(function(a){return a.published&&!a.sysadmin_only||e.sysadmin&&a.sysadmin_only&&a.published?t("div",{staticClass:"form-group em-mb-8"},[t("label",[e._v(e._s(e.translate(a.label)))]),"dropdown"===a.type?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,a.name,t.target.multiple?s:s[0])}}},e._l(a.options,(function(a){return t("option",{domProps:{value:a.value}},[e._v(e._s(e.translate(a.label)))])})),0)]):"textarea"===a.type?t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",domProps:{value:e.element.params[a.name]},on:{input:function(t){t.target.composing||e.$set(e.element.params,a.name,t.target.value)}}}):"databasejoin"===a.type?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],key:e.reloadOptions,staticClass:"em-w-100",class:e.databasejoin_description?"em-mb-4":"",attrs:{id:a.name},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,a.name,t.target.multiple?s:s[0])},e.updateDatabasejoinParams]}},e._l(a.options,(function(a){return t("option",{domProps:{value:a.database_name}},[e._v(e._s(a.label))])})),0),e.databasejoin_description?t("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.databasejoin_description))]):e._e()]):"databasejoin_cascade"===a.type?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],key:e.reloadOptionsCascade,staticClass:"em-w-100",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.element.params,a.name,t.target.multiple?s:s[0])}}},e._l(a.options,(function(a){return t("option",{domProps:{value:a.COLUMN_NAME}},[e._v(e._s(a.COLUMN_NAME))])})),0)]):"checkbox"===a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:"checkbox"},domProps:{checked:Array.isArray(e.element.params[a.name])?e._i(e.element.params[a.name],null)>-1:e.element.params[a.name]},on:{change:function(t){var s=e.element.params[a.name],i=t.target,n=!!i.checked;if(Array.isArray(s)){var l=null,r=e._i(s,l);i.checked?r<0&&e.$set(e.element.params,a.name,s.concat([l])):r>-1&&e.$set(e.element.params,a.name,s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.element.params,a.name,n)}}}):"radio"===a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:"radio"},domProps:{checked:e._q(e.element.params[a.name],null)},on:{change:function(t){return e.$set(e.element.params,a.name,null)}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.params[a.name],expression:"element.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:a.type},domProps:{value:e.element.params[a.name]},on:{input:function(t){t.target.composing||e.$set(e.element.params,a.name,t.target.value)}}}),""!==a.helptext?t("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.translate(a.helptext)))]):e._e()]):e._e()})),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],2)},$s=[],js={name:"FormBuilderElementParams",components:{},props:{element:{type:Object,required:!1},params:{type:Array,required:!1},databases:{type:Array,required:!1}},data:()=>({databasejoin_description:null,reloadOptions:0,reloadOptionsCascade:0,idElement:0,loading:!1}),created(){this.params.forEach(e=>{"databasejoin"===e.type&&(this.sysadmin?(this.loading=!0,Ts.getAllDatabases().then(t=>{e.options=t.data.data,this.reloadOptions+=1,""!=this.element.params["join_db_name"]&&this.updateDatabasejoinParams(),this.loading=!1})):(e.options=this.databases,""!=this.element.params["join_db_name"]&&this.updateDatabasejoinParams()))})},methods:{updateDatabasejoinParams(){if(this.sysadmin)Ts.getDatabaseJoinOrderColumns(this.element.params["join_db_name"]).then(e=>{let t=this.params.map(e=>e.name).indexOf("join_key_column");this.params[t].options=e.data.data,""==this.element.params["join_key_column"]&&(this.element.params["join_key_column"]=this.params[t].options[0].COLUMN_NAME),t=this.params.map(e=>e.name).indexOf("join_val_column"),this.params[t].options=e.data.data,""==this.element.params["join_val_column"]&&(this.element.params["join_val_column"]=this.params[t].options[0].COLUMN_NAME),this.reloadOptionsCascade+=1});else{const e=this.databases.map(e=>e.database_name).indexOf(this.element.params["join_db_name"]);if(-1!==e){let t=this.databases[e];this.element.params["join_key_column"]=t.join_column_id,this.element.params["database_join_where_sql"]="order by {thistable}."+t.join_column_id,1==t.translation?(this.element.params["join_val_column"]=t.join_column_val+"_fr",this.element.params["join_val_column_concat"]="{thistable}."+t.join_column_val+"_{shortlang}"):(this.element.params["join_val_column"]=t.join_column_val,this.element.params["join_val_column_concat"]=""),this.databasejoin_description=this.databases[e].description}else{let e=this.params.map(e=>e.name).indexOf("join_db_name"),t={label:this.element.params["join_db_name"],database_name:this.element.params["join_db_name"]};this.params[e].options.push(t),setTimeout(()=>{document.getElementById("join_db_name").disabled=!0},500)}}}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)}}},Gs=js,Hs=Object(b["a"])(Gs,Fs,$s,!1,null,null,null),zs=Hs.exports,Vs={name:"FormBuilderElementProperties",components:{FormBuilderElementParams:zs},props:{element:{type:Object,required:!0},profile_id:{type:Number,required:!0}},mixins:[Us],data(){return{databases:[],params:[],elementsNeedingDb:["dropdown","checkbox","radiobutton","databasejoin"],tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!0,published:!0},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_PARAMETERS",active:!1,published:!0}],loading:!1}},mounted(){this.getDatabases(),this.paramsAvailable()},methods:{getDatabases(){Ts.getDatabases().then(e=>{e.status&&(this.databases=e.data.data)})},saveProperties(){this.loading=!0,Ts.updateTranslation({value:this.element.id,key:"element"},this.element.label_tag,this.element.label),["radiobutton","checkbox","dropdown"].includes(this.element.plugin)?Ts.getJTEXTA(this.element.params.sub_options.sub_labels).then(e=>{e&&(this.element.params.sub_options.sub_labels.forEach((t,a)=>{this.element.params.sub_options.sub_labels[a]=Object.values(e.data)[a]}),Ts.updateParams(this.element).then(e=>{e.status&&(this.loading=!1,this.updateLastSave(),this.$emit("close"))}))}):Ts.updateParams(this.element).then(e=>{e.status&&(this.loading=!1,this.updateLastSave(),this.$emit("close"))})},togglePublish(){this.element.publish=!this.element.publish,Ts.toggleElementPublishValue(this.element.id).then(e=>{e.status||(this.element.publish=!this.element.publish)})},toggleHidden(){this.element.hidden=!this.element.hidden,Ts.toggleElementHiddenValue(this.element.id).then(e=>{e.status||(this.element.hidden=!this.element.hidden)})},selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},paramsAvailable(){"undefined"!==typeof Ps[this.element.plugin]?(this.tabs[1].published=!0,this.params=Ps[this.element.plugin]):(this.tabs[1].active=!1,this.tabs[0].active=!0,this.tabs[1].published=!1)}},computed:{componentType(){let e="";switch(this.element.plugin){case"databasejoin":e="radio"==this.element.params.database_join_display_type?"radiobutton":this.element.params.database_join_display_type;break;case"years":case"date":case"birthday":e="birthday";break;default:e=this.element.plugin;break}return e},isPublished(){return!this.element.publish},isHidden(){return this.element.hidden},sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},publishedTabs(){return this.tabs.filter(e=>e.published)}},watch:{"element.id":function(e){this.paramsAvailable()}}},Ys=Vs,qs=(a("8160"),Object(b["a"])(Ys,Is,Bs,!1,null,null,null)),Js=qs.exports,Ws=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-element-properties"}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES")))]),t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),t("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.publishedTabs,(function(a){return t("li",{key:a.id,staticClass:"em-p-16 em-pointer",class:{"is-active":a.active,"em-w-50":"2"==e.publishedTabs.length,"em-w-100":1==e.publishedTabs.length},on:{click:function(t){return e.selectTab(a)}}},[e._v(" "+e._s(e.translate(a.label))+" ")])})),0),t("div",{attrs:{id:"properties"}},[e.tabs[0].active?t("div",{staticClass:"em-p-16",attrs:{id:"section-parameters"}},[t("label",{attrs:{for:"section-label"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_LABEL")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.section_tmp.label,expression:"section_tmp.label"}],staticClass:"em-w-100",attrs:{id:"section-label",name:"section-label",type:"text"},domProps:{value:e.section_tmp.label},on:{input:function(t){t.target.composing||e.$set(e.section_tmp,"label",t.target.value)}}})]):e._e(),e.tabs[1].active?t("div",{staticClass:"em-p-16"},[t("form-builder-section-params",{attrs:{params:e.params,section:e.section_tmp}})],1):e._e()]),t("div",{staticClass:"em-flex-row em-flex-space-between actions em-m-16"},[t("button",{staticClass:"em-primary-button",on:{click:function(t){return e.saveProperties()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES_SAVE"))+" ")])])])},Ks=[],Xs=a("4c13"),Qs=function(){var e=this,t=e._self._c;return e.params.length>0?t("div",[e._l(e.displayedParams,(function(a){return t("div",{staticClass:"form-group"},[t("label",[e._v(e._s(e.translate(a.label)))]),"dropdown"===a.type?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.section.params[a.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.section.params,a.name,t.target.multiple?s:s[0])}}},e._l(a.options,(function(a){return t("option",{domProps:{value:a.value}},[e._v(e._s(e.translate(a.label)))])})),0)]):"textarea"===a.type?t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.section.params[a.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",domProps:{value:e.section.params[a.name]},on:{input:function(t){t.target.composing||e.$set(e.section.params,a.name,t.target.value)}}}):"checkbox"===a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[a.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:"checkbox"},domProps:{checked:Array.isArray(e.section.params[a.name])?e._i(e.section.params[a.name],null)>-1:e.section.params[a.name]},on:{change:function(t){var s=e.section.params[a.name],i=t.target,n=!!i.checked;if(Array.isArray(s)){var l=null,r=e._i(s,l);i.checked?r<0&&e.$set(e.section.params,a.name,s.concat([l])):r>-1&&e.$set(e.section.params,a.name,s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.section.params,a.name,n)}}}):"radio"===a.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[a.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:"radio"},domProps:{checked:e._q(e.section.params[a.name],null)},on:{change:function(t){return e.$set(e.section.params,a.name,null)}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.section.params[a.name],expression:"section.params[param.name]"}],staticClass:"em-w-100",attrs:{placeholder:e.translate(a.placeholder),type:a.type},domProps:{value:e.section.params[a.name]},on:{input:function(t){t.target.composing||e.$set(e.section.params,a.name,t.target.value)}}}),""!==a.helptext?t("label",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.translate(a.helptext)))]):e._e()])})),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],2):e._e()},Zs=[],ei={name:"FormBuilderSectionParams",props:{section:{type:Object,required:!1},params:{type:Array,required:!1}},data:()=>({loading:!1}),computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},displayedParams(){return this.params.filter(e=>e.published&&!e.sysadmin_only||this.sysadmin&&e.sysadmin_only&&e.published)}}},ti=ei,ai=Object(b["a"])(ti,Qs,Zs,!1,null,"19da62a1",null),si=ai.exports,ii={name:"FormBuilderSectionProperties",components:{FormBuilderSectionParams:si},props:{section_id:{type:Number,required:!0},profile_id:{type:Number,required:!0}},data(){return{section_tmp:{},params:[],tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!1,published:!1},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_PARAMETERS",active:!0,published:!0}]}},created(){this.paramsAvailable(),this.getSection()},methods:{saveProperties(){Ts.updateGroupParams(this.section_tmp.id,this.section_tmp.params,this.shortDefaultLang).then(()=>{this.$emit("close")})},toggleHidden(){this.section_tmp.params.hidden=!this.section_tmp.hidden},selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},paramsAvailable(){"undefined"!==typeof Xs["parameters"]?(this.tabs[1].published=!0,this.params=Xs["parameters"]):(this.tabs[1].active=!1,this.tabs[0].active=!0,this.tabs[1].published=!1)},getSection(){Ts.getSection(this.$props.section_id).then(e=>{this.section_tmp=e.data.group})}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},publishedTabs(){return this.tabs.filter(e=>e.published)}},watch:{section:function(){this.paramsAvailable(),this.getSection()}}},ni=ii,li=(a("760c"),Object(b["a"])(ni,Ws,Ks,!1,null,null,null)),ri=li.exports,oi=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-page"}},[t("div",{staticClass:"em-flex-row em-flex-space-between"},[t("span",{ref:"pageTitle",staticClass:"em-font-size-24 em-font-weight-600 editable-data",attrs:{contenteditable:"true",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_TITLE_ADD")},domProps:{innerHTML:e._s(e.translate(e.title))},on:{focusout:e.updateTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateTitleKeyup.apply(null,arguments)},keydown:t=>e.checkMaxMinlength(t,50,0)}}),t("span",{staticClass:"material-icons-outlined em-pointer",attrs:{title:e.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_TITLE")},on:{click:function(t){return e.$emit("open-create-model",e.page.id)}}},[e._v("post_add")])]),t("span",{ref:"pageDescription",staticClass:"description editable-data",attrs:{id:"pageDescription",contenteditable:"true",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_INTRO_ADD")},domProps:{innerHTML:e._s(e.description)},on:{focusout:e.updateDescription}}),t("div",{staticClass:"form-builder-page-sections"},[e.sections.length>0?t("button",{staticClass:"em-primary-button px-6 py-3",attrs:{id:"add-section"},on:{click:function(t){return e.addSection()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_SECTION"))+" ")]):e._e(),e._l(e.sections,(function(a,s){return t("form-builder-page-section",{key:a.group_id,ref:"section-"+a.group_id,refInFor:!0,attrs:{profile_id:parseInt(e.profile_id),page_id:parseInt(e.page.id),section:a,index:s+1,totalSections:e.sections.length},on:{"open-element-properties":function(t){return e.$emit("open-element-properties",t)},"move-element":e.updateElementsOrder,"delete-section":e.deleteSection,"update-element":e.getSections,"move-section":e.moveSection,"open-section-properties":function(t){return e.$emit("open-section-properties",a)}}})}))],2),t("button",{staticClass:"em-primary-button px-6 py-3",attrs:{id:"add-section"},on:{click:function(t){return e.addSection()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_SECTION"))+" ")]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},ci=[],di=a("bef5"),mi=a.n(di),ui={async checkSetup(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=checksetup")}catch(e){return!1}},async configureSetup(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=configuresetup")}catch(e){return!1}},async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");return e.data}catch(e){return!1}},async getDefaultLanguage(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getdefaultlanguage");return e.data}catch(e){return!1}},async updateLanguage(e,t,a=0){try{const s=new FormData;return s.append("published",t),s.append("lang_code",e),s.append("default_lang",a),await h().post("index.php?option=com_emundus&controller=translations&task=updatelanguage",s,{headers:{"Content-Type":"multipart/form-data"}})}catch(s){return{status:!1,msg:s.message}}},async getObjects(){try{return await h().get("index.php?option=com_emundus&controller=translations&task=gettranslationsobjects")}catch(e){return{status:!1,msg:e.message}}},async getDatas(e,t,a,s){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getdatas",{params:{table:e,reference_id:t,label:a,filters:s}})}catch(i){return{status:!1,msg:i.message}}},async getChildrens(e,t,a){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getchildrens",{params:{table:e,reference_id:t,label:a}})}catch(s){return{status:!1,msg:s.message}}},async getTranslations(e,t,a,s="",i="",n=""){switch(e){case"falang":try{return await h().get("index.php?option=com_emundus&controller=translations&task=getfalangtranslations",{params:{default_lang:t,lang_to:a,reference_table:n,reference_id:s,fields:i}})}catch(l){return{status:!1,msg:l.message}}case"override":let e={default_lang:t,lang_to:a,reference_table:n,reference_id:s,fields:i},r=p.a.create({paramsSerializer:e=>mi.a.stringify(e)});try{return await r.get("index.php?option=com_emundus&controller=translations&task=gettranslations",{params:e})}catch(l){return{status:!1,msg:l.message}}break;default:}},async updateTranslations(e,t,a,s,i,n,l){switch(t){case"falang":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("field",i),t.append("reference_table",n),t.append("reference_id",s),await h().post("index.php?option=com_emundus&controller=translations&task=updatefalangtranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(r){return{status:!1,msg:r.message}}break;case"override":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("tag",i),t.append("reference_table",n),t.append("reference_id",s),t.append("reference_field",l),await h().post("index.php?option=com_emundus&controller=translations&task=updatetranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(r){return{status:!1,msg:r.message}}break;default:}},async insertTranslation(e,t,a,s,i,n){switch(t){case"override":try{const t=new FormData;return t.append("value",e),t.append("lang_to",a),t.append("tag",i),t.append("reference_table",n),t.append("reference_id",s),await h().post("index.php?option=com_emundus&controller=translations&task=inserttranslation",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(l){return{status:!1,msg:l.message}}break;default:}},async getOrphelins(e,t){try{return await h().get("index.php?option=com_emundus&controller=translations&task=getorphelins",{params:{default_lang:e,lang_to:t}})}catch(a){return{status:!1,msg:a.message}}},async sendMailToInstallLanguage(e,t=""){try{const a=new FormData;return a.append("suggest_language",e),a.append("comment",t),await h().post("index.php?option=com_emundus&controller=translations&task=sendpurposenewlanguage",a,{headers:{"Content-Type":"multipart/form-data"}})}catch(a){return{status:!1,msg:a.message}}},async getJText(e){try{return await h().get("index.php?option=com_emundus&controller=formbuilder&task=getJTEXT",{params:{toJTEXT:e}})}catch(t){return{status:!1,msg:t.message}}}},pi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-builder-page-section em-mt-32 em-mb-32",attrs:{id:"form-builder-page-section-"+e.section.group_id}},[t("div",{staticClass:"section-card em-flex-column"},[t("div",{staticClass:"section-identifier em-bg-main-500 em-pointer em-flex-row",on:{click:function(t){e.closedSection=!e.closedSection}}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.section.repeat_group,expression:"section.repeat_group"}],staticClass:"material-icons em-mr-8 em-color-white"},[e._v("library_add")]),e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION"))+" "+e._s(e.index)+" / "+e._s(e.totalSections)+" "),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.closedSection,expression:"!closedSection"}],staticClass:"material-icons em-ml-8 em-color-white"},[e._v("unfold_less")]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.closedSection,expression:"closedSection"}],staticClass:"material-icons em-ml-8 em-color-white"},[e._v("unfold_more")])]),t("div",{staticClass:"section-content em-w-100 em-p-32",class:{closed:e.closedSection}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-w-100"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.section.label[e.shortDefaultLang],expression:"section.label[shortDefaultLang]"}],staticClass:"editable-data em-w-100",attrs:{id:"section-title",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_TITLE_ADD"),maxlength:"100"},domProps:{value:e.section.label[e.shortDefaultLang]},on:{focusout:e.updateTitle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurElement("#section-title")},input:function(t){t.target.composing||e.$set(e.section.label,e.shortDefaultLang,t.target.value)}}}),t("div",{staticClass:"section-actions-wrapper"},[t("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section upwards"},on:{click:function(t){return e.moveSection("up")}}},[e._v("keyboard_double_arrow_up")]),t("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section downwards"},on:{click:function(t){return e.moveSection("down")}}},[e._v("keyboard_double_arrow_down")]),t("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer delete hover-opacity",on:{click:e.deleteSection}},[e._v("delete")]),t("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",on:{click:function(t){return e.$emit("open-section-properties")}}},[e._v("settings")])])]),t("transition",{attrs:{name:"slide-down"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.closedSection,expression:"!closedSection"}]},[t("p",{ref:"sectionIntro",staticClass:"editable-data",attrs:{id:"section-intro",contenteditable:"true"},domProps:{innerHTML:e._s(e.section.group_intro)},on:{focusout:e.updateIntro,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.blurElement("#section-intro")}}}),t("draggable",{staticClass:"draggables-list",attrs:{group:"form-builder-section-elements",sort:!0,handle:".handle"},on:{end:e.onDragEnd},model:{value:e.elements,callback:function(t){e.elements=t},expression:"elements"}},[t("transition-group",{attrs:{"data-prid":e.profile_id,"data-page":e.page_id,"data-sid":e.section.group_id}},e._l(e.elements,(function(a){return t("form-builder-page-section-element",{key:a.id,attrs:{element:a},on:{"open-element-properties":function(t){return e.$emit("open-element-properties",a)},"delete-element":e.deleteElement,"cancel-delete-element":e.cancelDeleteElement,"update-element":function(t){return e.$emit("update-element")}}})})),1)],1),e.publishedElements.length<1?t("div",{staticClass:"empty-section-element"},[t("draggable",{staticClass:"draggables-list",attrs:{list:e.emptySection,group:"form-builder-section-elements",sort:!1}},[t("transition-group",{attrs:{"data-prid":e.profile_id,"data-page":e.page_id,"data-sid":e.section.group_id}},e._l(e.emptySection,(function(a,s){return t("p",{key:s,staticClass:"em-w-100 em-text-align-center"},[e._v(" "+e._s(e.translate(a.text))+" ")])})),0)],1)],1):e._e()],1)])],1)])])},_i=[],hi=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.element.hidden&&-2!==e.element.publish||e.element.hidden&&e.sysadmin,expression:"(!element.hidden && element.publish !== -2) || (element.hidden && sysadmin)"}],staticClass:"form-builder-page-section-element",class:{unpublished:!e.element.publish||e.element.hidden,"properties-active":e.propertiesOpened==e.element.id},attrs:{id:"element_"+e.element.id}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-w-100"},[t("label",{staticClass:"em-w-100 em-flex-row fabrikLabel control-label fabrikTip",on:{click:e.triggerElementProperties}},[e.element.FRequire?t("i",{staticClass:"icon-star small",attrs:{"data-isicon":"true"}}):e._e(),e.element.label_value&&2!=e.element.labelsAbove?t("input",{directives:[{name:"model",rawName:"v-model",value:e.element.label[e.shortDefaultLang],expression:"element.label[shortDefaultLang]"}],ref:"element-label-"+e.element.id,staticClass:"element-title editable-data",attrs:{id:"element-label-"+e.element.id,name:"element-label-"+e.element.id,type:"text"},domProps:{value:e.element.label[e.shortDefaultLang]},on:{focusout:e.updateLabel,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLabelKeyup.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.element.label,e.shortDefaultLang,t.target.value)}}}):e._e()]),t("div",{staticClass:"em-flex-row",attrs:{id:"element-action-icons"}},[t("span",{staticClass:"material-icons-outlined handle em-grab"},[e._v("drag_indicator")]),t("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer",attrs:{id:"delete-element"},on:{click:e.deleteElement}},[e._v("delete")]),e.sysadmin?t("span",{staticClass:"material-icons-outlined em-pointer em-ml-8",on:{click:e.openAdmin}},[e._v("content_copy")]):e._e()])]),t("div",{class:"element-field fabrikElement"+e.element.plugin,on:{click:e.triggerElementProperties}},[["radiobutton","checkbox"].includes(e.element.plugin)||e.displayOptions&&"dropdown"===e.element.plugin?t("form-builder-element-options",{attrs:{element:e.element,type:"radiobutton"==e.element.plugin?"radio":e.element.plugin},on:{"update-element":function(t){return e.$emit("update-element")}}}):"display"===e.element.plugin?t("form-builder-element-wysiwig",{attrs:{element:e.element,type:"display"},on:{"update-element":function(t){return e.$emit("update-element")}}}):t("div",{staticClass:"fabrikElement",domProps:{innerHTML:e._s(e.element.element)}})],1)])},gi=[],fi=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-radio-button"}},[e.loading?t("div",{staticClass:"em-loader"}):t("div",[t("draggable",{attrs:{handle:".handle-options"},on:{end:e.updateOrder},model:{value:e.arraySubValues,callback:function(t){e.arraySubValues=t},expression:"arraySubValues"}},e._l(e.arraySubValues,(function(a,s){return t("div",{key:a,staticClass:"element-option em-flex-row em-flex-space-between em-mt-8 em-mb-8",on:{mouseover:function(t){e.optionHighlight=s},mouseleave:function(t){e.optionHighlight=null}}},[t("div",{staticClass:"em-flex-row em-w-100"},[t("div",{staticClass:"em-flex-row"},[t("span",{staticClass:"icon-handle",style:e.optionHighlight===s?"opacity: 1":"opacity: 0"},[t("span",{staticClass:"material-icons-outlined handle-options em-grab"},[e._v("drag_indicator")])])]),"dropdown"!==e.type?t("input",{attrs:{type:e.type,name:"element-id-"+e.element.id},domProps:{value:e.optionsTranslations[s]}}):t("div",[e._v(e._s(s+1)+". ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.optionsTranslations[s],expression:"optionsTranslations[index]"}],staticClass:"editable-data editable-data-input em-ml-4 em-w-100",attrs:{type:"text",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_OPTION")},domProps:{value:e.optionsTranslations[s]},on:{focusout:function(t){return e.updateOption(s,e.optionsTranslations[s])},input:function(t){t.target.composing||e.$set(e.optionsTranslations,s,t.target.value)}}})]),t("div",{staticClass:"em-flex-row"},[t("span",{staticClass:"material-icons-outlined em-pointer",style:e.optionHighlight===s?"opacity: 1":"opacity: 0",on:{click:function(t){return e.removeOption(s)}}},[e._v("close")])])])})),0),t("div",{staticClass:"em-flex-row em-flex-start em-s-justify-content-center",attrs:{id:"add-option"}},[e._m(0),"dropdown"!==e.type?t("input",{attrs:{type:e.type,name:"element-id-"+e.element.id}}):t("div",[e._v(e._s(e.element.params.sub_options.sub_labels.length+1)+". ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newOption,expression:"newOption"}],staticClass:"editable-data editable-data-input em-ml-4 em-w-100",attrs:{type:"text",placeholder:e.translate("COM_EMUNDUS_FORM_BUILDER_ADD_OPTION")},domProps:{value:e.newOption},on:{focusout:e.addOption,input:function(t){t.target.composing||(e.newOption=t.target.value)}}})])],1)])},vi=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"icon-handle",staticStyle:{opacity:"0"}},[t("span",{staticClass:"material-icons-outlined handle-options"},[e._v("drag_indicator")])])}],bi={props:{element:{type:Object,required:!0},type:{type:String,required:!0}},components:{draggable:Bt.a},data(){return{loading:!1,newOption:"",arraySubValues:[],optionsTranslations:[],optionHighlight:null}},created(){this.getSubOptionsTranslation()},methods:{async reloadOptions(){this.loading=!0,Ts.getElementSubOptions(this.element.id).then(e=>{e.data.status?(this.element.params.sub_options=e.data.new_options,this.getSubOptionsTranslation()):this.loading=!1})},async getSubOptionsTranslation(){this.loading=!0,Ts.getJTEXTA(this.element.params.sub_options.sub_labels).then(e=>{e&&(this.optionsTranslations=Object.values(e.data),this.arraySubValues=this.element.params.sub_options.sub_values.map((e,t)=>({sub_value:e,sub_label:this.element.params.sub_options.sub_labels[t]}))),this.loading=!1})},addOption(){""!=this.newOption.trim()&&(this.loading=!0,Ts.addOption(this.element.id,this.newOption,this.shortDefaultLang).then(e=>{this.newOption="",e.data.status&&this.reloadOptions(),this.loading=!1}))},updateOption(e,t){this.loading=!0,Ts.updateOption(this.element.id,this.element.params.sub_options,e,t,this.shortDefaultLang).then(e=>{e.data.status?this.reloadOptions():this.loading=!1})},updateOrder(){if(this.arraySubValues.length>1){let e={sub_values:[],sub_labels:[]};this.arraySubValues.forEach((t,a)=>{e.sub_values.push(t.sub_value),e.sub_labels.push(t.sub_label)}),this.element.params.sub_options.sub_values.every((t,a)=>t===e.sub_values[a])?console.log("No need to call reorder, same order"):(this.loading=!0,Ts.updateElementSubOptionsOrder(this.element.id,this.element.params.sub_options,e).then(e=>{e.data.status?this.reloadOptions():this.loading=!1}))}else console.log("No need to reorder, only one element")},removeOption(e){this.loading=!0,Ts.deleteElementSubOption(this.element.id,e).then(e=>{e.data.status?this.reloadOptions():this.loading=!1})}}},Ci=bi,Oi=(a("29d4"),Object(b["a"])(Ci,fi,vi,!1,null,null,null)),yi=Oi.exports,Ei=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-wysiwig"}},[e.loading?t("div",{staticClass:"em-loader"}):t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.editable,expression:"!editable"}],attrs:{id:e.element.id},domProps:{innerHTML:e._s(e.element.element)},on:{click:function(t){e.editable=!0}}}),t("transition",{attrs:{name:"slide-down",type:"transition"}},[e.editable?t("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.element.default,lang:"fr",enable_variables:!1,id:"editor_"+e.element.id},on:{focusout:e.updateDisplayText},model:{value:e.element.default,callback:function(t){e.$set(e.element,"default",t)},expression:"element.default"}}):e._e()],1)],1)])},Di=[],Mi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editor"},[t("div",{attrs:{id:"tiny_"+e.selector_id}})])},Si=[],Ai=(a("a881"),a("59d1"),a("9908"),a("53b8"),a("66c5"),a("26ab"),a("2efd"),a("5cb9"),a("0898"),a("5aa7"),a("750b"),a("8f8e"),a("bedc"),{components:{editor:tt.a},props:{text:String,lang:String,placeholder:String,id:String,height:String,enable_variables:Boolean},data(){return{selector_id:this.id+fa.a.random(1e4,99999),variables:{},data:null}},methods:{saveText(){void 0!==typeof tt.a.activeEditor&&null!==tt.a.activeEditor&&this.$emit("input",tt.a.activeEditor.getContent())}},watch:{text:function(){this.$forceUpdate()}},mounted(){p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=geteditorvariables"}).then(e=>{this.variables=e.data.data});var e=window.location.protocol+"//"+window.location.host+"/media/com_emundus_vue/";let t={selector:"#tiny_"+this.selector_id,images_upload_url:"index.php?option=com_emundus&controller=settings&task=uploadimages",plugins:"paste link media preview image code advlist hr emoticons lists searchreplace charmap quickbars pagebreak autolink print mention",toolbar:"undo redo | forecolor bold italic underline strikethrough | fontsizeselect | image preview | alignleft aligncenter alignright alignjustify hr | bullist numlist | outdent indent | insertfile media anchor| charmap emoticons backcolor | searchreplace print",fontsize_formats:"8pt 10pt 12pt 14pt 18pt 24pt 36pt",content_css:e+"skins/ui/oxide/content.min.css",convert_urls:!1,height:this.height,branding:!1,elementpath:!1,statusbar:!1,menubar:!1,a11y_advanced_options:!1,toolbar_sticky:!1,quickbars_insert_toolbar:"",quickbars_selection_toolbar:"bold italic underline | quicklink h2 h3 blockquote",toolbar_mode:"sliding",placeholder:this.placeholder,file_picker_types:"image",paste_data_images:!0,file_picker_callback:function(e,t,a){var s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.onchange=function(){var t=this.files[0],a=new FileReader;a.onload=function(){var s="blobid"+(new Date).getTime(),i=tt.a.activeEditor.editorUpload.blobCache,n=a.result.split(",")[1],l=i.create(s,t,n);i.add(l),e(l.blobUri(),{title:t.name})},a.readAsDataURL(t)},s.click()},mentions:{delimiter:"/",source:(e,t,a)=>{"/"===a&&1==this.enable_variables&&t(this.variables)},queryBy:"value",delay:200,insert:e=>(setTimeout(()=>{this.$emit("input",tt.a.activeEditor.getContent())},500),"<span>["+e.value+"]</span>"),render:function(e){return'<li class="email-tags"><a href="javascript:;"><span>'+e.value+"</span><p>"+e.description+"</p></a></li>"},renderDropdown:function(){return'<ul class="rte-autocomplete em-autocomplete dropdown-menu"></ul>'}},setup:e=>{e.on("keyup",()=>{this.$emit("input",tt.a.activeEditor.getContent())}),e.on("blur",()=>{this.$emit("focusout",tt.a.activeEditor.getContent())}),e.on("init",()=>{tt.a.activeEditor.setContent(this.text)})}};"fr"==this.lang?(t.language="fr_FR",t.language_url=e+"languages/fr_FR.js",tt.a.init(t)):tt.a.init(t),this.$forceUpdate(),setInterval(this.saveText,3e3)}}),Ni=Ai,wi=(a("1284"),Object(b["a"])(Ni,Mi,Si,!1,null,"da9a3e9e",null)),Ti=wi.exports,Ui={props:{element:{type:Object,required:!0},type:{type:String,required:!0}},components:{Editor:Ti},data(){return{loading:!1,editable:!1,dynamicComponent:0}},created(){},methods:{updateDisplayText(e){this.editable=!1,Ts.updateDefaultValue(this.$props.element.id,e).then(e=>{this.$emit("update-element")})}},watch:{}},Ri=Ui,xi=Object(b["a"])(Ri,Ei,Di,!1,null,null,null),Li=xi.exports,ki={components:{FormBuilderElementWysiwig:Li,FormBuilderElementOptions:yi},props:{element:{type:Object,default:{}}},mixins:[Us,A],data(){return{keysPressed:[],options_enabled:!1}},methods:{updateLabel(){this.element.label[this.shortDefaultLang]=this.$refs["element-label-"+this.element.id].value.trim().replace(/[\r\n]/gm,""),Ts.updateTranslation({value:this.element.id,key:"element"},this.element.label_tag,this.element.label).then(e=>{e.data.status?(this.element.label_tag=e.data.data,this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_SAVE_TRANSLATION"),type:"error",cancelButtonText:this.translate("OK")})})},updateLabelKeyup(){document.activeElement.blur()},updateElement(){Ts.updateParams(this.element).then(e=>{e.data.status?(this.$emit("update-element"),this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_UPDATE_PARAMS"),type:"error",cancelButtonText:this.translate("OK")})})},deleteElement(){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_ELEMENT"),this.element.label[this.shortDefaultLang],this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_ELEMENT_CONFIRM"),this.translate("JNO"),()=>{Ts.deleteElement(this.element.id),this.$emit("delete-element",this.element.id),this.updateLastSave(),this.tip("foo-velocity",this.translate("COM_EMUNDUS_FORM_BUILDER_DELETED_ELEMENT_TEXT"),this.translate("COM_EMUNDUS_FORM_BUILDER_DELETED_ELEMENT_TITLE")),window.addEventListener("keydown",this.cancelDelete)})},openAdmin(){navigator.clipboard.writeText(this.element.id),Swal.fire({title:"Identifiant de l'lment copi",type:"success",showCancelButton:!1,showConfirmButton:!1,customClass:{title:"em-swal-title"},timer:1500})},triggerElementProperties(){this.$emit("open-element-properties")},cancelDelete(e){let t=this.$parent.$parent.$parent.elementsDeletedPending,a=t.indexOf(this.element.id);t.indexOf(this.element.id)===t.length-1&&(e.stopImmediatePropagation(),this.keysPressed[e.key]=!0,(this.keysPressed["Control"]||this.keysPressed["Meta"])&&"z"===e.key&&(Ts.toggleElementPublishValue(this.element.id),this.$emit("cancel-delete-element",this.element.id),this.keysPressed=[],document.removeEventListener("keydown",this.cancelDelete),this.$parent.$parent.$parent.elementsDeletedPending.splice(a,1)))}},computed:{sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)},displayOptions:function(){return this.$parent.$parent.$parent.$parent.$parent.$parent.optionsSelectedElement&&null!==this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement&&this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement.id==this.element.id},propertiesOpened:function(){return null!==this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement?this.$parent.$parent.$parent.$parent.$parent.$parent.selectedElement.id:0}}},Ii=ki,Bi=(a("f71d"),Object(b["a"])(Ii,hi,gi,!1,null,null,null)),Pi=Bi.exports,Fi={components:{FormBuilderPageSectionElement:Pi,draggable:Bt.a},props:{profile_id:{type:Number,required:!0},page_id:{type:Number,required:!0},section:{type:Object,required:!0},index:{type:Number,default:0},totalSections:{type:Number,default:0}},mixins:[Us,A],data(){return{closedSection:!1,elements:[],emptySection:[{text:"COM_EMUNDUS_FORM_BUILDER_EMPTY_SECTION"}],elementsDeletedPending:[]}},created(){this.getElements()},methods:{getElements(){this.elements=Object.values(this.section.elements).length>0?Object.values(this.section.elements):[]},updateTitle(){this.section.label[this.shortDefaultLang]=this.section.label[this.shortDefaultLang].trim(),Ts.updateTranslation({value:this.section.group_id,key:"group"},this.section.group_tag,this.section.label).then(e=>{e.data.status?(this.section.group_tag=e.data.data,this.updateLastSave()):Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_SAVE_TRANSLATION"),type:"error",cancelButtonText:this.translate("OK")})})},blurElement(e){document.querySelector(e).blur()},updateIntro(){this.$refs.sectionIntro.innerHTML=this.$refs.sectionIntro.innerHTML.trim().replace(/[\r\n]/gm," "),this.section.group_intro=this.$refs.sectionIntro.innerHTML,Ts.updateGroupParams(this.section.group_id,{intro:this.section.group_intro},this.shortDefaultLang).then(e=>{e.data.status?this.updateLastSave():Swal.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR_UPDATE_GROUP_PARAMS"),type:"error",cancelButtonText:this.translate("OK")})})},onDragEnd(e){const t=e.to.getAttribute("data-sid");if(t==this.section.group_id){const t=this.elements.map((e,t)=>({id:e.id,order:t+1})),a=this.elements[e.newIndex];Ts.updateOrder(t,this.section.group_id,a).then(e=>{this.updateLastSave();let t={};this.elements.forEach((e,a)=>{t["element"+e.id]=e}),this.section.elements=t})}else this.$emit("move-element",e,this.section.group_id,t)},deleteElement(e){this.section.elements["element"+e].publish=-2,this.elementsDeletedPending.push(e),this.getElements(),this.updateLastSave()},cancelDeleteElement(e){this.section.elements["element"+e].publish=!0,this.getElements()},deleteSection(){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_SECTION"),this.section.label[this.shortDefaultLang],this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_SECTION_CONFIRM"),this.translate("JNO"),()=>{Ts.deleteGroup(this.section.group_id),this.$emit("delete-section",this.section.group_id),this.updateLastSave()})},moveSection(e="up"){this.$emit("move-section",this.section.group_id,e)}},watch:{section:{handler(){this.getElements()},deep:!0}},computed:{publishedElements(){return this.elements&&this.elements.length>0?this.elements.filter(e=>!0===e.publish&&(!1===e.hidden||this.sysadmin)):[]},sysadmin:function(){return parseInt(this.$store.state.global.sysadminAccess)}}},$i=Fi,ji=(a("3907"),Object(b["a"])($i,pi,_i,!1,null,null,null)),Gi=ji.exports,Hi={components:{FormBuilderPageSection:Gi},props:{profile_id:{type:Number,default:0},page:{type:Object,default:{}}},mixins:[Us,A,se],data(){return{fabrikPage:{},title:"COM_EMUNDUS_FORM_BUILDER_NEW_PAGE",description:"",sections:[],loading:!1}},mounted(){this.page.id&&(this.title=this.page.label,this.getSections())},methods:{getSections(){this.loading=!0,Ra.getPageObject(this.page.id).then(e=>{if(e.status&&""!=e.data){this.fabrikPage=e.data,this.title=this.fabrikPage.show_title.label[this.shortDefaultLang];const t=Object.values(e.data.Groups);this.sections=t.filter(e=>-1!=e.hidden_group),this.getDescription()}else j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_ERROR"),type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}});this.loading=!1})},getDescription(){Ts.getAllTranslations(this.fabrikPage.intro_raw).then(e=>{e.status&&e.data&&""!==e.data[this.shortDefaultLang]&&(this.description=e.data[this.shortDefaultLang])})},addSection(){this.sections.length<10?Ts.createSimpleGroup(this.page.id,{fr:"Nouvelle section",en:"New section"}).then(e=>{e.status?(this.getSections(),this.updateLastSave()):this.displayError(this.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_SECTION_ERROR"),this.translate(e.msg))}).catch(e=>{this.displayError(this.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_SECTION_ERROR"),e)}):this.displayError(this.translate("COM_EMUNDUS_FORM_BUILDER_MAX_SECTION_TITLE"),this.translate("COM_EMUNDUS_FORM_BUILDER_MAX_SECTION_TEXT"))},moveSection(e,t){let a=this.sections.map((e,t)=>({id:e.group_id,order:t}));const s=a.findIndex(t=>e===t.id),i=a[s].id;"up"===t?s>0&&(a[s].id=a[s-1].id,a[s-1].id=i):s<a.length-1&&(a[s].id=a[s+1].id,a[s+1].id=i),Ts.reorderSections(this.page.id,a);const n=this.sections;let l=[];a.forEach(e=>{l.push(n.find(t=>t.group_id===e.id))}),this.sections=l},updateTitle(){this.fabrikPage.show_title.label[this.shortDefaultLang]=this.$refs.pageTitle.innerText.trim().replace(/[\r\n]/gm,""),this.$refs.pageTitle.innerText=this.$refs.pageTitle.innerText.trim().replace(/[\r\n]/gm,""),Ts.updateTranslation(null,this.fabrikPage.show_title.titleraw,this.fabrikPage.show_title.label).then(e=>{e.status&&(ui.updateTranslations(this.fabrikPage.show_title.label[this.shortDefaultLang],"falang",this.shortDefaultLang,this.fabrikPage.menu_id,"title","menu"),this.$emit("update-page-title",{page:this.page.id,new_title:this.$refs.pageTitle.innerText}),this.updateLastSave())})},updateTitleKeyup(){document.activeElement.blur()},updateDescription(){this.fabrikPage.intro[this.shortDefaultLang]=this.$refs.pageDescription.innerText.replace(/[\r\n]/gm,"<br/>"),Ts.updateTranslation(null,this.fabrikPage.intro_raw,this.fabrikPage.intro).then(e=>{e.data.status&&(this.updateLastSave(),this.fabrikPage.intro_raw=e.data.data),""===this.$refs.pageDescription.innerText&&(document.getElementById("pageDescription").textContent=this.translate("COM_EMUNDUS_FORM_BUILDER_ADD_PAGE_INTRO_ADD"),document.getElementById("pageDescription").classList.add("em-text-neutral-600"))})},updateElementsOrder(e,t,a){let s=!1;if(t>0&&a>0&&t!=a){const i=this.sections.find(e=>e.group_id===t),n=Object.values(i.elements),l=n[e.oldIndex];if(void 0!==l&&null!==l&&l.id){const t=this.$refs["section-"+a][0].elements.find(e=>e.id===l.id);void 0!=t&&null!=t||this.$refs["section-"+a][0].elements.splice(e.newIndex,0,l);const i=this.$refs["section-"+a][0].elements.map((e,t)=>({id:e.id,order:t+1}));Ts.updateOrder(i,a,l).then(e=>{s=e.data.status,s||this.displayError("COM_EMUNDUS_FORM_BUILDER_UPDATE_ELEMENTS_ORDER_FAILED")}),this.updateLastSave()}else this.displayError("COM_EMUNDUS_FORM_BUILDER_UPDATE_ELEMENTS_ORDER_FAILED")}else this.displayError("COM_EMUNDUS_FORM_BUILDER_UPDATE_ELEMENTS_ORDER_FAILED")},deleteSection(e){this.sections=this.sections.filter(t=>t.group_id!==e),this.updateLastSave()}}},zi=Hi,Vi=(a("1a8e"),Object(b["a"])(zi,oi,ci,!1,null,null,null)),Yi=Vi.exports,qi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-w-100 em-p-32 em-pt-16",attrs:{id:"form-builder-create-page"}},[t("div",[t("h3",{staticClass:"em-mb-4 em-text-neutral-800"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE")))]),t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE_INTRO")))]),t("section",{attrs:{id:"new-page"}},[t("div",{staticClass:"em-mt-16 em-mb-16 card-wrapper",class:{selected:-1===e.selected},on:{click:function(t){e.selected=-1}}},[t("div",{staticClass:"card em-shadow-cards em-pointer em-flex-row",on:{dblclick:e.createPage}},[t("span",{staticClass:"add_circle material-icons-outlined em-main-500-color"},[e._v("add_circle")])]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.page.label[e.shortDefaultLang],expression:"page.label[shortDefaultLang]"}],staticClass:"em-p-4",class:{"em-color-white":-1===e.selected,"em-bg-main-500":-1===e.selected},attrs:{type:"text"},domProps:{value:e.page.label[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.page.label,e.shortDefaultLang,t.target.value)}}})])]),t("div",{staticClass:"separator em-mt-32"},[t("p",{staticClass:"line-head em-mt-4 em-p-8 em-color-white em-bg-main-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_NEW_PAGE_FROM_MODEL")))]),t("div",{staticClass:"line em-bg-main-500"})]),t("section",{staticClass:"em-flex-row em-w-100",attrs:{id:"models"}},[e.loading?t("div",{staticClass:"em-w-100"},[t("skeleton",{attrs:{width:"206px",height:"41px",classes:"em-mt-16 em-mb-16 em-border-radius-5"}}),t("div",{staticClass:"models-card em-grid"},e._l(16,(function(e){return t("div",{key:e,staticClass:"em-flex-column card-wrapper em-mr-24"},[t("skeleton",{attrs:{width:"150px",height:"200px",classes:"card em-shadow-cards model-preview"}}),t("skeleton",{attrs:{width:"150px",height:"20px",classes:"em-p-4"}})],1)})),0)],1):t("div",{staticClass:"em-w-100"},[t("div",{attrs:{id:"search-model-wrapper"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-mt-16",attrs:{id:"search-model",type:"text",placeholder:"Rechercher"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),t("span",{staticClass:"reset-search material-icons-outlined em-pointer",on:{click:function(t){e.search=""}}},[e._v("close")])]),t("section",{attrs:{id:"structure-options"}},[t("div",{staticClass:"em-flex-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.structure,expression:"structure"}],attrs:{type:"radio",id:"new-structure",name:"structure",value:"new"},domProps:{checked:e._q(e.structure,"new")},on:{change:function(t){e.structure="new"}}}),t("label",{attrs:{for:"new-structure"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_NEW_STRUCTURE")))])]),t("div",{staticClass:"em-flex-row",class:{disabled:!e.canUseInitialStructure}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.structure,expression:"structure"}],attrs:{type:"radio",id:"initial-structure",name:"structure",value:"initial"},domProps:{checked:e._q(e.structure,"initial")},on:{change:function(t){e.structure="initial"}}}),t("label",{attrs:{for:"initial-structure"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_INITIAL_STRUCTURE")))])])]),t("div",{staticClass:"models-card em-flex-row"},[e._l(e.models,(function(a){return t("div",{key:a.id,staticClass:"card-wrapper em-mr-32",class:{selected:a.id===e.selected,hidden:!a.displayed},attrs:{title:a.label[e.shortDefaultLang]},on:{click:function(t){e.selected=a.id},dblclick:e.createPage}},[t("form-builder-preview-form",{staticClass:"card em-shadow-cards model-preview em-pointer",class:{"em-color-white":a.id===e.selected,"em-bg-main-500":a.id===e.selected},attrs:{form_id:Number(a.form_id),form_label:a.label[e.shortDefaultLang]}}),t("p",{staticClass:"em-p-4",class:{"em-color-white":a.id===e.selected,"em-bg-main-500":a.id===e.selected}},[e._v(" "+e._s(a.label[e.shortDefaultLang])+" ")])],1)})),e.displayedModels.length<1?t("div",{staticClass:"empty-model-message em-w-100 em-text-align-center"},[t("span",{staticClass:"material-icons-outlined"},[e._v("manage_search")]),t("p",{staticClass:"em-w-100"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EMPTY_PAGE_MODELS")))])]):e._e()],2)])])]),t("div",{staticClass:"actions em-flex-space-between em-flex-row em-w-100"},[t("button",{staticClass:"em-secondary-button em-w-auto em-white-bg",on:{click:function(t){return e.close(!1)}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CANCEL")))]),t("button",{staticClass:"em-primary-button em-w-auto em-ml-8",on:{click:e.createPage}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_PAGE_CREATE_SAVE")))])])])},Ji=[],Wi={name:"FormBuilderCreatePage.vue",components:{Skeleton:Ee,FormBuilderPreviewForm:Ia},props:{profile_id:{type:Number,required:!0}},data(){return{loading:!0,selected:-1,models:[],page:{label:{fr:"Nouvelle page",en:"New page"},intro:{fr:"",en:""},prid:this.profile_id,template:0},search:"",structure:"new",canUseInitialStructure:!0}},created(){this.getModels()},methods:{getModels(){Ts.getModels().then(e=>{e.status?this.models=e.data.map(e=>(e.displayed=!0,e)):Swal.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_GET_PAGE_MODELS_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.loading=!1})},createPage(){let e=-1;if(this.selected>0){const t=this.models.find(e=>e.id===this.selected);t&&(e=t.form_id,this.page.label=t.label,this.page.intro=t.intro),"new"===this.structure||this.canUseInitialStructure||(this.structure="new")}const t={...this.page,modelid:e,keep_structure:"initial"===this.structure};Ts.addPage(t).then(e=>{e.status?this.close(!0,e.data.id):(Swal.fire({type:"error",title:this.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_PAGE_ERROR"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.close(!1))})},close(e=!0,t=0){this.$emit("close",{reload:e,newSelected:t})},isInitialStructureAlreadyUsed(){let e=!1;if(-1===this.selected)return e;{const t=this.models.find(e=>e.id===this.selected);if(!t)return e;Ts.checkIfModelTableIsUsedInForm(t.form_id,this.profile_id).then(t=>(t.status&&(e=t.data),e?(this.structure="new",this.canUseInitialStructure=!1):this.canUseInitialStructure=!0,e)).catch(()=>(this.canUseInitialStructure=!1,!0))}}},computed:{displayedModels(){return this.models.filter(e=>e.displayed)}},watch:{search:function(){this.models.forEach(e=>{e.displayed=e.label[this.shortDefaultLang].toLowerCase().includes(this.search.toLowerCase().trim())})},selected:function(){-1!==this.selected&&this.isInitialStructureAlreadyUsed()}}},Ki=Wi,Xi=(a("2567"),Object(b["a"])(Ki,qi,Ji,!1,null,"5f07a74d",null)),Qi=Xi.exports,Zi=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-pages"}},[t("p",{staticClass:"form-builder-title em-flex-row em-s-justify-content-center em-flex-space-between em-p-16"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EVERY_PAGE")))]),t("span",{staticClass:"material-icons em-pointer",attrs:{id:"add-page"},on:{click:function(t){return e.$emit("open-page-create")}}},[e._v(" add ")])]),t("draggable",{staticClass:"draggables-list",attrs:{group:"form-builder-pages",sort:!0},on:{end:e.onDragEnd},model:{value:e.pages,callback:function(t){e.pages=t},expression:"pages"}},[t("transition-group",e._l(e.formPages,(function(a,s){return t("div",{key:a.id,staticClass:"em-font-weight-500 em-pointer",class:{selected:a.id===e.selected}},[t("div",{staticClass:"em-flex-row em-flex-space-between",on:{mouseover:function(t){e.pageOptionsShown=a.id},mouseleave:function(t){e.pageOptionsShown=0}}},[t("p",{staticClass:"em-w-100 em-p-16 form-builder-page-label",on:{click:function(t){return e.selectPage(a.id)}}},[e._v(e._s(""!==a.label?e.translate(a.label):e.translate("COM_EMUNDUS_FILES_PAGE")+" "+(s+1)))]),t("div",{staticClass:"em-flex-row em-p-16",style:e.pageOptionsShown===a.id?"opacity:1":"opacity: 0"},[t("v-popover",{attrs:{popoverArrowClass:"custom-popover-arraow","open-class":"form-builder-pages-popover",placement:"left"}},[t("span",{staticClass:"material-icons"},[e._v("more_horiz")]),t("template",{slot:"popover"},[t("transition",{attrs:{name:"slide-down",type:"transition"}},[t("div",[t("nav",{staticClass:"em-flex-col-start",attrs:{"aria-label":"action"}},[t("p",{staticClass:"em-p-8-12 em-w-100 em-red-500-color",on:{click:function(t){return e.deletePage(a)}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE"))+" ")]),t("p",{staticClass:"em-p-8-12 em-w-100",on:{click:function(t){return e.createModelFrom(a)}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_TITLE"))+" ")])])])])],1)],2)],1)])])})),0)],1),t("transition-group",e._l(e.submissionPages,(function(a){return t("div",{key:a.id,staticClass:"em-font-weight-500 em-pointer",class:{selected:a.id===e.selected}},[t("div",{staticClass:"em-flex-row em-flex-space-between"},[t("p",{staticClass:"em-w-100 em-p-16 em-main-500-color",on:{click:function(t){return e.selectPage(a.id)}}},[e._v(e._s(a.label))])])])})),0)],1)},en=[],tn={name:"FormBuilderPages",components:{draggable:Bt.a},props:{pages:{type:Array,required:!0},selected:{type:Number,default:0},profile_id:{type:Number,required:!0}},mixins:[Us],data(){return{pageOptionsShown:0}},created(){},methods:{selectPage(e){this.$emit("select-page",e)},deletePage(e){this.pages.length>2?j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_CONFIRMATION")+e.label,text:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_CONFIRMATION_TEXT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate("COM_EMUNDUS_ACTIONS_DELETE"),cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-delete-button"}}).then(t=>{t.value&&Ts.deletePage(e.id).then(t=>{if(t.status){let t=this.pages.findIndex(t=>t.id===e.id);this.pages.splice(t,1),this.selected==e.id&&this.$emit("delete-page"),this.updateLastSave()}})}):j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_ERROR"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_PAGE_ERROR_TEXT"),type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},createModelFrom(e){this.$emit("open-create-model",e.id)},onDragEnd(){const e=this.pages.map((e,t)=>({rgt:t,link:e.link}));Ts.reorderMenu(e,this.$props.profile_id).then(e=>{200==e.status&&e.data.status?this.$emit("reorder-pages",this.pages):j.a.fire({title:this.translate("COM_EMUNDUS_FORM_BUILDER_UPDATE_ORDER_PAGE_ERROR"),text:result.msg,type:"error",showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_OK"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})})}},computed:{formPages(){return this.pages.filter(e=>"submission"!=e.type)},submissionPages(){return this.pages.filter(e=>"submission"==e.type)}}},an=tn,sn=(a("b81c"),Object(b["a"])(an,Zi,en,!1,null,null,null)),nn=sn.exports,ln=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-documents"}},[t("div",{staticClass:"em-pointer em-flex-row em-flex-space-between em-p-16",attrs:{id:"form-builder-title"},on:{click:function(t){return e.$emit("show-documents")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_EVERY_DOCUMENTS")))]),t("span",{staticClass:"material-icons-outlined em-pointer",attrs:{id:"add-document"},on:{click:e.createDocument}},[e._v("add")])]),e._l(e.documents,(function(a){return t("div",{key:a.id,staticClass:"em-p-16",on:{click:function(t){return e.$emit("show-documents")}}},[t("p",{staticClass:"document-label"},[e._v(e._s(a.label))])])}))],2)},rn=[],on={name:"FormBuilderDocuments",props:{profile_id:{type:Number,required:!0},campaign_id:{type:Number,required:!0}},mixins:[se],data(){return{documents:[]}},created(){this.getDocuments(),0===this.$store.getters["formBuilder/getDocumentModels"].length&&this.getDocumentModels()},methods:{getDocuments(){Ra.getDocuments(this.profile_id).then(e=>{e.status?this.documents=e.data:this.displayError(this.translate("COM_EMUNDUS_FORM_BUILDER_GET_DOCUMENTS_FAILED"),e.msg)})},getDocumentModels(){Ra.getDocumentModels().then(e=>{e.status&&this.$store.dispatch("formBuilder/updateDocumentModels",e.data)})},createDocument(){this.$emit("open-create-document")}}},cn=on,dn=(a("2da3"),Object(b["a"])(cn,ln,rn,!1,null,null,null)),mn=dn.exports,un=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-document-list"}},[t("div",{staticClass:"em-w-100 em-mb-32 em-mt-32",attrs:{id:"required-documents"}},[t("p",{staticClass:"em-font-size-24 em-font-weight-600"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_REQUIRED_DOCUMENTS")))]),e.requiredDocuments.length>0?t("div",[t("draggable",{attrs:{group:"form-builder-documents",sort:!1},model:{value:e.requiredDocuments,callback:function(t){e.requiredDocuments=t},expression:"requiredDocuments"}},[t("transition-group",{attrs:{id:"required-documents"}},e._l(e.requiredDocuments,(function(a,s){return t("form-builder-document-list-element",{key:"required-"+a.id,attrs:{document:a,documentIndex:s+1,totalDocuments:e.requiredDocuments.length,profile_id:e.profile_id},on:{"edit-document":function(t){return e.editDocument(a)},"delete-document":e.deleteDocument,"move-document":e.moveDocument}})})),1)],1)],1):e._e(),e.requiredDocuments.length<1?t("div",{staticClass:"empty-documents em-mt-16 em-mb-16"},[t("draggable",{staticClass:"draggables-list",attrs:{list:e.emptyDocuments,group:"form-builder-documents",sort:!1}},[t("transition-group",{attrs:{id:"required-documents"}},e._l(e.emptyDocuments,(function(a,s){return t("p",{key:s,staticClass:"em-w-100 em-text-align-center em-p-16"},[e._v(" "+e._s(e.translate(a.text))+" ")])})),0)],1)],1):e._e(),t("button",{staticClass:"em-secondary-button",attrs:{id:"add-document"},on:{click:function(t){return e.addDocument("1")}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_REQUIRED_DOCUMENT")))])]),t("div",{staticClass:"em-w-100 em-mb-32 em-mt-32",attrs:{id:"optional-documents"}},[t("p",{staticClass:"em-font-size-24 em-font-weight-600"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_OPTIONAL_DOCUMENTS")))]),e.optionalDocuments.length>0?t("div",[t("draggable",{attrs:{group:"form-builder-documents",sort:!1},model:{value:e.optionalDocuments,callback:function(t){e.optionalDocuments=t},expression:"optionalDocuments"}},[t("transition-group",{attrs:{id:"optional-documents"}},e._l(e.optionalDocuments,(function(a,s){return t("form-builder-document-list-element",{key:"optional-"+a.id,attrs:{document:a,documentIndex:s+1,totalDocuments:e.optionalDocuments.length,profile_id:e.profile_id},on:{"edit-document":function(t){return e.editDocument(a)},"delete-document":e.deleteDocument,"move-document":e.moveDocument}})})),1)],1)],1):e._e(),e.optionalDocuments.length<1?t("div",{staticClass:"empty-documents em-mt-16 em-mb-16"},[t("draggable",{staticClass:"draggables-list",attrs:{list:e.emptyDocuments,group:"form-builder-documents",sort:!1}},[t("transition-group",{attrs:{id:"optional-documents"}},e._l(e.emptyDocuments,(function(a,s){return t("p",{key:s,staticClass:"em-w-100 em-text-align-center em-p-16"},[e._v(" "+e._s(e.translate(a.text))+" ")])})),0)],1)],1):e._e(),t("button",{staticClass:"em-secondary-button",attrs:{id:"add-document"},on:{click:function(t){return e.addDocument("0")}}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_CREATE_OPTIONAL_DOCUMENT")))])])])},pn=[],_n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-document-list-element"},on:{click:e.editDocument}},[t("div",{staticClass:"section-card em-mt-32 em-mb-32 em-w-100 em-flex-column"},[t("div",{staticClass:"section-identifier em-bg-main-500 em-pointer"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT"))+" "+e._s(e.documentIndex)+" / "+e._s(e.totalDocuments)+" ")]),t("div",{staticClass:"section-content",class:{closed:e.closedSection}},[e.documentData.id?t("div",[t("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[t("span",{staticClass:"section-title"},[e._v(e._s(e.documentData.name[e.shortDefaultLang]))]),t("div",[t("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section upwards"},on:{click:function(t){return e.moveDocument("up")}}},[e._v("keyboard_double_arrow_up")]),t("span",{staticClass:"material-icons-outlined em-pointer hover-opacity",attrs:{title:"Move section downwards"},on:{click:function(t){return e.moveDocument("down")}}},[e._v("keyboard_double_arrow_down")]),e.canBeRemoved?t("span",{staticClass:"material-icons-outlined em-red-500-color em-pointer hover-opacity",on:{click:e.deleteDocument}},[e._v("delete")]):e._e()])]),t("p",[e._v(" "+e._s(e.documentData.description[e.shortDefaultLang])+" ")]),t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_TYPES"))+" : "+e._s(e.documentData.allowed_types))]),t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MAX_DOCUMENTS"))+" : "+e._s(e.documentData.nbmax))])]):t("div",[t("span",{staticClass:"section-title"},[e._v(e._s(e.document.label))])])])])])},hn=[],gn={name:"FormBuilderDocumentListElement",props:{document:{type:Object,required:!0},totalDocuments:{type:Number,default:1},documentIndex:{type:Number,default:1},profile_id:{type:Number,required:!0}},mixins:[Us],data(){return{closedSection:!1,documentData:{},canBeRemoved:!1,reasonCantRemove:""}},created(){this.document.docid&&(this.getDocumentModel(this.document.docid),this.checkIfDocumentCanBeDeleted())},methods:{moveDocument(e){this.$emit("move-document",this.document,e)},getDocumentModel(e=null,t=!0){if(this.models=t?this.$store.getters["formBuilder/getDocumentModels"]:[],this.documentData={},this.models.length>0){const t=this.models.find(t=>t.id===e);t?this.documentData=t:Ra.getDocumentModels(e).then(e=>{e.status&&(this.documentData=e.data)})}else Ra.getDocumentModels(e).then(e=>{e.status&&(this.documentData=e.data)})},editDocument(e){"delete-section"!==e.target.id&&this.$emit("edit-document")},deleteDocument(e){this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_DOCUMENT"),this.document.label,this.translate("COM_EMUNDUS_FORM_BUILDER_DELETE_DOCUMENT_CONFIRM"),this.translate("JNO"),()=>{Ra.removeDocumentFromProfile(this.document.id).then(e=>{this.$emit("delete-document",this.document.id),this.$destroy()})})},checkIfDocumentCanBeDeleted(){Ra.checkIfDocumentCanBeDeletedForProfile(this.document.docid,this.profile_id).then(e=>{e.status?e.data.can_be_deleted?(this.canBeRemoved=!0,this.reasonCantRemove=""):(this.canBeRemoved=!1,this.reasonCantRemove=e.data.reason):this.canBeRemoved=!1})}},watch:{document:{handler(e){this.getDocumentModel(e.docid,!1)},deep:!0}}},fn=gn,vn=(a("ee12"),Object(b["a"])(fn,_n,hn,!1,null,null,null)),bn=vn.exports,Cn={name:"FormBuilderDocumentList",components:{FormBuilderDocumentListElement:bn,draggable:Bt.a},props:{profile_id:{type:Number,required:!0},campaign_id:{type:Number,required:!0}},data(){return{documents:[],emptyDocuments:[{text:"COM_EMUNDUS_FORM_BUILDER_EMPTY_DOCUMENTS"}],closedSection:!1}},created(){this.getDocuments()},methods:{getDocuments(){Ra.getDocuments(this.profile_id).then(e=>{e.status&&(this.documents=e.data.filter(e=>e.id))})},moveDocument(e,t){let a=this.requiredDocuments.map((e,t)=>({id:e.id,order:t})),s=this.optionalDocuments.map((e,t)=>({id:e.id,order:t})),i=null,n=null,l=!0;1==e.mandatory?(i=a.findIndex(t=>t.id===e.id),n=a.length):(i=s.findIndex(t=>t.id===e.id),n=s.length),null!=i&&(1==e.mandatory?0==i&&"up"===t?l=!1:i==n-1&&"down"===t?(e.mandatory=!1,a=a.filter(t=>t.id!=e.id),s.unshift({id:e.id,order:0})):"up"===t?(a[i].id=a[i-1].id,a[i-1].id=e.id):(a[i].id=a[i+1].id,a[i+1].id=e.id):0==i&&"up"==t?(e.mandatory=!0,s=s.filter(t=>t.id!=e.id),a.push({id:e.id,order:a.length})):i==n-1&&"down"===t?l=!1:"up"===t?(s[i].id=s[i-1].id,s[i-1].id=e.id):(s[i].id=s[i+1].id,s[i+1].id=e.id),l&&(a.forEach((e,t)=>{e.order=t}),s.forEach((e,t)=>{e.order=t+a.length}),this.documents.forEach((e,t)=>{const i=a.find(t=>t.id==e.id),n=s.find(t=>t.id==e.id);i?(this.documents[t].mandatory=1,this.documents[t].ordering=i.order):n&&(this.documents[t].mandatory=0,this.documents[t].ordering=n.order)}),Ra.reorderDocuments(this.documents).then(t=>{Xe.setDocumentMandatory({mandatory:e.mandatory,pid:this.profile_id,did:e.attachment_id})})))},addDocument(e="1"){this.$emit("add-document",e)},editDocument(e){this.$emit("edit-document",e)},deleteDocument(){this.$emit("delete-document"),this.getDocuments()}},computed:{requiredDocuments(){const e=this.documents.filter(e=>1==e.mandatory);return e.sort((e,t)=>e.ordering-t.ordering)},optionalDocuments(){const e=this.documents.filter(e=>0==e.mandatory);return e.sort((e,t)=>e.ordering-t.ordering)}}},On=Cn,yn=(a("fbc1"),Object(b["a"])(On,un,pn,!1,null,null,null)),En=yn.exports,Dn=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-create-document"}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[t("p",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PROPERTIES")))]),t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),t("ul",{staticClass:"em-flex-row em-flex-space-between em-p-16 em-w-90",attrs:{id:"properties-tabs"}},e._l(e.activeTabs,(function(a){return t("li",{key:a.id,staticClass:"em-p-16 em-pointer",class:{"is-active":a.active,"em-w-50":2==e.activeTabs.length,"em-w-100":1==e.activeTabs.length},on:{click:function(t){return e.selectTab(a)}}},[e._v(" "+e._s(e.translate(a.label))+" ")])})),0),t("div",{attrs:{id:"properties"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.tabs[0].active,expression:"tabs[0].active"}],staticClass:"em-p-16",attrs:{id:"general-properties"}},[t("div",{staticClass:"em-mb-16 em-flex-row em-flex-space-between"},[t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_REQUIRED")))]),t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isMandatory,expression:"isMandatory"}],staticClass:"em-toggle-check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isMandatory)?e._i(e.isMandatory,null)>-1:e.isMandatory},on:{click:e.toggleDocumentMandatory,change:function(t){var a=e.isMandatory,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.isMandatory=a.concat([n])):l>-1&&(e.isMandatory=a.slice(0,l).concat(a.slice(l+1)))}else e.isMandatory=i}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})])]),t("div",{staticClass:"em-mb-16"},[t("label",{staticClass:"em-font-weight-500",attrs:{for:"title"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_NAME")))]),e.models.length>0?t("incremental-select",{attrs:{options:e.documentList,defaultValue:e.incSelectDefaultValue,locked:"create"!=e.mode},on:{"update-value":e.updateDocumentSelectedValue}}):e._e()],1),t("div",{staticClass:"em-mb-16"},[t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_DESCRIPTION")))]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.document.description[e.shortDefaultLang],expression:"document.description[shortDefaultLang]"}],attrs:{id:"",name:"",rows:"5"},domProps:{value:e.document.description[e.shortDefaultLang]},on:{input:function(t){t.target.composing||e.$set(e.document.description,e.shortDefaultLang,t.target.value)}}},[e._v(e._s(e.document.description[e.shortDefaultLang]))])]),t("div",{staticClass:"em-mb-16"},[t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_TYPES")))]),e._l(e.fileTypes,(function(a,s){return t("div",{key:a.value,staticClass:"em-flex-row em-mb-4 em-flex-align-start"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.selectedTypes[a.value],expression:"document.selectedTypes[filetype.value]"}],staticStyle:{height:"auto"},attrs:{type:"checkbox",name:"filetypes",id:a.value},domProps:{value:a.value,checked:Array.isArray(e.document.selectedTypes[a.value])?e._i(e.document.selectedTypes[a.value],a.value)>-1:e.document.selectedTypes[a.value]},on:{change:[function(t){var s=e.document.selectedTypes[a.value],i=t.target,n=!!i.checked;if(Array.isArray(s)){var l=a.value,r=e._i(s,l);i.checked?r<0&&e.$set(e.document.selectedTypes,a.value,s.concat([l])):r>-1&&e.$set(e.document.selectedTypes,a.value,s.slice(0,r).concat(s.slice(r+1)))}else e.$set(e.document.selectedTypes,a.value,n)},e.checkFileType]}}),t("label",{staticClass:"em-font-weight-400 em-mb-0-important em-ml-8",attrs:{for:a.value}},[e._v(" "+e._s(e.translate(a.title))+" ("+e._s(a.value)+")")])])}))],2),t("div",{staticClass:"em-mb-16"},[t("label",{staticClass:"em-font-weight-500",attrs:{for:"nbmax"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_NBMAX")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.nbmax,expression:"document.nbmax"}],staticClass:"em-w-100",attrs:{type:"number",id:"nbmax"},domProps:{value:e.document.nbmax},on:{input:function(t){t.target.composing||e.$set(e.document,"nbmax",t.target.value)}}})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tabs[1].active,expression:"tabs[1].active"}],staticClass:"em-p-16",attrs:{id:"advanced-properties"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasImg,expression:"hasImg"}],staticClass:"em-mb-16",attrs:{id:"resolution"}},[t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_IMAGE_WIDTH")))]),t("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[t("div",{staticClass:"em-w-50 em-mr-4"},[t("label",{staticClass:"em-font-weight-400",attrs:{for:"minResolutionW"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MIN_RESOLUTION_PLACEHOLDER")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.minResolution.width,expression:"document.minResolution.width"}],staticClass:"em-w-100",attrs:{type:"number",id:"minResolutionW",max:e.document.maxResolution.width},domProps:{value:e.document.minResolution.width},on:{input:function(t){t.target.composing||e.$set(e.document.minResolution,"width",t.target.value)}}})]),t("div",{staticClass:"em-w-50 em-ml-4"},[t("label",{staticClass:"em-font-weight-400",attrs:{for:"maxResolutionW"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MAX_RESOLUTION_PLACEHOLDER")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.maxResolution.width,expression:"document.maxResolution.width"}],staticClass:"em-w-100",attrs:{type:"number",id:"maxResolutionW",min:e.document.minResolution.width},domProps:{value:e.document.maxResolution.width},on:{input:function(t){t.target.composing||e.$set(e.document.maxResolution,"width",t.target.value)}}})])]),t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_IMAGE_HEIGHT")))]),t("div",{staticClass:"em-w-100 em-flex-row em-flex-space-between"},[t("div",{staticClass:"em-w-50 em-mr-4"},[t("label",{staticClass:"em-font-weight-400",attrs:{for:"minResolutionH"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MIN_RESOLUTION_PLACEHOLDER")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.minResolution.height,expression:"document.minResolution.height"}],staticClass:"em-w-100",attrs:{type:"number",id:"minResolutionH",max:e.document.maxResolution.height},domProps:{value:e.document.minResolution.height},on:{input:function(t){t.target.composing||e.$set(e.document.minResolution,"height",t.target.value)}}})]),t("div",{staticClass:"em-w-50 em-ml-4"},[t("label",{staticClass:"em-font-weight-400",attrs:{for:"maxResolutionH"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_MAX_RESOLUTION_PLACEHOLDER")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.document.maxResolution.height,expression:"document.maxResolution.height"}],staticClass:"em-w-100",attrs:{type:"number",id:"maxResolutionH",min:e.document.minResolution.height},domProps:{value:e.document.maxResolution.height},on:{input:function(t){t.target.composing||e.$set(e.document.maxResolution,"height",t.target.value)}}})])])]),t("div",{attrs:{id:"document-sample"}},[t("label",{staticClass:"em-font-weight-500"},[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_MODEL_TITLE")))]),t("div",{staticClass:"em-mb-16 em-flex-row em-flex-space-between"},[t("label",{staticClass:"em-font-weight-500",attrs:{for:"has-model"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_GIVE_MODEL")))]),t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.hasSample,expression:"hasSample"}],staticClass:"em-toggle-check",attrs:{type:"checkbox",id:"has-model",name:"has-model"},domProps:{checked:Array.isArray(e.hasSample)?e._i(e.hasSample,null)>-1:e.hasSample},on:{change:[function(t){var a=e.hasSample,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&(e.hasSample=a.concat([n])):l>-1&&(e.hasSample=a.slice(0,l).concat(a.slice(l+1)))}else e.hasSample=i},e.onHasSampleChange]}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})])]),e.hasSample&&e.currentSample?t("div",{staticClass:"em-mb-16",attrs:{id:"current-sample"}},[t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_CURRENT_MODEL")))]),t("a",{attrs:{href:e.currentSample,target:"_blank"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_DOWNLOAD_SAMPLE")))])]):e._e(),e.hasSample?t("div",[t("label",{attrs:{for:"sample",id:"formbuilder_attachments_sample_upload"}},[e.currentSample?t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_MODEL_EDIT")))]):t("span",[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_MODEL_ADD")))]),t("span",{staticClass:"material-icons-outlined em-ml-4 em-text-neutral-900"},[e._v("backup")])]),t("input",{ref:"sampleFileInput",staticStyle:{display:"none"},attrs:{id:"sample",name:"sample",type:"file",accept:".pdf,.doc,.docx,.png,.jpg,.xls,.xlsx"},on:{change:e.onSampleFileInputChange}})]):e._e(),""!==e.newSample?t("div",[t("p",{staticClass:"em-neutral-700-color"},[e._v(e._s(e.translate("COM_EMUNDUS_FORMBUILDER_DOCUMENTS_MODEL_FILE_UPLOADED"))+" : "+e._s(this.newSample.name))])]):e._e()])])]),t("div",{staticClass:"em-p-16"},[t("button",{staticClass:"em-primary-button",on:{click:e.saveDocument}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_SAVE")))])])])},Mn=[],Sn={name:"FormBuilderCreateDocument",props:{profile_id:{type:Number,required:!0},current_document:{type:Object,default:null},mandatory:{type:Boolean,default:!0},mode:{type:String,default:"create"}},components:{IncrementalSelect:vt,editor:Ti},mixins:[A,Us],data(){return{models:[],modelsUsage:[],document:{id:null,type:{},mandatory:"1",nbmax:1,description:{fr:"",en:""},name:{fr:"",en:""},selectedTypes:{},minResolution:{width:0,height:0},maxResolution:{width:0,height:0},max_pages_pdf:0},fileTypes:[],activeTab:"general",tabs:[{id:0,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_GENERAL",active:!0,published:!0},{id:1,label:"COM_EMUNDUS_FORM_BUILDER_ELEMENT_PROPERTIES_ADVANCED",active:!1,published:!0}],hasPDF:!1,hasImg:!1,hasSample:!1,currentSample:"",newSample:"",sampleFromDocumentId:null}},created(){this.getDocumentModels(),this.getFileTypes()},methods:{selectTab(e){this.tabs.forEach(e=>{e.active=!1}),e.active=!0},getDocumentModels(){Ra.getDocumentModels().then(e=>{e.status&&(this.models=e.data,null!=this.current_document&&(this.current_document.docid||this.current_document.id)&&this.selectModel({target:{value:this.current_document.docid?this.current_document.docid:this.current_document.id}},null!==this.current_document.mandatory&&"undefined"!=this.current_document.mandatory?this.current_document.mandatory:null),Ra.getDocumentModelsUsage(this.models.map(e=>e.id)).then(e=>{e.status&&(this.modelsUsage=e.data)}))})},toggleDocumentMandatory(){this.document.mandatory="1"==this.document.mandatory?"0":"1"},getFileTypes(){this.fileTypes=a("9ac1"),this.fileTypes.forEach(e=>{this.document.selectedTypes[e.value]=!1})},checkFileType(e){this.document.selectedTypes[e.target.value]=e.target.checked,this.hasImgFormat(),this.hasPDFFormat()},selectModel(e,t=null){if("none"!==e.target.value){const a=this.models.find(t=>t.id==e.target.value);this.document.id=a.id,this.document.type=a.type,this.document.mandatory=null==t?a.mandatory:t,this.document.nbmax=a.nbmax,this.document.description=a.description,this.document.name=a.name,this.document.minResolution={width:a.min_width,height:a.min_height},this.document.maxResolution={width:a.max_width,height:a.max_height},this.document.max_pages_pdf=a.max_pages_pdf,this.fileTypes.forEach(e=>{this.document.selectedTypes[e.value]=!1});let s=a.allowed_types.split(";");s.forEach(e=>{["pdf"].includes(e)&&(this.document.selectedTypes["pdf"]=!0),["jpeg","jpg","png","gif"].includes(e)&&(this.document.selectedTypes["jpeg;jpg;png;gif"]=!0),["doc","docx","odt","ppt","pptx"].includes(e)&&(this.document.selectedTypes["doc;docx;odt;ppt;pptx"]=!0),["xls","xlsx","odf"].includes(e)&&(this.document.selectedTypes["xls;xlsx;odf"]=!0),["mp3"].includes(e)&&(this.document.selectedTypes["mp3"]=!0),["mp4"].includes(e)&&(this.document.selectedTypes["mp4"]=!0)}),this.hasImgFormat(),this.hasPDFFormat()}},saveDocument(){let e=!0;if(Object.values(this.document.name).forEach(t=>{""!=t&&(e=!1)}),!0===e)return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PLEASE_FILL_TYPE"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),!1;const t=this.models.find(e=>e.id==this.document.id);let a=[];if(Object.entries(this.document.selectedTypes).forEach((e,t)=>{e[1]&&a.push(e[0])}),a.length<1)return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_PLEASE_FILL_FORMAT"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),!1;if(t){const e={profile_id:this.profile_id,document_id:this.document.id,types:JSON.stringify(a),document:JSON.stringify(this.document),has_sample:this.hasSample};if(this.hasSample&&null!==this.newSample){const t=this.$refs.sampleFileInput,a=t.files[0];e.sample=a}Object.keys(this.modelsUsage).includes(this.document.id)&&this.modelsUsage[this.document.id].usage>1?this.swalConfirm(this.translate("COM_EMUNDUS_FORM_BUILDER_MULTIPLE_FORMS_IMPACTED"),this.translate("COM_EMUNDUS_FORM_BUILDER_MULTIPLE_FORMS_IMPACTED_TEXT")+" : "+this.modelsUsage[this.document.id].profiles.map(e=>e.label).join(", "),this.translate("COM_EMUNDUS_ONBOARD_OK"),this.translate("COM_EMUNDUS_ONBOARD_CANCEL")).then(t=>{t&&Ts.updateDocument(e).then(e=>{this.$emit("documents-updated")})}):Ts.updateDocument(e).then(e=>{this.$emit("documents-updated")})}else{this.document.id=null;const e={pid:this.profile_id,types:JSON.stringify(a),document:JSON.stringify(this.document),has_sample:this.hasSample};if(this.hasSample&&null!==this.newSample){const t=this.$refs.sampleFileInput,a=t.files[0];e.sample=a}Xe.updateDocument(e,!0).then(e=>{this.$emit("documents-updated")})}},updateDocumentSelectedValue(e){e.id?(this.document.name[this.shortDefaultLang]=e.label,this.selectModel({target:{value:e.id}},this.current_document&&this.current_document.id&&this.current_document.id==e.id?this.current_document.mandatory:this.mandatory)):(this.document.id=null,this.document.name[this.shortDefaultLang]=e.label)},hasImgFormat(){let e=!1;const t=["jpeg","jpg","png","gif"];Object.keys(this.document.selectedTypes).forEach(a=>{this.document.selectedTypes[a]&&t.some(e=>a.includes(e))&&(e=!0)}),this.hasImg=e},hasPDFFormat(){let e=!1;Object.keys(this.document.selectedTypes).forEach(t=>{this.document.selectedTypes[t]&&t.includes("pdf")&&(e=!0)}),this.hasPDF=e},onHasSampleChange(){this.hasSample||(this.newSample="")},onSampleFileInputChange(e){const t=e.target.files||[];if(t.length>0){const e=["pdf","doc","docx","jpg","jpeg","png"],a=t[0].name.split(".").pop().toLowerCase();if(!e.includes(a))return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_DOCUMENT_SAMPLE_WRONG_FORMAT"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.newSample=null,!1;this.newSample=t[0]}else this.newSample=null},getCurrentSample(){this.sampleFromDocumentId=this.document.id,null===this.document.id?(this.hasSample=!1,this.currentSample=""):Ts.getDocumentSample(Number(this.document.id),Number(this.profile_id)).then(e=>{e.status&&e.data?(this.hasSample="1"===e.data.has_sample,this.currentSample=this.hasSample?e.data.sample_filepath:""):(this.hasSample=!1,this.currentSample="")})}},computed:{activeTabs(){return this.tabs.filter(e=>e.published)},documentList(){return this.models.map(e=>({id:e.id,label:e.name[this.shortDefaultLang]}))},isMandatory(){return"1"==this.document.mandatory},incSelectDefaultValue(){let e=null;return this.current_document&&(this.current_document.docid||this.current_document.id)&&(e=this.current_document.docid?this.current_document.docid:this.current_document.id),e}},watch:{current_document(e){e&&(e.docid||e.id)&&(this.models.length<1?this.getDocumentModels().then(()=>{this.selectModel({target:{value:e.docid?e.docid:e.id}},e.mandatory?e.mandatory:null)}):this.selectModel({target:{value:e.docid?e.docid:e.id}},e.mandatory?e.mandatory:null))},document:{handler(e){e.id!==this.sampleFromDocumentId&&this.getCurrentSample()},deep:!0}}},An=Sn,Nn=(a("959e"),Object(b["a"])(An,Dn,Mn,!1,null,null,null)),wn=Nn.exports,Tn=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"form-builder-document-formats"}},[t("p",{staticClass:"em-text-align-center em-w-100 em-p-16",attrs:{id:"form-builder-document-title"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_FORMATS"))+" ")]),e.formats.length>0?t("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"em-mt-16 em-w-100",attrs:{id:"search",type:"text",placeholder:""},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}):e._e(),t("draggable",{staticClass:"draggables-list",attrs:{group:{name:"form-builder-documents",pull:"clone",put:!1},sort:!1,clone:e.setCloneFormat},on:{start:function(t){return e.$emit("dragging-element")},end:e.onDragEnd},model:{value:e.displayedFormats,callback:function(t){e.displayedFormats=t},expression:"displayedFormats"}},[t("transition-group",e._l(e.displayedFormats,(function(a){return t("div",{key:a.id,staticClass:"em-flex-row em-flex-space-between draggable-element em-mt-8 em-mb-8 em-p-16"},[t("span",{staticClass:"em-w-100 em-p-16",attrs:{id:"format-name",title:a.name[e.shortDefaultLang]}},[e._v(e._s(a.name[e.shortDefaultLang]))]),t("span",{staticClass:"material-icons-outlined"},[e._v(" drag_indicator ")])])})),0)],1)],1)},Un=[],Rn={components:{draggable:Bt.a},props:{profile_id:{type:Number,required:!0}},mixins:[Us],data(){return{formats:[],cloneFormat:null,search:""}},created(){this.getFormats()},methods:{getFormats(){Ra.getDocumentModels().then(e=>{e.status&&(this.formats=e.data)})},setCloneFormat(e){this.cloneFormat=e},onDragEnd(e){const t=e.to;null!==t&&(this.cloneFormat.mandatory="required-documents"==t.id?"1":"0",this.$emit("open-create-document",this.cloneFormat))}},computed:{displayedFormats(){return this.formats.filter(e=>!(this.search.length>0&&this.formats.length>0)||e.name[this.shortDefaultLang].toLowerCase().includes(this.search.toLowerCase()))}}},xn=Rn,Ln=(a("b403"),Object(b["a"])(xn,Tn,Un,!1,null,null,null)),kn=Ln.exports,In=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-flex-column em-flex-space-between em-w-100",attrs:{id:"form-builder-create-model"}},[t("div",{staticClass:"em-w-100"},[t("div",{staticClass:"em-flex-row em-flex-space-between em-p-16"},[t("p",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_PROPERTIES")))]),t("span",{staticClass:"material-icons-outlined em-pointer",on:{click:function(t){return e.$emit("close")}}},[e._v("close")])]),e.loading?t("div",{staticClass:"em-w-100 em-flex-row em-flex-center"},[t("div",{staticClass:"em-loader"})]):t("div",{staticClass:"em-flex-column em-flex-start em-p-16 em-text-align-left",attrs:{id:"model-properties"}},[t("p",{staticClass:"em-main-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_PROPERTIES_INTRO")))]),t("label",{staticClass:"em-mt-16 em-text-align-left em-w-100",attrs:{for:"page-model-title"}},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_INPUT_LABEL")))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.modelTitle,expression:"modelTitle"}],staticClass:"em-w-100 em-mb-16",attrs:{id:"page-model-title",type:"text"},domProps:{value:e.modelTitle},on:{input:function(t){t.target.composing||(e.modelTitle=t.target.value)}}}),e.alreadyExists?t("p",{staticClass:"em-red-500-color"},[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_WITH_SAME_TITLE_EXISTS")))]):e._e()])]),t("div",{staticClass:"em-flex-row em-flex-space-between actions em-w-100"},[t("button",{staticClass:"em-primary-button em-m-16",class:{"em-gray-bg em-color-white":e.modelTitle.length<1||e.loading},attrs:{disabled:e.modelTitle.length<1||e.loading},on:{click:function(t){return e.addFormModel()}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_SECTION_PROPERTIES_SAVE"))+" ")])])])},Bn=[],Pn={props:{page:{type:Number,required:!0}},data(){return{modelTitle:"",models:[],alreadyExists:!1,loading:!1}},mounted(){this.getModels()},methods:{getModels(){Ts.getModels().then(e=>{e.status&&(this.models=e.data)})},checkTitleNotAlreadyExists(){const e=this.models.filter(e=>e.label[this.shortDefaultLang]===this.modelTitle.trim());this.alreadyExists=e.length>0},addFormModel(){if(this.loading=!0,this.modelTitle=this.modelTitle.trim(),this.modelTitle.length<1)return j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_MODEL_MUST_HAVE_TITLE"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),void(this.loading=!1);const e=this.models.filter(e=>e.label[this.shortDefaultLang]===this.modelTitle);this.alreadyExists=e.length>0,this.alreadyExists?this.replaceFormModel(e[0].id,this.modelTitle):Ts.addFormModel(this.page,this.modelTitle).then(e=>{e.status||j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_FAILURE"),text:e.msg,reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.loading=!1,this.$emit("close")})},replaceFormModel(e,t){Ts.addFormModel(this.page,t).then(t=>{if(t.status){const t=[e];Ts.deleteFormModelFromId(t).then(()=>{this.$emit("close")})}else j.a.fire({type:"warning",title:this.translate("COM_EMUNDUS_FORM_BUILDER_SAVE_AS_MODEL_FAILURE"),text:t.msg,reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}),this.$emit("close");this.loading&&(this.loading=!1)})}},watch:{modelTitle:function(e,t){e!=t&&this.checkTitleNotAlreadyExists()}}},Fn=Pn,$n=(a("fa31"),Object(b["a"])(Fn,In,Bn,!1,null,null,null)),jn=$n.exports,Gn={name:"FormBuilder",components:{FormBuilderCreateModel:jn,FormBuilderSectionProperties:ri,FormBuilderCreatePage:Qi,FormBuilderElements:ks,FormBuilderElementProperties:Js,FormBuilderPage:Yi,FormBuilderPages:nn,FormBuilderDocuments:mn,FormBuilderDocumentList:En,FormBuilderCreateDocument:wn,FormBuilderDocumentFormats:kn},data(){return{mode:"forms",profile_id:0,form_id:0,campaign_id:0,title:"",pages:[],principalContainer:"default",showInSection:"page",selectedPage:0,selectedSection:null,selectedElement:null,optionsSelectedElement:!1,selectedDocument:null,rightPanel:{tabs:["hierarchy","element-properties","section-properties","create-model","create-document"]},showInRightPanel:"hierarchy",createDocumentMandatory:!0,lastSave:null,leftPanel:{tabs:[{title:"Elements",icon:"edit_note",active:!0,displayed:!0},{title:"Documents",icon:"edit_note",active:!1,displayed:!1},{title:"Translations",icon:"translate",active:!1,displayed:!0,url:"/parametres-globaux"}]},formBuilderCreateDocumentKey:0,createDocumentMode:"create"}},created(){const e=this.$store.getters["global/datas"];0===parseInt(this.$store.state.global.manyLanguages)&&(this.leftPanel.tabs[2].displayed=!1),this.profile_id=e.prid.value,this.campaign_id=e.cid.value,e&&e.mode&&e.mode.value&&(this.mode=e.mode.value,"eval"!==this.mode&&"models"!=this.mode||(this.rightPanel.tabs=this.rightPanel.tabs.filter(e=>"hierarchy"!==e&&"create-document"!==e),this.leftPanel.tabs=this.leftPanel.tabs.filter(e=>"Documents"!=e.title),this.form_id=this.profile_id,this.profile_id=0)),this.getFormTitle(),this.getPages()},mounted(){this.$modal.show("formBuilder")},methods:{getFormTitle(){this.profile_id&&Ra.getProfileLabelByProfileId(this.profile_id).then(e=>{!1!==e.status&&(this.title=e.data.data.label)})},updateFormTitle(){this.title=this.$refs.formTitle.innerText.trim().replace(/[\r\n]/gm," "),this.$refs.formTitle.innerText=this.$refs.formTitle.innerText.trim().replace(/[\r\n]/gm," "),Ra.updateFormLabel({label:this.title,prid:this.profile_id,form_id:this.form_id})},updateFormTitleKeyup(){document.activeElement.blur()},getPages(e=0){this.profile_id?Ra.getFormsByProfileId(this.profile_id).then(t=>{this.pages=t.data.data,0===e?this.selectPage(this.pages[0].id):this.selectPage(String(e)),this.principalContainer="default",Ra.getSubmissionPage(this.profile_id).then(e=>{const t=e.data.link.match(/formid=(\d+)/)[1];if(t){const e=this.pages.find(e=>e.id===t);e||this.pages.push({id:t,label:this.translate("COM_EMUNDUS_FORM_BUILDER_SUBMISSION_PAGE"),type:"submission",elements:[]})}})}):this.form_id&&Ra.getFormByFabrikId(this.form_id).then(e=>{this.title=e.data.data.label,this.pages=[e.data.data],this.selectPage(this.pages[0].id),this.principalContainer="default"})},onReorderedPages(e){this.pages=e},onElementCreated(e){this.$refs.formBuilderPage.getSections(e)},onDocumentCreated(){this.$refs.formBuilderDocuments.getDocuments(),this.$refs.formBuilderDocumentList.getDocuments()},onOpenSectionProperties(e){this.selectedSection=e,this.showInRightPanel="section-properties"},onOpenElementProperties(e){this.selectedElement=e,"dropdown"===this.selectedElement.plugin?this.optionsSelectedElement=!0:(!0===this.optionsSelectedElement&&this.$refs.formBuilderPage.getSections(),this.optionsSelectedElement=!1),this.showInRightPanel="element-properties"},onUpdateDocument(){this.$refs.formBuilderDocumentList.getDocuments(),this.showInRightPanel="hierarchy"},onCloseElementProperties(){this.selectedElement=null,this.showInRightPanel="hierarchy",this.$refs.formBuilderPage.getSections()},onCloseSectionProperties(){this.selectedSection=null,this.showInRightPanel="hierarchy",this.$refs.formBuilderPage.getSections()},onCloseCreatePage(e){e.reload?this.getPages(e.newSelected):this.principalContainer="default"},onOpenCreateModel(e){e>0?(this.selectedPage=e,this.showInRightPanel="create-model"):console.error("No page id provided")},onOpenCreateDocument(e="1"){this.selectedDocument=null,this.createDocumentMandatory=e,this.createDocumentMode="create",this.formBuilderCreateDocumentKey++,this.showInRightPanel="create-document",this.setSectionShown("documents")},onEditDocument(e){this.selectedDocument=e,this.createDocumentMode="update",this.createDocumentMandatory=e.mandatory,this.formBuilderCreateDocumentKey++,this.showInRightPanel="create-document",this.setSectionShown("documents")},onDeleteDocument(){this.selectedDocument=null,this.showInRightPanel="hierarchy",this.setSectionShown("documents")},selectTab(e){this.leftPanel.tabs.forEach(t=>{t.active=t.title===e})},selectPage(e){this.selectedPage=e,this.setSectionShown("page")},setSectionShown(e){"documents"===e?(this.leftPanel.tabs.forEach((e,t)=>{this.leftPanel.tabs[t].displayed="Elements"!==e.title}),this.selectTab("Documents"),this.selectedPage=null):(this.leftPanel.tabs.forEach((e,t)=>{this.leftPanel.tabs[t].displayed="Documents"!==e.title}),this.selectTab("Elements")),this.showInSection=e},goTo(e,t=!1){const a=window.location.origin;t?window.open(a+e,"_blank"):window.location.href=a+e},clickGoBack(){"create-page"===this.principalContainer?this.onCloseCreatePage({reload:!1}):window.history.go(-1)}},computed:{currentPage(){return this.pages.find(e=>e.id===this.selectedPage)},leftPanelActiveTab(){return this.leftPanel.tabs.find(e=>e.active).title},displayedLeftPanels(){return this.leftPanel.tabs.filter(e=>e.displayed)}},watch:{"$store.state.formBuilder.lastSave":{handler(e){this.lastSave=e},deep:!0}}},Hn=Gn,zn=(a("8f19"),Object(b["a"])(Hn,Ss,As,!1,null,null,null)),Vn=zn.exports,Yn=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-w-100"},[t("div",[t("transition",{attrs:{name:"slide-right"}},[0===e.menuHighlight?t("div",{staticClass:"em-grid-3"},e._l(e.displayedMenus,(function(a,s){return t("div",{directives:[{name:"wave",rawName:"v-wave"}],key:"menu_"+a.index,staticClass:"em-shadow-cards col-md-3 em-hover-s-scale",staticStyle:{background:"var(--neutral-0)"},on:{click:function(t){return e.changeMenu(a)}}},[t("span",{staticClass:"material-icons-outlined em-main-500-color em-mb-16"},[e._v(e._s(a.icon))]),t("h4",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate(a.title)))]),t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate(a.description)))])])})),0):e._e()]),t("transition",{attrs:{name:"fade"}},[1===e.menuHighlight?t("StyleTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):2===e.menuHighlight?t("ContentTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):3===e.menuHighlight?t("FilesTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):9===e.menuHighlight?t("TranslationTool",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],ref:"translations",on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):5===e.menuHighlight?t("AttachmentStorage",{directives:[{name:"show",rawName:"v-show",value:e.modal_ready,expression:"modal_ready"}],on:{resetMenuIndex:function(t){e.menuHighlight=0}}}):e._e()],1)],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},qn=[],Jn=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-settings-menu"},[t("div",{staticClass:"em-w-80"},[t("div",{staticClass:"em-grid-3 em-mb-16"},[t("button",{staticClass:"em-primary-button em-mb-24",staticStyle:{width:"max-content"},on:{click:e.pushStatus}},[t("div",{staticClass:"add-button-div"},[t("em",{staticClass:"fas fa-plus em-mr-4"}),e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_STATUS"))+" ")])])]),t("draggable",{class:"draggables-list",attrs:{handle:".handle"},on:{end:e.updateStatusOrder},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.status,(function(a,s){return t("div",{key:a.step,staticClass:"em-mb-24",attrs:{title:"step_"+a.step,id:"step_"+a.step},on:{mouseover:function(t){return e.enableGrab(s)},mouseleave:function(t){return e.disableGrab()}}},[t("div",{staticClass:"em-flex-row em-flex-row-start em-w-100"},[t("span",{staticClass:"handle em-grab",style:e.grab&&e.indexGrab==s?"opacity: 1":"opacity: 0"},[t("span",{staticClass:"material-icons-outlined"},[e._v("drag_indicator")])]),t("div",{staticClass:"status-field"},[t("div",[t("p",{staticClass:"em-p-8-12 em-editable-content",attrs:{contenteditable:"true",id:"status_label_"+a.step},on:{focusout:function(t){return e.updateStatus(a)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.manageKeyup(a)},keydown:e.checkMaxlength}},[e._v(e._s(a.label[e.actualLanguage]))])]),t("input",{class:"label-"+a.class,attrs:{type:"hidden"}})]),t("div",{staticClass:"em-flex-row"},[t("v-swatches",{attrs:{swatches:e.swatches,shapes:"circles","row-length":"8","show-border":"","popover-x":"left","popover-y":"top"},on:{input:function(t){return e.updateStatus(a)}},model:{value:a.class,callback:function(t){e.$set(a,"class",t)},expression:"statu.class"}}),1==a.edit&&0!=a.step&&1!=a.step?t("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_DELETE_STATUS")},on:{click:function(t){return e.removeStatus(a,s)}}},[t("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("delete_outline")])]):t("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_CANNOT_DELETE_STATUS")}},[t("span",{staticClass:"material-icons-outlined em-text-neutral-600"},[e._v("delete_outline")])])],1)]),t("hr")])})),0)],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},Wn=[],Kn=a("b26c"),Xn=a.n(Kn);a("afdb");const Qn=a("bef5");var Zn={name:"editStatus",components:{VSwatches:Xn.a,draggable:Bt.a},props:{},mixins:[A],data(){return{index:"",indexGrab:"0",grab:0,loading:!1,status:[],show:!1,actualLanguage:"",swatches:[],colors:[],variables:null}},created(){let e=document.querySelector(":root");this.variables=getComputedStyle(e),this.prepareSwatchesColor(),this.getStatus(),this.actualLanguage=this.$store.getters["global/shortLang"]},methods:{prepareSwatchesColor(){this.swatches.push(this.variables.getPropertyValue("--em-red-1")),this.colors.push({name:"red-1",value:this.variables.getPropertyValue("--em-red-1")}),this.swatches.push(this.variables.getPropertyValue("--em-red-2")),this.colors.push({name:"red-2",value:this.variables.getPropertyValue("--em-red-2")}),this.swatches.push(this.variables.getPropertyValue("--em-pink-1")),this.colors.push({name:"pink-1",value:this.variables.getPropertyValue("--em-pink-1")}),this.swatches.push(this.variables.getPropertyValue("--em-pink-2")),this.colors.push({name:"pink-2",value:this.variables.getPropertyValue("--em-pink-2")}),this.swatches.push(this.variables.getPropertyValue("--em-purple-1")),this.colors.push({name:"purple-1",value:this.variables.getPropertyValue("--em-purple-1")}),this.swatches.push(this.variables.getPropertyValue("--em-purple-2")),this.colors.push({name:"purple-2",value:this.variables.getPropertyValue("--em-purple-2")}),this.swatches.push(this.variables.getPropertyValue("--em-light-blue-1")),this.colors.push({name:"light-blue-1",value:this.variables.getPropertyValue("--em-light-blue-1")}),this.swatches.push(this.variables.getPropertyValue("--em-light-blue-2")),this.colors.push({name:"light-blue-2",value:this.variables.getPropertyValue("--em-light-blue-2")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-1")),this.colors.push({name:"blue-1",value:this.variables.getPropertyValue("--em-blue-1")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-2")),this.colors.push({name:"blue-2",value:this.variables.getPropertyValue("--em-blue-2")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-3")),this.colors.push({name:"blue-3",value:this.variables.getPropertyValue("--em-blue-3")}),this.swatches.push(this.variables.getPropertyValue("--em-green-1")),this.colors.push({name:"green-1",value:this.variables.getPropertyValue("--em-green-1")}),this.swatches.push(this.variables.getPropertyValue("--em-green-2")),this.colors.push({name:"green-2",value:this.variables.getPropertyValue("--em-green-2")}),this.swatches.push(this.variables.getPropertyValue("--em-yellow-1")),this.colors.push({name:"yellow-1",value:this.variables.getPropertyValue("--em-yellow-1")}),this.swatches.push(this.variables.getPropertyValue("--em-yellow-2")),this.colors.push({name:"yellow-2",value:this.variables.getPropertyValue("--em-yellow-2")}),this.swatches.push(this.variables.getPropertyValue("--em-orange-1")),this.colors.push({name:"orange-1",value:this.variables.getPropertyValue("--em-orange-1")}),this.swatches.push(this.variables.getPropertyValue("--em-orange-2")),this.colors.push({name:"orange-2",value:this.variables.getPropertyValue("--em-orange-2")}),this.swatches.push(this.variables.getPropertyValue("--em-beige")),this.colors.push({name:"beige",value:this.variables.getPropertyValue("--em-beige")}),this.swatches.push(this.variables.getPropertyValue("--em-brown")),this.colors.push({name:"brown",value:this.variables.getPropertyValue("--em-brown")}),this.swatches.push(this.variables.getPropertyValue("--em-grey-1")),this.colors.push({name:"grey-1",value:this.variables.getPropertyValue("--em-grey-1")}),this.swatches.push(this.variables.getPropertyValue("--em-grey-2")),this.colors.push({name:"grey-2",value:this.variables.getPropertyValue("--em-grey-2")}),this.swatches.push(this.variables.getPropertyValue("--em-black")),this.colors.push({name:"black",value:this.variables.getPropertyValue("--em-black")})},getStatus(){p.a.get("index.php?option=com_emundus&controller=settings&task=getstatus").then(e=>{this.status=e.data.data,setTimeout(()=>{this.status.forEach(e=>{this.getHexColors(e)})},100)})},async updateStatus(e){this.$emit("updateSaving",!0);let t=this.colors.findIndex(t=>t.value===e.class);const a=new FormData;a.append("status",e.step),a.append("label",document.getElementById("status_label_"+e.step).textContent),a.append("color",this.colors[t].name),await h().post("index.php?option=com_emundus&controller=settings&task=updatestatus",a,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},async updateStatusOrder(){let e=[];this.status.forEach(t=>{e.push(t.step)}),this.$emit("updateSaving",!0);const t=new FormData;t.append("status",e.join(",")),await h().post("index.php?option=com_emundus&controller=settings&task=updatestatusorder",t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},pushStatus(){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=createstatus",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.status.push(e.data),setTimeout(()=>{this.getHexColors(e.data)},100),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},removeStatus(e,t){1==e.edit&&0!=e.step&&1!=e.step&&(this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=deletestatus",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Qn.stringify({id:e.id,step:e.step})}).then(()=>{this.status.splice(t,1),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))}))},manageKeyup(e){document.getElementById("status_label_"+e.step).textContent=document.getElementById("status_label_"+e.step).textContent.trim(),document.activeElement.blur()},getHexColors(e){e.translate=!1,e.class=this.variables.getPropertyValue("--em-"+e.class)},checkMaxlength(e){50===e.target.textContent.length&&8!=e.keyCode&&e.preventDefault()},enableGrab(e){1!==this.status.length&&(this.indexGrab=e,this.grab=!0)},disableGrab(){this.indexGrab=0,this.grab=!1}}},el=Zn,tl=(a("8090"),Object(b["a"])(el,Jn,Wn,!1,null,"c10697e8",null)),al=tl.exports,sl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-settings-menu"},[t("div",{staticClass:"em-w-80"},[t("div",{staticClass:"em-grid-3 em-mb-16"},[t("button",{staticClass:"em-primary-button em-mb-24",staticStyle:{width:"max-content"},on:{click:e.pushTag}},[t("div",{staticClass:"add-button-div"},[t("em",{staticClass:"fas fa-plus em-mr-4"}),e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_SETTINGS_ADDTAG"))+" ")])])]),e._l(e.tags,(function(a,s){return t("div",{key:"tag_"+a.id,staticClass:"em-mb-24",attrs:{id:"tag_"+a.id},on:{mouseover:function(t){return e.enableGrab(s)},mouseleave:function(t){return e.disableGrab()}}},[t("div",{staticClass:"em-flex-row em-flex-row-start em-w-100"},[t("div",{staticClass:"status-field"},[t("div",{staticStyle:{width:"100%"}},[t("p",{staticClass:"em-p-8-12 em-editable-content",attrs:{contenteditable:"true",id:"tag_label_"+a.id},on:{focusout:function(t){return e.updateTag(a)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.manageKeyup(a)},keydown:e.checkMaxlength}},[e._v(e._s(a.label))])]),t("input",{class:a.class,attrs:{type:"hidden"}})]),t("div",{staticClass:"em-flex-row"},[t("v-swatches",{attrs:{swatches:e.swatches,shapes:"circles","row-length":"8","show-border":"","popover-x":"left","popover-y":"top"},on:{input:function(t){return e.updateTag(a)}},model:{value:a.class,callback:function(t){e.$set(a,"class",t)},expression:"tag.class"}}),t("a",{staticClass:"em-flex-row em-ml-8 em-pointer",attrs:{type:"button",title:e.translate("COM_EMUNDUS_ONBOARD_DELETE_TAGS")},on:{click:function(t){return e.removeTag(a,s)}}},[t("span",{staticClass:"material-icons-outlined em-red-500-color"},[e._v("delete_outline")])])],1)]),t("hr")])}))],2)])},il=[];const nl=a("bef5");var ll={name:"editTags",components:{VSwatches:Xn.a,draggable:Bt.a},props:{},mixins:[A],data(){return{index:"",indexGrab:"0",grab:0,loading:!1,tags:[],show:!1,actualLanguage:"",swatches:[],colors:[],variables:null}},created(){let e=document.querySelector(":root");this.variables=getComputedStyle(e),this.prepareSwatchesColor(),this.getTags(),this.actualLanguage=this.$store.getters["global/shortLang"]},methods:{prepareSwatchesColor(){this.swatches.push(this.variables.getPropertyValue("--em-red-1")),this.colors.push({name:"red-1",value:this.variables.getPropertyValue("--em-red-1")}),this.swatches.push(this.variables.getPropertyValue("--em-red-2")),this.colors.push({name:"red-2",value:this.variables.getPropertyValue("--em-red-2")}),this.swatches.push(this.variables.getPropertyValue("--em-pink-1")),this.colors.push({name:"pink-1",value:this.variables.getPropertyValue("--em-pink-1")}),this.swatches.push(this.variables.getPropertyValue("--em-pink-2")),this.colors.push({name:"pink-2",value:this.variables.getPropertyValue("--em-pink-2")}),this.swatches.push(this.variables.getPropertyValue("--em-purple-1")),this.colors.push({name:"purple-1",value:this.variables.getPropertyValue("--em-purple-1")}),this.swatches.push(this.variables.getPropertyValue("--em-purple-2")),this.colors.push({name:"purple-2",value:this.variables.getPropertyValue("--em-purple-2")}),this.swatches.push(this.variables.getPropertyValue("--em-light-blue-1")),this.colors.push({name:"light-blue-1",value:this.variables.getPropertyValue("--em-light-blue-1")}),this.swatches.push(this.variables.getPropertyValue("--em-light-blue-2")),this.colors.push({name:"light-blue-2",value:this.variables.getPropertyValue("--em-light-blue-2")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-1")),this.colors.push({name:"blue-1",value:this.variables.getPropertyValue("--em-blue-1")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-2")),this.colors.push({name:"blue-2",value:this.variables.getPropertyValue("--em-blue-2")}),this.swatches.push(this.variables.getPropertyValue("--em-blue-3")),this.colors.push({name:"blue-3",value:this.variables.getPropertyValue("--em-blue-3")}),this.swatches.push(this.variables.getPropertyValue("--em-green-1")),this.colors.push({name:"green-1",value:this.variables.getPropertyValue("--em-green-1")}),this.swatches.push(this.variables.getPropertyValue("--em-green-2")),this.colors.push({name:"green-2",value:this.variables.getPropertyValue("--em-green-2")}),this.swatches.push(this.variables.getPropertyValue("--em-yellow-1")),this.colors.push({name:"yellow-1",value:this.variables.getPropertyValue("--em-yellow-1")}),this.swatches.push(this.variables.getPropertyValue("--em-yellow-2")),this.colors.push({name:"yellow-2",value:this.variables.getPropertyValue("--em-yellow-2")}),this.swatches.push(this.variables.getPropertyValue("--em-orange-1")),this.colors.push({name:"orange-1",value:this.variables.getPropertyValue("--em-orange-1")}),this.swatches.push(this.variables.getPropertyValue("--em-orange-2")),this.colors.push({name:"orange-2",value:this.variables.getPropertyValue("--em-orange-2")}),this.swatches.push(this.variables.getPropertyValue("--em-beige")),this.colors.push({name:"beige",value:this.variables.getPropertyValue("--em-beige")}),this.swatches.push(this.variables.getPropertyValue("--em-brown")),this.colors.push({name:"brown",value:this.variables.getPropertyValue("--em-brown")}),this.swatches.push(this.variables.getPropertyValue("--em-grey-1")),this.colors.push({name:"grey-1",value:this.variables.getPropertyValue("--em-grey-1")}),this.swatches.push(this.variables.getPropertyValue("--em-grey-2")),this.colors.push({name:"grey-2",value:this.variables.getPropertyValue("--em-grey-2")}),this.swatches.push(this.variables.getPropertyValue("--em-black")),this.colors.push({name:"black",value:this.variables.getPropertyValue("--em-black")})},getTags(){p.a.get("index.php?option=com_emundus&controller=settings&task=gettags").then(e=>{this.tags=e.data.data,setTimeout(()=>{this.tags.forEach(e=>{this.getHexColors(e)})},100)})},async updateTag(e){this.$emit("updateSaving",!0);let t=this.colors.findIndex(t=>t.value===e.class);const a=new FormData;a.append("tag",e.id),a.append("label",document.getElementById("tag_label_"+e.id).textContent),a.append("color",this.colors[t].name),await h().post("index.php?option=com_emundus&controller=settings&task=updatetags",a,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},pushTag(){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=createtag",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{this.tags.push(e.data),setTimeout(()=>{this.getHexColors(e.data)},100),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},removeTag(e,t){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=deletetag",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:nl.stringify({id:e.id})}).then(()=>{this.tags.splice(t,1),this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},manageKeyup(e){document.getElementById("tag_label_"+e.id).textContent=document.getElementById("tag_label_"+e.id).textContent.trim(),document.activeElement.blur()},getHexColors(e){e.translate=!1,e.class=this.variables.getPropertyValue("--em-"+e.class.replace("label-",""))},checkMaxlength(e){50===e.target.textContent.length&&8!=e.keyCode&&e.preventDefault()},enableGrab(e){1!==this.tags.length&&(this.indexGrab=e,this.grab=!0)},disableGrab(){this.indexGrab=0,this.grab=!1}}},rl=ll,ol=(a("ecd4"),Object(b["a"])(rl,sl,il,!1,null,"a0ff6a48",null)),cl=ol.exports,dl=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"translationTool"}},[t("modal",{attrs:{name:"translationTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{opened:e.checkSetup,closed:e.beforeClose}},[t("div",{staticClass:"em-modal-header"},[t("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("translationTool")}}},[t("div",{staticClass:"em-w-max-content em-flex-row"},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?t("div",{staticClass:"em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),t("div",{staticClass:"em-modal-content"},[t("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(a,s){return t("div",{key:"menu_"+a.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===a.index?"em-modal-menu__current":"",on:{click:function(t){e.currentMenu=a.index}}},[t("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(a.title)))]),3===a.index&&e.orphelins_count>0?t("div",{staticClass:"em-notifications-yellow"}):e._e()])})),0),t("transition",{attrs:{name:"fade"}},[1===e.currentMenu?t("Global",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component",on:{updateOrphelinsCount:e.updateOrphelinsCount}}):e._e(),2===e.currentMenu?t("Translations",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),3===e.currentMenu?t("Orphelins",{directives:[{name:"show",rawName:"v-show",value:!e.setup_success,expression:"!setup_success"}],staticClass:"em-modal-component"}):e._e()],1),e.setup_success?t("img",{staticClass:"em-success-animation",attrs:{alt:"checked-animation",src:"/images/emundus/animations/checked.gif"}}):e._e()],1),e.loading?t("div",[e.setup_success?e._e():t("div",{staticClass:"em-page-loader"}),e.setup_success?e._e():t("p",{staticClass:"em-page-loader-text"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SETUP_PROGRESSING")))]),e.setup_success?t("p",{staticClass:"em-page-loader-text em-fade-loader"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SETUP_SUCCESS")))]):e._e()]):e._e()])],1)},ml=[],ul=function(){var e=this,t=e._self._c;return t("div",[t("h1",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_GLOBAL")))]),t("div",{staticClass:"em-mb-24 em-flex-row em-flex-space-between"},[t("div",[t("p",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_DEFAULT")))]),t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_DEFAULT_DESC")))])]),t("div",{staticClass:"em-w-33"},[t("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.allLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!1},on:{select:e.updateDefaultLanguage},model:{value:e.defaultLang,callback:function(t){e.defaultLang=t},expression:"defaultLang"}})],1)]),t("div",{staticClass:"em-mb-24 em-flex-row em-flex-space-between"},[t("div",[t("p",{staticClass:"em-body-16-semibold em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SECONDARY")))]),t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SECONDARY_DESC")))])]),t("div",{staticClass:"em-w-33"},[t("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.otherLanguages,multiple:!0,taggable:!1,"select-label":"","selected-label":"","deselect-label":"","close-on-select":!1,"clear-on-select":!1,searchable:!1},on:{remove:e.unpublishLanguage,select:e.publishLanguage},model:{value:e.secondaryLanguages,callback:function(t){e.secondaryLanguages=t},expression:"secondaryLanguages"}}),t("a",{staticClass:"em-pointer em-blue-500-color em-mt-16 em-font-size-12 em-hover-blue-500",on:{click:e.purposeLanguage}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_OTHER_LANGUAGE")))])],1)]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},pl=[],_l={name:"global",props:{},components:{Multiselect:fe.a},data(){return{defaultLang:null,secondaryLanguages:[],allLanguages:[],otherLanguages:[],orphelins_count:0,loading:!1}},created(){this.loading=!0,ui.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages(),this.loading=!1})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data,this.allLanguages.forEach(e=>{e.lang_code!==this.defaultLang.lang_code&&(1==e.published&&this.secondaryLanguages.push(e),this.otherLanguages.push(e))}),this.secondaryLanguages.forEach(e=>{ui.getOrphelins(this.defaultLang.lang_code,e.lang_code).then(e=>{this.orphelins_count=e.data.length,this.$emit("updateOrphelinsCount",this.orphelins_count)})})}catch(e){return!1}},unpublishLanguage(e){ui.updateLanguage(e.lang_code,0)},publishLanguage(e){ui.updateLanguage(e.lang_code,1)},updateDefaultLanguage(e){ui.updateLanguage(e.lang_code,1,1).then(()=>{let t=this.secondaryLanguages.findIndex(t=>t.lang_code==e.lang_code);-1!==t&&this.secondaryLanguages.splice(t,1),this.getAllLanguages()})},async purposeLanguage(){const{value:e}=await j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE"),html:'<p class="em-body-16-semibold em-mb-8 em-text-align-left">'+this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_FIELD")+'</p><input id="language_purpose" class="em-input">',showCancelButton:!0,cancelButtonText:this.translate("COM_EMUNDUS_ONBOARD_CANCEL"),confirmButtonText:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SEND"),showLoaderOnConfirm:!0,reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"},preConfirm:()=>{const e=document.getElementById("language_purpose").value;return ui.sendMailToInstallLanguage(e)},allowOutsideClick:()=>!j.a.isLoading()});e&&await j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SENDED"),text:this.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SUGGEST_LANGUAGE_SENDED_TEXT"),showCancelButton:!1,showConfirmButton:!1,timer:3e3,customClass:{title:"em-swal-title"}})}}},hl=_l,gl=Object(b["a"])(hl,ul,pl,!1,null,"d8c82910",null),fl=gl.exports,vl=function(){var e=this,t=e._self._c;return t("div",[t("h1",{staticClass:"em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS")))]),t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE")))]),0!==e.availableLanguages.length||e.loading?t("div",{staticClass:"em-grid-4"},[t("div",[t("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},on:{select:e.getObjects},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1),e.lang?t("div",[t("multiselect",{attrs:{label:"name","track-by":"name",options:e.objects,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_OBJECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.object,callback:function(t){e.object=t},expression:"object"}})],1):e._e(),e.object?t("div",[t("multiselect",{attrs:{label:"label","track-by":"id",options:e.datas,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!0,"allow-empty":!0},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}})],1):e._e(),e.childrens.length>0?t("div",[t("multiselect",{attrs:{label:"label","track-by":"id",options:e.childrens,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT"),"close-on-select":!0,"clear-on-select":!1,searchable:!0,"allow-empty":!0},model:{value:e.children,callback:function(t){e.children=t},expression:"children"}})],1):e._e()]):t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_NO_LANGUAGES_AVAILABLE")))]),t("hr",{staticClass:"col-md-12",staticStyle:{"z-index":"0"}}),t("div",{staticClass:"col-md-12"},[""===e.lang||null==e.lang||""===e.object||null==e.object||!1===e.init_translations?t("div",{staticClass:"text-center em-mt-80"},[t("h5",{staticClass:"em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_TRANSLATION_TITLE")))]),t("p",{staticClass:"em-font-size-14 em-text-neutral-600"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_TRANSLATION_TEXT")))])]):t("div",["emundus_setup_profiles"===e.object.table.name?t("button",{staticClass:"float-right",on:{click:e.exportToCsv}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_EXPORT")))]):e._e(),e._l(e.object.fields.Sections,(function(a){return t("div",{staticClass:"em-mb-32"},[t("h4",{staticClass:"mb-2"},[e._v(e._s(a.Label))]),t("TranslationRow",{attrs:{section:a,translations:e.translations},on:{saveTranslation:e.saveTranslation}})],1)}))],2)]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},bl=[],Cl=function(){var e=this,t=e._self._c;return t("div",e._l(e.translations_rows,(function(a){return t("div",{staticClass:"em-mb-32 em-neutral-100-box em-p-24"},e._l(a,(function(a,s){return t("div",{staticClass:"em-mb-24"},[t("p",[e._v(e._s(a.reference_label?a.reference_label.toUpperCase():a.reference_id))]),t("div",{staticClass:"em-flex-space-between em-mt-16 em-grid-50 em-ml-24"},[t("p",{staticClass:"em-neutral-700-color"},[e._v(e._s(a.default_lang))]),"field"===a.field_type?t("input",{staticClass:"mb-0 em-input em-w-100",attrs:{type:"text"},domProps:{value:a.lang_to},on:{focusout:function(t){return e.saveTranslation(t.target.value,a)}}}):e._e(),"textarea"===a.field_type?t("textarea",{staticClass:"mb-0 em-input",domProps:{value:a.lang_to},on:{focusout:function(t){return e.saveTranslation(t.target.value,a)}}}):e._e()])])})),0)})),0)},Ol=[],yl={name:"TranslationRow",components:{Multiselect:fe.a},mixins:[A],props:{section:Object,translations:Array},data(){return{translations_rows:{},key_fields:[]}},created(){this.initTranslations()},methods:{initTranslations(){this.key_fields=Object.keys(this.$props.section.indexedFields),Object.values(this.$props.translations).forEach(e=>{Object.values(e).forEach(e=>{this.key_fields.includes(e.reference_field)&&e.reference_table===this.$props.section.Name&&(e.reference_field_order=this.key_fields.indexOf(e.reference_field),e.reference_label=this.$props.section.indexedFields[e.reference_field].Label,e.field_type=this.$props.section.indexedFields[e.reference_field].Type,e.hasOwnProperty("tag")||(e.tag=e.reference_field),this.translations_rows.hasOwnProperty(e.reference_id)||(this.translations_rows[e.reference_id]=[]),this.translations_rows[e.reference_id].push(e))})}),Object.values(this.translations_rows).forEach(e=>{e.sort((e,t)=>e.reference_field_order>t.reference_field_order?1:-1)})},async saveTranslation(e,t){this.$emit("saveTranslation",{value:e,translation:t})}}},El=yl,Dl=Object(b["a"])(El,Cl,Ol,!1,null,"07992dc4",null),Ml=Dl.exports,Sl={name:"Translations",components:{TranslationRow:Ml,Multiselect:fe.a},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],objects:[],datas:[],childrens:[],translations:{},lang:null,object:null,data:null,children_type:null,children:null,loading:!1,init_translations:!1}},created(){this.loading=!0,ui.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages().then(()=>{this.loading=!1})})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data;for(const t of this.allLanguages)t.lang_code!==this.defaultLang.lang_code&&1==t.published&&this.availableLanguages.push(t);1===this.availableLanguages.length&&(this.lang=this.availableLanguages[0],await this.getObjects())}catch(e){return this.loading=!1,!1}},async getObjects(){this.loading=!0,this.translations=[],this.childrens=[],this.datas=[],this.objects=[],this.object=null,this.data=null,this.children=null,ui.getObjects().then(e=>{this.objects=e.data,this.loading=!1})},async getDatas(e){this.loading=!0,ui.getDatas(e.table.name,e.table.reference,e.table.label,e.table.filters).then(async t=>{if(this.datas=t.data,console.log(e.table),"true"===e.table.load_all){let e=[];await this.asyncForEach(this.object.fields.Fields,async t=>{e.push(t.Name)}),e=e.join(",");const t=async()=>{for(const t of this.datas)await ui.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,t.id,e,this.object.table.name).then(async e=>{for(const a of Object.values(e.data))this.translations[t.id]={},this.object.fields.Fields.forEach(e=>{this.translations[t.id][e.Name]=a[e.Name]})});this.init_translations=!0,this.loading=!1};await t()}else"true"===e.table.load_first_data?this.data=this.datas[0]:this.loading=!1})},async getTranslations(e){let t=[];this.object.fields.Fields.forEach(e=>{t.push(e.Name)}),t=t.join(","),ui.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,e.id,t,this.object.table.name).then(e=>{this.translations=e.data,this.init_translations=!0,this.loading=!1})},async saveTranslation({value:e,translation:t}){this.$emit("updateSaving",!0),ui.updateTranslations(e,this.object.table.type,this.lang.lang_code,t.reference_id,t.tag,t.reference_table,t.reference_field).then(e=>{this.$emit("updateLastSaving",this.formattedDate("","LT")),this.$emit("updateSaving",!1)})},async exportToCsv(){window.open("index.php?option=com_emundus&controller=translations&task=export&profile="+this.data.id,"_blank")}},watch:{object:function(e){this.init_translations=!1,this.translations={},this.childrens=[],this.children=null,this.datas=[],this.data=null,null!=e&&this.getDatas(e)},data:function(e){this.loading=!0,this.init_translations=!1,this.translations={},this.childrens=[],this.children=null,this.children_type=null;var t=!1;null!=e?(this.object.fields.Fields.forEach(e=>{"children"===e.Type&&(this.children_type=e.Label,t=!0,ui.getChildrens(e.Label,this.data.id,e.Name).then(e=>{this.childrens=e.data,"true"===this.object.table.load_first_child&&(this.children=this.childrens[0]),this.loading=!1}))}),t||this.getTranslations(e)):this.getDatas(this.object)},children:function(e){if(this.loading=!0,this.init_translations=!1,this.translations={},null!=e){let t=[];this.object.fields.Sections.forEach(e=>{const a={table:e.Table,join_table:e.TableJoin,join_column:e.TableJoinColumn,reference_column:e.ReferenceColumn,fields:Object.keys(e.indexedFields)};t.push(a)}),ui.getTranslations(this.object.table.type,this.defaultLang.lang_code,this.lang.lang_code,e.id,"",t).then(e=>{this.translations=e.data,this.init_translations=!0,this.loading=!1})}else this.loading=!1}}},Al=Sl,Nl=Object(b["a"])(Al,vl,bl,!1,null,"5417bc14",null),wl=Nl.exports,Tl=function(){var e=this,t=e._self._c;return t("div",[t("h1",{staticClass:"em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELINS")))]),e.saving||null!=e.last_save?e._e():t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE")))]),e.saving?t("div",{staticClass:"em-mb-24 em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))]),0!==e.availableLanguages.length||e.loading?e._e():t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_NO_LANGUAGES_AVAILABLE")))]),0!==e.translations.length||e.loading?t("div",{staticClass:"em-grid-4"},[t("div",[t("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1)]):t("p",{staticClass:"em-font-size-14 em-mb-24 em-h-25"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHANS_CONGRATULATIONS")))]),t("hr",{staticClass:"col-md-12",staticStyle:{"z-index":"0"}}),t("div",{staticClass:"col-md-12"},[""===e.lang||null==e.lang||0===e.translations.length?t("div",{staticClass:"text-center em-mt-80"},[t("h5",{staticClass:"em-mb-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_ORPHELINS_TITLE")))]),""===e.lang||null==e.lang?t("p",{staticClass:"em-font-size-14 em-text-neutral-600"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_NO_ORPHELINS_TEXT")))]):e._e()]):t("div",e._l(e.translations,(function(a){return t("div",{key:a.id},[t("div",{staticClass:"em-mb-32 em-neutral-100-box em-p-24"},[t("div",{staticClass:"em-flex-space-between em-mt-16 em-grid-50"},[t("p",{staticClass:"em-neutral-700-color"},[e._v(e._s(a.override))]),t("div",[t("input",{ref:"translation-"+a.id,refInFor:!0,staticClass:"mb-0 em-input em-w-100",attrs:{type:"text"},domProps:{value:a.override}}),t("a",{staticClass:"em-pointer em-blue-500-color em-mt-16 em-font-size-12 em-hover-blue-500",on:{click:function(t){return e.saveTranslation(a)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELIN_CONFIRM_TRANSLATION")))])])])])])})),0)]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},Ul=[],Rl={name:"Orphelins",components:{Multiselect:fe.a},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],translations:[],lang:null,loading:!0,saving:!1,last_save:null}},created(){ui.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages()})},methods:{async getAllLanguages(){try{const e=await h().get("index.php?option=com_emundus&controller=translations&task=getlanguages");this.allLanguages=e.data;for(const t of this.allLanguages)t.lang_code!==this.defaultLang.lang_code&&1==t.published&&this.availableLanguages.push(t);1===this.availableLanguages.length?this.lang=this.availableLanguages[0]:this.loading=!1}catch(e){return this.loading=!1,!1}},async saveTranslation(e){this.saving=!0;const t=this.$refs["translation-"+e.id][0].value;t&&ui.insertTranslation(t,"override",this.lang.lang_code,e.reference_id,e.tag,e.reference_table).then(t=>{this.last_save=this.formattedDate("","LT"),this.saving=!1,this.translations=this.translations.filter((function(t){return t.id!==e.id}))})}},watch:{lang:function(e){null!==e&&void 0!==typeof e&&(this.loading=!0,this.translations=[],ui.getOrphelins(this.defaultLang.lang_code,e.lang_code).then(e=>{this.translations=e.data,this.loading=!1}))}}},xl=Rl,Ll=Object(b["a"])(xl,Tl,Ul,!1,null,"2ccb3e54",null),kl=Ll.exports,Il={name:"translationTool",props:{},components:{Orphelins:kl,Translations:wl,Global:fl},data(){return{orphelins_count:0,currentMenu:0,menus:[{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_GLOBAL",index:1},{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS",index:2},{title:"COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_ORPHELINS",index:3}],loading:!1,setup_success:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateOrphelinsCount(e){this.orphelins_count=e},checkSetup(){ui.checkSetup().then(e=>{0===e.data?(this.loading=!0,ui.configureSetup().then(e=>{1===e.data&&(this.loading=!1,this.setup_success=!0,this.currentMenu=1,setTimeout(()=>{this.setup_success=!1},2700))})):this.currentMenu=1})},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},Bl=Il,Pl=Object(b["a"])(Bl,dl,ml,!1,null,"44ee664e",null),Fl=Pl.exports,$l=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"contentTool"}},[t("modal",{attrs:{name:"contentTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[t("div",{staticClass:"em-modal-header"},[t("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("contentTool")}}},[t("div",{staticClass:"em-w-max-content em-flex-row"},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?t("div",{staticClass:"em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),t("div",{staticClass:"em-modal-content"},[t("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(a){return t("div",{key:"menu_"+a.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===a.index?"em-modal-menu__current":"",on:{click:function(t){e.currentMenu=a.index}}},[t("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(a.title)))])])})),0),e.selectedMenu?t("transition",{attrs:{name:"fade",mode:"out-in"}},["article"===e.selectedMenu.type?t("EditArticle",{key:e.currentMenu,staticClass:"em-modal-component",attrs:{article_id:e.selectedMenu.id,article_alias:e.selectedMenu.alias},on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):"footer"===e.selectedMenu.type?t("EditFooter",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1):e._e()],1),e.loading?t("div"):e._e()])],1)},jl=[],Gl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-settings-menu"},[t("div",{staticClass:"em-w-80"},[t("div",{staticClass:"em-grid-3 em-mb-16"},[t("multiselect",{attrs:{label:"title_native","track-by":"lang_code",options:e.availableLanguages,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_LANGUAGE"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!1},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1),t("div",{staticClass:"form-group controls"},[t("editor-quill",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content,enable_variables:!1,id:"editor"},on:{focusout:e.saveContent},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},Hl=[],zl={name:"editArticle",components:{EditorQuill:nt,Editor:Ti,Multiselect:fe.a},props:{actualLanguage:{type:String,default:"fr"},article_alias:{type:String,default:null},article_id:{type:Number,default:0}},mixins:[A],data(){return{defaultLang:null,availableLanguages:[],lang:null,loading:!1,dynamicComponent:0,form:{content:""}}},created(){this.loading=!0,ui.getDefaultLanguage().then(e=>{this.defaultLang=e,this.getAllLanguages(),this.loading=!1})},methods:{async getArticle(){let e={article_id:this.$props.article_id,lang:this.lang.lang_code,field:"introtext"};null!==this.$props.article_alias&&(e={article_alias:this.$props.article_alias,lang:this.lang.lang_code,field:"introtext"}),await h().get("index.php?option=com_emundus&controller=settings&task=getarticle",{params:e}).then(e=>{this.form.content=e.data.data.introtext,this.dynamicComponent++})},async saveContent(){this.$emit("updateSaving",!0);const e=new FormData;e.append("content",this.form.content),e.append("lang",this.lang.lang_code),null!==this.$props.article_alias?e.append("article_alias",this.$props.article_alias):e.append("article_id",this.$props.article_id),e.append("field","introtext"),await h().post("index.php?option=com_emundus&controller=settings&task=updatearticle",e,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},async getAllLanguages(){await ui.getAllLanguages().then(e=>{this.availableLanguages=e,this.lang=this.defaultLang})}},watch:{lang:function(){null!==this.lang?this.getArticle():(this.form.content="",this.dynamicComponent++)}}},Vl=zl,Yl=Object(b["a"])(Vl,Gl,Hl,!1,null,"38d360f0",null),ql=Yl.exports,Jl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-settings-menu"},[t("div",{staticClass:"em-w-80"},[t("div",{staticClass:"em-grid-3 em-mb-16"},[t("multiselect",{attrs:{label:"label","track-by":"index",options:e.columns,multiple:!1,taggable:!1,"select-label":"","selected-label":"","deselect-label":"",placeholder:e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_SELECT_COLUMN"),"close-on-select":!0,"clear-on-select":!1,searchable:!1,"allow-empty":!0},model:{value:e.selectedColumn,callback:function(t){e.selectedColumn=t},expression:"selectedColumn"}})],1),0===e.selectedColumn.index&&null!=this.form.content.col1?t("div",{staticClass:"form-group controls"},[t("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content.col1,lang:e.actualLanguage,enable_variables:!1,id:"editor_1"},on:{focusout:e.saveFooter},model:{value:e.form.content.col1,callback:function(t){e.$set(e.form.content,"col1",t)},expression:"form.content.col1"}})],1):e._e(),1===e.selectedColumn.index&&null!=this.form.content.col2?t("div",{staticClass:"form-group controls"},[t("editor",{key:e.dynamicComponent,attrs:{height:"30em",text:e.form.content.col2,lang:e.actualLanguage,enable_variables:!1,id:"editor_2"},on:{focusout:e.saveFooter},model:{value:e.form.content.col2,callback:function(t){e.$set(e.form.content,"col2",t)},expression:"form.content.col2"}})],1):e._e()]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])},Wl=[],Kl={name:"EditFooter",components:{Editor:Ti,Multiselect:fe.a},props:{actualLanguage:String},mixins:[A],data(){return{loading:!1,dynamicComponent:0,selectedColumn:0,form:{content:{col1:null,col2:null}},columns:[{index:0,label:this.translate("COM_EMUNDUS_ONBOARD_COLUMN")+" 1"},{index:1,label:this.translate("COM_EMUNDUS_ONBOARD_COLUMN")+" 2"}]}},created(){this.loading=!0,this.getArticles(),this.selectedColumn=this.columns[0]},methods:{async getArticles(){await h().get("index.php?option=com_emundus&controller=settings&task=getfooterarticles").then(e=>{this.form.content.col1=e.data.data.column1,this.form.content.col2=e.data.data.column2,this.loading=!1})},async saveFooter(){this.$emit("updateSaving",!0);const e=new FormData;e.append("col1",this.form.content.col1),e.append("col2",this.form.content.col2),await h().post("index.php?option=com_emundus&controller=settings&task=updatefooter",e,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})}},watch:{selectedColumn:function(){this.dynamicComponent++}}},Xl=Kl,Ql=Object(b["a"])(Xl,Jl,Wl,!1,null,"73ecf13c",null),Zl=Ql.exports,er={name:"contentTool",props:{},components:{EditFooter:Zl,EditArticle:ql},mixins:[A],data(){return{currentMenu:1,menus:[],loading:!1,saving:!1,last_save:null}},created(){let e=1;h().get("index.php?option=com_emundus&controller=settings&task=gethomearticle").then(t=>{this.menus.push({type:"article",id:t.data.data,title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_HOMEPAGE",index:e}),h().get("index.php?option=com_emundus&controller=settings&task=getrgpdarticles").then(t=>{t.data.data.forEach(t=>{e++,t.id?this.menus.push({type:"article",id:parseInt(t.id),title:t.title,index:e}):this.menus.push({type:"article",alias:t.alias,title:t.title,index:e})}),e++,this.menus.push({type:"footer",title:"COM_EMUNDUS_ONBOARD_CONTENT_TOOL_FOOTER",index:e})})})},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}},computed:{selectedMenu(){return this.menus.find(e=>e.index===this.currentMenu)}}},tr=er,ar=Object(b["a"])(tr,$l,jl,!1,null,"5cdc8ef6",null),sr=ar.exports,ir=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"filesTool"}},[t("modal",{attrs:{name:"filesTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[t("div",{staticClass:"em-modal-header"},[t("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("filesTool")}}},[t("div",{staticClass:"em-w-max-content em-flex-row"},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?t("div",{staticClass:"em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),t("div",{staticClass:"em-modal-content"},[t("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(a){return t("div",{key:"menu_"+a.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===a.index?"em-modal-menu__current":"",on:{click:function(t){e.currentMenu=a.index}}},[t("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(a.title)))])])})),0),t("transition",{attrs:{name:"fade",mode:"out-in"}},[1===e.currentMenu?t("EditStatus",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),2===e.currentMenu?t("EditTags",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),3===e.currentMenu?t("EditApplicants",{key:e.currentMenu,staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1)],1),e.loading?t("div"):e._e()])],1)},nr=[],lr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-settings-menu"},[t("div",{staticClass:"em-w-80"},e._l(e.params,(function(a,s){return t("div",{key:s,staticClass:"form-group em-flex-center em-w-100 em-mb-16"},[t("label",{attrs:{for:"param_"+s}},[e._v(e._s(a.label))]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"param.value"}],staticClass:"dropdown-toggle w-select",staticStyle:{"margin-bottom":"0"},attrs:{id:"param_"+s},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"value",t.target.multiple?s:s[0])},function(t){return e.saveEmundusParam(a)}]}},e._l(a.options,(function(a){return t("option",{key:a.value,domProps:{value:a.value}},[e._v(e._s(a.label))])})),0)])})),0)])},rr=[];const or=a("bef5");var cr={name:"EditApplicants",components:{},props:{},mixins:[A],data(){return{params:{applicant_can_renew:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_RENEW"),param:"applicant_can_renew",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1},{label:this.translate("COM_EMUNDUS_APPLICANT_CAN_RENEW_CAMPAIGN"),value:2},{label:this.translate("COM_EMUNDUS_APPLICANT_CAN_RENEW_YEAR"),value:3}],value:0},can_edit_until_deadline:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_EDIT_UNTIL_DEADLINE"),param:"can_edit_until_deadline",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1}],value:0},can_submit_encrypted:{label:this.translate("COM_EMUNDUS_ONBOARD_SETTINGS_APPLICANT_CAN_SUBMIT_ENCRYPTED"),param:"can_submit_encrypted",options:[{label:this.translate("JNO"),value:0},{label:this.translate("JYES"),value:1}],value:0}},config:{}}},created(){this.getEmundusParams()},methods:{getEmundusParams(){p.a.get("index.php?option=com_emundus&controller=settings&task=getemundusparams").then(e=>{this.config=e.data.config,this.params.applicant_can_renew.value=parseInt(this.config.applicant_can_renew),this.params.can_edit_until_deadline.value=parseInt(this.config.can_edit_until_deadline),this.params.copy_application_form.value=parseInt(this.config.copy_application_form),this.params.can_submit_encrypted.value=parseInt(this.config.can_submit_encrypted)})},saveEmundusParam(e){this.$emit("updateSaving",!0),p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=updateemundusparam",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:or.stringify({param:e.param,value:e.value})}).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})}}},dr=cr,mr=(a("ce46"),Object(b["a"])(dr,lr,rr,!1,null,"5dd811c8",null)),ur=mr.exports,pr={name:"filesTool",props:{},components:{EditApplicants:ur,EditTags:cl,EditStatus:al},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STATUS",index:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TAGS",index:2},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_APPLICANTS",index:3}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},_r=pr,hr=Object(b["a"])(_r,ir,nr,!1,null,"07063a76",null),gr=hr.exports,fr=function(){var e=this,t=e._self._c;return t("span",{class:"full-width-modal",attrs:{id:"styleTool"}},[t("modal",{attrs:{name:"styleTool",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[t("div",{staticClass:"em-modal-header"},[t("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("styleTool")}}},[t("div",{staticClass:"em-w-max-content em-flex-row"},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?t("div",{staticClass:"em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),t("div",{staticClass:"em-modal-content"},[t("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(a){return t("div",{key:"menu_"+a.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between pointer",class:e.currentMenu===a.index?"em-modal-menu__current":"",on:{click:function(t){e.currentMenu=a.index}}},[t("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(a.title)))])])})),0),t("transition",{attrs:{name:"fade"}},[1===e.currentMenu?t("General",{staticClass:"em-modal-component"}):e._e()],1)],1),e.loading?t("div"):e._e()])],1)},vr=[],br=function(){var e=this,t=e._self._c;return t("div",[t("ModalUpdateColors",{on:{UpdateColors:e.updateColors}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"em-grid-2"},[t("div",{staticClass:"em-style-options em-mb-32"},[t("div",{staticClass:"em-flex-row"},[t("div",[t("h4",{staticClass:"em-text-neutral-800 em-flex-row em-mb-8"},[e._v(" Logo "),t("span",{staticClass:"material-icons-outlined em-ml-4 em-font-size-16 em-pointer",on:{click:e.displayLogoTip}},[e._v("help_outline")])]),t("p",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, jpg, png, gif, svg")])]),t("p",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_LOGO_RECOMMENDED")))])])])]),e.logo_updating?e._e():t("div",{staticClass:"em-logo-box pointer em-mt-16"},[e.hideLogo?e._e():t("img",{staticClass:"logo-settings",attrs:{src:e.imageLink,srcset:"/"+e.imageLink},on:{error:function(t){e.hideLogo=!0}}}),e.hideLogo?t("p",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_INSERT_LOGO")))]):e._e()]),e.logo_updating?t("div",{staticClass:"em-mt-16"},[t("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.logoDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])])],1):e._e(),t("button",{staticClass:"em-mt-8 em-primary-button",on:{click:function(t){e.logo_updating=!e.logo_updating}}},[e.logo_updating?t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_CANCEL")))]):t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_UPDATE_LOGO")))])])]),t("div",{staticClass:"em-style-options em-mb-32"},[t("div",{staticClass:"em-flex-row"},[t("div",[t("h4",{staticClass:"em-text-neutral-800 em-flex-row em-mb-8"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ICON"))+" "),t("span",{staticClass:"material-icons-outlined em-ml-4 em-font-size-16 em-pointer",on:{click:e.displayFaviconTip}},[e._v("help_outline")])]),t("p",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, jpg, png")])]),t("p",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ICON_RECOMMENDED")))])])])]),e.favicon_updating?e._e():t("div",{staticClass:"em-logo-box pointer em-mt-16"},[e.hideIcon?e._e():t("img",{staticClass:"logo-settings",attrs:{src:e.iconLink,srcset:e.iconLink},on:{error:function(t){e.hideIcon=!0}}}),e.hideIcon?t("p",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_INSERT_ICON")))]):e._e()]),e.favicon_updating?t("div",{staticClass:"em-mt-16"},[t("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.faviconDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])])],1):e._e(),t("button",{staticClass:"em-mt-8 em-primary-button",on:{click:function(t){e.favicon_updating=!e.favicon_updating}}},[e.favicon_updating?t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_CANCEL")))]):t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_UPDATE_ICON")))])])]),t("div",{staticClass:"em-style-options em-mb-32"},[t("div",[t("h4",{staticClass:"em-text-neutral-800 em-flex-row em-mb-8"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_COLORS"))+" "),t("span",{staticClass:"material-icons-outlined em-ml-4 em-font-size-16 em-pointer",on:{click:e.displayColorsTip}},[e._v("help_outline")])]),t("span",{staticStyle:{opacity:"0"}},[e._v("Colors")]),t("br"),t("span",{staticStyle:{opacity:"0"}},[e._v("Colors")])]),t("div",{staticClass:"em-logo-box pointer em-mt-16"},[t("div",{staticClass:"color-preset",style:"background-color:"+e.primary+";border-right: 25px solid"+e.secondary})]),t("button",{staticClass:"em-mt-8 em-primary-button",on:{click:function(t){return e.$modal.show("modalUpdateColors")}}},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_UPDATE_COLORS")))])])]),e.bannerLink?t("div",{staticClass:"em-h-auto em-flex-col em-mb-32",staticStyle:{"align-items":"start"}},[t("div",{staticClass:"em-flex-row"},[t("div",[t("h4",{staticClass:"em-text-neutral-800 em-mb-8 em-flex-row"},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_BANNER"))+" "),t("span",{staticClass:"material-icons-outlined em-ml-4 em-font-size-16 em-pointer",on:{click:e.displayBannerTip}},[e._v("help_outline")])]),t("span",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_ALLOWED_FORMATS"))+" : jpeg, png")])]),t("br"),t("span",[t("em",[e._v(e._s(e.translate("COM_EMUNDUS_FORM_BUILDER_RECOMMENDED_SIZE"))+" : 1440x200px")])])])]),e.banner_updating?e._e():t("div",{staticClass:"em-logo-box pointer em-mt-16"},[t("img",{staticClass:"logo-settings",staticStyle:{width:"180px"},attrs:{src:e.bannerLink,srcset:"/"+e.bannerLink,alt:e.InsertBanner}})]),e.banner_updating?t("div",{staticClass:"em-mt-16"},[t("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone","include-styling":!1,options:e.bannerDropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_DROP_HERE"))+" ")])])],1):e._e(),t("button",{staticClass:"em-mt-8 em-primary-button",on:{click:function(t){e.banner_updating=!e.banner_updating}}},[e.banner_updating?t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_CANCEL")))]):t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_UPDATE_BANNER")))])])]):e._e()]),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},Cr=[],Or=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"modalUpdateColors"}},[t("modal",{attrs:{name:"modalUpdateColors",height:"auto","min-width":200,"min-height":200,delay:100,adaptive:!0,clickToClose:!1}},[t("div",{staticClass:"em-flex-row em-flex-space-between em-mb-16"},[t("h4",[e._v(" "+e._s(e.updateColors)+" ")]),t("button",{staticClass:"em-pointer em-transparent-button",on:{click:function(t){return t.preventDefault(),e.$modal.hide("modalUpdateColors")}}},[t("span",{staticClass:"material-icons-outlined"},[e._v("close")])])]),t("div",{staticClass:"em-grid-3"},e._l(e.presets,(function(a){return t("div",{staticClass:"preset-presentation",style:"background-color:"+a.primary+";border-right: 100px solid"+a.secondary,on:{click:function(t){return e.changeColors(a)}}})})),0)])],1)},yr=[];const Er=a("bef5");var Dr={name:"modalUpdateColors",props:{},components:{},data(){return{presets:[{primary:"#1b1f3c",secondary:"#de6339"},{primary:"#DA3832",secondary:"#204382"},{primary:"#727378",secondary:"#A0BD51"},{primary:"#727378",secondary:"#000000"},{primary:"#000000",secondary:"#5AA6DC"},{primary:"#A0BD51",secondary:"#204382"}],updateColors:this.translate("COM_EMUNDUS_ONBOARD_UPDATE_COLORS"),Retour:this.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR"),Continuer:this.translate("COM_EMUNDUS_ONBOARD_ADD_CONTINUER"),Error:this.translate("COM_EMUNDUS_ONBOARD_ERROR")}},methods:{changeColors(e){p()({method:"post",url:"index.php?option=com_emundus&controller=settings&task=updatecolor",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Er.stringify({preset:e})}).then(t=>{this.$emit("UpdateColors",e),this.$modal.hide("modalUpdateColors")})}}},Mr=Dr,Sr=(a("7756"),Object(b["a"])(Mr,Or,yr,!1,null,"48b0a5b0",null)),Ar=Sr.exports;const Nr=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <div data-dz-thumbnail-bg></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var wr={name:"global",props:{},components:{ModalUpdateColors:Ar,Multiselect:fe.a,vueDropzone:kt.a},data(){return{loading:!1,logo_updating:!1,favicon_updating:!1,banner_updating:!1,imageLink:"",iconLink:window.location.origin+"//images/custom/favicon.png?"+(new Date).getTime(),bannerLink:null,primary:"",secondary:"",changes:!1,hideIcon:!1,hideLogo:!1,InsertLogo:this.translate("COM_EMUNDUS_ONBOARD_INSERT_LOGO"),InsertIcon:this.translate("COM_EMUNDUS_ONBOARD_INSERT_ICON"),InsertBanner:this.translate("COM_EMUNDUS_ONBOARD_INSERT_BANNER"),logoDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updatelogo",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/*",previewTemplate:Nr(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" (10Mo).",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")},faviconDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updateicon",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/png,image/jpeg",previewTemplate:Nr(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" : 10Mo",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")},bannerDropzoneOptions:{url:"index.php?option=com_emundus&controller=settings&task=updatebanner",maxFilesize:10,maxFiles:1,autoProcessQueue:!0,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,resizeMimeType:"image/png",acceptedFiles:"image/png,image/jpeg",previewTemplate:Nr(),dictCancelUpload:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD"),dictCancelUploadConfirmation:this.translate("COM_EMUNDUS_ONBOARD_CANCEL_UPLOAD_CONFIRMATION"),dictRemoveFile:this.translate("COM_EMUNDUS_ONBOARD_REMOVE_FILE"),dictInvalidFileType:this.translate("COM_EMUNDUS_ONBOARD_INVALID_FILE_TYPE"),dictFileTooBig:this.translate("COM_EMUNDUS_ONBOARD_FILE_TOO_BIG")+" : 10Mo",dictMaxFilesExceeded:this.translate("COM_EMUNDUS_ONBOARD_MAX_FILES_EXCEEDED")}}},created(){this.loading=!0,this.changes=!1,p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getlogo"}).then(e=>{null==e.data.filename?this.imageLink="images/custom/logo.png":this.imageLink="images/custom/"+e.data.filename+"?"+(new Date).getTime(),setTimeout(()=>{this.changes=!0},1e3)}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getfavicon"}).then(e=>{null==e.data.filename?this.iconLink="images/custom/favicon.png":this.iconLink=e.data.filename+"?"+(new Date).getTime(),setTimeout(()=>{this.changes=!0},1e3)}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getbanner"}).then(e=>{null!=e.data.filename&&(this.bannerLink=e.data.filename),setTimeout(()=>{this.changes=!0},1e3)}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getbanner"}).then(e=>{null!=e.data.filename&&(this.bannerLink=e.data.filename),setTimeout(()=>{this.changes=!0},1e3),this.loading=!1}),p()({method:"get",url:"index.php?option=com_emundus&controller=settings&task=getappcolors"}).then(e=>{this.primary=e.data.primary,this.secondary=e.data.secondary,setTimeout(()=>{this.changes=!0},1e3),this.loading=!1})},methods:{updateView(e){this.hideLogo=!1,this.imageLink="images/custom/"+e.filename+"?"+(new Date).getTime(),document.querySelector('img[src="/images/custom/'+e.old_logo+'"]').src="/images/custom/"+e.filename+"?"+(new Date).getTime(),this.$forceUpdate()},updateIcon(e){this.hideIcon=!1,this.iconLink=window.location.origin+"//images/custom/"+e.filename+"?"+(new Date).getTime(),document.querySelector('link[type="image/x-icon"]').href=window.location.origin+"//images/custom/"+e.filename+"?"+(new Date).getTime(),document.querySelector(".tchooz-vertical-logo a img").src=window.location.origin+"//images/custom/"+e.filename+"?"+(new Date).getTime(),this.$forceUpdate()},updateBanner(e="png"){this.bannerLink="images/custom/default_banner."+e+"?"+(new Date).getTime(),this.$forceUpdate()},updateBanner(){this.bannerLink="images/custom/default_banner.png?"+(new Date).getTime(),this.$forceUpdate()},updateColors(e){this.primary=e.primary,this.secondary=e.secondary},beforeClose(e){},beforeOpen(e){},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(this.banner_updating||this.logo_updating||this.favicon_updating)&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){const t=e.name.split(".").pop();"success"==e.status&&(this.logo_updating&&(this.logo_updating=!1,this.updateView(JSON.parse(e.xhr.response))),this.favicon_updating&&(this.favicon_updating=!1,this.updateIcon(JSON.parse(e.xhr.response))),this.banner_updating&&(this.banner_updating=!1,this.updateBanner(t)),this.banner_updating&&(this.banner_updating=!1,this.updateBanner()))},catchError:function(e,t,a){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},thumbnail:function(e,t){var a,s,i,n;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),i=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),a=0,s=i.length;a<s;a++)n=i[a],n.alt=e.name,n.style.backgroundImage='url("'+t+'")';return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},uploadNewLogo(){this.$refs.dropzone.processQueue()},displayFaviconTip(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_ICON"),text:this.translate("COM_EMUNDUS_ONBOARD_ICON_TIP_TEXT"),showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_SWAL_OK_BUTTON"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}}).then(e=>{})},displayLogoTip(){j.a.fire({title:"Logo",text:this.translate("COM_EMUNDUS_ONBOARD_LOGO_TIP_TEXT"),showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_SWAL_OK_BUTTON"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},displayBannerTip(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_BANNER"),text:this.translate("COM_EMUNDUS_ONBOARD_BANNER_TIP_TEXT"),showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_SWAL_OK_BUTTON"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},displayColorsTip(){j.a.fire({title:this.translate("COM_EMUNDUS_ONBOARD_COLORS"),text:this.translate("COM_EMUNDUS_FORM_BUILDER_COLORS_RECOMMENDED"),showCancelButton:!1,confirmButtonText:this.translate("COM_EMUNDUS_SWAL_OK_BUTTON"),reverseButtons:!0,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},openFileInput(){setTimeout(()=>{document.getElementsByClassName("dz-clickable")[0].click()},300)}},watch:{logo_updating:function(e){e&&(this.favicon_updating=!1,this.banner_updating=!1,this.openFileInput())},favicon_updating:function(e){e&&(this.logo_updating=!1,this.banner_updating=!1,this.openFileInput())},banner_updating:function(e){e&&(this.favicon_updating=!1,this.logo_updating=!1,this.openFileInput())}}},Tr=wr,Ur=(a("7f8c"),Object(b["a"])(Tr,br,Cr,!1,null,"3d875e5e",null)),Rr=Ur.exports,xr={name:"styleTool",props:{},components:{General:Rr},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STYLE",index:1}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(e){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}},computed:{selectedMenu(){return this.menus.find(e=>e.index===this.currentMenu)}}},Lr=xr,kr=Object(b["a"])(Lr,fr,vr,!1,null,"11441714",null),Ir=kr.exports,Br=function(){var e=this,t=e._self._c;return t("span",{attrs:{id:"attachmentStorage"}},[t("modal",{attrs:{name:"attachmentStorage",height:"auto",transition:"fade",delay:100,adaptive:!0,clickToClose:!1},on:{closed:e.beforeClose}},[t("div",{staticClass:"em-modal-header"},[t("div",{staticClass:"em-flex-space-between em-flex-row em-pointer",on:{click:function(t){return t.preventDefault(),e.$modal.hide("attachmentStorage")}}},[t("div",{staticClass:"em-w-max-content em-flex-row"},[t("span",{staticClass:"material-icons-outlined"},[e._v("arrow_back")]),t("span",{staticClass:"em-ml-8"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ADD_RETOUR")))])]),e.saving?t("div",{staticClass:"em-flex-row em-flex-start"},[t("div",{staticClass:"em-loader em-mr-8"}),t("p",{staticClass:"em-font-size-14 em-flex-row"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_PROGRESS")))])]):e._e(),e.saving||null==e.last_save?e._e():t("p",{staticClass:"em-font-size-14"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_TRANSLATION_TOOL_TRANSLATIONS_AUTOSAVE_LAST")+e.last_save))])])]),t("div",{staticClass:"em-modal-content"},[t("div",{staticClass:"em-modal-menu__sidebar"},e._l(e.menus,(function(a){return t("div",{key:"menu_"+a.index,staticClass:"translation-menu-item em-p-16 em-flex-row em-flex-space-between em-pointer",class:e.currentMenu===a.index?"em-modal-menu__current":"",on:{click:function(t){e.currentMenu=a.index}}},[t("p",{staticClass:"em-font-size-16"},[e._v(e._s(e.translate(a.title)))])])})),0),t("transition",{attrs:{name:"fade",mode:"out-in"}},[1===e.currentMenu?t("Configuration",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),2===e.currentMenu?t("Storage",{staticClass:"em-modal-component",on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e()],1)],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()])],1)},Pr=[],Fr=function(){var e=this,t=e._self._c;return t("div",[t("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_CONFIGURATION")))]),t("div",{staticClass:"em-flex-row"},[t("ul",{staticClass:"nav nav-tabs topnav"},e._l(e.integrations,(function(a,s){return t("li",{key:"integration-"+s},[t("a",{staticClass:"em-neutral-700-color em-pointer",class:e.currentIntegration===s?"w--current":""},[e._v(" "+e._s(e.translate(a))+" ")])])})),0)]),0===e.currentIntegration?t("IntegrationGED",{attrs:{site:e.site,level_max:e.level_max},on:{updateSaving:e.updateSaving,updateLastSaving:e.updateLastSaving}}):e._e(),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},$r=[],jr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-mt-32"},[t("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_CONF_WRITING")))]),t("div",{staticClass:"em-flex-row em-mb-16"},[t("span",{staticClass:"material-icons"},[e._v("folder")]),t("span",{staticClass:"em-ml-8 em-mr-8"},[e._v("/"+e._s(e.site))]),t("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[t("span",{staticClass:"tooltip-target b3 material-icons"},[e._v("more_horiz")]),t("template",{slot:"popover"},[t("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300",on:{click:function(t){return e.addNode(null)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_ADD_MENU")))])])],2)],1),e._l(e.nodes,(function(a){return t("div",[t("Tree",{attrs:{node:a,level_max:e.level_max,emundus_tags:e.emundus_tags},on:{addNode:e.addNode,deleteNode:e.deleteNode,saveConfig:e.saveConfig}})],1)})),t("hr"),e.buildedComponent?t("FilesName",{attrs:{name:e.name},on:{updateName:e.updateName}}):e._e(),t("hr"),t("Aspects",{attrs:{aspects:e.aspects},on:{"update-aspects":e.updateAspects}})],2)},Gr=[],Hr=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"em-flex-row em-mb-16",class:"em-level-"+e.node.level},[0!==e.node.type?t("span",{staticClass:"material-icons"},[e._v("folder")]):t("span",{staticClass:"material-icons-outlined"},[e._v("folder")]),!e.other_tags.includes(e.node.type)&&0!==e.node.type||""===e.node.type?t("input",{staticClass:"em-ml-8 em-mr-8 em-xs-input em-w-auto tree-branch",attrs:{type:"text"},domProps:{value:e.node.type},on:{focusout:function(t){return e.updateNodeType(t)}}}):t("select",{directives:[{name:"model",rawName:"v-model",value:e.node.type,expression:"node.type"}],staticClass:"em-ml-8 em-mr-8 em-clear-dropdown tree-branch",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.node,"type",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"0",selected:""}},[e._v("/"+e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SELECT_TYPE")))]),e._l(e.fieldsData,(function(a){return t("option",{domProps:{value:a.value}},[e._v(e._s(e.translate(a.label)))])}))],2),t("v-popover",{attrs:{popoverArrowClass:"custom-popover-arrow"}},[t("span",{staticClass:"tooltip-target b3 material-icons"},[e._v("more_horiz")]),t("template",{slot:"popover"},[!e.other_tags.includes(e.node.type)&&0!==e.node.type||""===e.node.type?t("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300",on:{click:function(t){e.node.type=0}}},[e._v(" "+e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GO_BACK_TO_SELECT"))+" ")]):e._e(),e.node.level<e.level_max?t("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300",on:{click:function(t){return e.$emit("addNode",e.node)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_ADD_MENU")))]):e._e(),t("div",{staticClass:"em-font-size-14 em-pointer em-p-8-12 em-hover-background-neutral-300 em-red-500-color",on:{click:function(t){return e.$emit("deleteNode",e.node)}}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_DELETE")))])])],2)],1),e._l(e.node.childrens,(function(a){return t("div",{staticClass:"em-flex-row",class:"em-level-"+a.level},[t("Tree",{attrs:{node:a,level_max:e.level_max,emundus_tags:e.emundus_tags},on:{addNode:e.addNode,deleteNode:e.deleteNode,saveConfig:function(t){return e.$emit("saveConfig")}}})],1)}))],2)},zr=[],Vr={default:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_CAMPAIGN_TYPE",value:"[CAMPAIGN_LABEL]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_FILE_TYPE",value:"[FNUM]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_USER_TYPE",value:"[APPLICANT_ID]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_YEAR_TYPE",value:"[CAMPAIGN_YEAR]",field:"none"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_OTHER",value:"",field:"text"}]},Yr={name:"Tree",props:{node:{type:Object,required:!0},level_max:{type:Number,default:3},emundus_tags:Array},data(){return{fieldsData:[],other_tags:[]}},mounted(){this.fieldsData=Vr["default"],this.fieldsData.forEach(e=>{this.other_tags.push(e.value)})},methods:{addNode(e){this.$emit("addNode",e)},deleteNode(e){this.$emit("deleteNode",e)},updateNodeType(e){this.node.type=e.target.value}},watch:{"node.type":function(){this.$emit("saveConfig")}}},qr=Yr,Jr=(a("c555"),Object(b["a"])(qr,Hr,zr,!1,null,"83858e82",null)),Wr=Jr.exports,Kr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-mt-16"},[t("div",{staticClass:"em-flex-row em-flex-space-between"},[t("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_WRITING")))]),t("div",{staticClass:"em-flex-row"},[t("a",{staticClass:"em-mr-16 em-pointer em-blue-500-color em-hover-blue-500",attrs:{href:"component/emundus/?view=export_select_columns&format=html&layout=all_programs&Itemid=1173",target:"_blank"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_TAGS_LIST")))]),t("div",{staticClass:"em-pointer em-blue-500-color",on:{click:e.resetName}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_RESET")))])])]),t("div",{staticClass:"em-name-preview em-mb-16 em-flex-row",class:0===e.selectedTags.length?"em-name-preview-error":""},e._l(e.selectedTags,(function(a,s){return t("div",{staticClass:"em-flex-row"},[t("span",[e._v(e._s(a.value))]),s+1!==e.selectedTags.length?t("div",[e._v(e._s(e.selectedSeparator))]):e._e()])})),0),0===e.selectedTags.length?t("div",{staticClass:"em-red-500-color em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_NAME_SELECT_A_TAG")))]):e._e(),t("div",{staticClass:"em-flex-row"},[t("multiselect",{attrs:{label:"label","track-by":"value",options:e.tags,multiple:!0,taggable:!0,"tag-placeholder":"Ajouter une balise","select-label":"","selected-label":"","deselect-label":"",placeholder:"Ajouter une balise"},on:{tag:e.addTag},model:{value:e.new_tag,callback:function(t){e.new_tag=t},expression:"new_tag"}}),e._l(e.selectedTags,(function(a,s){return t("div",{key:s,staticClass:"em-ml-16 em-flex-row em-tag-preview"},[t("span",[e._v(e._s(a.label))]),t("span",{staticClass:"material-icons em-pointer em-ml-8",on:{click:function(t){return e.removeTag(a.value)}}},[e._v("close")])])}))],2),t("div",{staticClass:"em-flex-row em-mt-16"},[t("span",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SEPARATOR"))+" : ")]),e._l(e.separators,(function(a){return t("div",{staticClass:"em-ml-16 em-separator em-pointer",class:e.selectedSeparator===a?"em-selected-separator":"",on:{click:function(t){e.selectedSeparator=a}}},[t("span",[e._v(e._s(a))])])}))],2)])},Xr=[],Qr={name:"FilesName",components:{Multiselect:fe.a},props:{name:String},data(){return{loading:!1,new_tag:"",tags:[{label:"N de dossier",value:"[FNUM]"},{label:"Nom du candidat",value:"[APPLICANT_NAME]"},{label:"Type de document",value:"[DOCUMENT_TYPE]"}],separators:["-","_"],selectedTags:[],selectedSeparator:""}},created(){L.getSetupTags().then(e=>{if(e.status&&e.data.forEach(e=>{this.tags.find(t=>t.value=="["+e.tag+"]")||this.tags.push({label:e.description,value:"["+e.tag+"]"})}),""!==this.name){this.selectedSeparator=-1===this.name.indexOf("-")?"_":"-";let e=[];if("_"==this.selectedSeparator){const t=this.name.split("]_[");t.forEach((t,a)=>{t=t.replace(/\[/g,""),t=t.replace(/]/g,""),""!==t&&e.push(t)})}else this.name=this.name.replace(/\[/g,""),this.name=this.name.replace(/]/g,""),e=this.name.split(this.selectedSeparator);e.forEach((t,a)=>{e[a]="["+t+"]";let s=this.tags.findIndex((function(e,a){if(e.value==="["+t+"]")return!0}));-1!==s&&this.selectedTags.push(this.tags[s])})}else this.selectedSeparator="-",0===this.selectedTags.length&&this.resetName()})},methods:{addTag(e){const t={label:e,value:e};this.tags.push(t),this.selectedTags.push(t),this.updateName()},removeTag(e){let t=this.selectedTags.findIndex((function(t,a){if(t.value===e)return!0}));this.selectedTags.splice(t,1),this.updateName()},resetName(){this.selectedTags=[{label:"N de dossier",value:"[FNUM]"},{label:"Type de document",value:"[DOCUMENT_TYPE]"}],this.updateName()},updateName(){let e="";this.selectedTags.forEach((t,a)=>{a!=this.selectedTags.length-1?e=e+t.value+this.selectedSeparator:(e+=t.value,this.$emit("updateName",e))})}},watch:{new_tag:function(e){if(""!==e){const t=e[0];this.selectedTags.push(t),this.updateName()}this.new_tag=""},selectedSeparator:function(){this.updateName()}}},Zr=Qr,eo=(a("d7bb"),Object(b["a"])(Zr,Kr,Xr,!1,null,"ec02e80c",null)),to=eo.exports,ao=function(){var e=this,t=e._self._c;return t("section",[t("div",{staticClass:"em-h4 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS")))]),e.aspects.length<1&&e.upload?t("div",{staticClass:"em-flex-row",attrs:{id:"no-aspects"}},[t("input",{staticClass:"em-m-0",attrs:{type:"file",id:"aspect-file",accept:".xml"}}),t("div",{staticClass:"em-primary-button em-w-33 em-ml-16 em-pointer",on:{click:e.uploadAspectFile}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD")))])]):t("div",{attrs:{id:"aspects"}},[t("div",{staticClass:"em-h5 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_MAPPING")))]),e._l(e.aspects,(function(a){return t("div",{key:a.name,staticClass:"em-mb-16"},[t("div",{staticClass:"em-flex-row em-flex-space-between"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.label,expression:"aspect.label"}],attrs:{type:"text",disabled:""},domProps:{value:a.label},on:{input:function(t){t.target.composing||e.$set(a,"label",t.target.value)}}}),t("span",{staticClass:"material-icons"},[e._v("sync_alt")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.mapping,expression:"aspect.mapping"}],on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"mapping",t.target.multiple?s:s[0])},e.updateAspectMapping]}},e._l(e.tags,(function(a){return t("option",{key:a.id,domProps:{value:a.id}},[e._v(e._s(a.tag))])})),0)])])})),e.upload?t("div",[t("div",{staticClass:"em-h6 em-mb-16"},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD_ADD_FROM_FILE")))]),t("div",{staticClass:"em-flex-row",attrs:{id:"add-aspects-from-file"}},[t("input",{attrs:{type:"file",id:"update-aspect-file",accept:".xml"}}),t("div",{staticClass:"em-primary-button em-pointer",on:{click:e.updateAspectListFromFile}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_UPLOAD_ADD")))])])]):e._e()],2)])},so=[],io={name:"Aspects",props:{aspects:{type:Array,default:[]},upload:{type:Boolean,default:!0}},data(){return{tags:[]}},mounted(){this.getTags()},methods:{getTags(){L.getSetupTags().then(e=>{this.tags=e.data})},uploadAspectFile(){let e=document.getElementById("aspect-file").files[0];"undefined"!==typeof e&&null!==e?L.uploadAspectFile(e).then(e=>{this.aspects=e.data.data,this.$emit("update-aspects",this.aspects)}):Swal.fire({type:"warning",title:this.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_GED_ALFRESCO_ASPECTS_MISSING_ASPECT_FILE"),timer:5e3,customClass:{title:"em-swal-title",confirmButton:"em-swal-confirm-button",actions:"em-swal-single-action"}})},updateAspectListFromFile(){let e=document.getElementById("update-aspect-file").files[0];L.updateAspectListFromFile(e).then(e=>{this.aspects=e.data.data,this.$emit("update-aspects",this.aspects)})},updateAspectMapping(e){this.$emit("update-aspects",this.aspects)}}},no=io,lo=(a("92dd"),Object(b["a"])(no,ao,so,!1,null,null,null)),ro=lo.exports,oo={name:"IntegrationGED",components:{FilesName:to,Tree:Wr,Aspects:ro},mixins:[A],props:{site:String,level_max:{type:Number,default:3}},data(){return{loading:!1,buildedComponent:!1,emundus_tags:[],nodes:[],aspects:[],name:""}},created(){L.getConfig("ged").then(e=>{null!==e.data.data&&(this.nodes=e.data.data.tree,this.name=e.data.data.name,this.aspects=e.data.data.aspects),this.buildedComponent=!0})},methods:{addNode(e){if(null===e){let e=1;"undefined"!==typeof this.nodes[this.nodes.length-1]&&(e=this.nodes[this.nodes.length-1].id++);let t={id:e,level:1,type:0,parent:0,childrens:[]};this.nodes.push(t)}else{let t=e.level+1,a=e.id+"_1";if("undefined"!==typeof e.childrens[e.childrens.length-1]){let t=e.childrens.length+1;a=e.id+"_"+t}let s={id:a,level:t,type:0,parent:e.id,childrens:[]};e.childrens.push(s)}this.saveConfig()},deleteNode(e){this.deleteNodeById(this.nodes,e.id),this.saveConfig()},deleteNodeById(e,t){for(let a=0;a<e.length;a++){if(e[a].id===t)return void e.splice(a,1);e[a].childrens.length>0&&this.deleteNodeById(e[a].childrens,t)}},updateName(e){this.name=e,this.nodes.length>0&&this.saveConfig()},updateAspects(e){this.aspects=e,this.saveConfig()},saveConfig(){this.$emit("updateSaving",!0);let e={tree:this.nodes,name:this.name,aspects:this.aspects};L.saveConfig(e,"ged").then(()=>{this.$emit("updateLastSaving",this.formattedDate("","LT")),this.$emit("updateSaving",!1)})}}},co=oo,mo=Object(b["a"])(co,jr,Gr,!1,null,"7442d7a2",null),uo=mo.exports,po={name:"Configuration",components:{IntegrationGED:uo},data(){return{loading:!1,em_params:{},integrations:[],currentIntegration:0,site:null,level_max:null}},created(){this.loading=!0,Te.getEmundusParams().then(e=>{this.em_params=e.data.config,1===parseInt(this.em_params.external_storage_ged_alfresco_integration)&&(this.integrations.push("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO"),this.site=this.em_params.external_storage_ged_alfresco_site,this.level_max=parseInt(this.em_params.external_storage_ged_alfresco_max_level)),this.loading=!1})},methods:{updateSaving(e){this.$emit("updateSaving",e)},updateLastSaving(e){this.$emit("updateLastSaving",e)}}},_o=po,ho=(a("da3d"),Object(b["a"])(_o,Fr,$r,!1,null,"47f83f82",null)),go=ho.exports,fo=function(){var e=this,t=e._self._c;return t("div",[t("h2",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE")))]),t("table",[t("thead",[t("tr",[t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_DOCTYPE")))]),t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STATUS")))]),t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE_TYPE")))]),t("th",[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNCHRO")))])]),e._l(e.documents,(function(a){return t("tr",[t("td",{on:{click:function(t){return e.openAttachmentParameters(a)}}},[e._v(e._s(a.value))]),t("td"),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.sync,expression:"document.sync"}],staticClass:"em-mr-8 em-clear-dropdown",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"sync",t.target.multiple?s:s[0])},function(t){return e.updateSync(a.id,a.sync)}]}},e._l(e.syncTypes,(function(a){return t("option",{domProps:{value:a.value}},[e._v(e._s(e.translate(a.label)))])})),0)]),t("td",[0!=a.sync?t("select",{directives:[{name:"model",rawName:"v-model",value:a.sync_method,expression:"document.sync_method"}],staticClass:"em-mr-8 em-clear-dropdown",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"sync_method",t.target.multiple?s:s[0])},function(t){return e.updateSyncMethod(a.id,a.sync_method)}]}},[t("option",{attrs:{selected:""},domProps:{value:"write"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNC_WRITE")))]),t("option",{domProps:{value:"read"}},[e._v(e._s(e.translate("COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_SYNC_READ")))])]):e._e()])])}))],2)]),t("modal",{staticClass:"em-h-100 em-w-25",attrs:{name:"attachmentParameters",transition:"fade",delay:100,adaptive:!0,id:"modal-attachment-parameters"}},[t("AttachmentParameters",{attrs:{attachment:e.selectedDocument}})],1),e.loading?t("div",{staticClass:"em-page-loader"}):e._e()],1)},vo=[],bo={sync_type:[{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SYNC_TYPE_LOCAL",value:"0"},{label:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_GED_ALFRESCO_SYNC_TYPE_GED",value:"1"}]},Co=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-container"},[t("div",{staticClass:"em-h4"},[e._v(" "+e._s(e.attachment.value)+" ")]),1==e.attachment.sync?t("AttachmentAspectsMapping",{attrs:{attachment:e.attachment}}):e._e()],1)},Oo=[],yo=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-mt-16",attrs:{id:"attachment-aspects-mapping"}},[t("div",{staticClass:"em-flex-row em-flex-start",attrs:{id:"default-aspects-toggle"}},[t("div",{staticClass:"em-toggle"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.aspectsConfig.default,expression:"aspectsConfig.default"}],staticClass:"em-toggle-check",attrs:{type:"checkbox","true-value":!0,"false-value":!1,id:"default-aspects",name:"'default-aspects'"},domProps:{checked:Array.isArray(e.aspectsConfig.default)?e._i(e.aspectsConfig.default,null)>-1:e.aspectsConfig.default},on:{click:function(t){e.aspectsConfig.default=!e.aspectsConfig.default,e.saveAttachmentAspects()},change:function(t){var a=e.aspectsConfig.default,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&e.$set(e.aspectsConfig,"default",a.concat([n])):l>-1&&e.$set(e.aspectsConfig,"default",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(e.aspectsConfig,"default",i)}}}),t("strong",{staticClass:"b em-toggle-switch"}),t("strong",{staticClass:"b em-toggle-track"})]),t("label",{attrs:{for:"default-aspects"}},[e._v(e._s(e.translate("COM_EMUNDUS_ATTACHMENT_STORAGE_DEFAULT_ASPECTS_MAPPING")))])]),0==e.aspectsConfig.default?t("div",[t("Aspects",{attrs:{aspects:e.aspectsConfig.aspects,upload:!1},on:{"update-aspects":e.saveAttachmentAspects}})],1):e._e()])},Eo=[],Do={name:"AttachmentAspectsMapping",components:{Aspects:ro},props:{attachment:{type:Object,required:!0}},data(){return{tags:[],aspectsConfig:{default:!0,aspects:[]}}},created(){this.getAttachmentAspectsConfig()},methods:{getAttachmentAspectsConfig(){L.getConfig("ged").then(e=>{e.data.data.aspects&&(this.aspectsConfig.aspects=e.data.data.aspects)}).then(()=>{L.getAttachmentAspectsConfig(this.attachment.id).then(e=>{const t=("string"===typeof e.data||e.data instanceof String)&&JSON.parse(e.data);t&&(this.aspectsConfig=t)})})},saveAttachmentAspects(){L.saveAttachmentAspectsConfig(this.attachment.id,this.aspectsConfig)}}},Mo=Do,So=(a("1fd0"),Object(b["a"])(Mo,yo,Eo,!1,null,null,null)),Ao=So.exports,No={name:"AttachmentParameters",components:{AttachmentAspectsMapping:Ao},props:{attachment:{type:Object,required:!0}},data(){return{syncType:""}}},wo=No,To=Object(b["a"])(wo,Co,Oo,!1,null,null,null),Uo=To.exports,Ro={name:"Storage",components:{AttachmentParameters:Uo},mixins:[A],data(){return{loading:!1,documents:[],syncTypes:[],selectedDocument:{}}},mounted(){this.syncTypes=bo["sync_type"]},created(){L.getDocuments().then(e=>{this.documents=e.data.data})},methods:{updateSync(e,t){this.$emit("updateSaving",!0),L.updateSync(e,t).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},updateSyncMethod(e,t){this.$emit("updateSaving",!0),L.updateSyncMethod(e,t).then(()=>{this.$emit("updateSaving",!1),this.$emit("updateLastSaving",this.formattedDate("","LT"))})},openAttachmentParameters(e){this.selectedDocument=e,this.$modal.show("attachmentParameters")}}},xo=Ro,Lo=(a("9f4d"),Object(b["a"])(xo,fo,vo,!1,null,"5489a6f0",null)),ko=Lo.exports,Io={name:"attachmentStorage",props:{},components:{Storage:ko,Configuration:go},data(){return{currentMenu:1,menus:[{title:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_CONFIGURATION",index:1},{title:"COM_EMUNDUS_ONBOARD_ATTACHMENT_STORAGE_STORAGE",index:2}],loading:!1,saving:!1,last_save:null}},methods:{beforeClose(){this.$emit("resetMenuIndex")},updateSaving(e){this.saving=e},updateLastSaving(e){this.last_save=e}}},Bo=Io,Po=Object(b["a"])(Bo,Br,Pr,!1,null,"c1ae86ac",null),Fo=Po.exports,$o={name:"globalSettings",components:{StyleTool:Ir,AttachmentStorage:Fo,FilesTool:gr,ContentTool:sr,TranslationTool:Fl,EditStatus:al,EditTags:cl},props:{actualLanguage:{type:String,default:"fr"},coordinatorAccess:{type:Number,default:1},manyLanguages:{type:Number,default:1}},data:()=>({menuHighlight:0,currentTitle:"",langue:0,saving:!1,endSaving:!1,loading:!1,em_params:{},menus:[{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STYLE",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_STYLE_DESC",icon:"style",index:1,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_CONTENT",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_CONTENT_DESC",icon:"notes",index:2,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_FILES_TOOL",description:"COM_EMUNDUS_ONBOARD_SETTINGS_FILES_TOOL_DESC",icon:"source",index:3,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TRANSLATIONS",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_TRANSLATIONS_DESC",icon:"language",index:9,access:1},{title:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_ATTACHMENT_STORAGE",description:"COM_EMUNDUS_ONBOARD_SETTINGS_MENU_ATTACHMENT_STORAGE_DESC",icon:"inventory_2",index:5,access:0}],modal_ready:!1}),created(){this.loading=!0,Te.getEmundusParams().then(e=>{this.em_params=e.data.config,this.menus[0].access=void 0!=this.em_params.style?parseInt(this.em_params.style):1,this.menus[1].access=void 0!=this.em_params.content?parseInt(this.em_params.content):1,this.menus[2].access=1,this.menus[3].access=void 0!=this.em_params.translations?parseInt(this.em_params.translations):1,this.menus[4].access=void 0!=this.em_params.attachment_storage?parseInt(this.em_params.attachment_storage):0,this.loading=!1})},methods:{changeMenu(e){setTimeout(()=>{this.menuHighlight=e.index,this.currentTitle=e.title},200)}},computed:{displayedMenus(){return this.menus.filter(e=>1===e.access)}},watch:{menuHighlight:function(e){this.modal_ready=!1,setTimeout(()=>{switch(e){case 1:this.$modal.show("styleTool"),this.modal_ready=!0;break;case 2:this.$modal.show("contentTool"),this.modal_ready=!0;break;case 3:this.$modal.show("filesTool"),this.modal_ready=!0;break;case 9:this.$modal.show("translationTool"),this.modal_ready=!0;break;case 5:this.$modal.show("attachmentStorage"),this.modal_ready=!0;break;default:break}},500)}}},jo=$o,Go=(a("3616"),Object(b["a"])(jo,Yn,qn,!1,null,"3a3a8930",null)),Ho=Go.exports,zo=function(){var e=this,t=e._self._c;return t("div",{staticClass:"messages__coordinator_vue em-w-100"},[t("div",{staticClass:"messages__list col-md-12"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("div",{staticClass:"messages__list-block",attrs:{id:"messages__list"}},e._l(e.dates,(function(a){return t("div",[t("div",{staticClass:"messages__date-section"},[t("hr"),t("p",[e._v(e._s(e.moment(a.dates).format("DD/MM/YYYY")))]),t("hr")]),e._l(e.messages,(function(s){return a.messages.includes(s.message_id)?t("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(t){e.showDate!=s.message_id?e.showDate=s.message_id:e.showDate=0}}},[t("p",[t("span",{staticClass:"messages__message-item-from"},[e._v(e._s(s.name)+" - "+e._s(e.moment(s.date_time).format("HH:mm")))])]),t("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user",domProps:{innerHTML:e._s(s.message)}}),t("p",[e.showDate==s.message_id?t("span",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(s.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),0),t("transition",{attrs:{name:"slide-up",type:"transition"}},[e.attachOpen?t("AttachDocument",{ref:"attachment",attrs:{user:e.user,fnum:e.fnum,applicant:!1},on:{pushAttachmentMessage:e.pushAttachmentMessage}}):e._e()],1),t("div",{staticClass:"messages__bottom-input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text",rows:"1",spellcheck:"true",placeholder:e.translations.writeMessage},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.sendMessage(t))},input:function(t){t.target.composing||(e.message=t.target.value)}}})]),t("div",{staticClass:"messages__bottom-input-actions"},[t("div",{staticClass:"messages__actions_bar"},[t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/attached.svg"},on:{click:e.attachDocument}})]),t("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},Vo=[],Yo=(a("367a"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"messages__vue_attach_document"},[t("span",{attrs:{id:"attach_documents"+e.fnum}},[t("div",{attrs:{name:"attach_documents"+e.fnum,transition:"nice-modal-fade",adaptive:!0,height:"auto",width:"30%",scrollable:!0,delay:100,clickToClose:!0},on:{closed:e.beforeClose,opened:e.getTypesByCampaign}},[t("div",{staticClass:"messages__attach_content"},[e.applicant?e._e():t("ul",{staticClass:"messages__attach_actions_tabs"},[t("li",{staticClass:"messages__attach_action",class:1===e.action?"messages__attach_action__current":"",on:{click:function(t){e.action=1}}},[e._v(e._s(e.translations.sendDocument))]),t("li",{staticClass:"messages__attach_action",class:2===e.action?"messages__attach_action__current":"",on:{click:function(t){e.action=2}}},[e._v(e._s(e.translations.askDocument))])]),1===e.action?t("div",[e.applicant?t("label",[e._v(e._s(e.translations.sendDocument))]):e._e(),e.applicant&&e.types.length>0?t("div",{staticClass:"messages__attach_applicant_doc"},[t("label",{attrs:{for:"applicant_attachment_input"}},[e._v(e._s(e.translations.typeAttachment))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.attachment_input,expression:"attachment_input"}],attrs:{id:"applicant_attachment_input"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachment_input=t.target.multiple?a:a[0]}}},[t("option",{domProps:{value:0}},[e._v(e._s(e.translations.pleaseSelect))]),e._l(e.types,(function(a){return t("option",{domProps:{value:a.id}},[e._v(e._s(a.value))])}))],2)]):e._e(),t("vue-dropzone",{ref:"dropzone",attrs:{id:"customdropzone_messenger","include-styling":!1,options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-file-added":e.afterAdded,"vdropzone-thumbnail":e.thumbnail,"vdropzone-removed-file":e.afterRemoved,"vdropzone-complete":e.onComplete,"vdropzone-error":e.catchError,"vdropzone-sending":e.sendingEvent}},[t("div",{staticClass:"dropzone-custom-content",attrs:{id:"dropzone-message"}},[t("em",{staticClass:"fas fa-file-image"}),e._v(" "+e._s(e.translations.DropHere)+" ")])]),e.applicant?t("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")]):e._e()],1):e._e(),2===e.action?t("div",[t("label",{attrs:{for:"attachment_input"}},[e._v(e._s(e.translations.typeAttachment))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.attachment_input,expression:"attachment_input"}],attrs:{id:"attachment_input"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.attachment_input=t.target.multiple?a:a[0]}}},[t("option",{domProps:{value:0}},[e._v(e._s(e.translations.pleaseSelect))]),e._l(e.types,(function(a){return t("option",{domProps:{value:a.id}},[e._v(e._s(a.value))])}))],2)]):e._e()])])]),e.loading?t("div",{staticClass:"loader"}):e._e()])}),qo=[];const Jo=a("bef5"),Wo=()=>'\n<div class="dz-preview dz-file-preview">\n  <div class="dz-image">\n    <img src="/images/emundus/messenger/file_download.svg" style="max-width: 50px"/>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n</div>\n';var Ko={name:"AttachDocument",props:{user:Number,fnum:String,applicant:Boolean},components:{vueDropzone:kt.a},data(){return{translations:{sendDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND_DOCUMENT"),askDocument:Joomla.JText._("COM_EMUNDUS_MESSENGER_ASK_DOCUMENT"),DropHere:Joomla.JText._("COM_EMUNDUS_MESSENGER_DROP_HERE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),typeAttachment:Joomla.JText._("COM_EMUNDUS_MESSENGER_TYPE_ATTACHMENT"),pleaseSelect:Joomla.JText._("COM_EMUNDUS_PLEASE_SELECT")},types:[],message_input:"",attachment_input:0,loading:!1,action:1,dropzoneOptions:{url:"index.php?option=com_emundus&controller=messenger&task=uploaddocument&fnum="+this.fnum+"&applicant="+this.applicant,maxFilesize:10,maxFiles:5,autoProcessQueue:!1,addRemoveLinks:!0,thumbnailWidth:null,thumbnailHeight:null,previewTemplate:Wo()}}},methods:{beforeClose(){},afterAdded(){document.getElementById("dropzone-message").style.display="none"},afterRemoved(){0===this.$refs.dropzone.getAcceptedFiles().length&&(document.getElementById("dropzone-message").style.display="block")},onComplete:function(e){this.message_input="",console.log(e),"success"==e.status&&this.$emit("pushAttachmentMessage",JSON.parse(e.xhr.response).data)},sendingEvent(e,t,a){a.append("message",this.message_input),a.append("attachment",this.attachment_input)},catchError:function(e,t,a){j.a.fire({title:Joomla.JText._("COM_EMUNDUS_ONBOARD_ERROR"),text:t,type:"error",showCancelButton:!1,showConfirmButton:!1,timer:3e3}),this.$refs.dropzone.removeFile(e)},thumbnail:function(e,t){var a,s,i,n;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),i=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),a=0,s=i.length;a<s;a++)n=i[a],n.alt=e.name,n.style.backgroundImage='url("'+t+'")';return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},getTypesByCampaign(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getdocumentsbycampaign",params:{fnum:this.fnum,applicant:this.applicant},paramsSerializer:e=>Jo.stringify(e)}).then(e=>{this.types=e.data.data})},askAttachment(){p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=askattachment",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jo.stringify({fnum:this.fnum,attachment:this.attachment_input,message:this.message_input})}).then(e=>{this.$emit("pushAttachmentMessage",e.data.data)})},sendMessage(e){1===this.action?(this.applicant||(this.message_input=e),this.$refs.dropzone.processQueue()):this.attachment_input&&(this.message_input="Demande de document : ",this.message_input+=e,this.askAttachment())}}},Xo=Ko,Qo=(a("d7c7"),Object(b["a"])(Xo,Yo,qo,!1,null,"5b3e8f50",null)),Zo=Qo.exports;const ec=a("bef5");var tc={name:"MessagesCoordinator",props:{},components:{AttachDocument:Zo},data(){return{fnum:String,user:Number,dates:[],messages:[],fileSelected:0,message:"",loading:!1,showDate:0,counter:0,attachOpen:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),writeMessage:Joomla.JText._("COM_EMUNDUS_MESSENGER_WRITE_MESSAGE")}}},methods:{moment(e){return r()(e)},getMessagesByFnum(e=!0,t=!0){this.loading=e,p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getmessagesbyfnum",params:{fnum:this.fileSelected},paramsSerializer:e=>ec.stringify(e)}).then(e=>{this.messages=e.data.data.messages,this.dates=e.data.data.dates,this.markAsRead(),"undefined"!=typeof document.getElementsByClassName("notifications-counter")[0]&&document.getElementsByClassName("notifications-counter")[0].remove(),t&&this.scrollToBottom(),this.loading=!1})},markAsRead(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=markasread",params:{fnum:this.fileSelected},paramsSerializer:e=>ec.stringify(e)}).then(e=>{this.$emit("removeNotifications",e.data.data)})},sendMessage(e){"undefined"!=typeof e&&e.stopImmediatePropagation(),this.attachOpen?(this.$refs.attachment.sendMessage(this.message),this.message=""):""!==this.message.trim()&&p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ec.stringify({message:this.message,fnum:this.fileSelected})}).then(e=>{this.message="",this.pushToDatesArray(e.data),this.scrollToBottom()})},pushToDatesArray(e){var t=!1,a=e.date_time.split(" ")[0];if(this.dates.forEach((s,i)=>{s.dates==a&&(this.dates[i].messages.push(e.message_id),t=!0)}),!t){var s={dates:this.moment().format("YYYY-MM-DD"),messages:[]};s.messages.push(e.message_id),this.dates.push(s)}this.messages.push(e)},scrollToBottom(){setTimeout(()=>{const e=document.getElementsByClassName("messages__list-block")[0];e.scrollTop=e.scrollHeight},500)},attachDocument(){this.attachOpen=!this.attachOpen,setTimeout(()=>{this.attachOpen&&this.$refs.attachment.getTypesByCampaign()},500)},pushAttachmentMessage(e){this.pushToDatesArray(e),this.scrollToBottom(),this.attachDocument()}},created(){this.fnum=this.$store.getters["global/datas"].fnum.value,this.user=this.$store.getters["global/datas"].user.value,"undefined"!=typeof this.fnum&&(this.fileSelected=this.fnum,this.getMessagesByFnum(),setInterval(()=>{this.getMessagesByFnum(!1,!1)},2e4))},watch:{fileSelected:function(){this.getMessagesByFnum(!0)}}},ac=tc,sc=(a("07df"),Object(b["a"])(ac,zo,Vo,!1,null,null,null)),ic=sc.exports,nc=function(){var e=this,t=e._self._c;return t("div",{staticClass:"messages__vue"},[t("span",{attrs:{id:"messages"}},[t("modal",{attrs:{name:"messages",transition:"nice-modal-fade",adaptive:!0,height:"90%",width:"90%",scrollable:!0,delay:100,clickToClose:!0,draggable:".drag-window"},on:{closed:e.beforeClose,opened:e.getFilesByUser}},[t("div",{staticClass:"em-flex-row em-flex-align-start em-w-100 em-h-100 em-small-flex-column"},[t("div",{staticClass:"messages__campaigns-list"},e._l(e.files,(function(a){return t("div",{staticClass:"messages__block",class:a.fnum==e.fileSelected?"messages__active-campaign":"",on:{click:function(t){e.fileSelected=a.fnum}}},[t("div",{staticClass:"messages__campaign-block em-w-100"},[t("div",{staticClass:"em-w-100"},[t("p",{staticClass:"messages__campaigns_title"},[e._v(e._s(a.label))]),t("p",{staticClass:"messages__campaigns_fnum messages__campaigns_title"},[e._v("N "+e._s(a.fnum))]),t("p",{staticClass:"messages__campaigns_fnum messages__campaigns_title"},[e._v(e._s(a.year))])])]),t("div")])})),0),t("div",{staticClass:"messages__campaigns-list-select"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.fileSelected,expression:"fileSelected"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.fileSelected=t.target.multiple?a:a[0]}}},e._l(e.files,(function(a){return t("option",{domProps:{value:a.fnum}},[e._v(e._s(a.label)+" - "+e._s(a.fnum))])})),0)]),t("div",{staticClass:"messages__list em-w-100 em-h-100"},[t("div",{staticClass:"message__header"},[t("label",{staticClass:"text-center",staticStyle:{width:"100%"}},[e._v(e._s(e.translations.messages))]),t("i",{staticClass:"fas fa-times pointer",on:{click:function(t){return e.$modal.hide("messages")}}})]),t("div",{staticClass:"messages__list-block em-h-80",attrs:{id:"messages__list"}},[e._l(e.dates,(function(a){return t("div",[t("div",{staticClass:"messages__date-section"},[t("hr"),t("p",[e._v(e._s(e.moment(a.dates).format("DD/MM/YYYY")))]),t("hr")]),e._l(e.messages,(function(s){return a.messages.includes(s.message_id)?t("div",{staticClass:"messages__message-item",class:e.user==s.user_id_from?"messages__current_user":"messages__other_user"},[t("div",{staticClass:"messages__message-item-block",class:e.user==s.user_id_from?"messages__text-align-right":"messages__text-align-left",on:{click:function(t){e.showDate!=s.message_id?e.showDate=s.message_id:e.showDate=0}}},[t("p",[t("span",{staticClass:"messages__message-item-from"},[0===e.anonymous&&e.user!=s.user_id_from?t("span",[e._v(e._s(s.name)+" - ")]):e._e(),e.user==s.user_id_from?t("span",[e._v(e._s(s.name)+" - ")]):e._e(),e._v(" "+e._s(e.moment(s.date_time).format("HH:mm"))+" ")])]),t("span",{staticClass:"messages__message-item-span",class:e.user==s.user_id_from?"messages__message-item-span_current-user":"messages__message-item-span_other-user",domProps:{innerHTML:e._s(s.message)}}),t("p",[e.showDate==s.message_id?t("span",{staticClass:"messages__message-item-from"},[e._v(e._s(e.moment(s.date_time).format("DD/MM/YYYY HH:mm")))]):e._e()])])]):e._e()}))],2)})),t("transition",{attrs:{name:"slide-up",type:"transition"}},[e.attachOpen?t("AttachDocument",{ref:"attachment",attrs:{user:e.user,fnum:e.fileSelected,applicant:!0},on:{pushAttachmentMessage:e.pushAttachmentMessage}}):e._e()],1)],2),t("div",{staticStyle:{position:"sticky",bottom:"15px",padding:"0 15px","margin-right":"15px"}},[t("div",{staticClass:"messages__bottom-input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"messages__input_text",attrs:{type:"text",rows:"1",disabled:e.send_progress,spellcheck:"true",placeholder:e.translations.writeMessage},domProps:{value:e.message},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.sendMessage(t))},input:function(t){t.target.composing||(e.message=t.target.value)}}})]),t("div",{staticClass:"messages__bottom-input-actions"},[t("div",{staticClass:"messages__actions_bar"},[t("img",{staticClass:"messages__send-icon",attrs:{src:"/images/emundus/messenger/attached.svg"},on:{click:e.attachDocument}})]),t("button",{staticClass:"messages__send_button",attrs:{type:"button"},on:{click:e.sendMessage}},[e._v(" "+e._s(e.translations.send)+" ")])])])])])])],1),e.loading?t("div",{staticClass:"loader"}):e._e()])},lc=[];const rc=a("bef5");var oc={name:"Messages",props:{user:Number,fnum:String,notifications:Object},components:{AttachDocument:Zo},data(){return{dates:[],messages:[],anonymous:0,files:[],fileSelected:0,message:"",loading:!1,interval:0,showDate:0,attachOpen:!1,send_progress:!1,translations:{messages:Joomla.JText._("COM_EMUNDUS_MESSENGER_TITLE"),send:Joomla.JText._("COM_EMUNDUS_MESSENGER_SEND"),writeMessage:Joomla.JText._("COM_EMUNDUS_MESSENGER_WRITE_MESSAGE")}}},methods:{moment(e){return r()(e)},beforeClose(){clearInterval(this.interval)},getFilesByUser(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getfilesbyuser"}).then(e=>{this.files=e.data.data,""!=this.fnum?this.fileSelected=this.fnum:this.fileSelected=this.files[0].fnum,this.getMessagesByFnum(!0),this.interval=setInterval(()=>{this.getMessagesByFnum(!1,!1)},2e4)})},getMessagesByFnum(e=!0,t=!0){this.loading=e,p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=getmessagesbyfnum",params:{fnum:this.fileSelected},paramsSerializer:e=>rc.stringify(e)}).then(e=>{this.messages=e.data.data.messages,this.dates=e.data.data.dates,this.anonymous=parseInt(e.data.data.anonymous),this.markAsRead(),t&&this.scrollToBottom(),this.loading=!1})},markAsRead(){p()({method:"get",url:"index.php?option=com_emundus&controller=messenger&task=markasread",params:{fnum:this.fileSelected},paramsSerializer:e=>rc.stringify(e)}).then(e=>{this.$emit("removeNotifications",e.data.data)})},sendMessage(e){"undefined"!=typeof e&&e.stopImmediatePropagation(),""===this.message.trim()||this.send_progress||(this.send_progress=!0,p()({method:"post",url:"index.php?option=com_emundus&controller=messenger&task=sendmessage",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:rc.stringify({message:this.message,fnum:this.fileSelected})}).then(e=>{this.message="",this.send_progress=!1,this.pushToDatesArray(e.data),this.scrollToBottom()}))},pushToDatesArray(e){var t=!1,a=e.date_time.split(" ")[0];if(this.dates.forEach((s,i)=>{s.dates==a&&(this.dates[i].messages.push(e.message_id),t=!0)}),!t){var s={dates:this.moment().format("YYYY-MM-DD"),messages:[]};s.messages.push(e.message_id),this.dates.push(s)}this.messages.push(e)},scrollToBottom(){setTimeout(()=>{const e=document.getElementById("messages__list");e.scrollTop=e.scrollHeight},500)},attachDocument(){this.attachOpen=!this.attachOpen,this.scrollToBottom(),setTimeout(()=>{this.attachOpen&&this.$refs.attachment.getTypesByCampaign()},500)},pushAttachmentMessage(e){this.pushToDatesArray(e),this.scrollToBottom(),this.attachOpen=!this.attachOpen}},watch:{fileSelected:function(){this.getMessagesByFnum(!0)}}},cc=oc,dc=(a("c8b4"),Object(b["a"])(cc,nc,lc,!1,null,null,null)),mc=dc.exports,uc={props:{datas:NamedNodeMap,currentLanguage:String,shortLang:String,manyLanguages:String,coordinatorAccess:String,sysadminAccess:String,defaultLang:{type:String,default:"fr"},component:{type:String,required:!0},data:{type:Object,default:()=>({})}},components:{Attachments:V,addcampaign:dt,addformnextcampaign:Ms,addemail:Et,formbuilder:Vn,settings:Ho,messagescoordinator:ic,messages:mc,Files:Ae,list_v2:Le},created(){"attachments"===this.$props.component&&F.isDataAnonymized().then(e=>{!1!==e.status&&this.$store.dispatch("global/setAnonyme",e.anonyme)}),this.data.attachments&&(this.data.attachments=JSON.parse(atob(this.data.attachments))),"undefined"!=typeof this.$props.datas&&this.$store.commit("global/initDatas",this.$props.datas),"undefined"!=typeof this.$props.currentLanguage?(this.$store.commit("global/initCurrentLanguage",this.$props.currentLanguage),r.a.locale(this.$store.state.global.currentLanguage)):(this.$store.commit("global/initCurrentLanguage","fr"),r.a.locale("fr")),"undefined"!=typeof this.$props.shortLang&&this.$store.commit("global/initShortLang",this.$props.shortLang),"undefined"!=typeof this.$props.manyLanguages&&this.$store.commit("global/initManyLanguages",this.$props.manyLanguages),"undefined"!=typeof this.$props.defaultLang&&this.$store.commit("global/initDefaultLang",this.$props.defaultLang),"undefined"!=typeof this.$props.coordinatorAccess&&this.$store.commit("global/initCoordinatorAccess",this.$props.coordinatorAccess),"undefined"!=typeof this.$props.coordinatorAccess&&this.$store.commit("global/initSysadminAccess",this.$props.sysadminAccess),Te.getOffset().then(e=>{!1!==e.status&&this.$store.commit("global/initOffset",e.data.data)})},mounted(){this.data.base&&this.$store.dispatch("attachment/setAttachmentPath",this.data.base+"/images/emundus/files/")}},pc=uc,_c=(a("8ba5"),Object(b["a"])(pc,i,n,!1,null,null,null)),hc=_c.exports,gc=a("209f"),fc=a.n(gc),vc=a("3332"),bc=a("4859"),Cc=(a("9e26"),a("c2ca")),Oc=a("66d6"),yc=a.n(Oc),Ec=a("6db0"),Dc=a.n(Ec),Mc=a("7cdb"),Sc=a("94ea");const Ac={datas:[],currentLanguage:"",shortLang:"",manyLanguages:"",defaultLang:"",coordinatorAccess:"",sysadminAccess:!1,anonyme:!1,offset:0},Nc={datas:e=>e.datas,currentLanguage:e=>e.currentLanguage,shortLang:e=>e.shortLang,manyLanguages:e=>e.manyLanguages,defaultLang:e=>e.defaultLang,coordinatorAccess:e=>e.coordinatorAccess,sysadminAccess:e=>e.sysadminAccess,offset:e=>e.offset},wc={setLang({commit:e},t){e("setLang",t)},setAnonyme({commit:e},t){e("setAnonyme",t)}},Tc={initDatas(e,t){return e.datas=t,e.datas},initCurrentLanguage(e,t){return e.currentLanguage=t,e.currentLanguage},initOffset(e,t){return e.offset=t,e.offset},initShortLang(e,t){return e.shortLang=t,e.shortLang},initManyLanguages(e,t){return e.manyLanguages=t,e.manyLanguages},initDefaultLang(e,t){return e.defaultLang=t,e.defaultLang},initCoordinatorAccess(e,t){return e.coordinatorAccess=t,e.coordinatorAccess},initSysadminAccess(e,t){return e.sysadminAccess=t,e.sysadminAccess},setAnonyme(e,t){e.anonyme=t}};var Uc={namespaced:!0,state:Ac,getters:Nc,actions:wc,mutations:Tc};const Rc={users:{},currentUser:0,displayedUser:0,rights:{}},xc={},Lc={setUsers({commit:e},t){e("setUser",t)},setCurrentUser({commit:e},t){e("setCurrentUser",t)},setDisplayedUser({commit:e},t){e("setDisplayedUser",t)},setAccessRights({commit:e},t){e("setAccessRights",t)}},kc={setUser(e,t){t&&t.length>0&&t.forEach(t=>{e.users[t.user_id]=t})},setCurrentUser(e,t){e.currentUser=t},setDisplayedUser(e,t){e.displayedUser=t},setAccessRights(e,t){e.rights[t.fnum]=t.rights}};var Ic={namespaced:!0,state:Rc,getters:xc,actions:Lc,mutations:kc};const Bc={attachmentPath:"images/emundus/files/",attachments:{},selectedAttachment:{},previews:{},categories:{},checkedAttachments:[]},Pc={},Fc={setAttachments({commit:e},t){e("setAttachments",t)},setAttachmentsOfFnum({commit:e},t){e("setAttachmentsOfFnum",t)},updateAttachmentOfFnum({commit:e},t){e("updateAttachmentOfFnum",t)},setSelectedAttachment({commit:e},t){e("setSelectedAttachment",t)},setPreview({commit:e},t){e("setPreview",t)},setCategories({commit:e},t){e("setCategories",t)},setAttachmentPath({commit:e},t){e("setAttachmentPath",t)},setCheckedAttachments({commit:e},t){e("setCheckedAttachments",t)}},$c={setAttachments(e,t){e.attachments=t},setAttachmentsOfFnum(e,t){e.attachments[t.fnum]=t.attachments},updateAttachmentOfFnum(e,t){const a=e.attachments[t.fnum].findIndex(e=>e.aid===t.attachment.aid);e.attachments[t.fnum][a]=t.attachment},setSelectedAttachment(e,t){e.selectedAttachment=t},setPreview(e,t){e.previews[t.id]=t.preview},setCategories(e,t){e.categories=t},setAttachmentPath(e,t){e.attachmentPath=t},setCheckedAttachments(e,t){e.checkedAttachments=t}};var jc={namespaced:!0,state:Bc,getters:Pc,actions:Fc,mutations:$c};const Gc={list:[],selectedItems:[],formsAccess:[]},Hc={list:e=>e.list,formsAccess:e=>e.formsAccess,selectedItems:e=>e.selectedItems,isSelected:e=>t=>e.selectedItems.includes(t),isSomething:e=>Array.isArray(e.selectedItems)&&e.selectedItems.length},zc={deleteSelected({commit:e,state:t},a){a.forEach(t=>{e("deleteSelected",t)})}},Vc={selectItem(e,t){return e.selectedItems.includes(t)?e.selectedItems.splice(e.selectedItems.indexOf(t),1):e.selectedItems.push(t),e.selectedItems},resetSelectedItemsList(e){e.selectedItems=[]},listUpdate(e,t){e.list=t},formsAccessUpdate(e,t){e.formsAccess=t},listInsert(e,t){t.forEach(t=>{e.list.push(t)})},publish(e,t){e.list.forEach((a,s)=>{t.includes(a.id)&&(e.list[s].published=1)})},unpublish(e,t){e.list.forEach((a,s)=>{t.includes(a.id)&&(e.list[s].published=0)})},deleteSelected(e,t){e.list.some((a,s)=>{if(t==a.id)return e.list.splice(s,1),!0})}};var Yc={namespaced:!0,state:Gc,getters:Hc,actions:zc,mutations:Vc};const qc={fnums:[]},Jc={},Wc={},Kc={};var Xc={namespaced:!0,state:qc,getters:Jc,actions:Wc,mutations:Kc};const Qc={lastSave:null,pages:null,documentModels:[]},Zc={getLastSave:e=>e.lastSave,getPages:e=>e.pages,getDocumentModels:e=>e.documentModels},ed={updateLastSave({commit:e},t){e("updateLastSave",t)},updateDocumentModels({commit:e},t){e("updateDocumentModels",t)}},td={updateLastSave(e,t){e.lastSave=t},updateDocumentModels(e,t){e.documentModels=t}};var ad={namespaced:!0,state:Qc,getters:Zc,actions:ed,mutations:td};const sd={unsavedChanges:!1,allowPinnedCampaign:!1,pinned:0},id={unsavedChanges:e=>e.unsavedChanges,pinned:e=>e.pinned,allowPinnedCampaign:e=>e.allowPinnedCampaign},nd={setUnsavedChanges({commit:e},t){e("setUnsavedChanges",t)},setPinned({commit:e},t){e("setPinned",t)},setAllowPinnedCampaign({commit:e},t){e("setAllowPinnedCampaign",t)}},ld={setUnsavedChanges(e,t){e.unsavedChanges=t},setPinned(e,t){e.pinned=t},setAllowPinnedCampaign(e,t){e.allowPinnedCampaign=t}};var rd={namespaced:!0,state:sd,getters:id,actions:nd,mutations:ld};s["default"].use(Sc["a"]);var od=new Sc["a"].Store({modules:{global:Uc,user:Ic,attachment:jc,file:Xc,lists:Yc,formBuilder:ad,campaign:rd}}),cd={data(){return{shortDefaultLang:"fr"}},beforeMount(){null!==this.$data.translations&&"undefined"!==typeof this.$data.translations&&Object.entries(this.$data.translations).forEach(([e,t])=>{this.$data.translations[e]=this.translate(t)})},mounted(){null!==this.$store&&"undefined"!==typeof this.$store&&(this.shortDefaultLang=this.$store.getters["global/defaultLang"].substring(0,2))},methods:{translate(e){return void 0!=typeof e&&null!=e&&null!==Joomla&&"undefined"!==typeof Joomla?Joomla.JText._(e)?Joomla.JText._(e):e:""}}};const dd=["click"];function md({event:e,el:t,handler:a,middleware:s}){const i=e.target!==t&&!t.contains(e.target);return i&&s(e,t)?a(e,t):null}const ud=new Map;function pd(e){return t=>{e.forEach(({event:e,handler:a})=>{document[t+"EventListener"](e,a,!0)})}}function _d(e){const t="function"===typeof e;if(!t&&"object"!==typeof e)throw new Error(`v-click-outside: Binding value should be a function or an object, ${typeof bindingValue} given`);return{handler:t?e:e.handler,middleware:e.middleware||(()=>!0)}}function hd(e,{el:t,handler:a,middleware:s}){return e.map(e=>({event:e,handler:e=>md({event:e,el:t,handler:a,middleware:s})}))}function gd(e,{value:t}){const{handler:a,middleware:s}=_d(t),i=hd(dd,{el:e,handler:a,middleware:s});ud.set(e,i),pd(i)("add")}function fd(e){const t=ud.get(e);pd(t)("remove"),ud.delete(e)}const vd={bind:gd,unbind:fd};var bd=vd;s["default"].config.productionTip=!0,s["default"].config.devtools=!1,s["default"].component("v-popover",vc["b"]),s["default"].component("table-component",Cc["TableComponent"]),s["default"].component("table-column",Cc["TableColumn"]),s["default"].use(yc.a,{velocity:Dc.a}),s["default"].use(fc.a),s["default"].use(bc),s["default"].use(Mc["a"]),s["default"].use(Sc["a"]),s["default"].mixin(cd),s["default"].directive("tooltip",vc["c"]),s["default"].directive("close-popover",vc["a"]),s["default"].directive("click-outside",bd);let Cd="",Od={},yd="";const Ed=document.getElementById("em-application-attachment"),Dd=document.getElementById("em-files");if(Ed||Dd){let e=null;Ed?(e=Ed,yd="attachments",Cd="#em-application-attachment"):Dd&&(e=Dd,yd="files",Cd="#em-files"),null!==e&&(Array.prototype.slice.call(e.attributes).forEach((function(e){Od[e.name]=e.value})),new s["default"]({el:Cd,store:od,render(e){return e(hc,{props:{component:yd,data:Od}})}}))}else document.getElementById("em-component-vue")&&new s["default"]({el:"#em-component-vue",store:od,render(e){return e(hc,{props:{component:this.$el.attributes.component.value,datas:this.$el.attributes,currentLanguage:this.$el.attributes.currentLanguage.value,shortLang:this.$el.attributes.shortLang.value,manyLanguages:this.$el.attributes.manyLanguages.value,defaultLang:this.$el.attributes.defaultLang?this.$el.attributes.defaultLang.value:this.$el.attributes.currentLanguage.value,coordinatorAccess:this.$el.attributes.coordinatorAccess.value,sysadminAccess:this.$el.attributes.sysadminAccess.value}})}})},"5c31":function(e,t,a){},"5d7e":function(e,t,a){},"64c2":function(e,t,a){"use strict";a("33a8")},"68e9":function(e,t,a){"use strict";a("9106")},"6f1d":function(e,t,a){"use strict";a("95f8")},"760c":function(e,t,a){"use strict";a("41c0")},7756:function(e,t,a){"use strict";a("c91b")},"7ca2":function(e,t,a){},"7f86":function(e,t,a){"use strict";a("c7ca")},"7f8c":function(e,t,a){"use strict";a("45bc")},"7fa3":function(e,t,a){"use strict";a("354f")},8090:function(e,t,a){"use strict";a("dc35")},8160:function(e,t,a){"use strict";a("f261")},"832d":function(e,t,a){"use strict";a("8a81")},8353:function(e,t,a){"use strict";a("1492")},"85db":function(e,t,a){"use strict";a("986d")},"85f3":function(e,t,a){},"869a":function(e,t,a){},8783:function(e,t,a){},"8a81":function(e,t,a){},"8ba5":function(e,t,a){"use strict";a("8783")},"8e0b":function(e,t,a){},"8f19":function(e,t,a){"use strict";a("5d7e")},9106:function(e,t,a){},9142:function(e,t,a){"use strict";a("9b3e")},"92dd":function(e,t,a){"use strict";a("f4b5")},"959e":function(e,t,a){"use strict";a("230d")},"95f8":function(e,t,a){},"986d":function(e,t,a){},"9a53":function(e,t,a){"use strict";a("fc00")},"9ac1":function(e){e.exports=JSON.parse('[{"title":"COM_EMUNDUS_ONBOARD_PDF_DOCUMENTS","value":"pdf"},{"title":"COM_EMUNDUS_ONBOARD_PICTURES_DOCUMENTS","value":"jpeg;jpg;png;gif"},{"title":"COM_EMUNDUS_ONBOARD_OFFICE_DOCUMENTS","value":"doc;docx;odt;ppt;pptx"},{"title":"COM_EMUNDUS_ONBOARD_EXCEL_DOCUMENTS","value":"xls;xlsx;odf"},{"title":"COM_EMUNDUS_FORM_BUILDER_FORMATS_AUDIO","value":"mp3"},{"title":"COM_EMUNDUS_FORM_BUILDER_FORMATS_VIDEO","value":"mp4"},{"title":"Zip","value":"zip"}]')},"9b06":function(e,t,a){},"9b3e":function(e,t,a){},"9c1c":function(e,t,a){"use strict";a("d39c")},"9d1b":function(e,t,a){},"9f05":function(e,t,a){},"9f4d":function(e,t,a){"use strict";a("de9b")},a3fc:function(e,t,a){},a671:function(e,t,a){},a81d:function(e,t,a){},a93c:function(e,t,a){"use strict";a("9f05")},b252:function(e,t,a){"use strict";a("2a23")},b403:function(e,t,a){"use strict";a("2631")},b477:function(e,t,a){},b81c:function(e,t,a){"use strict";a("e42e")},bb4c:function(e,t,a){},bd9d:function(e,t,a){"use strict";a("3d34")},bf7c:function(e,t,a){},c435:function(e,t,a){},c555:function(e,t,a){"use strict";a("b477")},c6d8:function(e,t,a){},c7c3:function(e,t,a){"use strict";a("9d1b")},c7ca:function(e,t,a){},c8b4:function(e,t,a){"use strict";a("cabb")},c91b:function(e,t,a){},cabb:function(e,t,a){},cd95:function(e,t,a){"use strict";a("5573")},ce46:function(e,t,a){"use strict";a("fc4d")},d1e7:function(e,t,a){},d234:function(e,t,a){},d39c:function(e,t,a){},d709:function(e,t,a){},d7bb:function(e,t,a){"use strict";a("9b06")},d7c7:function(e,t,a){"use strict";a("a3fc")},d9c2:function(e,t,a){},da3d:function(e,t,a){"use strict";a("bf7c")},dc35:function(e,t,a){},de9b:function(e,t,a){},e3f8:function(e,t,a){"use strict";a("a81d")},e42e:function(e,t,a){},ecd4:function(e,t,a){"use strict";a("f18e")},ed97:function(e,t,a){"use strict";a("f437")},ee12:function(e,t,a){"use strict";a("c435")},eea2:function(e,t,a){},ef96:function(e){e.exports=JSON.parse('[{"id":0,"value":"field","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_FIELD","published":true},{"id":5,"value":"textarea","icon":"notes","name":"COM_EMUNDUS_ONBOARD_TYPE_TEXTAREA","published":true},{"id":8,"value":"nom","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_LASTNAME","published":true},{"id":9,"value":"prenom","icon":"text_fields","name":"COM_EMUNDUS_ONBOARD_TYPE_FIRSTNAME","published":true},{"id":10,"value":"email","icon":"mail","name":"COM_EMUNDUS_ONBOARD_TYPE_EMAIL","published":true},{"id":2,"value":"checkbox","icon":"check_box","name":"COM_EMUNDUS_ONBOARD_TYPE_CHECKBOX","published":true},{"id":4,"value":"radiobutton","icon":"radio_button_checked","name":"COM_EMUNDUS_ONBOARD_TYPE_RADIOBUTTON","published":true},{"id":3,"value":"dropdown","icon":"arrow_drop_down_circle","name":"COM_EMUNDUS_ONBOARD_TYPE_DROPDOWN","published":true},{"id":1,"value":"birthday","icon":"event","name":"COM_EMUNDUS_ONBOARD_TYPE_BIRTHDAY","published":true},{"id":14,"value":"date","icon":"calendar_month","name":"COM_EMUNDUS_ONBOARD_TYPE_CALENDAR","published":true},{"id":6,"value":"display","icon":"wysiwyg","name":"COM_EMUNDUS_ONBOARD_TYPE_DISPLAY","published":true},{"id":12,"value":"yesno","icon":"toggle_on","name":"COM_EMUNDUS_ONBOARD_TYPE_YESNO","published":true},{"id":13,"value":"databasejoin","icon":"table_rows","name":"COM_EMUNDUS_ONBOARD_TYPE_DATABASEJOIN","published":true},{"id":15,"value":"currency","icon":"money","name":"COM_EMUNDUS_ONBOARD_TYPE_CURRENCY","published":false},{"id":7,"value":"emundus_fileupload","icon":"file_upload","name":"COM_EMUNDUS_ONBOARD_TYPE_FILE","published":false}]')},f15d:function(e,t,a){"use strict";a("d1e7")},f18e:function(e,t,a){},f261:function(e,t,a){},f437:function(e,t,a){},f4b5:function(e,t,a){},f71d:function(e,t,a){"use strict";a("0a20")},fa31:function(e,t,a){"use strict";a("85f3")},fbc1:function(e,t,a){"use strict";a("d9c2")},fc00:function(e,t,a){},fc4d:function(e,t,a){},fc50:function(e,t,a){}});
//# sourceMappingURL=app_emundus.js.map