(function(t){function e(e){for(var a,i,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(m.length)m.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],a=!0,r=1;r<o.length;r++){var l=o[r];0!==n[l]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=o[0]))}return t}var a={},n={app:0},s=[];function i(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=a,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(o,a,function(e){return t[e]}.bind(null,a));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},1:function(t,e){},"1a69":function(t,e,o){},"23d9":function(t,e,o){},"2c1a":function(t,e,o){},3871:function(t,e,o){},4678:function(t,e,o){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf755","./tlh.js":"cf755","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=s(t);return o(e)}function s(t){if(!o.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}n.keys=function(){return Object.keys(a)},n.resolve=s,t.exports=n,n.id="4678"},"554d":function(t,e,o){"use strict";o("23d9")},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var a=o("2b0e"),n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"workflow-dashboard"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("workflow-creator-menu",{ref:"creatormenu",on:{updateTable:t.updateTable,gotoStepFlow:t.redirectStepFlow}}),o("workflow-info-table",{ref:"infotable",on:{gotoStepFlow:t.redirectStepFlow,updateCampaign:t.updateCampaign}})],1)},s=[],r=(o("ac6a"),o("96cf"),o("3b8d")),l=o("bc3a"),c=o.n(l),d=(o("859b"),o("3d20")),u=o.n(d),m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"workflow-creator-menu"}},[o("div",{staticStyle:{"text-align":"center"}},[o("b-alert",{staticStyle:{"background-color":"#fff3cd","border-color":"#ffeeba",padding:"3.75rem","align-items":"center"},attrs:{show:"",variant:"success",show:"",dismissible:""}},[o("h1",[t._v("EMundus Workflow Demo")])])],1),o("b-form-group",{attrs:{"label-cols":"4","label-cols-lg":"2","label-size":"lg",label:t.WorkflowCreatorMenu_Title.label,"label-for":"input-lg"}},[o("b-form-input",{attrs:{placeholder:t.WorkflowCreatorMenu_PlaceHolder.label,size:"sm"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),o("b-form-group",{attrs:{"label-cols":"4","label-cols-lg":"2","label-size":"lg",label:t.WorkflowCreatorMenu_Title.campaigns,"label-for":"input-lg"}},[o("b-form-select",{staticClass:"form-control-select",attrs:{id:"campaign"},model:{value:t.selectedCampaign,callback:function(e){t.selectedCampaign=e},expression:"selectedCampaign"}},[o("b-form-select-option",{attrs:{disabled:"",selected:"","aria-placeholder":"test"}},[t._v(t._s(t.WorkflowCreatorMenu_PlaceHolder.campaigns))]),t._l(this.availableCampaign,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.label)+" ")])}))],2)],1),o("b-button",{attrs:{type:"submit",variant:"success"},on:{click:t.createWorkflow}},[t._v(t._s(t.WorkflowCreatorMenu_Button.add_button))])],1)},f=[],p=(o("7f7f"),o("c5f6"),o("1157")),_=o.n(p),h=o("4328"),g={name:"WorkflowCreatorMenu",props:{workflowLabel:String,associatedCampaign:Number},data:function(){return{WorkflowCreatorMenu_PlaceHolder:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_CREATOR_MENU_WORKFLOW_NAME_PLACEHOLDER"),campaigns:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_CREATOR_MENU_AVAILABLE_CAMPAIGNS_PLACEHOLDER")},WorkflowCreatorMenu_Title:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_CREATOR_MENU_TITLE_WORKFLOW_NAME"),campaigns:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_CREATOR_MENU_TITLE_ASSOCIATED_CAMPAIGN")},WorkflowCreatorMenu_Button:{add_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_ADD_BUTTON_TITLE")},availableCampaign:[],workflowMessage:"",form:{workflowName:""},selectedCampaign:0,name:""}},created:function(){this.getAllAvailableCampaigns()},methods:{getAllAvailableCampaigns:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getallavailablecampaigns").then((function(e){t.availableCampaign=e.data.data})).catch((function(t){console.log(t)}))},createWorkflow:function(){var t=this,e={campaign_id:this.selectedCampaign,workflow_name:this.name||"Workflow de"+_()("#campaign option:selected").text()};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=createworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:h.stringify({data:e})}).then((function(o){t.workflow=o.data.data,t.availableCampaign=t.availableCampaign.filter((function(t){return t.id!==e.campaign_id})),t.$emit("gotoStepFlow",o.data.data);var a=1;t.$emit("updateTable",a)})).catch((function(t){console.log(t)}))}}},w=g,b=o("0c7c"),v=Object(b["a"])(w,m,f,!1,null,"70bdfd40",null),k=v.exports,O=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"workflow-info-table"}},[o("table",{staticClass:"styled-table",attrs:{id:"infotable"}},[o("thead",[o("tr",t._l(this.$data.table_header,(function(e,a){return o("th",{key:a},[t._v("\n        "+t._s(e)+"\n      ")])})),0)]),o("tbody",t._l(this.workflows,(function(e,a){return o("tr",{key:e.id,attrs:{id:"row_"+e.id}},[o("th",[t._v(t._s(e.id))]),o("th",[t._v(t._s(e.workflow_name))]),o("th",[t._v(" "+t._s(e.label)+" ")]),o("th",[t._v(t._s(e.name))]),o("th",[t._v(t._s(e.created_at))]),o("th",[t._v(t._s(e.saved_at))]),o("th",[t._v(t._s(e.last_activity))]),o("th",[o("button",{staticClass:"edit-button",on:{click:function(o){return t.openWorkflowSpace(e.id)}}},[t._v("OUVRIR")]),o("button",{staticClass:"delete-button",on:{click:function(o){return t.alertDeleteDisplay(e.id)}}},[t._v("SUPPRIMER")])])])})),0)]),o("div",{staticClass:"alert-count"},[o("p",[t._v(" "+t._s(this.workflowMessage)+" ")])])])},S=[],M=o("4328"),T={name:"WorkflowInfoTable",props:{receiver:Number},data:function(){return{workflows:[],workflowMessage:"",id:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_WORKFLOW_ID"),label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_WORKFLOW_NAME"),campaign:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_ASSOCIATED_CAMPAIGN"),last_user:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_LAST_UPDATED_BY"),last_updated:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_LAST_UPDATED"),last_created:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_CREATED_AT"),logs:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_LOGS"),actions:Joomla.JText._("COM_EMUNDUS_WORKFLOW_WORKFLOW_INFO_TABLE_ACTIONS"),table_header:["Workflow ID","Nom du workflow","Campagne Associeé","Dernier Mis-a-jour par","Créé à","Mis-a-jour","Logs","Action"],WorkflowInfoTable_Button:{open_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_OPEN_BUTTON_TITLE"),remove_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_REMOVE_BUTTON_TITLE")}}},created:function(){this.getAllWorkflow()},methods:{getAllWorkflow:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getallworkflows").then((function(e){t.workflows=e.data.data,0==parseInt(e.data.count)?t.workflowMessage="Aucun workflow trouvé":t.workflowMessage="Il y a "+e.data.count+" workflow(s)"})).catch((function(t){console.log(t)}))},deleteWorkflow:function(t){var e=this;c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=deleteworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:M.stringify({wid:t})}).then((function(o){e.workflows=e.workflows.filter((function(e){return e.id!==t}));var a=_()("#infotable tbody tr").length-1;e.workflowMessage=0==a?"Aucun workflow trouvé":"Il y a "+a+" workflow(s)";var n=!0;e.$emit("updateCampaign",n)})).catch((function(t){console.log(t)}))},alertDeleteDisplay:function(t){var e=this;u.a.fire({title:"Supprime le workflow",text:"Action irréversible",icon:"error",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",confirmButtonText:'<i class="far fa-thumbs-up"></i> Oui, c\'est sûr',cancelButtonText:"Non, garder ce workflow"}).then((function(o){o.isConfirmed?(u.a.fire("Merci","Le workflow est supprimé","success"),e.deleteWorkflow(t)):o.isDismissed&&u.a.fire("Merci","Le workflow est gardé","success")}))},openWorkflowSpace:function(t){this.$emit("gotoStepFlow",t)}}},C=T,E=Object(b["a"])(C,O,S,!1,null,"2cbdd997",null),x=E.exports,y=(new Date,o("4328")),L={name:"workflowDashboard",components:{WorkflowCreatorMenu:k,WorkflowInfoTable:x},data:function(){return{}},props:{},created:function(){},methods:{updateTable:function(t){1===t&&this.$refs.infotable.getAllWorkflow()},updateCampaign:function(t){1==t&&this.$refs.creatormenu.getAllAvailableCampaigns()},redirectJRoute:function(t){c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=settings&task=redirectjroute",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{link:t},paramsSerializer:function(t){return y.stringify(t)}}).then((function(t){window.location.href=window.location.pathname+t.data.data}))},redirectStepFlow:function(t){this.redirectJRoute("index.php?option=com_emundus_workflow&view=item&layout=add&id="+t)},duplicateWorkflow:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var o,a,n,s,i,r,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getworkflowbyid",{params:{wid:e}});case 2:return o=t.sent,a=o.data.data[0],n={campaign_id:a.campaign_id,workflow_name:a.workflow_name+"copy"},t.next=7,c.a.get("index.php?option=com_emundus_workflow&controller=item&task=getallitemsbyworkflow",{params:{data:e}});case 7:return s=t.sent,t.next=10,c.a.get("index.php?option=com_emundus_workflow&controller=item&task=getalllinks",{params:{data:e}});case 10:i=t.sent,r=s.data.data,i.data.data,c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=createworkflow&suboption=clone&oldworkflow="+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:y.stringify({data:n})}).then((function(t){r.forEach((function(e){var o={item_id:e.item_id,item_label:e.item_label,item_name:e.item_name,style:e.style,workflow_id:t.data.data,axisX:e.axisX,axisY:e.axisY};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+t.data.data+"&itemid="+o.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:y.stringify({data:o})}).then((function(t){})),l.getAllWorkflow()}))})).catch((function(t){console.log(t)}));case 14:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),alertDuplicateDisplay:function(t){u.a.fire({icon:"success",title:"Congrat",html:'Le workflow est dupliqué <h2 style="color:red">SAUF LES LIAISONS!',footer:"<a href>EMundus SAS</a>",timer:2e3,showConfirmButton:!1}),this.duplicateWorkflow(t)}}},D=L,N=(o("7b15"),Object(b["a"])(D,n,s,!1,null,null,null)),W=N.exports,A=(o("15f5"),o("7051"),o("5886")),U=o("1881"),I=o.n(U),j=o("5f5b"),R=o("b1e0"),P=(o("f9e3"),o("2dd8"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"stepflow"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),0==t.hideStep?o("div",{staticClass:"editable-workflow-label",attrs:{contenteditable:"true",id:"editable-workflow-label"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updateWorkflowLabel()}}},[t._v("\n      "+t._s(this.workflowLabel)+"\n    ")]):t._e(),0==t.hideStep?o("b-button",{staticStyle:{position:"sticky"},attrs:{variant:"success"},on:{click:function(e){return t.createStep()}}},[t._v(t._s(t.StepFlow_Button.add_button))]):t._e(),o("draggable",{staticClass:"flex",attrs:{invertedSwapThreshold:.4,invertSwap:!0,group:t.columns,sort:!0},model:{value:t.columns,callback:function(e){t.columns=e},expression:"columns"}},[t._l(t.columns,(function(e){return 0==t.hideStep?o("div",{key:e.title,staticClass:"bg-gray-100 rounded-lg px-3 py-3 column-width rounded mr-4",attrs:{id:"step_"+e.id},on:{dragstart:t.dragStart,dragend:t.dragEnd,mousedown:t.handleDown}},[o("div",{staticClass:"editable-step-label",staticStyle:{background:"#a8bb4a"},attrs:{contenteditable:"true",id:"step_label_"+e.id},on:{keyup:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")?null:t.setStepLabel(e.id)}}},[t._v(t._s(e.title))]),o("div",{staticStyle:{color:"red"}},[t._v(t._s(e.stateIn))]),o("div",{staticStyle:{color:"blueviolet"}},[t._v(t._s(e.stateOut))]),o("div",{staticStyle:{color:"blue"}},[t._v(" "+t._s(e.startDate))]),o("div",{staticStyle:{color:"orange"}},[t._v(" "+t._s(e.endDate))]),o("div",{staticStyle:{color:"forestgreen"}},[t._v(" "+t._s(e.order)+" ")]),o("modal-config-step",{ref:"stepModal",refInFor:!0,attrs:{ID:e.id,element:e},on:{updateStep:t.updateStep,deleteStep:function(o){return t.deleteStep(e.id)}}}),o("b-button",{attrs:{variant:"warning"},on:{click:function(o){return t.configStep(e.id)}}},[t._v(t._s(t.StepFlow_Button.configure_button))]),o("b-button",{staticStyle:{"margin-left":"20px"},attrs:{variant:"danger"},on:{click:function(o){return t.deleteStep(e.id)}}},[t._v(t._s(t.StepFlow_Button.remove_button))]),o("b-button",{staticStyle:{"margin-left":"20px"},attrs:{variant:"primary"},on:{click:function(o){return t.openStep(e.id)}}},[t._v(t._s(t.StepFlow_Button.open_button))]),o("hr"),o("div",{staticStyle:{position:"sticky"}},[o("b-button",{attrs:{variant:"info"},on:{click:function(o){return t.createMessageDiv(e.id)}}},[t._v(t._s(t.StepFlow_Button.add_button))])],1),t._l(t.messages,(function(a){return e.id==a.step_id?o("div",{staticClass:"message-block",attrs:{id:"message_zone"+a.id}},[o("div",[t._v("\n            "+t._s(a.title)+"\n\n            "),o("b-button",{attrs:{variant:"primary",id:"button_"+a.id},on:{click:function(e){return t.openDiv(a.id)}}},[t._v(t._s(t.StepFlow_Button.trigger_button))]),o("b-button",{attrs:{id:"button_"+a.id,variant:"danger"},on:{click:function(e){return t.deleteMessageDiv(a.id,a.triggerId)}}},[t._v(t._s(t.StepFlow_Button.remove_button))]),o("div",{staticStyle:{color:"forestgreen"}},[t._v(" "+t._s(a.messageTemplate)+" ")]),o("div",{staticStyle:{color:"lightseagreen"}},[t._v(" "+t._s(a.messageDestination)+" ")]),o("div",{staticStyle:{color:"midnightblue"}},[t._v(" "+t._s(a.messageDestinationList)+" ")]),o("div",{staticStyle:{color:"darkgoldenrod"}},[t._v(" "+t._s(a.trigger)+" ")]),t._l(t.stepParams,(function(n){return 1==t.showDiv&&t.currentDiv==a.id&&n.id==e.id?o("message-modal",{attrs:{messageParams:a,stepParams:n},on:{updateMessageBlock:t.updateMessageBlock}}):t._e()}))],2)]):t._e()}))],2):t._e()})),t._l(t.columns,(function(e){return t.currentStep==e.id&&0==t.hideWorkflow?o("workflow-space",{attrs:{step:e},on:{returnBack:t.returnToStepFlow}}):t._e()}))],2)],1)}),J=[],F=(o("6b54"),o("28a5"),o("20d6"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ModalConfigStep",attrs:{id:"ModalConfigStep"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{staticClass:"bounding",attrs:{id:"bounding"}},[o("modal",{attrs:{name:"stepModal"+t.ID,width:580,height:3e3,adaptive:!0,draggable:!0,scrollable:!0,clickToClose:!0},on:{"before-open":t.beforeOpen,"before-close":t.beforeClose}},[o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.label))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.stepLabel,expression:"stepLabel"}],staticClass:"notes",staticStyle:{width:"95%",height:"35px !important"},attrs:{id:"step_label",rows:"3",placeholder:"Nom de l'etape"},domProps:{value:t.stepLabel},on:{input:function(e){e.target.composing||(t.stepLabel=e.target.value)}}})])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.input_status))]),t._l(this.$data.inStatus,(function(e){return e.disabled?t._e():o("div",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.checked[e.step],expression:"checked[item.step]"}],attrs:{type:"checkbox",id:e.step},domProps:{value:e.step,checked:Array.isArray(t.checked[e.step])?t._i(t.checked[e.step],e.step)>-1:t.checked[e.step]},on:{change:function(o){var a=t.checked[e.step],n=o.target,s=!!n.checked;if(Array.isArray(a)){var i=e.step,r=t._i(a,i);n.checked?r<0&&t.$set(t.checked,e.step,a.concat([i])):r>-1&&t.$set(t.checked,e.step,a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.checked,e.step,s)}}}),o("label",{staticClass:"form-check-label",attrs:{id:"status"+e.step,name:""}},[t._v(" "+t._s(e.value))])])}))],2),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.output_status))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.outputStatus,expression:"form.outputStatus"}],staticClass:"form-control-select",attrs:{id:"outstatus-selected"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"outputStatus",e.target.multiple?o:o[0])}}},[o("option",{attrs:{selected:"",disabled:""}},[t._v(t._s(t.ModalConfigStep_PlaceHolder.output_status))]),t._l(this.outStatus,(function(e){return o("option",{domProps:{value:e.step}},[t._v(" "+t._s(e.value))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.start_date))]),o("div",{staticClass:"col-xs-8"},[o("date-picker",{attrs:{mode:"dateTime",is24hr:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,n=e.inputEvents;return[o("input",t._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",attrs:{id:"start_date_"+t.ID},domProps:{value:a}},n))]}}]),model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.end_date))]),o("div",{staticClass:"col-xs-8"},[o("date-picker",{attrs:{mode:"dateTime",is24hr:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,n=e.inputEvents;return[o("input",t._g({staticClass:"px-2 py-1 border rounded focus:outline-none focus:border-blue-300",attrs:{id:"end_date_"+t.ID},domProps:{value:a}},n))]}}]),model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.supplementary_notes))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.stepNotes,expression:"form.stepNotes"}],staticStyle:{margin:"-5px",width:"102%"},attrs:{id:"notes_form",rows:"3",placeholder:t.ModalConfigStep_PlaceHolder.supplementary_notes},domProps:{value:t.form.stepNotes},on:{input:function(e){e.target.composing||t.$set(t.form,"stepNotes",e.target.value)}}})])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.ModalConfigStep_Title.color_palette))]),o("div",{staticClass:"col-xs-8"},[o("color-picker",{attrs:{element:t.form,colorParam:t.colorParams}})],1)]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v("Migration des triggers existant ")]),o("div",{staticClass:"col-xs-8"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.triggerMigration,expression:"form.triggerMigration"}],attrs:{type:"checkbox",id:"triggerMigration_"},domProps:{checked:Array.isArray(t.form.triggerMigration)?t._i(t.form.triggerMigration,null)>-1:t.form.triggerMigration},on:{change:function(e){var o=t.form.triggerMigration,a=e.target,n=!!a.checked;if(Array.isArray(o)){var s=null,i=t._i(o,s);a.checked?i<0&&t.$set(t.form,"triggerMigration",o.concat([s])):i>-1&&t.$set(t.form,"triggerMigration",o.slice(0,i).concat(o.slice(i+1)))}else t.$set(t.form,"triggerMigration",n)}}})])]),o("div",{staticStyle:{"align-items":"center"}},[o("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.updateParams()}}},[t._v(t._s(t.ModalConfigStep_Button.save_button))]),o("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.exitModal()}}},[t._v(t._s(t.ModalConfigStep_Button.exit_button))])],1)])],1)])}),$=[],B=(o("a481"),o("86e3")),K=o.n(B),z=o("404b"),Y=o.n(z),X=(o("386d"),{data:function(){return{id:""}},created:function(){this.id=this.getURLParams("id")},methods:{getURLParams:function(t){var e=window.location.search,o=new URLSearchParams(e);return o.get(t)}}}),H=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(t.messageModal_Title.email_template))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.emailSelected,expression:"form.emailSelected"}],staticClass:"form-control-select",attrs:{id:"email-selected"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"emailSelected",e.target.multiple?o:o[0])}}},[o("option",{attrs:{selected:"",disabled:""}},[t._v(t._s(t.messageModal_PlaceHolder.email_template))]),t._l(this.$data.emails,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.lbl))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(t.messageModal_Title.destination))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.destinationSelected,expression:"form.destinationSelected"}],staticClass:"form-control-select",attrs:{id:"destination-selected"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"destinationSelected",e.target.multiple?o:o[0])}}},[o("option",{attrs:{selected:"",disabled:""}},[t._v(t._s(t.messageModal_PlaceHolder.destination))]),t._l(this.$data.destination,(function(e){return o("option",{domProps:{value:e.id},on:{click:t.handleOtherClick}},[t._v(" "+t._s(e.label))])})),o("option",{domProps:{value:"other"},on:{click:t.handleClick}},[t._v(t._s(t.messageModal_Title.select_one))])],2)])]),1==t.showOtherUser?o("div",{staticClass:"row mb-3"},[1==t.showOtherUser?o("input",{attrs:{type:"checkbox",id:"selectAll_"},on:{click:t.handleSelect}}):t._e(),t._v(" "+t._s(t.messageModal_Title.select_all)+"\n      "),t._l(this.userList,(function(e){return 1==t.showOtherUser?o("div",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.userChecked[e.id],expression:"userChecked[user.id]"}],attrs:{type:"checkbox",id:"check"+e.id},domProps:{value:e.id,checked:Array.isArray(t.userChecked[e.id])?t._i(t.userChecked[e.id],e.id)>-1:t.userChecked[e.id]},on:{click:function(o){return t.handleClickUser(e.id)},change:function(o){var a=t.userChecked[e.id],n=o.target,s=!!n.checked;if(Array.isArray(a)){var i=e.id,r=t._i(a,i);n.checked?r<0&&t.$set(t.userChecked,e.id,a.concat([i])):r>-1&&t.$set(t.userChecked,e.id,a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.userChecked,e.id,s)}}}),o("label",{staticClass:"form-check-label",attrs:{id:"userName_"+e.id}},[t._v(" "+t._s(e.firstname)+" "+t._s(e.lastname))]),o("label",{staticClass:"form-check-label",attrs:{id:"userEmail_"+e.id}},[t._v(" "+t._s("["+e.email+"]"))])]):t._e()}))],2):t._e(),0==t.showOtherUser?o("div"):t._e(),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(t.messageModal_Title.trigger))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.triggerSelected,expression:"form.triggerSelected"}],staticClass:"form-control-select",attrs:{id:"trigger-selected"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"triggerSelected",e.target.multiple?o:o[0])}}},[o("option",{attrs:{value:"to_current_user"}},[t._v(t._s(t.TO_CURRENT_USER))]),o("option",{attrs:{value:"to_applicant"}},[t._v(t._s(t.TO_APPLICANT))])])])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(t.messageModal_Title.supplementary_information))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.messageNotes,expression:"form.messageNotes"}],staticStyle:{margin:"-3px",width:"95%"},attrs:{placeholder:t.messageModal_PlaceHolder.supplementary_information},domProps:{value:t.form.messageNotes},on:{input:function(e){e.target.composing||t.$set(t.form,"messageNotes",e.target.value)}}})])]),o("div",{staticClass:"row mb-3"},[o("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.updateTrigger()}}},[t._v(t._s(t.messageModal_Button.save_button))]),o("b-button",{attrs:{variant:"danger"}},[t._v(t._s(t.messageModal_Button.exit_button))])],1)])},G=[],V=o("4328"),q={name:"messageModal",props:{messageParams:Object,stepParams:Object,activateParams:Boolean,selectOtherUsers:Boolean},data:function(){return{messageModal_PlaceHolder:{email_template:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_EMAIL_TEMPLATE_PLACEHOLDER"),destination:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_DESTINATION_PLACEHOLDER"),supplementary_information:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_SUPPLEMENTARY_INFORMATION_PLACEHOLDER")},messageModal_Title:{email_template:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_EMAIL_TEMPLATE"),destination:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_DESTINATION"),supplementary_information:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_SUPPLEMENTARY_INFORMATION"),trigger:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_TRIGGER"),select_one:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_SELECT_ONE"),select_all:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MESSAGE_MODAL_TITLE_SELECT_ALL")},messageModal_Button:{save_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SAVE_BUTTON_TITLE"),exit_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_EXIT_BUTTON_TITLE")},form:{emailSelected:"",destinationSelected:"",messageNotes:"",usersSelected:[],triggerSelected:[]},emails:[],status:[],destination:[],isDisable:!0,showOtherUser:!1,userList:[],userChecked:[],triggerChecked:[],selectAll:!1,TO_CURRENT_USER:"Current User",TO_APPLICANT:"Applicant",userIdList:[],users_selected:""}},created:function(){this.getAllMessages(),this.getAllDestinations(),this.getAllUsers(),this.getMessageParams(this.messageParams.id)},methods:{handleOtherClick:function(){var t=this;this.showOtherUser=!1,this.form.usersSelected=null,this.userIdList.forEach((function(e){t.userChecked[e]=!1,_()("#check"+e).prop("checked",!1)}))},handleClick:function(){!0===this.showOtherUser&&(this.form.usersSelected=this.userChecked),this.showOtherUser=!this.showOtherUser},handleClickUser:function(t){!0===this.showOtherUser&&(this.userChecked[t]=!0,this.form.usersSelected=this.userChecked)},handleSelect:function(){var t=this;this.selectAll=!this.selectAll,this.userIdList.forEach((function(e){1==t.selectAll?(document.getElementById("check"+e).checked=!0,t.userChecked[e]=!0,t.form.usersSelected=t.userChecked):(t.userChecked[e]=!1,document.getElementById("check"+e).checked=!1)}))},updateTrigger:function(){var t=this,e=[],o=_()("#destination-selected option:selected").index(),a=_()("#destination-selected option").eq(o).val();!0===this.showOtherUser&&"other"===a&&(this.userIdList.forEach((function(t){!0===document.getElementById("check"+t).checked&&e.push(document.getElementById("check"+t).value)})),this.form.usersSelected=e.toString());var n={id:this.messageParams.triggerId,step:this.stepParams.outputStatus,email_id:this.form.emailSelected,to_current_user:"to_current_user"===this.form.triggerSelected?1:0,to_applicant:"to_applicant"===this.form.triggerSelected?1:0},s={params:this.form,id:this.messageParams.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=updatemessagebloc",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:V.stringify({data:s})}).then((function(e){var o=[];""===_()("#email-selected option:selected").text()&&void 0===_()("#email-selected option:selected").text()&&null===_()("#email-selected option:selected").text()||(o["messageTemplate"]=_()("#email-selected option:selected").text()),""===_()("#destination-selected option:selected").text()&&void 0===_()("#destination-selected option:selected").text()&&null===_()("#destination-selected option:selected").text()||(o["messageDestination"]=_()("#destination-selected option:selected").text());var a=_()("#destination-selected option:selected").index(),n=_()("#destination-selected option").eq(a).val(),s=[];if("other"===n&&void 0!==t.form.usersSelected){var i=t.form.usersSelected.split(",");i.forEach((function(t){s.push(document.getElementById("userName_"+t).innerText)})),o["messageDestinationList"]=s.toString()}""===_()("#trigger-selected option:selected").text()&&void 0===_()("#trigger-selected option:selected").text()&&null===_()("#trigger-selected option:selected").text()||(o["trigger"]=_()("#trigger-selected option:selected").text()),o["messageDivId"]=t.messageParams.id,t.$emit("updateMessageBlock",o)})).catch((function(t){console.log(t)})),c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=updatetrigger",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:V.stringify({trigger:n,users:0===e.length?this.form.destinationSelected:e})}).then((function(t){})).catch((function(t){console.log(t)}))},getMessageParams:function(t){var e=this,o={id:t,mode:null};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=getmessageblocbyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:V.stringify({data:o})}).then((function(t){var o=t.data.data.data.params;if(null!==o)if(e.form.emailSelected=JSON.parse(o).emailSelected,e.form.destinationSelected=JSON.parse(o).destinationSelected,e.form.triggerSelected=JSON.parse(o).triggerSelected,"other"===e.form.destinationSelected){var a=JSON.parse(o).usersSelected;e.showOtherUser=!0;var n=a.split(",");n.forEach((function(t){e.userChecked[t]=!0}))}else e.showOtherUser=!1})).catch((function(t){console.log(t)}))},getAllMessages:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallmessages").then((function(e){t.$data.emails=e.data.data})).catch((function(t){console.log(t)}))},getAllDestinations:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=common&task=getalldestinations").then((function(e){t.$data.destination=e.data.data})).catch((function(t){console.log(t)}))},getAllUsers:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallusers").then((function(e){t.userList=e.data.data,e.data.data.forEach((function(e){return t.userIdList.push(e.id)}))})).catch((function(t){console.log(t)}))}}},Q=q,Z=Object(b["a"])(Q,H,G,!1,null,null,null),tt=Z.exports,et=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"colorPicker"}},[1==t.showColor?o("input",{attrs:{id:"picker",type:"color"},domProps:{value:t.colorParam.color},on:{input:function(e){return t.handleChange()}}}):t._e(),0==t.showColor?o("input",{attrs:{type:"color"},domProps:{value:t.colorParam.color},on:{click:function(e){t.showColor=!t.showColor},input:function(e){return t.handleChange()}}}):t._e(),o("span",{staticStyle:{"margin-left":"5vh","font-weight":"bold"},style:{color:t.colorParam.color},attrs:{id:"labelColor"},model:{value:t.colorParam.color,callback:function(e){t.$set(t.colorParam,"color",e)},expression:"colorParam.color"}},[t._v(" "+t._s(t.colorParam.color||"#000000")+" ")])])},ot=[],at={name:"colorPicker",props:{element:Object,colorParam:Object},data:function(){return{showColor:!1,form:{setColor:""}}},created:function(){void 0===this.colorParam.color?this.showColor=!1:(this.form.setColor=this.colorParam.color,this.showColor=!0),this.form=this.element},methods:{handleChange:function(){this.form.setColor=_()(" #picker ").val(),this.colorParam.color=_()(" #picker ").val()}}},nt=at,st=Object(b["a"])(nt,et,ot,!1,null,"6d2e9046",null),it=st.exports;o("c1df")().format("YYYY-MM-DD HH:mm:ss");var rt=o("4328"),lt={name:"ModalConfigStep",mixins:[X],props:{ID:Number,element:Object},components:{Calendar:K.a,DatePicker:Y.a,messageModal:tt,colorPicker:it},data:function(){return{messageParams:Object,colorParams:Object,ModalConfigStep_PlaceHolder:{output_status:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_PLACEHOLDER_OUTPUT_STATUS"),supplementary_notes:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_PLACEHOLDER_SUPPLEMENTARY_INFORMATION")},ModalConfigStep_Title:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_LABEL"),input_status:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_INPUT_STATUS"),output_status:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_OUTPUT_STATUS"),start_date:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_START_DATE"),end_date:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_END_DATE"),supplementary_notes:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_SUPPLEMENTARY_INFORMATION"),color_palette:Joomla.JText._("COM_EMUNDUS_WORKFLOW_STEP_MODAL_STEP_TITLE_STEP_COLOR")},ModalConfigStep_Button:{save_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SAVE_BUTTON_TITLE"),exit_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_EXIT_BUTTON_TITLE")},ModalConfigStep_SweetAlert:{congratulation_title:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_CONGRATULATION_TITLE"),congratulation_message:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_CONGRATULATION_MESSAGE"),error_title:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_ERROR_TITLE"),error_message:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_ERROR_MESSAGE")},form:{id:"",inputStatus:[],outputStatus:"",stepNotes:"",triggerMigration:""},startDate:"",endDate:"",inStatus:[],outStatus:[],checked:[],inputList:[],inStatusSelected:[],stepLabel:""}},created:function(){this.form.inputStatus=this.checked},methods:{getCurrentParams:function(t){var e=this;c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=step&task=getcurrentparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{sid:t},paramsSerializer:function(t){return rt.stringify(t)}}).then((function(t){e.showMessage=!1,e.form.id=e.ID,e.form.outputStatus=t.data.data.outputStatus,e.form.stepNotes=t.data.data.notes,e.startDate=t.data.data.startDate,e.endDate=t.data.data.endDate;var o=t.data.data.inputStatus.split(",");o.forEach((function(t){e.checked[t]=!0})),e.stepLabel=t.data.data.stepLabel,e.colorParams=t.data.data}))},getAvailableStatus:function(t){var e=this;c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=step&task=getavailablestatus",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{data:t},paramsSerializer:function(t){return rt.stringify(t)}}).then((function(t){var o=t.data.dataIn;null!==o&&(o.forEach((function(t){return t["disabled"]=!1})),e.inStatus=o),e.outStatus=t.data.dataOut}))},updateParams:function(){var t=this;null!==this.form.inputStatus&&null!==this.form.outputStatus&&null!==this.startDate&&null!==this.endDate&&new Date(this.startDate).toISOString().slice(0,19).replace("T"," ")<=new Date(this.endDate).toISOString().slice(0,19).replace("T"," ")?c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:rt.stringify({data:{id:this.element.id,step_label:this.stepLabel,workflow_id:this.$data.id,params:this.form,start_date:new Date(this.startDate).toISOString().slice(0,19).replace("T"," "),end_date:new Date(this.endDate).toISOString().slice(0,19).replace("T"," ")}})}).then((function(e){u.a.fire({icon:"success",title:t.ModalConfigStep_SweetAlert.congratulation_title,text:t.ModalConfigStep_SweetAlert.congratulation_message,footer:"<a href>EMundus SAS</a>",confirmButtonColor:"#28a745"}).then((function(e){e.isConfirmed&&t.$modal.hide("stepModal"+t.element.id)}))})).catch((function(t){console.log(t)})):u.a.fire({icon:"error",title:this.ModalConfigStep_SweetAlert.error_title,html:this.ModalConfigStep_SweetAlert.error_message,timer:1500,showConfirmButton:!1})},exitModal:function(){var t=this.form.inputStatus,e=this.form.outputStatus;0!=t.length&&null!==e||(this.$emit("deleteStep",this.element.id),this.$modal.hide("stepModal"+this.element.id))},beforeOpen:function(){var t={wid:this.$data.id,sid:this.element.id};this.getCurrentParams(this.element.id),this.getAvailableStatus(t)},beforeClose:function(){var t=[],e=[];for(i=0;i<=this.form.inputStatus.length;i++)1==this.form.inputStatus[i]&&t.push(document.getElementById("status"+i).innerText);e["output"]=_()("#outstatus-selected option:selected").text(),e["input"]=t.toString(),e["startDate"]=_()("#start_date_"+this.ID).val(),e["endDate"]=_()("#end_date_"+this.ID).val(),e["id"]=this.form.id,e["label"]=_()("#step_label").val(),e["color"]=_()("#labelColor").text(),this.$emit("updateStep",e)}}},ct=lt,dt=(o("554d"),Object(b["a"])(ct,F,$,!1,null,null,null)),ut=dt.exports,mt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flowchart-container",on:{mousemove:t.handleMove,mouseup:t.handleUp,mousedown:t.handleDown}},[o("svg",{attrs:{width:"100%",height:t.height+"vh"}},t._l(t.lines,(function(e,a){return o("flowchart-link",t._b({key:"link"+a,on:{deleteLink:function(o){return t.linkDelete(e.id)}}},"flowchart-link",e,!1,!0))})),1),t._l(t.scene.nodes,(function(e,a){return o("modal-config-element",{attrs:{ID:e.id,element:e},on:{linkingStart:t.linkingStart,linkingStop:t.linkingStop,linkDelete:t.linkDelete,updateLabel:t.updateLabel}},[t._v("\n    "+t._s(e.id)+"\n  ")])})),t._l(t.scene.nodes,(function(e,a){return o("flowchart-node",t._b({key:"node"+a,style:{background:e.background},attrs:{options:t.nodeOptions,params:t.step,nodeLabel:t.info},on:{linkingStart:function(o){return t.linkingStart(e.id)},linkingStop:function(o){return t.linkingStop(e.id)},nodeSelected:function(o){return t.nodeSelected(e.id,o)}}},"flowchart-node",e,!1,!0))}))],2)},ft=[],pt=o("75fc"),_t=(o("7514"),o("768b")),ht=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("g",{on:{mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[o("path",{style:t.pathStyle,attrs:{d:t.dAttr}}),t.show.delete?o("a",{on:{click:t.deleteLink}},[o("text",{staticClass:"link-delete",attrs:{"text-anchor":"middle",transform:t.arrowTransform,"font-size":"22"}},[t._v("×")])]):o("path",{style:t.arrowStyle,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:t.arrowTransform}})])},gt=[],wt={name:"FlowchartLink",props:{start:{type:Array,from:Number,default:function(){return[0,0]}},end:{type:Array,end:Number,default:function(){return[0,0]}},id:Number},data:function(){return{show:{delete:!1}}},methods:{handleMouseOver:function(){this.id&&(this.show.delete=!0)},handleMouseLeave:function(){this.show.delete=!1},caculateCenterPoint:function(){var t=(this.end[0]-this.start[0])/2,e=(this.end[1]-this.start[1])/2;return[this.start[0]+t,this.start[1]+e]},caculateRotation:function(){var t=-Math.atan2(this.end[0]-this.start[0],this.end[1]-this.start[1]),e=180*t/Math.PI;return e<0?e+360:e},deleteLink:function(){this.$emit("deleteLink")}},computed:{pathStyle:function(){return{stroke:"rgb(255, 136, 85)",strokeWidth:2.73205,fill:"none"}},arrowStyle:function(){return{stroke:"rgb(255, 136, 85)",strokeWidth:5.73205,fill:"none"}},arrowTransform:function(){var t=this.caculateCenterPoint(),e=Object(_t["a"])(t,2),o=e[0],a=e[1],n=this.caculateRotation();return"translate(".concat(o,", ").concat(a,") rotate(").concat(n,")")},dAttr:function(){var t=this.start[0],e=this.start[1],o=this.end[0],a=this.end[1],n=t,s=e+50,i=o,r=a-50;return"M ".concat(t,", ").concat(e," C ").concat(n,", ").concat(s,", ").concat(i,", ").concat(r,", ").concat(o,", ").concat(a)}}},bt=wt,vt=(o("900b"),Object(b["a"])(bt,ht,gt,!1,null,"04260896",null)),kt=vt.exports,Ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flowchart-node",class:{selected:t.options.selected===t.id},style:t.nodeStyle,on:{mousedown:t.handleMousedown,mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[o("div",{staticClass:"node-port node-input",on:{mousedown:t.inputMouseDown,mouseup:t.inputMouseUp}}),o("div",{staticClass:"node-main"},[o("div",{staticClass:"node-type",domProps:{textContent:t._s(t.type)}}),null!==this.$attrs.itemLabel||void 0!==this.$attrs.itemLabel?o("p",{attrs:{id:"label_"+t.id,disabled:"true"}},[t._v(" "+t._s(this.$attrs.itemLabel)+"\n    ")]):t._e(),null===this.$attrs.itemLabel||void 0===this.$attrs.itemLabel?o("p",{attrs:{id:"label_"+t.id,disabled:"true"}},[t._v(" "+t._s(this.$props.label)+"\n  ")]):t._e()]),o("div",{staticClass:"node-port node-output",on:{mousedown:t.outputMouseDown}}),o("div",{directives:[{name:"show",rawName:"v-show",value:t.show.delete,expression:"show.delete"}],staticClass:"node-delete"},[t._v("×")]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.show.clone,expression:"show.clone"}],ref:"duplicate",staticClass:"duplicate-option",attrs:{id:t.id}},[t._v("Dupliquer")]),o("div",{ref:"configuration",staticClass:"configuration",attrs:{id:t.id}},[t._v("Configurer")]),o("div",{staticClass:"input-status",attrs:{id:t.id}},[t._v(" "+t._s(this.params.stateIn))]),o("div",{staticClass:"output-status",attrs:{id:t.id}},[t._v(" "+t._s(this.params.stateOut))])])},St=[],Mt=o("4328"),Tt={name:"FlowchartNode",props:{nodeLabel:String,params:Object,background:{type:String,default:""},id:{type:Number,default:1e3,validator:function(t){return"number"===typeof t}},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},type:{type:String,default:"Element"},label:{type:String,default:"input name"},options:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140}}}},data:function(){return{show:{delete:!1,clone:!1},inputStatus:[],outputStatus:[]}},mounted:function(){},created:function(){},computed:{nodeStyle:function(){return{top:this.options.centerY+this.y*this.options.scale+"px",left:this.options.centerX+this.x*this.options.scale+"px",transform:"scale(".concat(this.options.scale,")")}}},methods:{handleMousedown:function(t){var e=t.target||t.srcElement;e.className.indexOf("node-input")<0&&e.className.indexOf("node-output")<0&&this.$emit("nodeSelected",t)},handleMouseOver:function(){this.show.delete=!0,this.show.clone=!0},handleMouseLeave:function(){this.show.delete=!1,this.show.clone=!1},outputMouseDown:function(t){this.$emit("linkingStart"),t.preventDefault()},inputMouseDown:function(t){t.preventDefault()},inputMouseUp:function(t){this.$emit("linkingStop"),t.preventDefault()},handleDuplicatItem:function(t){this.$emit("duplicateItem"),t.preventDefault()},handleConfigure:function(t){this.$emit("configureItem"),t.preventDefault()},getCurrentStatus:function(t){var e=this;c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getcurrentstatusbyitem",params:{id:t},paramsSerializer:function(t){return Mt.stringify(t)}}).then((function(t){e.inputStatus=t.data.dataIn,e.outputStatus=t.data.dataOut})).catch((function(t){console.log(t)}))}}},Ct=Tt,Et=(o("c54a"),Object(b["a"])(Ct,Ot,St,!1,null,"6264d851",null)),xt=Et.exports;function yt(t){var e=t.getBoundingClientRect(),o=window.pageYOffset,a=window.pageXOffset,n=e.top+o,s=e.left+a;return{top:Math.round(n),left:Math.round(s)}}function Lt(t,e){var o=e.pageX||e.clientX+document.documentElement.scrollLeft,a=e.pageY||e.clientY+document.documentElement.scrollTop,n=yt(t),s=o-n.left,i=a-n.top;return[s,i]}var Dt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"ModalConfigElement"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("modal",{attrs:{name:"elementModal"+t.ID,width:580,height:600,adaptive:!0,draggable:!0,scrollable:!0,clickToClose:!0},on:{"before-open":t.beforeOpen,"before-close":t.beforeClose}},[o("b-badge",{attrs:{variant:"warning"}},[o("h3",{staticStyle:{color:"white !important"}},[t._v(t._s(this.$data.name)+" "+t._s(t.ModalConfigElement_Title.label))])]),o("br"),o("br"),o("b-nav",{attrs:{tabs:""}},[o("b-nav-item",{attrs:{active:""}},[t._v(t._s(t.ModalConfigElement_Title.breadcrumb))])],1),o("br"),o("br"),2==this.type?o("espace-modal",{ref:"forms",attrs:{element:t.element}}):t._e(),o("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.updateParams()}}},[t._v(t._s(t.ModalConfigElement_Button.save_button))]),o("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.exitModal()}}},[t._v(t._s(t.ModalConfigElement_Button.exit_button))])],1)],1)},Nt=[],Wt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.espaceModal_Title.label))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.itemLabel,expression:"form.itemLabel"}],staticStyle:{width:"95%",height:"35px !important"},attrs:{id:"step_label"+t.element.id,rows:"3",placeholder:t.espaceModal_PlaceHolder.label},domProps:{value:t.form.itemLabel},on:{input:function(e){e.target.composing||t.$set(t.form,"itemLabel",e.target.value)}}})])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.espaceModal_Title.profile))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.formNameSelected,expression:"form.formNameSelected"}],staticClass:"form-control-select",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"formNameSelected",e.target.multiple?o:o[0])}}},[o("option",{attrs:{selected:"",disabled:""}},[t._v(t._s(t.espaceModal_PlaceHolder.profile))]),t._l(this.$data.forms,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.label))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(t.espaceModal_Title.supplementary_information))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.notes,expression:"form.notes"}],staticStyle:{margin:"-5px",width:"102%"},attrs:{id:"notes_form",rows:"3",placeholder:t.espaceModal_PlaceHolder.supplementary_information},domProps:{value:t.form.notes},on:{input:function(e){e.target.composing||t.$set(t.form,"notes",e.target.value)}}})])])])},At=[],Ut=o("4328"),It={name:"espaceModal",props:{element:Object},data:function(){return{espaceModal_PlaceHolder:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_PLACEHOLDER_LABEL"),profile:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_PLACEHOLDER_PROFILE"),supplementary_information:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_PLACEHOLDER_SUPPLEMENTARY_INFORMATION")},espaceModal_Title:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_TITLE_LABEL"),profile:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_TITLE_PROFILE"),supplementary_information:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_ESPACE_MODAL_TITLE_SUPPLEMENTARY_INFORMATION")},form:{itemLabel:"",formNameSelected:"",notes:""},forms:[],status:[],inStatus:[],outStatus:[],isDisabled:!0,checked:[],in:[],out:[]}},methods:{getAllFormType:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallpublishedforms").then((function(e){t.$data.forms=e.data.data})).catch((function(t){console.log(t)}))},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},getCurrentStatus:function(t){var e=this;c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getcurrentstatusbyitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:t},paramsSerializer:function(t){return Ut.stringify(t)}}).then((function(t){null!==t.data.dataIn&&null!==t.data.dataOut?(t.data.dataIn.forEach((function(t){e.checked[t.step]=!0})),e.form.outputStatus=t.data.dataOut[0].step):null==t.data.dataIn&&null!==t.data.dataOut?e.form.outputStatus=t.data.dataOut[0].step:null!==t.data.dataIn&&null==t.data.dataOut&&t.data.dataIn.forEach((function(t){e.checked[t.step]=!0}))})).catch((function(t){console.log(t)}))},getNonStatusParams:function(t){var e=this;c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getnonstatusparamsbyitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:t},paramsSerializer:function(t){return Ut.stringify(t)}}).then((function(t){null!==t.data.data&&(e.form.formNameSelected=t.data.data.profile,e.form.notes=t.data.data.notes,e.form.itemLabel=t.data.data.label)}))}},created:function(){this.getAllFormType(),this.form=this.element,this.getNonStatusParams(this.form.id)}},jt=It,Rt=Object(b["a"])(jt,Wt,At,!1,null,null,null),Pt=Rt.exports,Jt=o("4328"),Ft={name:"ModalConfigElement",mixins:[X],components:{espaceModal:Pt},data:function(){return{type:"",name:"",ModalConfigElement_Title:{label:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MODAL_TITLE_LABEL"),breadcrumb:Joomla.JText._("COM_EMUNDUS_WORKFLOW_ELEMENT_MODAL_TITLE_BREADCRUMB")},ModalConfigElement_Button:{save_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SAVE_BUTTON_TITLE"),exit_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_EXIT_BUTTON_TITLE")},ModalConfigElement_SweetAlert:{congratulation_title:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_CONGRATULATION_TITLE"),congratulation_message:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SWEET_ALERT_CONGRATULATION_MESSAGE")}}},props:{ID:Number,element:Object},methods:{beforeClose:function(){var t=[];t["id"]=this.$refs.forms.form.id,t["label"]=this.$refs.forms.form.itemLabel,this.$emit("updateLabel",t)},getElementByItem:function(){var t=this;c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:this.ID},paramsSerializer:function(t){return Jt.stringify(t)}}).then((function(e){t.$data.type=e.data.data[0].item_id,t.$data.name=e.data.data[0].item_name})).catch((function(t){console.log(t)}))},updateParams:function(){var t=this;c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jt.stringify({data:{params:this.element,workflow_id:this.$data.id}})}).then((function(e){u.a.fire({icon:"success",title:t.ModalConfigElement_SweetAlert.congratulation_title,text:t.ModalConfigElement_SweetAlert.congratulation_message,footer:"<a href>EMundus SAS</a>",confirmButtonColor:"#28a745"}).then((function(e){if(e.isConfirmed){t.$modal.hide("elementModal"+t.ID);var o={wid:t.getWorkflowIdFromURL(),id:t.ID};t.autoCreateLink(o)}}))})).catch((function(t){console.log(t)}))},exitModal:function(){this.$modal.hide("elementModal"+this.ID)},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},autoCreateLink:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=matchalllinksbyitem",params:{data:e},paramsSerializer:function(t){return Jt.stringify(t)}}).then((function(t){if("available"==t.data.permission){var e={_from:t.data.data,_to:o.ID};o.$emit("linkingStart",e._from),o.$emit("linkingStop",e._to)}else c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=checkexistlink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jt.stringify({data:o.ID})}).then((function(t){if(console.log(t),1==t.data.data){var e={_from:void 0,_to:o.ID};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getlinkbytoitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:Jt.stringify({data:e})}).then((function(t){var e=t.data.data;console.log(e[0].id),o.$emit("linkDelete",e[0].id)}))}}))})).catch((function(t){console.log(t)}));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),beforeOpen:function(t){this.getElementByItem()}}},$t=Ft,Bt=(o("d2333"),Object(b["a"])($t,Dt,Nt,!1,null,null,null)),Kt=Bt.exports,zt=o("4328"),Yt={name:"VueFlowchart",mixins:[X],props:{step:Object,scene:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140,nodes:[],links:[],background:""}}},height:{type:Number,default:60}},data:function(){return{action:{linking:!1,dragging:!1,scrolling:!1,selected:0},mouse:{x:0,y:0,lastX:0,lastY:0},draggingLink:null,rootDivOffset:{top:0,left:0}}},components:{ModalConfigElement:Kt,FlowchartLink:kt,FlowchartNode:xt},computed:{nodeOptions:function(){return{centerY:this.scene.centerY,centerX:this.scene.centerX,scale:this.scene.scale,offsetTop:this.rootDivOffset.top,offsetLeft:this.rootDivOffset.left,selected:this.action.selected}},lines:function(){var t=this,e=this.scene.links.map((function(e){var o,a,n,s,i,r,l=t.findNodeWithID(e.from),c=t.findNodeWithID(e.to);o=t.scene.centerX+l.x,a=t.scene.centerY+l.y;var d=t.getPortPosition("bottom",o,a),u=Object(_t["a"])(d,2);s=u[0],n=u[1],o=t.scene.centerX+c.x,a=t.scene.centerY+c.y;var m=t.getPortPosition("top",o,a),f=Object(_t["a"])(m,2);return i=f[0],r=f[1],{start:[s,n],end:[i,r],id:e.id}}));if(this.draggingLink){var o,a,n,s,i=this.findNodeWithID(this.draggingLink.from);o=this.scene.centerX+i.x,a=this.scene.centerY+i.y;var r=this.getPortPosition("bottom",o,a),l=Object(_t["a"])(r,2);s=l[0],n=l[1],e.push({start:[s,n],end:[this.draggingLink.mx,this.draggingLink.my]})}return e}},mounted:function(){this.rootDivOffset.top=this.$el?this.$el.offsetTop:0,this.rootDivOffset.left=this.$el?this.$el.offsetLeft:0},methods:{updateLabel:function(t){console.log(t),this.info=t,this.$forceUpdate()},findNodeWithID:function(t){return this.scene.nodes.find((function(e){return t===e.id}))},getPortPosition:function(t,e,o){return"top"===t?[e+40,o]:"bottom"===t?[e+40,o+80]:void 0},linkingStart:function(t){this.action.linking=!0,this.draggingLink={from:t,mx:0,my:0}},linkingStop:function(t){var e=this;if(this.draggingLink&&this.draggingLink.from!==t){var o=this.scene.links.find((function(o){return o.from===e.draggingLink.from&&o.to===t}));if(!o){Math.max.apply(Math,[0].concat(Object(pt["a"])(this.scene.links.map((function(t){return t.id})))));var a={from:this.draggingLink.from,to:t},n={parent:a.from,child:t,workflow_id:this.getWorkflowIdFromURL(),link_label:"",step_id:this.step.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=link&task=createlink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({data:n})}).then((function(t){console.log(t),a["id"]=t.data.data.data})).catch((function(t){console.log(t)})),this.scene.links.push(a),this.$emit("linkAdded",a)}}this.draggingLink=null},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},linkDelete:function(t){var e=this.scene.links.find((function(e){return e.id===t}));e&&(this.scene.links=this.scene.links.filter((function(e){return e.id!==t})),this.$emit("linkBreak",e),this.$swal("Merci","Cette liaison est supprimée","success"),this.deleteLink(t))},nodeSelected:function(t,e){e.preventDefault(),this.action.dragging=t,this.action.selected=t,this.$emit("nodeClick",t),this.mouse.lastX=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouse.lastY=e.pageY||e.clientY+document.documentElement.scrollTop,e.preventDefault()},handleMove:function(t){if(this.action.linking){var e=Lt(this.$el,t),o=Object(_t["a"])(e,2);this.mouse.x=o[0],this.mouse.y=o[1];var a=[this.mouse.x,this.mouse.y];this.draggingLink.mx=a[0],this.draggingLink.my=a[1],t.preventDefault()}if(this.action.dragging){this.mouse.x=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouse.y=t.pageY||t.clientY+document.documentElement.scrollTop;var n=this.mouse.x-this.mouse.lastX,s=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.moveSelectedNode(n,s),t.preventDefault()}if(this.action.scrolling){var i=Lt(this.$el,t),r=Object(_t["a"])(i,2);this.mouse.x=r[0],this.mouse.y=r[1];var l=this.mouse.x-this.mouse.lastX,c=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.scene.centerX+=l,this.scene.centerY+=c,t.preventDefault()}},handleUp:function(t){var e=t.target||t.srcElement,o=this.action.dragging;if(null!==o&&void 0!==o){var a=function(t){return t.id===o},n=this.scene.nodes.findIndex(a);if(-1===n);else{var s={id:o,axisX:this.scene.nodes[n].x,axisY:this.scene.nodes[n].y,workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=saveitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({data:s})}).then((function(t){})).catch((function(t){console.log(t)}))}}this.$el.contains(e)&&(("string"!==typeof e.className||e.className.indexOf("node-input")<0)&&(this.draggingLink=null),"string"===typeof e.className&&e.className.indexOf("node-delete")>-1&&this.nodeDelete(this.action.dragging),"string"===typeof e.className&&e.className.indexOf("duplicate-option")>-1&&this.nodeCloned(this.action.dragging),"string"===typeof e.className&&e.className.indexOf("configuration")>-1&&this.nodeConfig(this.action.dragging)),this.action.linking=!1,this.action.dragging=null,this.action.scrolling=!1},handleDown:function(t){var e=t.target||t.srcElement;if("vm--modal"===e.className&&t.preventDefault(),(e===this.$el||e.matches("svg, svg *"))&&1===t.which){this.action.scrolling=!0;var o=Lt(this.$el,t),a=Object(_t["a"])(o,2);this.mouse.lastX=a[0],this.mouse.lastY=a[1],this.action.selected=null,t.preventDefault()}this.$emit("canvasClick",t)},moveSelectedNode:function(t,e){var o=this,a=this.scene.nodes.findIndex((function(t){return t.id===o.action.dragging})),n=this.scene.nodes[a].x+t/this.scene.scale,s=this.scene.nodes[a].y+e/this.scene.scale;this.$set(this.scene.nodes,a,Object.assign(this.scene.nodes[a],{x:n,y:s}))},nodeDelete:function(t){var e=this;this.$emit("nodeDelete",t),c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({id:t})}).then((function(o){var a=o.data.data[0];"Initialisation"==a.item_name?(u.a.fire({icon:"error",title:"Erreur",html:'Vous pouvez pas supprimer le bloc <h2 style="color:red">INITIALISATION!',timer:1500,showConfirmButton:!1}),console.log("cannot delete")):(e.scene.nodes=e.scene.nodes.filter((function(e){return e.id!==t})),e.scene.links=e.scene.links.filter((function(e){return e.from!==t&&e.to!==t})),e.alertDelete(t))}))},nodeConfig:function(t){var e=this;this.$emit("nodeConfig",t),c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({id:t})}).then((function(o){var a=o.data.data[0];"Initialisation"==a.item_name||"Cloture"==a.item_name||e.$modal.show("elementModal"+t)})).catch((function(t){console.log(t)}))},nodeCloned:function(t){var e=this;this.$emit("nodeClone",t),c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({id:t})}).then((function(o){var a=o.data.data[0];"Initialisation"==a.item_name?u.a.fire({icon:"error",title:"Erreur",html:'Vous pouvez pas cloner le bloc <h2 style="color:red">INITIALISATION!',timer:1500,showConfirmButton:!1}):e.alertClone(t)}))},deleteItem:function(t){var e={id:t,workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=deleteitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({data:e})}).then((function(t){})).catch((function(t){console.log(t)}))},deleteLink:function(t){var e={id:t,workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=link&task=deletelink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({data:e})}).then((function(t){})).catch((function(t){console.log(t)}))},alertDelete:function(t){u.a.fire({icon:"success",title:"Congrat",text:"Le bloc est supprimé!",timer:2e3,showConfirmButton:!1}),this.deleteItem(t)},alertClone:function(t){u.a.fire({icon:"success",title:"Congrat",text:"Le bloc est dupliqué!",timer:2e3,showConfirmButton:!1}),this.cloneItem(t)},cloneItem:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var o,a,n,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c.a.get("index.php?option=com_emundus_workflow&controller=item&task=getitem",{params:{id:e}});case 2:o=t.sent,a=o.data.data[0],n={item_name:a.item_name,item_id:a.item_id,workflow_id:a.workflow_id,item_label:document.getElementById("label_"+e).innerText||"anonyme"},c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&sub_option=clone&workflowid="+n.workflow_id+"&olditemid="+n.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({data:n})}).then((function(t){c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:zt.stringify({id:t.data.data})}).then((function(e){var o=e.data.data[0];s.scene.nodes.push({id:t.data.data,x:-500+Math.floor(100*Math.random()+1),y:70+Math.floor(100*Math.random()+1),type:n.item_name,label:n.item_label,background:o.CSS_style})}))}));case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}},Xt=Yt,Ht=(o("6b88"),Object(b["a"])(Xt,mt,ft,!1,null,"68b13ca0",null)),Gt=Ht.exports,Vt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"workflowspace"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{staticClass:"editable-label",attrs:{contenteditable:"true",id:"editable-label"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updateStepLabel()}}},[t._v("\n    "+t._s(this.step.title)+"\n  ")]),o("div",{staticClass:"button-group"},[o("b-button",{staticStyle:{margin:"10px"},attrs:{variant:"warning"},on:{click:function(e){t.seen=!t.seen}}},[t._v(t._s(t.WorkflowSpace_button.add_button)),o("b-icon",{attrs:{icon:"clipboard-plus"}})],1),o("b-button",{staticStyle:{margin:"10px"},attrs:{variant:"success"},on:{click:function(e){return t.alertSaveDisplay()}}},[t._v(t._s(t.WorkflowSpace_button.save_button)),o("b-icon",{attrs:{icon:"bookmark-check"}})],1),o("b-button",{staticStyle:{margin:"10px"},attrs:{variant:"danger"},on:{click:function(e){return t.alertExitDisplay()}}},[t._v(t._s(t.WorkflowSpace_button.exit_button)),o("b-icon",{attrs:{icon:"x-circle"}})],1)],1),o("transition",{attrs:{name:"bounce"}},[t.seen?o("div",{staticClass:"element-menu"},[o("workflow-space-tools-menu",{attrs:{stepID:t.step},on:{createItem:t.createNode}})],1):t._e()]),o("simple-flowchart",{attrs:{scene:t.scene,height:800,step:t.step},on:{"update:scene":function(e){t.scene=e},nodeClick:t.nodeClick,nodeDelete:t.nodeDelete,linkBreak:t.linkBreak,linkAdded:t.linkAdded,canvasClick:t.canvasClick}})],1)},qt=[],Qt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"workflowspace-tools-menu"}},[o("h2",{staticStyle:{"align-items":"center"}},[t._v(" "+t._s(this.menuTitle)+" ")]),t._l(t.items,(function(e,a){return o("li",{staticStyle:{"line-height":"2.8"}},[o("i",{class:e.icon}),o("span",{staticStyle:{margin:"0 35px"}},[t._v(" "+t._s(e.item_name)+" ")]),o("button",{staticClass:"add-button",on:{click:function(e){return t.addNode(a+1)}}},[t._v("(+)")])])}))],2)},Zt=[],te=o("4328"),ee={name:"WorkflowSpaceToolsMenu",mixins:[X],props:{stepID:Object},data:function(){return{items:[],menuTitle:"Menu",nodeCategory:[]}},created:function(){this.getMenu()},methods:{getMenu:function(){var t=this;c.a.get("index.php?option=com_emundus_workflow&controller=item&task=getitemmenu").then((function(e){var o=[];e.data.data.forEach((function(t){return o.push(t.item_name)})),t.nodeCategory=o,t.items=e.data.data,t.items.splice(0,1)})).catch((function(t){console.log(t)}))},addNode:function(t){var e=this,o=this.nodeCategory,a={item_name:o[t],item_id:t+1,workflow_id:this.$data.id,params:"",axisX:-400+Math.floor(100*Math.random()+1),axisY:50+Math.floor(100*Math.random()+1),step_id:this.stepID.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+a.workflow_id+"&itemid="+a.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:te.stringify({data:a})}).then((function(n){var s={id:n.data.data.id,x:a.axisX,y:a.axisY,type:o[t],label:"",background:n.data.data.style.CSS_style};e.$emit("createItem",s)}))}}},oe=ee,ae=Object(b["a"])(oe,Qt,Zt,!1,null,"3a7647ec",null),ne=ae.exports,se=o("4328"),ie={name:"WorkflowSpace",mixins:[X],components:{ModalConfigElement:Kt,SimpleFlowchart:Gt,WorkflowSpaceToolsMenu:ne},props:{items:Array,step:Object},data:function(){return{WorkflowSpace_button:{add_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_ADD_BUTTON_TITLE"),save_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_SAVE_BUTTON_TITLE"),exit_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_EXIT_BUTTON_TITLE")},seen:!1,scene:{centerX:1024,centerY:140,scale:1,nodes:[],links:[]}}},created:function(){this.loadStep(),this.cronUpdate()},methods:{returnStep:function(){var t=!0;this.$emit("returnBack",t)},createNode:function(t){var e=this;this.scene.nodes.push(t),setTimeout((function(){e.$modal.show("elementModal"+t.id)}),500)},alertWelcomeDisplay:function(){u.a.fire({icon:"success",title:"Bienvenue",text:"C'est vos espace de travail!",footer:"<a href>Tutorials</a>",timer:3e3,showConfirmButton:!1})},insertInitBloc:function(){var t=this,e={item_id:1,step_id:this.step.id,item_name:"Initialisation",workflow_id:this.$data.id,axisX:-700,axisY:-50,style:"#9bde74",params:""};c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getcounditembyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{data:e},paramsSerializer:function(t){return se.stringify(t)}}).then((function(o){0==o.data.status&&c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+e.workflow_id+"&itemid=1",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:se.stringify({data:e})}).then((function(e){t.scene.nodes.push({id:e.data.data,x:-700,y:-69,type:"Initialisation",label:"",background:"#9bde74"})})).catch((function(t){console.log(t)}))}))},saveWorkflow:function(){this.$data.scene.nodes.forEach((function(t){var e={id:t.id,type:t.type,axisX:t.x,axisY:t.y,item_label:document.getElementById("label_"+t.id).innerText,style:t.background};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=saveitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:se.stringify({data:e})}).then((function(t){})).catch((function(t){console.log(t)}))}))},quitWorkflow:function(){this.saveWorkflow(),setTimeout(this.returnStep(),4500)},redirectJRoute:function(t){c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=settings&task=redirectjroute",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{link:t},paramsSerializer:function(t){return se.stringify(t)}}).then((function(t){window.location.href=t.data.data}))},changeToDashboard:function(){this.redirectJRoute("index.php?option=com_emundus_workflow&view=workflow")},loadStep:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,o,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c.a.get("index.php?option=com_emundus_workflow&controller=item&task=getallitemsbystep",{params:{data:this.step.id}});case 2:e=t.sent,o=e.data.data,o.forEach((function(t){a.$data.scene.nodes.push({id:t.id,label:t.item_label,type:t.item_name,x:Number(t.axisX),y:Number(t.axisY),background:t.style})}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),alertExitDisplay:function(){var t=this;u.a.fire({title:"Quitter l'espace de travail",text:"Le workflow sera sauvegardé automatiquement",icon:"error",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",confirmButtonText:'<i class="far fa-thumbs-up"></i> Oui, c\'est sûr',cancelButtonText:"Non, garder ce workflow"}).then((function(e){e.isConfirmed?(u.a.fire("Merci","Le workflow est sauvegardé","success"),t.quitWorkflow()):e.isDismissed&&u.a.fire("Merci","Rester ici","success")}))},alertSaveDisplay:function(){u.a.fire({icon:"success",title:"Congrat",text:"Le workflow est sauvegardé!",footer:"<a href>EMundus SAS</a>",timer:2e3,showConfirmButton:!1}),this.saveWorkflow()},setStepLabel:function(){},cronUpdate:function(){setInterval(this.getWorkflowInfo,45e3)},autoMatchLink:function(){c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=matchalllinksbyworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:se.stringify({data:this.$data.id})}).then((function(t){})).catch((function(t){console.log(t)}))},updateStepLabel:function(){var t={step_label:document.getElementById("editable-label").innerText,id:this.step.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:se.stringify({data:t})}).then((function(t){})).catch((function(t){console.log(t)}))}}},re=ie,le=(o("b801"),Object(b["a"])(re,Vt,qt,!1,null,null,null)),ce=le.exports,de=o("b76a"),ue=o.n(de),me=o("4328"),fe={name:"stepflow",mixins:[X],components:{ModalConfigStep:ut,SimpleFlowchart:Gt,WorkflowSpace:ce,draggable:ue.a,messageModal:tt},props:{},data:function(){return{StepFlow_Button:{add_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_ADD_BUTTON_TITLE"),remove_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_REMOVE_BUTTON_TITLE"),configure_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_CONFIGURE_BUTTON_TITLE"),open_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_OPEN_BUTTON_TITLE"),trigger_button:Joomla.JText._("COM_EMUNDUS_WORKFLOW_COMMON_TRIGGER_BUTTON_TITLE")},columns:[],currentStep:"",hideStep:!1,stateIn:"",stateOut:"",workflowLabel:"",hideWorkflow:!1,loading:!1,campaignID:"",messages:[],stepList:[],show:!1,showDiv:!1,hideDiv:!0,currentDiv:"",form:{},stepParams:Object}},created:function(){this.getWorkflowFromURL(),this.getAllSteps(),this.getMessagesDiv()},methods:{updateMessageBlock:function(t){var e=this.messages.findIndex((function(e){return e.id===t["messageDivId"]}));this.messages[e]["messageTemplate"]=t["messageTemplate"],this.messages[e]["messageDestination"]=t["messageDestination"],this.messages[e]["messageDestinationList"]=t["messageDestinationList"],this.messages[e]["trigger"]=t["trigger"],this.showDiv=!1,this.$forceUpdate()},handleDown:function(t){var e=t.target||t.srcElement;"vm--modal"===e.className&&t.preventDefault()},dragStart:function(t){var e=t.target.id,o=e.split("step_")[1];t.dataTransfer.setData("step",o),this.$emit("dragStart",o)},dragEnd:function(t){var e,o=this,a=[];for(t.preventDefault(),this.columns.forEach((function(t){a[o.columns.indexOf(t)]=t.id})),e=0;e<a.length;e++){var n=function(t){return t.id==a[e]},s=this.columns.findIndex(n);this.columns[s]["order"]=e,this.$forceUpdate()}c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=updatestepordering",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:a,wid:this.$data.id})}).then((function(t){})).catch((function(t){console.log(t)}))},returnToStepFlow:function(t){!0===t&&(this.hideStep=!1,this.hideWorkflow=!0)},updateStep:function(t){var e=function(e){return e.id==t["id"]},o=this.columns.findIndex(e);this.columns[o]["stateIn"]=t["input"],this.columns[o]["stateOut"]=t["output"],this.columns[o]["title"]=t["label"],this.columns[o]["startDate"]=t["startDate"],this.columns[o]["endDate"]=t["endDate"],this.columns[o]["emailTemplate"]=t["email"],this.columns[o]["destination"]=t["destination"],this.columns[o]["style"]=t["color"],this.columns[o]["users"]=t["users"],this.$forceUpdate()},openStep:function(t){this.currentStep=t,this.hideStep=!0,this.hideWorkflow=!1},openDiv:function(t){this.currentDiv=t,this.showDiv=!this.showDiv,this.hideDiv=!this.hideDiv},createStep:function(){var t=this,e={workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=createstep",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:e})}).then((function(e){t.columns.push({id:e.data.data.step_id,order:e.data.data.ordering}),setTimeout((function(){t.$modal.show("stepModal"+e.data.data.step_id)}),500)}))},deleteStep:function(t){var e=this,o={id:t,wid:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=deletestep",params:{data:o},paramsSerializer:function(t){return me.stringify(t)}}).then((function(o){e.columns=e.columns.filter((function(e){return e.id!==t}));var a,n=[];for(e.columns.forEach((function(t){n[e.columns.indexOf(t)]=t.id})),a=0;a<n.length;a++){var s=function(t){return t.id==n[a]},i=e.columns.findIndex(s);e.columns[i]["order"]=a,e.$forceUpdate()}}))},getAllSteps:function(){var t=this;c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=getallsteps",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({wid:this.$data.id})}).then((function(e){t.columns=e.data.data,t.stepParams=e.data.data;var o=e.data.data;t.stepList=o,o.forEach((function(e){c()({method:"get",url:"index.php?option=com_emundus_workflow&controller=step&task=getcurrentparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{sid:e.id},paramsSerializer:function(t){return me.stringify(t)}}).then((function(o){var a=function(t){return t.id==e.id},n=t.columns.findIndex(a),s=o.data.data.inputStatusNames,i=[];s.forEach((function(t){return i.push(t.value)})),t.columns[n]["stateIn"]=i.toString(),t.columns[n]["stateOut"]=o.data.data.outputStatusNames[0].value,t.columns[n]["title"]=o.data.data.stepLabel,t.columns[n]["startDate"]=o.data.data.startDate,t.columns[n]["endDate"]=o.data.data.endDate,t.columns[n]["order"]=o.data.data.ordering,t.columns[n]["style"]=o.data.data.color,t.columns[n]["outputStatus"]=o.data.data.outputStatus,t.columns[n]["campaignId"]=t.campaignID,t.$forceUpdate()}))}))}))},configStep:function(t){this.$modal.show("stepModal"+t)},getWorkflowFromURL:function(){var t=this;c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=getworkflowbyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({wid:this.$data.id})}).then((function(e){t.workflowLabel=e.data.data[0].workflow_name,t.campaignID=e.data.data[0].campaign_id})).catch((function(t){console.log(t)}))},updateWorkflowLabel:function(){var t={workflow_name:_()("#editable-workflow-label").text(),id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=updateworkflowlabel",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:t})}).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))},setStepLabel:function(t){var e=this,o={step_label:_()("#step_label_"+t).text(),id:t,workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=step&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{data:o},paramsSerializer:function(t){return me.stringify(t)}}).then((function(a){var n=e.columns.findIndex((function(e){return e.id==t}));e.columns[n]["title"]=o.step_label})).catch((function(t){console.log(t)}))},createMessageDiv:function(t){var e=this,o={title:Math.random().toString(36).substring(2,10),step_id:t,workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=createmessagebloc",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:o,campaignId:this.campaignID})}).then((function(t){var a=t.data.data.step_id;e.messages.push({step_id:a,id:t.data.data.id,triggerId:t.data.data.trigger,title:o.title})})).catch((function(t){console.log(t)}))},deleteMessageDiv:function(t,e){var o=this,a={id:t,trigger:e};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=deletemessagebloc",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:a})}).then((function(e){o.messages=o.messages.filter((function(e){return e.id!==t}))})).catch((function(t){console.log(t)}))},getMessagesDiv:function(){var t=this,e={workflow_id:this.$data.id};c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=getmessageblocsbyworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:e})}).then((function(e){t.messages=e.data.data;var o=e.data.data;o.forEach((function(e){c()({method:"post",url:"index.php?option=com_emundus_workflow&controller=common&task=getmessageblocbyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:me.stringify({data:{id:e.id}})}).then((function(o){var a=[],n=t.messages.findIndex((function(t){return t.id===e.id}));t.messages[n]["messageTemplate"]=o.data.data.parsedParams.emailSelectedName,t.messages[n]["messageDestination"]=o.data.data.parsedParams.destinationSelectedName;var s=o.data.data.parsedParams.userSelectedName;""!==s?(s.forEach((function(t){a.push(t.name)})),t.messages[n]["messageDestinationList"]=a.toString()):t.messages[n]["messageDestinationList"]="",t.messages[n]["trigger"]=o.data.data.parsedParams.triggerSelected,t.$forceUpdate()})).catch((function(t){console.log(t)}))}))})).catch((function(t){console.log(t)}))}}},pe=fe,_e=(o("d05d"),Object(b["a"])(pe,P,J,!1,null,null,null)),he=_e.exports,ge=o("79e8"),we=o.n(ge);o("4328");a["default"].use(j["a"]),a["default"].use(R["a"]),a["default"].use(I.a),a["default"].config.productionTip=!1,a["default"].config.devtools=!0,a["default"].use(A["a"]),a["default"].use(we.a),document.getElementById("workflow-dashboard")&&new a["default"]({el:"#workflow-dashboard",render:function(t){return t(W,{props:{}})}}),document.getElementById("add-item")&&new a["default"]({el:"#add-item",render:function(t){return t(he,{props:{}})}})},"6b88":function(t,e,o){"use strict";o("7957")},7957:function(t,e,o){},"7b15":function(t,e,o){"use strict";o("8f7e")},"8ce6":function(t,e,o){},"8f7e":function(t,e,o){},"900b":function(t,e,o){"use strict";o("2c1a")},b801:function(t,e,o){"use strict";o("1a69")},c54a:function(t,e,o){"use strict";o("3871")},d05d:function(t,e,o){"use strict";o("8ce6")},d2333:function(t,e,o){"use strict";o("e45f")},e45f:function(t,e,o){}});
//# sourceMappingURL=app.js.map