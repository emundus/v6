(function(t){function e(e){for(var n,s,r=e[0],l=e[1],c=e[2],d=0,m=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(m.length)m.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],n=!0,r=1;r<o.length;r++){var l=o[r];0!==a[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},a={app:0},i=[];function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;i.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"0a43":function(t,e,o){},3264:function(t,e,o){"use strict";o("f1d1")},4818:function(t,e,o){"use strict";o("8caf")},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var n=o("2b0e"),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.top.hover",modifiers:{top:!0,hover:!0}}],staticClass:"editable-workflow-name",attrs:{contenteditable:"true",id:"editable-workflow-name-div",title:"Cliquer sur le nom du workflow pour le changer"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updateWorkflowname()}}},[t._v(" "+t._s(this.$data.workflowname)+" ")]),o("p",{staticClass:"tooltip"},[t._v(" Dernier mis a jour: "+t._s(this.$data.lastSave))]),o("button",{staticClass:"vertical-menu",on:{click:function(e){t.seen=!t.seen}}},[t._v(" NEW BLOCK ")]),o("button",{staticClass:"save-button",on:{click:function(e){return t.alertSaveDisplay()}}},[t._v(" SAUVEGARDER ")]),o("button",{staticClass:"exit-button",on:{click:function(e){return t.alertExitDisplay()}}},[t._v(" QUITTER ")]),o("transition",{attrs:{name:"bounce"}},[t.seen?o("div",{staticClass:"element-menu"},[o("h2",{staticStyle:{"align-items":"center"}},[t._v(" "+t._s(this.$data.menu_message)+" ")]),t._l(t.items,(function(e,n){return o("li",{staticStyle:{"line-height":"2.8"}},[o("i",{class:e.icon}),o("span",{staticStyle:{margin:"0 35px"}},[t._v(" "+t._s(e.item_name)+" ")]),o("button",{staticClass:"add-button",on:{click:function(e){return t.addNode(n+1)}}},[t._v("ADD")])])}))],2):t._e()]),o("simple-flowchart",{attrs:{scene:t.scene,height:800},on:{"update:scene":function(e){t.scene=e},nodeClick:t.nodeClick,nodeDelete:t.nodeDelete,linkBreak:t.linkBreak,linkAdded:t.linkAdded,canvasClick:t.canvasClick}})],1)},i=[],s=(o("c5f6"),o("96cf"),o("3b8d")),r=(o("6b54"),o("ac6a"),o("28a5"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flowchart-container",on:{mousemove:t.handleMove,mouseup:t.handleUp,mousedown:t.handleDown}},[o("svg",{attrs:{width:"100%",height:t.height+"px"}},t._l(t.lines,(function(e,n){return o("flowchart-link",t._b({key:"link"+n,on:{deleteLink:function(o){return t.linkDelete(e.id)}}},"flowchart-link",e,!1,!0))})),1),t._l(t.scene.nodes,(function(e,n){return o("modal-config-element",{attrs:{ID:e.id,element:e},on:{linkingStart:t.linkingStart,linkingStop:t.linkingStop,linkDelete:t.linkDelete}},[t._v(" "+t._s(e.id))])})),t._l(t.scene.nodes,(function(e,n){return o("flowchart-node",t._b({key:"node"+n,style:{background:e.background},attrs:{options:t.nodeOptions},on:{linkingStart:function(o){return t.linkingStart(e.id)},linkingStop:function(o){return t.linkingStop(e.id)},nodeSelected:function(o){return t.nodeSelected(e.id,o)}}},"flowchart-node",e,!1,!0))}))],2)}),l=[],c=(o("20d6"),o("75fc")),u=(o("7514"),o("768b")),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("g",{on:{mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[o("path",{style:t.pathStyle,attrs:{d:t.dAttr}}),t.show.delete?o("a",{on:{click:t.deleteLink}},[o("text",{staticClass:"link-delete",attrs:{"text-anchor":"middle",transform:t.arrowTransform,"font-size":"22"}},[t._v("×")])]):o("path",{style:t.arrowStyle,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:t.arrowTransform}})])},m=[],f={name:"FlowchartLink",props:{start:{type:Array,from:Number,default:function(){return[0,0]}},end:{type:Array,end:Number,default:function(){return[0,0]}},id:Number},data:function(){return{show:{delete:!1}}},methods:{handleMouseOver:function(){this.id&&(this.show.delete=!0)},handleMouseLeave:function(){this.show.delete=!1},caculateCenterPoint:function(){var t=(this.end[0]-this.start[0])/2,e=(this.end[1]-this.start[1])/2;return[this.start[0]+t,this.start[1]+e]},caculateRotation:function(){var t=-Math.atan2(this.end[0]-this.start[0],this.end[1]-this.start[1]),e=180*t/Math.PI;return e<0?e+360:e},deleteLink:function(){this.$emit("deleteLink")}},computed:{pathStyle:function(){return{stroke:"rgb(255, 136, 85)",strokeWidth:2.73205,fill:"none"}},arrowStyle:function(){return{stroke:"rgb(255, 136, 85)",strokeWidth:5.73205,fill:"none"}},arrowTransform:function(){var t=this.caculateCenterPoint(),e=Object(u["a"])(t,2),o=e[0],n=e[1],a=this.caculateRotation();return"translate(".concat(o,", ").concat(n,") rotate(").concat(a,")")},dAttr:function(){var t=this.start[0],e=this.start[1],o=this.end[0],n=this.end[1],a=t,i=e+50,s=o,r=n-50;return"M ".concat(t,", ").concat(e," C ").concat(a,", ").concat(i,", ").concat(s,", ").concat(r,", ").concat(o,", ").concat(n)}}},p=f,h=(o("eebe"),o("2877")),w=Object(h["a"])(p,d,m,!1,null,"0210c1b9",null),g=w.exports,v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flowchart-node",class:{selected:t.options.selected===t.id},style:t.nodeStyle,on:{mousedown:t.handleMousedown,mouseover:t.handleMouseOver,mouseleave:t.handleMouseLeave}},[o("div",{staticClass:"node-port node-input",on:{mousedown:t.inputMouseDown,mouseup:t.inputMouseUp}}),o("div",{staticClass:"node-main"},[o("div",{staticClass:"node-type",domProps:{textContent:t._s(t.type)}}),o("p",{staticClass:"node-label",attrs:{contenteditable:"true",id:"label_"+t.id},domProps:{textContent:t._s(t.label)}})]),o("div",{staticClass:"node-port node-output",on:{mousedown:t.outputMouseDown}}),o("div",{directives:[{name:"show",rawName:"v-show",value:t.show.delete,expression:"show.delete"}],staticClass:"node-delete"},[t._v("×")]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.show.clone,expression:"show.clone"}],ref:"duplicate",staticClass:"duplicate-option",attrs:{id:t.id}},[t._v("Dupliquer")]),o("div",{ref:"configuration",staticClass:"configuration",attrs:{id:t.id}},[t._v("Configurer")]),t._l(this.inputStatus,(function(e){return o("div",{ref:"input-status",refInFor:!0,staticClass:"input-status",attrs:{id:t.id}},[t._v(t._s(e.value)+" "+t._s(e.step))])})),t._l(this.outputStatus,(function(e){return o("div",{ref:"out-status",refInFor:!0,staticClass:"output-status",attrs:{id:t.id}},[t._v(t._s(e.value)+" "+t._s(e.step))])}))],2)},k=[],_=o("bc3a"),b=o.n(_),y=o("4328"),x={name:"FlowchartNode",props:{background:{type:String,default:""},id:{type:Number,default:1e3,validator:function(t){return"number"===typeof t}},x:{type:Number,default:0,validator:function(t){return"number"===typeof t}},y:{type:Number,default:0,validator:function(t){return"number"===typeof t}},type:{type:String,default:"Element"},label:{type:String,default:"input name"},options:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140}}}},data:function(){return{show:{delete:!1,clone:!1},inputStatus:[],outputStatus:[]}},mounted:function(){},created:function(){this.getCurrentStatus(this.id)},computed:{nodeStyle:function(){return{top:this.options.centerY+this.y*this.options.scale+"px",left:this.options.centerX+this.x*this.options.scale+"px",transform:"scale(".concat(this.options.scale,")")}}},methods:{handleMousedown:function(t){var e=t.target||t.srcElement;e.className.indexOf("node-input")<0&&e.className.indexOf("node-output")<0&&this.$emit("nodeSelected",t)},handleMouseOver:function(){this.show.delete=!0,this.show.clone=!0},handleMouseLeave:function(){this.show.delete=!1,this.show.clone=!1},outputMouseDown:function(t){this.$emit("linkingStart"),t.preventDefault()},inputMouseDown:function(t){t.preventDefault()},inputMouseUp:function(t){this.$emit("linkingStop"),t.preventDefault()},handleDuplicatItem:function(t){this.$emit("duplicateItem"),t.preventDefault()},handleConfigure:function(t){this.$emit("configureItem"),t.preventDefault()},getCurrentStatus:function(t){var e=this;b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getcurrentstatusbyitem",params:{id:t},paramsSerializer:function(t){return y.stringify(t)}}).then((function(t){e.inputStatus=t.data.dataIn,e.outputStatus=t.data.dataOut})).catch((function(t){console.log(t)}))}}},C=x,S=(o("3264"),Object(h["a"])(C,v,k,!1,null,"7c0c1c72",null)),$=S.exports;function I(t){var e=t.getBoundingClientRect(),o=window.pageYOffset,n=window.pageXOffset,a=e.top+o,i=e.left+n;return{top:Math.round(a),left:Math.round(i)}}function D(t,e){var o=e.pageX||e.clientX+document.documentElement.scrollLeft,n=e.pageY||e.clientY+document.documentElement.scrollTop,a=I(t),i=o-a.left,s=n-a.top;return[i,s]}var O=o("3d20"),T=o.n(O),M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"ModalConfigElement"}},[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("modal",{attrs:{name:"elementModal"+t.ID,width:580,height:600,adaptive:!0,draggable:!0,scrollable:!0,clickToClose:!0},on:{"before-open":t.beforeOpen}},[o("b-badge",{attrs:{variant:"warning"}},[o("h3",[t._v(t._s(this.$data.name)+" Configuration")])]),o("br"),o("br"),o("b-nav",{attrs:{tabs:""}},[o("b-nav-item",{attrs:{active:""}},[t._v("Configurations")]),o("b-nav-item",[t._v("Lorem Ipsum")])],1),o("br"),o("br"),2==this.type?o("espace-modal",{ref:"forms",attrs:{element:t.element}}):t._e(),4==this.type?o("message-modal",{ref:"emails",attrs:{element:t.element}}):t._e(),o("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.updateParams()}}},[t._v("Sauvegarder")]),o("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.exitModal()}}},[t._v("Quitter")])],1)],1)},L=[],N=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(this.$data.elementTitle.form_name_title))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.formNameSelected,expression:"form.formNameSelected"}],staticClass:"form-control",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"formNameSelected",e.target.multiple?o:o[0])}}},[o("b-form-select-option",{attrs:{selected:"",disabled:""}},[t._v("--Formulaire--")]),t._l(this.$data.forms,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.label))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(this.$data.elementTitle.edited_status_title))]),t._l(this.$data.inStatus,(function(e){return e.disabled?t._e():o("div",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.checked[e.step],expression:"checked[item.step]"}],attrs:{type:"checkbox",id:e.step},domProps:{value:e.step,checked:Array.isArray(t.checked[e.step])?t._i(t.checked[e.step],e.step)>-1:t.checked[e.step]},on:{change:function(o){var n=t.checked[e.step],a=o.target,i=!!a.checked;if(Array.isArray(n)){var s=e.step,r=t._i(n,s);a.checked?r<0&&t.$set(t.checked,e.step,n.concat([s])):r>-1&&t.$set(t.checked,e.step,n.slice(0,r).concat(n.slice(r+1)))}else t.$set(t.checked,e.step,i)}}}),o("label",{staticClass:"form-check-label",attrs:{for:e.step}},[t._v(t._s(e.value))])])}))],2),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(this.$data.elementTitle.output_status_title))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.outputStatus,expression:"form.outputStatus"}],staticClass:"form-control-select",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"outputStatus",e.target.multiple?o:o[0])}}},[o("b-form-select-option",{attrs:{selected:"",disabled:""}},[t._v("--Statut de sortie--")]),t._l(this.$data.outStatus,(function(e,n){return e.disabled?t._e():o("option",{attrs:{disabled:e.disabled},domProps:{value:e.step}},[t._v(" "+t._s(e.value))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-6 col-form-label"},[t._v(t._s(this.$data.elementTitle.notes_title))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.notes,expression:"form.notes"}],staticStyle:{margin:"-5px",width:"102%"},attrs:{id:"notes_form",rows:"3",placeholder:"Notes"},domProps:{value:t.form.notes},on:{input:function(e){e.target.composing||t.$set(t.form,"notes",e.target.value)}}})])]),o("div",{staticClass:"row"},[t._m(0),o("div",{staticClass:"col-sm-4",staticStyle:{"padding-left":"0"}},[o("v-input-colorpicker",{staticStyle:{width:"140px"},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1),o("div",{staticClass:"col-sm-2",attrs:{id:"hex_color"}},[o("p",{staticStyle:{padding:"3px",margin:"0px -15px"},style:{color:this.form.color}},[t._v(t._s(this.form.color))])])])])},E=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col-sm-6"},[o("label",[t._v("Choisir couleur")])])}],A=o("4328"),W={name:"espaceModal",props:{element:Object},data:function(){return{elementTitle:{form_name_title:"Nom du formulaire",edited_status_title:"Statut d'édition",output_status_title:"Statut de sortie",notes_title:"Notes"},form:{formNameSelected:"",inputStatus:[],outputStatus:"",notes:"",color:"#0f4c81"},forms:[],status:[],inStatus:[],outStatus:[],isDisabled:!0,checked:[],in:[],out:[]}},methods:{getAllFormType:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallpublishedforms").then((function(e){t.$data.forms=e.data.data})).catch((function(t){console.log(t)}))},getAllStatus:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallstatus").then((function(e){t.$data.status=e.data.data})).catch((function(t){console.log(t)}))},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},getCurrentStatus:function(t){var e=this;b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getcurrentstatusbyitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:t},paramsSerializer:function(t){return A.stringify(t)}}).then((function(t){null!==t.data.dataIn&&null!==t.data.dataOut?(t.data.dataIn.forEach((function(t){e.checked[t.step]=!0})),e.form.outputStatus=t.data.dataOut[0].step):null==t.data.dataIn&&null!==t.data.dataOut?e.form.outputStatus=t.data.dataOut[0].step:null!==t.data.dataIn&&null==t.data.dataOut&&t.data.dataIn.forEach((function(t){e.checked[t.step]=!0}))})).catch((function(t){console.log(t)}))},getAvailableInStatus:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var o,n,a,i,s,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getavailableinputstatus",{params:{data:e}});case 2:return o=t.sent,t.next=5,b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallstatus");case 5:n=t.sent,a=o.data.data,i=n.data.data,s=i.filter((function(t){var e=t.step;return!a.some((function(t){var o=t.step;return o===e}))})),r=i.filter((function(t){return a.some((function(e){return t.step===e.step}))})),0!==s.length&&0!==r.length?(s.forEach((function(t){return t["disabled"]=!0})),r.forEach((function(t){return t["disabled"]=!1})),l=s.concat(r)):0!==s.length&&0==r.length?(i.forEach((function(t){return t["disabled"]=!0})),l=i):(i.forEach((function(t){return t["disabled"]=!1})),l=i),this.$data.inStatus=l;case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getAvailableOutStatus:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var o,n,a,i,s,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getavailableoutputstatus",{params:{data:e}});case 2:return o=t.sent,t.next=5,b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallstatus");case 5:n=t.sent,a=o.data.data,i=n.data.data,s=i.filter((function(t){var e=t.step;return!a.some((function(t){var o=t.step;return o===e}))})),r=i.filter((function(t){return a.some((function(e){return t.step===e.step}))})),0!==s.length&&0!==r.length?(s.forEach((function(t){return t["disabled"]=!0})),r.forEach((function(t){return t["disabled"]=!1})),l=s.concat(r)):(i.forEach((function(t){return t["disabled"]=!1})),l=i),this.$data.outStatus=l;case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getNonStatusParams:function(t){var e=this;b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getnonstatusparamsbyitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:t},paramsSerializer:function(t){return A.stringify(t)}}).then((function(t){null!==t.data.data&&(e.form.formNameSelected=t.data.data.profile,e.form.notes=t.data.data.notes)}))}},created:function(){this.getAllFormType(),this.form=this.element,this.form.inputStatus=this.checked,this.getCurrentStatus(this.form.id);var t={wid:this.getWorkflowIdFromURL(),id:this.form.id};this.getAvailableInStatus(t),this.getAvailableOutStatus(t),this.getNonStatusParams(this.form.id)}},j=W,R=Object(h["a"])(j,N,E,!1,null,null,null),P=R.exports,B=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(this.$data.elementTitle.email_model_title))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.emailSelected,expression:"form.emailSelected"}],staticClass:"form-control",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"emailSelected",e.target.multiple?o:o[0])}}},[o("b-form-select-option",{attrs:{selected:"",disabled:""}},[t._v("--Message--")]),t._l(this.$data.emails,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.lbl))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(this.$data.elementTitle.input_status_title))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.inputStatus,expression:"form.inputStatus"}],staticClass:"form-control-select",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"inputStatus",e.target.multiple?o:o[0])}}},[o("b-form-select-option",{attrs:{selected:"",disabled:""}},[t._v("--Statut--")]),t._l(this.$data.status,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.value))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(this.$data.elementTitle.destination_title))]),o("div",{staticClass:"col-xs-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.destinationSelected,expression:"form.destinationSelected"}],staticClass:"form-control-select",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"destinationSelected",e.target.multiple?o:o[0])}}},[o("b-form-select-option",{attrs:{selected:"",disabled:""}},[t._v("--Destination--")]),t._l(this.$data.destination,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.label))])}))],2)])]),o("div",{staticClass:"row mb-3"},[o("label",{staticClass:"col-sm-4 col-form-label"},[t._v(t._s(this.$data.elementTitle.notes_title))]),o("div",{staticClass:"col-xs-8"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.notes,expression:"form.notes"}],staticStyle:{margin:"-3px",width:"95%"},attrs:{placeholder:"Supplementaires informations"},domProps:{value:t.form.notes},on:{input:function(e){e.target.composing||t.$set(t.form,"notes",e.target.value)}}})])]),o("div",{staticClass:"row"},[t._m(0),o("div",{staticClass:"col-sm-4",staticStyle:{"padding-left":"0"}},[o("v-input-colorpicker",{staticStyle:{width:"140px"},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1),o("div",{staticClass:"col-sm-2",attrs:{id:"hex_color"}},[o("p",{staticStyle:{padding:"3px",margin:"0px -15px"},style:{color:this.form.color}},[t._v(t._s(this.form.color))])])])])},X=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col-sm-6"},[o("label",[t._v("Choisir couleur")])])}],Y=(o("4328"),{name:"messageModal",props:{element:Object},data:function(){return{elementTitle:{email_model_title:"Message",input_status_title:"Statut d'entrée",destination_title:"Destinataire",notes_title:"Notes"},form:{emailSelected:"",inputStatus:"",destinationSelected:"",notes:"",color:"#0f4c81"},emails:[],status:[],destination:[]}},created:function(){this.getAllMessages(),this.getAllStatus(),this.getAllDestinations(),this.form=this.element},methods:{getAllMessages:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallmessages").then((function(e){t.$data.emails=e.data.data})).catch((function(t){console.log(t)}))},getAllStatus:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getallstatus").then((function(e){t.$data.status=e.data.data})).catch((function(t){console.log(t)}))},getAllDestinations:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=common&task=getalldestinations").then((function(e){t.$data.destination=e.data.data,console.log(e)})).catch((function(t){console.log(t)}))}}}),U=Y,F=Object(h["a"])(U,B,X,!1,null,null,null),z=F.exports,q=o("4328"),J={name:"ModalConfigElement",components:{espaceModal:P,messageModal:z},data:function(){return{type:"",name:""}},props:{ID:Number,element:Object},methods:{getElementByItem:function(){var t=this;b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{id:this.ID},paramsSerializer:function(t){return q.stringify(t)}}).then((function(e){t.$data.type=e.data.data[0].item_id,t.$data.name=e.data.data[0].item_name})).catch((function(t){console.log(t)}))},updateParams:function(){var t=this;b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=updateparams",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:q.stringify({params:this.element})}).then((function(e){T.a.fire({icon:"success",title:"Congrat",text:"Les parametres sont sauvegardés",footer:"<a href>EMundus SAS</a>",confirmButtonColor:"#28a745"}).then((function(e){if(e.isConfirmed){t.$modal.hide("elementModal"+t.ID);var o={wid:t.getWorkflowIdFromURL(),id:t.ID};t.autoCreateLink(o)}}))})).catch((function(t){console.log(t)}))},exitModal:function(){this.$modal.hide("elementModal"+this.ID)},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},autoCreateLink:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=matchalllinksbyitem",params:{data:e},paramsSerializer:function(t){return q.stringify(t)}}).then((function(t){if("available"==t.data.permission){var e={_from:t.data.data,_to:o.ID};o.$emit("linkingStart",e._from),o.$emit("linkingStop",e._to)}else b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=checkexistlink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:q.stringify({data:o.ID})}).then((function(t){if(console.log(t),1==t.data.data){var e={_from:void 0,_to:o.ID};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getlinkbytoitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:q.stringify({data:e})}).then((function(t){var e=t.data.data;console.log(e[0].id),o.$emit("linkDelete",e[0].id)}))}}))})).catch((function(t){console.log(t)}));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),beforeOpen:function(t){this.getElementByItem()}}},V=J,Q=(o("7592"),Object(h["a"])(V,M,L,!1,null,null,null)),G=Q.exports,K=o("4328"),H={name:"VueFlowchart",props:{scene:{type:Object,default:function(){return{centerX:1024,scale:1,centerY:140,nodes:[],links:[],background:""}}},height:{type:Number,default:400}},data:function(){return{action:{linking:!1,dragging:!1,scrolling:!1,selected:0},mouse:{x:0,y:0,lastX:0,lastY:0},draggingLink:null,rootDivOffset:{top:0,left:0}}},components:{ModalConfigElement:G,FlowchartLink:g,FlowchartNode:$},computed:{nodeOptions:function(){return{centerY:this.scene.centerY,centerX:this.scene.centerX,scale:this.scene.scale,offsetTop:this.rootDivOffset.top,offsetLeft:this.rootDivOffset.left,selected:this.action.selected}},lines:function(){var t=this,e=this.scene.links.map((function(e){var o,n,a,i,s,r,l=t.findNodeWithID(e.from),c=t.findNodeWithID(e.to);o=t.scene.centerX+l.x,n=t.scene.centerY+l.y;var d=t.getPortPosition("bottom",o,n),m=Object(u["a"])(d,2);i=m[0],a=m[1],o=t.scene.centerX+c.x,n=t.scene.centerY+c.y;var f=t.getPortPosition("top",o,n),p=Object(u["a"])(f,2);return s=p[0],r=p[1],{start:[i,a],end:[s,r],id:e.id}}));if(this.draggingLink){var o,n,a,i,s=this.findNodeWithID(this.draggingLink.from);o=this.scene.centerX+s.x,n=this.scene.centerY+s.y;var r=this.getPortPosition("bottom",o,n),l=Object(u["a"])(r,2);i=l[0],a=l[1],e.push({start:[i,a],end:[this.draggingLink.mx,this.draggingLink.my]})}return e}},mounted:function(){this.rootDivOffset.top=this.$el?this.$el.offsetTop:0,this.rootDivOffset.left=this.$el?this.$el.offsetLeft:0},methods:{findNodeWithID:function(t){return this.scene.nodes.find((function(e){return t===e.id}))},getPortPosition:function(t,e,o){return"top"===t?[e+40,o]:"bottom"===t?[e+40,o+80]:void 0},linkingStart:function(t){this.action.linking=!0,this.draggingLink={from:t,mx:0,my:0}},linkingStop:function(t){var e=this;if(this.draggingLink&&this.draggingLink.from!==t){var o=this.scene.links.find((function(o){return o.from===e.draggingLink.from&&o.to===t}));if(!o){Math.max.apply(Math,[0].concat(Object(c["a"])(this.scene.links.map((function(t){return t.id})))));var n={from:this.draggingLink.from,to:t},a={from:n.from,to:t,workflow_id:this.getWorkflowIdFromURL(),link_label:""};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=checkmatchingitems",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({data:a})}).then((function(t){1==t.data.data?(b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createlink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({data:a})}).then((function(t){n["id"]=t.data.data})).catch((function(t){console.log(t)})),e.scene.links.push(n),e.$emit("linkAdded",n)):T.a.fire({icon:"error",title:"Erreur",html:"Les status entre les deux items ne sont pas pareils",timer:1500,showConfirmButton:!1})}))}}this.draggingLink=null},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},linkDelete:function(t){var e=this.scene.links.find((function(e){return e.id===t}));e&&(this.scene.links=this.scene.links.filter((function(e){return e.id!==t})),this.$emit("linkBreak",e),this.$swal("Merci","Cette liaison est supprimée","success"),this.deleteLink(t))},nodeSelected:function(t,e){this.action.dragging=t,this.action.selected=t,this.$emit("nodeClick",t),this.mouse.lastX=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouse.lastY=e.pageY||e.clientY+document.documentElement.scrollTop},handleMove:function(t){if(this.action.linking){var e=D(this.$el,t),o=Object(u["a"])(e,2);this.mouse.x=o[0],this.mouse.y=o[1];var n=[this.mouse.x,this.mouse.y];this.draggingLink.mx=n[0],this.draggingLink.my=n[1]}if(this.action.dragging){this.mouse.x=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouse.y=t.pageY||t.clientY+document.documentElement.scrollTop;var a=this.mouse.x-this.mouse.lastX,i=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.moveSelectedNode(a,i)}if(this.action.scrolling){var s=D(this.$el,t),r=Object(u["a"])(s,2);this.mouse.x=r[0],this.mouse.y=r[1];var l=this.mouse.x-this.mouse.lastX,c=this.mouse.y-this.mouse.lastY;this.mouse.lastX=this.mouse.x,this.mouse.lastY=this.mouse.y,this.scene.centerX+=l,this.scene.centerY+=c}},handleUp:function(t){var e=t.target||t.srcElement;this.$el.contains(e)&&(("string"!==typeof e.className||e.className.indexOf("node-input")<0)&&(this.draggingLink=null),"string"===typeof e.className&&e.className.indexOf("node-delete")>-1&&this.nodeDelete(this.action.dragging),"string"===typeof e.className&&e.className.indexOf("duplicate-option")>-1&&this.nodeCloned(this.action.dragging),"string"===typeof e.className&&e.className.indexOf("configuration")>-1&&this.nodeConfig(this.action.dragging)),this.action.linking=!1,this.action.dragging=null,this.action.scrolling=!1},handleDown:function(t){var e=t.target||t.srcElement;if((e===this.$el||e.matches("svg, svg *"))&&1===t.which){this.action.scrolling=!0;var o=D(this.$el,t),n=Object(u["a"])(o,2);this.mouse.lastX=n[0],this.mouse.lastY=n[1],this.action.selected=null}this.$emit("canvasClick",t)},moveSelectedNode:function(t,e){var o=this,n=this.scene.nodes.findIndex((function(t){return t.id===o.action.dragging})),a=this.scene.nodes[n].x+t/this.scene.scale,i=this.scene.nodes[n].y+e/this.scene.scale;this.$set(this.scene.nodes,n,Object.assign(this.scene.nodes[n],{x:a,y:i}))},nodeDelete:function(t){var e=this;this.$emit("nodeDelete",t),b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t})}).then((function(o){var n=o.data.data[0];"Initialisation"==n.item_name?(T.a.fire({icon:"error",title:"Erreur",html:'Vous pouvez pas supprimer le bloc <h2 style="color:red">INITIALISATION!',timer:1500,showConfirmButton:!1}),console.log("cannot delete")):(e.scene.nodes=e.scene.nodes.filter((function(e){return e.id!==t})),e.scene.links=e.scene.links.filter((function(e){return e.from!==t&&e.to!==t})),e.alertDelete(t))}))},nodeConfig:function(t){var e=this;this.$emit("nodeConfig",t),b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t})}).then((function(o){var n=o.data.data[0];"Initialisation"==n.item_name||"Cloture"==n.item_name||e.$modal.show("elementModal"+t)})).catch((function(t){console.log(t)}))},nodeCloned:function(t){var e=this;this.$emit("nodeClone",t),b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t})}).then((function(o){var n=o.data.data[0];"Initialisation"==n.item_name?T.a.fire({icon:"error",title:"Erreur",html:'Vous pouvez pas cloner le bloc <h2 style="color:red">INITIALISATION!',timer:1500,showConfirmButton:!1}):e.alertClone(t)}))},deleteItem:function(t){b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=deleteitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t})}).then((function(t){})).catch((function(t){console.log(t)}))},deleteLink:function(t){b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=deletelink",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t})}).then((function(t){})).catch((function(t){console.log(t)}))},alertDelete:function(t){T.a.fire({icon:"success",title:"Congrat",text:"Le bloc est supprimé!",timer:2e3,showConfirmButton:!1}),this.deleteItem(t)},alertClone:function(t){T.a.fire({icon:"success",title:"Congrat",text:"Le bloc est dupliqué!",timer:2e3,showConfirmButton:!1}),this.cloneItem(t)},cloneItem:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var o,n,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getitem",{params:{id:e}});case 2:o=t.sent,n=o.data.data[0],a={item_name:n.item_name,item_id:n.item_id,workflow_id:n.workflow_id,item_label:document.getElementById("label_"+e).innerText||"anonyme"},b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&sub_option=clone&workflowid="+a.workflow_id+"&olditemid="+a.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({data:a})}).then((function(t){b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=getitem",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:K.stringify({id:t.data.data})}).then((function(e){var o=e.data.data[0];i.scene.nodes.push({id:t.data.data,x:-500+Math.floor(100*Math.random()+1),y:70+Math.floor(100*Math.random()+1),type:a.item_name,label:a.item_label,background:o.CSS_style})}))}));case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}},Z=H,tt=(o("4818"),Object(h["a"])(Z,r,l,!1,null,"0b8a17ce",null)),et=tt.exports,ot=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap/dist/css/bootstrap.min.css"}}),o("link",{attrs:{type:"text/css",rel:"stylesheet",href:"//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"}}),o("div",{staticStyle:{"text-align":"center"}},[o("b-alert",{staticStyle:{"background-color":"#d4edda","border-color":"#c3e6cb",padding:"3.75rem","align-items":"center"},attrs:{show:"",variant:"success",show:"",dismissible:""}},[o("h1",[t._v("EMundus Workflow Demo")])])],1),o("b-form-group",{attrs:{"label-cols":"4","label-cols-lg":"2","label-size":"lg",label:"Nom du workflow","label-for":"input-lg"}},[o("b-form-input",{attrs:{placeholder:"Nom du workflow",size:"sm"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),o("b-form-group",{attrs:{"label-cols":"4","label-cols-lg":"2","label-size":"lg",label:"Campagne associee","label-for":"input-lg"}},[o("b-form-select",{staticClass:"form-control-select",model:{value:t.selectedCampaign,callback:function(e){t.selectedCampaign=e},expression:"selectedCampaign"}},[o("b-form-select-option",{attrs:{disabled:"",selected:""}},[t._v("-- Campagnes disponibles --")]),t._l(this.availableCampaigns,(function(e){return o("option",{domProps:{value:e.id}},[t._v(" "+t._s(e.label)+" ")])}))],2)],1),o("b-button",{attrs:{type:"submit",variant:"success"},on:{click:t.createworkflow}},[t._v("Créer nouveau workflow")]),o("table",{staticClass:"styled-table"},[o("thead",[o("tr",t._l(this.$data.table_header,(function(e,n){return o("th",{key:n},[t._v(" "+t._s(e)+" ")])})),0)]),o("tbody",t._l(this.$props.workflows,(function(e,n){return o("tr",{key:e.id},[o("th",[t._v(t._s(n))]),o("th",[t._v(t._s(e.id))]),o("th",[t._v(t._s(e.workflow_name))]),o("th",[t._v(" "+t._s(e.label)+" ")]),o("th",[t._v(t._s(e.name))]),o("th",[t._v(t._s(e.created_at))]),o("th",[t._v(t._s(e.updated_at))]),o("th",[o("button",{staticClass:"edit-button",on:{click:function(o){return t.changeToWorkflowSpace(e.id)}}},[t._v("OUVRIR")]),o("button",{staticClass:"delete-button",on:{click:function(o){return t.alertDeleteDisplay(e.id)}}},[t._v("SUPPRIMER")]),o("button",{staticClass:"duplicate-button",on:{click:function(o){return t.alertDuplicateDisplay(e.id)}}},[t._v("DUPLIQUER")])])])})),0)]),o("div",{staticClass:"alert-count"},[o("p",[t._v(" "+t._s(this.workflow_message)+" ")])])],1)},nt=[],at=(o("7f7f"),o("859b"),new Date,o("4328")),it={name:"addWorkflow",data:function(){return{availableCampaigns:0,workflow_message:"",form:{workflow_name:""},name:"",selectedCampaign:0,workflow_id:0,table_header:["No.ligne","Workflow ID","Nom du workflow","Campagne Associeé","Dernier Mis-a-jour par","Créé à","Mis-a-jour ","Action"]}},props:{workflow:Object,campaigns:Array,workflow_id:Number,workflows:Array},created:function(){this.getAllWorkflow(),this.getAllAvailableCampaigns()},methods:{getAllAvailableCampaigns:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getallavailablecampaigns").then((function(e){console.log(e.data.data),t.$data.availableCampaigns=e.data.data})).catch((function(t){console.log(t)}))},getAllWorkflow:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getallworkflows").then((function(e){t.workflows=e.data.data,0==parseInt(e.data.count)?t.workflow_message="Aucun workflow trouvé":t.workflow_message="Il y a "+e.data.count+" workflow(s)"})).catch((function(t){console.log(t)}))},createworkflow:function(){var t=this;b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=getcampaignbyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:at.stringify({data:this.$data.selectedCampaign})}).then((function(e){var o={campaign_id:t.$data.selectedCampaign,workflow_name:t.$data.name||"Workflow de "+e.data.data[0].label};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=createworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:at.stringify({data:o})}).then((function(e){t.workflow=e.data.data,t.changeToWorkflowSpace(e.data.data)})).catch((function(t){console.log(t)}))}))},deleteWorkflow:function(t){var e=this;b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=deleteworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:at.stringify({wid:t})}).then((function(t){e.getAllWorkflow()})).catch((function(t){console.log(t)}))},duplicateWorkflow:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var o,n,a,i,s,r,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("index.php?option=com_emundus_workflow&controller=workflow&task=getworkflowbyid",{params:{wid:e}});case 2:return o=t.sent,n=o.data.data[0],a={campaign_id:n.campaign_id,workflow_name:n.workflow_name+"copy"},t.next=7,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getallitemsbyworkflow",{params:{data:e}});case 7:return i=t.sent,t.next=10,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getalllinks",{params:{data:e}});case 10:s=t.sent,r=i.data.data,s.data.data,b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=createworkflow&suboption=clone&oldworkflow="+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:at.stringify({data:a})}).then((function(t){r.forEach((function(e){var o={item_id:e.item_id,item_label:e.item_label,item_name:e.item_name,style:e.style,workflow_id:t.data.data,axisX:e.axisX,axisY:e.axisY};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+t.data.data+"&itemid="+o.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:at.stringify({data:o})}).then((function(t){})),l.getAllWorkflow()}))})).catch((function(t){console.log(t)}));case 14:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),alertDeleteDisplay:function(t){var e=this;T.a.fire({title:"Supprime le workflow",text:"Action irréversible",icon:"error",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",confirmButtonText:'<i class="far fa-thumbs-up"></i> Oui, c\'est sûr',cancelButtonText:"Non, garder ce workflow"}).then((function(o){o.isConfirmed?(T.a.fire("Merci","Le workflow est supprimé","success"),e.deleteWorkflow(t)):o.isDismissed&&T.a.fire("Merci","Le workflow est gardé","success")}))},alertDuplicateDisplay:function(t){T.a.fire({icon:"success",title:"Congrat",html:'Le workflow est dupliqué <h2 style="color:red">SAUF LES LIAISONS!',footer:"<a href>EMundus SAS</a>",timer:2e3,showConfirmButton:!1}),this.duplicateWorkflow(t)},redirectJRoute:function(t){b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=settings&task=redirectjroute",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{link:t},paramsSerializer:function(t){return at.stringify(t)}}).then((function(t){window.location.href=window.location.pathname+t.data.data}))},changeToWorkflowSpace:function(t){this.redirectJRoute("index.php?option=com_emundus_workflow&view=item&layout=add&id="+t)}}},st=it,rt=(o("f81a"),Object(h["a"])(st,ot,nt,!1,null,null,null)),lt=rt.exports,ct=(new Date,o("4328")),ut={name:"app",components:{ModalConfigElement:G,SimpleFlowchart:et,addWorkflow:lt},props:{items:Array,nodeCategory:Array},data:function(){return{lastSave:"",workflowname:"",seen:!1,menu_message:"Menu",scene:{centerX:1024,centerY:140,scale:1,nodes:[],links:[]}}},created:function(){this.cronSave(),this.alertWelcomeDisplay(),this.loadWorkflow(),this.insertInitBloc(),this.cronUpdate(),this.getWorkflowInfo(),this.getMenu()},methods:{alertWelcomeDisplay:function(){T.a.fire({icon:"success",title:"Bienvenue",text:"C'est vos espace de travail!",footer:"<a href>Tutorials</a>",timer:3e3,showConfirmButton:!1})},getWorkflowInfo:function(){var t=this;b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=workflow&task=getworkflowbyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{wid:this.getWorkflowIdFromURL()},paramsSerializer:function(t){return ct.stringify(t)}}).then((function(e){var o=e.data.data[0];t.$data.workflowname=o.workflow_name,t.$data.lastSave=o.updated_at}))},insertInitBloc:function(){var t=this,e={item_id:1,item_name:"Initialisation",workflow_id:this.getWorkflowIdFromURL(),axisX:-700,axisY:-50,style:"#9bde74"};b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=item&task=getcounditembyid",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{data:e},paramsSerializer:function(t){return ct.stringify(t)}}).then((function(o){0==o.data.status&&b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+e.workflow_id+"&itemid=1",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ct.stringify({data:e})}).then((function(e){t.scene.nodes.push({id:e.data.data,x:-700,y:-69,type:"Initialisation",label:"",background:"#9bde74"})})).catch((function(t){console.log(t)}))}))},getWorkflowIdFromURL:function(){return window.location.href.split("id=")[1]},getMenu:function(){var t=this;b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getallitems").then((function(e){var o=[];e.data.data.forEach((function(t){return o.push(t.item_name)})),t.$props.nodeCategory=o,t.items=e.data.data,t.items.splice(0,1)})).catch((function(t){console.log(t)}))},addNode:function(t){var e=this,o=this.$props.nodeCategory,n={item_name:o[t],item_id:t+1,workflow_id:this.getWorkflowIdFromURL(),params:"",axisX:-400+Math.floor(100*Math.random()+1),axisY:50+Math.floor(100*Math.random()+1)};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=createitem&workflowid="+n.workflow_id+"&itemid="+n.item_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ct.stringify({data:n})}).then((function(a){console.log(a);var i=a.data.data.id.toString();e.$data.scene.nodes.push({id:i,x:n.axisX,y:n.axisY,type:o[t],label:"",background:a.data.data.style.CSS_style}),setTimeout((function(){e.$modal.show("elementModal"+i)}),500)}))},cronSave:function(){setInterval(this.saveWorkflow,6e4)},saveWorkflow:function(){this.$data.scene.nodes.forEach((function(t){var e={id:t.id,type:t.type,axisX:t.x,axisY:t.y,item_label:document.getElementById("label_"+t.id).innerText,style:t.background};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=saveworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ct.stringify({data:e})}).then((function(t){})).catch((function(t){console.log(t)}))}))},quitWorkflow:function(){this.saveWorkflow(),setTimeout(this.changeToDashboard(),4500)},redirectJRoute:function(t){b()({method:"get",url:"index.php?option=com_emundus_workflow&controller=settings&task=redirectjroute",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{link:t},paramsSerializer:function(t){return ct.stringify(t)}}).then((function(t){window.location.href=t.data.data}))},changeToDashboard:function(){this.redirectJRoute("index.php?option=com_emundus_workflow&view=workflow")},loadWorkflow:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,o,n,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getallitemsbyworkflow",{params:{data:this.getWorkflowIdFromURL()}});case 2:return e=t.sent,t.next=5,b.a.get("index.php?option=com_emundus_workflow&controller=item&task=getalllinks",{params:{data:this.getWorkflowIdFromURL()}});case 5:o=t.sent,n=e.data.data,a=o.data.data,n.forEach((function(t){i.$data.scene.nodes.push({id:t.id,label:t.item_label,type:t.item_name,x:Number(t.axisX),y:Number(t.axisY),background:t.style})})),a.forEach((function(t){i.$data.scene.links.push({id:t.id,from:t.from,to:t.to})}));case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),alertExitDisplay:function(){var t=this;T.a.fire({title:"Quitter l'espace de travail",text:"Le workflow sera sauvegardé automatiquement",icon:"error",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",confirmButtonText:'<i class="far fa-thumbs-up"></i> Oui, c\'est sûr',cancelButtonText:"Non, garder ce workflow"}).then((function(e){e.isConfirmed?(T.a.fire("Merci","Le workflow est sauvegardé","success"),t.quitWorkflow()):e.isDismissed&&T.a.fire("Merci","Rester ici","success")}))},alertSaveDisplay:function(){T.a.fire({icon:"success",title:"Congrat",text:"Le workflow est sauvegardé!",footer:"<a href>EMundus SAS</a>",timer:2e3,showConfirmButton:!1}),this.saveWorkflow()},updateWorkflowname:function(){var t={workflow_name:document.getElementById("editable-workflow-name-div").innerText,id:this.getWorkflowIdFromURL()};b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=workflow&task=updateworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ct.stringify({data:t})}).then((function(t){})).catch((function(t){console.log(t)}))},cronUpdate:function(){setInterval(this.getWorkflowInfo,45e3)},autoMatchLink:function(){b()({method:"post",url:"index.php?option=com_emundus_workflow&controller=item&task=matchalllinksbyworkflow",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:ct.stringify({data:this.getWorkflowIdFromURL()})}).then((function(t){})).catch((function(t){console.log(t)}))}}},dt=ut,mt=(o("fffb"),Object(h["a"])(dt,a,i,!1,null,null,null)),ft=mt.exports,pt=(o("b15b"),o("15f5"),o("7051"),o("5886")),ht=o("1881"),wt=o.n(ht),gt=o("5f5b"),vt=o("b1e0"),kt=(o("f9e3"),o("2dd8"),o("79e8")),_t=o.n(kt);o("4328");n["default"].use(gt["a"]),n["default"].use(vt["a"]),n["default"].use(wt.a),n["default"].config.productionTip=!1,n["default"].config.devtools=!0,n["default"].use(pt["a"]),n["default"].use(_t.a),document.getElementById("add-workflow")&&new n["default"]({el:"#add-workflow",render:function(t){return t(lt,{props:{}})}}),document.getElementById("add-item")&&new n["default"]({el:"#add-item",render:function(t){return t(ft,{props:{}})}})},7592:function(t,e,o){"use strict";o("7655")},7655:function(t,e,o){},"8caf":function(t,e,o){},a210:function(t,e,o){},adb8:function(t,e,o){},eebe:function(t,e,o){"use strict";o("0a43")},f1d1:function(t,e,o){},f81a:function(t,e,o){"use strict";o("adb8")},fffb:function(t,e,o){"use strict";o("a210")}});
//# sourceMappingURL=app.js.map