if(!Joomla)throw new Error("Joomla API is not properly initialised");Joomla.apps={view:"dashboard",id:0,ordering:"",version:"current",cssfiles:[],jsfiles:[],list:0,loaded:0,update:!1,options:Joomla.getOptions("plg_installer_webinstaller",{})};var apps_base_url=Joomla.apps.options.base_url;Joomla.loadweb=function(e){if(""==e)return!1;var o=new RegExp(Joomla.apps.options.base_url),a=new RegExp("^index.php");if(!o.test(e)&&!a.test(e))return window.open(e,"_blank"),!1;e+="&product="+Joomla.apps.options.product+"&release="+Joomla.apps.options.release+"&dev_level="+Joomla.apps.options.dev_level+"&list="+(Joomla.apps.list?"list":"grid")+"&pv="+Joomla.apps.options.pv;var l=Joomla.apps.ordering,r=Joomla.apps.version;return""!==l&&jQuery("#com-apps-ordering").val()&&(e+="&ordering="+(l=jQuery("#com-apps-ordering").val())),""!==r&&jQuery("#com-apps-filter-joomla-version").val()&&(e+="&filter_version="+(r=jQuery("#com-apps-filter-joomla-version").val())),jQuery("html, body").animate({scrollTop:0},0),jQuery("#myTabContent").length&&Joomla.loadingLayer("show",jQuery("#myTabContent")[0]),jQuery.ajax({url:e,dataType:"jsonp",cache:!0,jsonpCallback:"jedapps_jsonpcallback",timeout:2e4,success:function(e){if(jQuery("#web-loader").hide(),jQuery("#jed-container").html(e.data.html),!Joomla.apps.update&&e.data.pluginuptodate<1){Joomla.apps.update=!0;var o=Joomla.JText._("COM_INSTALLER_WEBINSTALLER_INSTALL_OBSOLETE"),a=Joomla.JText._("JLIB_INSTALLER_UPDATE");0==e.data.pluginuptodate&&(o=Joomla.JText._("COM_INSTALLER_WEBINSTALLER_INSTALL_UPDATE_AVAILABLE")),Joomla.apps.options.is_hathor?jQuery("#element-box").prepend(jQuery('<dl id="system-message"><dt class="info">info</dt><dd class="info message"><ul><li>'+o+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input class="btn" type="button" value="'+a+'" onclick="Joomla.submitbuttonInstallWebInstaller()" /></li></ul></dd></dl>')):jQuery("#web").prepend(jQuery('<div class="alert alert-info j-jed-message" style="margin-bottom: 20px; line-height: 2em; color:#333333;">'+o+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input class="btn" type="button" value="'+a+'" onclick="Joomla.submitbuttonInstallWebInstaller()" /></div>'))}Joomla.apps.hideLoadingLayer()},fail:function(){jQuery("#web-loader").hide(),jQuery("#web-loader-error").show(),Joomla.apps.hideLoadingLayer()},complete:function(){jQuery("#joomlaapsinstallatinput")&&jQuery("#joomlaapsinstallatinput").val(Joomla.apps.options.installat_url),Joomla.apps.clickforlinks(),Joomla.apps.clicker(),Joomla.apps.list&&jQuery(".list-view").click(),Joomla.apps.hideLoadingLayer()},error:function(e,o,a){e.responseText&&jQuery("#web-loader-error").html(e.responseText),jQuery("#web-loader").hide(),jQuery("#web-loader-error").show(),Joomla.apps.hideLoadingLayer()}}),!0},Joomla.webpaginate=function(e,o){jQuery("#web-paginate-loader").show(),jQuery.get(e,function(e){jQuery("#web-paginate-loader").hide(),jQuery("#"+o).html(e.data.html)},"jsonp").fail(function(){jQuery("#web-paginate-loader").hide()})},Joomla.installfromwebexternal=function(e){return 1==confirm(Joomla.JText._("PLG_INSTALLER_WEBINSTALLER_REDIRECT_TO_EXTERNAL_SITE_TO_INSTALL").replace("[SITEURL]",redirectUrl))&&(jQuery("#adminForm").attr("action",e),jQuery("input[name=task]").prop("disabled",!0),jQuery("input[name=install_directory]").prop("disabled",!0),jQuery("input[name=install_url]").prop("disabled",!0),jQuery("input[name=installtype]").prop("disabled",!0),jQuery("input[name=filter_search]").prop("disabled",!0),!0)},Joomla.installfromweb=function(e,o){return""==e?(alert(Joomla.JText._("PLG_INSTALLER_WEBINSTALLER_CANNOT_INSTALL_EXTENSION_IN_PLUGIN")),!1):(jQuery("#install_url").val(e),jQuery("#uploadform-web-url").text(e),o?(jQuery("#uploadform-web-name").text(o),jQuery("#uploadform-web-name-label").show()):jQuery("#uploadform-web-name-label").hide(),jQuery("#jed-container").slideUp(300),jQuery("#uploadform-web").show(),!0)},Joomla.installfromwebcancel=function(){jQuery("#uploadform-web").hide(),jQuery("#jed-container").slideDown(300),Joomla.apps.list&&jQuery(".list-view").click()},Joomla.installfromwebajaxsubmit=function(){var e="&view="+Joomla.apps.view;(Joomla.apps.id&&(e+="&id="+Joomla.apps.id),jQuery("#com-apps-searchbox").val())&&(e+="&filter_search="+encodeURI(jQuery("#com-apps-searchbox").val().toLowerCase().replace(/ +/g,"_").replace(/[^a-z0-9-_]/g,"").trim()));var o=Joomla.apps.ordering,a=Joomla.apps.version;""!==o&&jQuery("#com-apps-ordering").val()&&(o=jQuery("#com-apps-ordering").val()),o&&(e+="&ordering="+o),""!==a&&jQuery("#com-apps-filter-joomla-version").val()&&(a=jQuery("#com-apps-filter-joomla-version").val()),a&&(e+="&filter_version="+a),Joomla.loadweb(Joomla.apps.options.base_url+"index.php?format=json&option=com_apps"+e)},Joomla.apps.clickforlinks=function(){jQuery("a.transcode").each(function(e,o){var a,l=jQuery(this).attr("href");a=l,jQuery(o).live("click",function(e){var o=new RegExp(Joomla.apps.options.base_url),l=new RegExp("^index.php");o.test(a)||l.test(a)?(Joomla.apps.view=a.replace(/^.+[&\?]view=(\w+).*$/,"$1"),"dashboard"==Joomla.apps.view?Joomla.apps.id=0:"category"==Joomla.apps.view&&(Joomla.apps.id=a.replace(/^.+[&\?]id=(\d+).*$/,"$1")),e.preventDefault(),Joomla.loadweb(Joomla.apps.options.base_url+a)):(e.preventDefault(),Joomla.loadweb(a))}),jQuery(this).attr("href","#")})},Joomla.apps.initialize=function(){Joomla.apps.loaded=1,Joomla.loadweb(Joomla.apps.options.base_url+"index.php?format=json&option=com_apps&view=dashboard"),Joomla.apps.clickforlinks(),jQuery("#com-apps-searchbox").live("keypress",function(e){13==e.which&&Joomla.apps.initiateSearch()}),jQuery("#search-reset").live("click",function(e){jQuery("#com-apps-searchbox").val(""),Joomla.apps.initiateSearch()}),jQuery("#com-apps-ordering").live("change",function(e){Joomla.apps.ordering=jQuery(this).prop("selectedIndex"),Joomla.installfromwebajaxsubmit()}),jQuery("#com-apps-filter-joomla-version").live("change",function(e){Joomla.apps.version=jQuery(this).prop("selectedIndex"),Joomla.installfromwebajaxsubmit()}),""!=Joomla.apps.options.installfrom_url&&Joomla.installfromweb(Joomla.apps.options.installfrom_url)},Joomla.apps.initiateSearch=function(){Joomla.apps.view="dashboard",Joomla.installfromwebajaxsubmit()},Joomla.apps.clicker=function(){jQuery(".grid-view").live("click",function(){Joomla.apps.list=0,jQuery(".list-container").addClass("hidden"),jQuery(".grid-container").removeClass("hidden"),jQuery("#btn-list-view").removeClass("active"),jQuery("#btn-grid-view").addClass("active")}),jQuery(".list-view").live("click",function(){Joomla.apps.list=1,jQuery(".grid-container").addClass("hidden"),jQuery(".list-container").removeClass("hidden"),jQuery("#btn-grid-view").removeClass("active"),jQuery("#btn-list-view").addClass("active")})},Joomla.apps.hideLoadingLayer=function(){jQuery("#myTabContent").length&&Joomla.loadingLayer("hide",jQuery("#myTabContent")[0])},Joomla.submitbutton5=function(e){var o=document.getElementById("adminForm");""!=o.install_url.value&&"http://"!=o.install_url.value?Joomla.submitbutton4():""==o.install_url.value?alert(Joomla.JText._("COM_INSTALLER_MSG_INSTALL_ENTER_A_URL")):(Joomla.apps.options.is_hathor||jQuery("#appsloading").css("display","block"),o.installtype.value="web",o.submit())};
