!function(){"use strict";var e,a,t,r,l,o,n,d=document.querySelector(".js-draggable");if(d)e=d.dataset.url,a=d.dataset.direction,t=d.dataset.nested;else if(Joomla.getOptions("draggable-list")){var s=Joomla.getOptions("draggable-list");(d=document.querySelector(s.id)).classList.contains("js-draggable")||d.classList.add("js-draggable"),e=s.url,a=s.direction,t=s.nested}if(d){o=d.closest("form"),(n=new FormData(o)).delete("task"),n.delete("order[]"),document.addEventListener("touchstart",(function(){}),!1);var u=function(e,t,r,l){var o,n=[];if(r<l)for(e[l].value=e[l-1].value,o=r;o<l;o+=1)e[o].value="asc"===a?parseInt(e[o].value,10)-1:parseInt(e[o].value,10)+1;else for(e[l].value=e[l+1].value,o=l+1;o<=r;o+=1)e[o].value="asc"===a?parseInt(e[o].value,10)+1:parseInt(e[o].value,10)-1;for(o=0;o<e.length-1;o+=1)n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(t[o].value));return n},c=function(a){var t,o,s,c=a.dataset.draggableGroup;c?(s='tr[data-draggable-group="'+c+'"]',t='[data-draggable-group="'+c+'"] [name="order[]"]',o='[data-draggable-group="'+c+'"] [name="cid[]"]'):(s="tr",t='[name="order[]"]',o='[name="cid[]"]');var i=[].slice.call(d.querySelectorAll(s)),g=[].slice.call(d.querySelectorAll(t)),m=[].slice.call(d.querySelectorAll(o));if(l=i.indexOf(a),e){var p=document.querySelector('[name="task"]');p&&p.setAttribute("name","some__Temporary__Name__");var v={url:e,method:"POST",data:new URLSearchParams(n).toString()+"&"+u(g,m,r,l).join("&"),perform:!0};Joomla.request(v),p&&p.setAttribute("name","task")}!function(e){if(e.dataset.itemId){var a=e.dataset.itemId,t=d.querySelectorAll('tr[data-parents~="'+a+'"]');t.length&&e.after.apply(e,t)}}(a)};dragula([d],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,r,l){return t&&null!==l?l.dataset.draggableGroup&&l.dataset.draggableGroup===e.dataset.draggableGroup:null===l||l&&"tr"===l.tagName.toLowerCase()},mirrorContainer:d}).on("drag",(function(e){var a,t=e.dataset.draggableGroup;a=t?'tr[data-draggable-group="'+t+'"]':"tr";var l=[].slice.call(d.querySelectorAll(a));r=l.indexOf(e)})).on("drop",(function(e){c(e)}))}}();