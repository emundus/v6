(function(t){function e(e){for(var s,i,c=e[0],o=e[1],l=e[2],u=0,m=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);d&&d(e);while(m.length)m.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,c=1;c<a.length;c++){var o=a[c];0!==n[o]&&(s=!1)}s&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var s={},n={app:0},r=[];function i(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=s,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(a,s,function(e){return t[e]}.bind(null,s));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=o;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("85ec")},1:function(t,e){},"2c19":function(t,e,a){"use strict";a("86ae")},"2d3c":function(t,e,a){"use strict";a("7e33")},"410a":function(t,e,a){"use strict";a("a6a7")},"41c7":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=a("2f62"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("List")],1)},i=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.currentFile?a("EvaluationModal",{attrs:{file:t.currentFile,evaluation_form:Number(t.files.evaluation_form),readonly:"1"==this.$parent.$props.readonly},on:{"reload-list":t.getMyEvaluations}}):t._e(),t.campaigns.length>0&&!t.loading?a("div",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCampaign,expression:"currentCampaign"}],staticStyle:{width:"max-content"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentCampaign=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"0"}},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_PLEASE_SELECT")))]),t._l(t.campaigns,(function(e){return a("option",{domProps:{value:e.id}},[t._v(t._s(e.label)+" - "+t._s(e.files)+" "+t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_FILES_TO_EVALUATE")))])}))],2)]):t._e(),0!==t.campaigns.length||t.loading?t._e():a("div",[a("p",{staticClass:"em-h5",staticStyle:{"text-align":"center","margin-top":"32px"}},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_NO_FILE")))])]),t.loading?t._e():a("div",{staticClass:"em-mt-16"},[t.files.elements&&0!==t.files.evaluation_form?a("div",{staticClass:"table-wrapper"},[a("table",{staticClass:"em-mt-16",class:{loading:t.loading},attrs:{"aria-describedby":"Table of files to evaluate"}},[a("thead",[a("tr",[a("th",{attrs:{id:"fnum"},on:{click:function(e){return t.orderBy("fnum")}}},[t._v(" "+t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_FNUM"))+" "),"fnum"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"fnum"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{attrs:{id:"applicant_name"},on:{click:function(e){return t.orderBy("applicant_name")}}},[t._v(" "+t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_APPLICANT_NAME"))+" "),"applicant_name"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v(" arrow_upward ")]):t._e(),"applicant_name"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v(" arrow_downward ")]):t._e()]),t._l(t.shownElements,(function(e){return a("th",{key:e.id,attrs:{id:e.name},on:{click:function(a){return t.orderBy(e.name)}}},[t._v(" "+t._s(e.label)+" "),t.sort.orderBy==e.name&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v(" arrow_upward ")]):t._e(),t.sort.orderBy==e.name&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v(" arrow_downward ")]):t._e()])})),a("th",{staticClass:"em-text-align-center",attrs:{id:"completed"}},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_COMPLETED")))])],2)]),a("tbody",t._l(t.files.evaluations,(function(e){return a("EvaluationRow",{key:e.fnum+"-"+e.id,attrs:{file:e,elements:t.files.elements},on:{"open-modal":t.openModal}})})),1)])]):t.currentCampaign.id&&t.files.elements&&0==t.files.evaluation_form?a("div",[a("p",{staticClass:"em-text-align-center"},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_MISSING_EVALUATION_GRID")))])]):t._e()]),t.loading?a("div",[a("div",{staticClass:"em-page-loader"})]):t._e()],1)},o=[],l=(a("4e82"),a("d3b7"),a("159b"),a("4fad"),a("bc3a")),d=a.n(l),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{key:t.file.id,staticClass:"file-row",on:{click:function(e){return t.$emit("open-modal",t.file)}}},[a("td",{staticClass:"td-file"},[a("span",[t._v(t._s(t.file.fnum))])]),a("td",{staticClass:"td-file"},[a("span",[t._v(t._s(t.file.applicant_name))])]),t._l(t.elements,(function(e){return 1==e.show_in_list_summary?a("td",{staticClass:"td-file"},[a("span",[t._v(t._s(t.file[e.name]))])]):t._e()})),a("td",[a("div",{staticClass:"em-w-100 em-flex-row",staticStyle:{"justify-content":"center"}},[""!=t.file.time_date?a("span",{staticClass:"material-icons"},[t._v("done")]):t._e()])])],2)},m=[],p={name:"EvaluationRow",props:{file:{type:Object,required:!0},elements:{type:Object,required:!0}},data:function(){return{columns:[]}}},h=p,f=(a("904e"),a("2877")),_=Object(f["a"])(h,u,m,!1,null,"d9c66f7c",null),v=_.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("modal",{attrs:{id:"evaluation-modal",name:"evaluation-modal",height:"100vh",width:"100vw",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"}},[a("div",{staticClass:"em-modal-header em-w-100"},[a("div",{staticClass:"em-flex-row em-pointer",attrs:{id:"evaluation-modal-close"},on:{click:function(e){t.$emit("reload-list"),t.$modal.hide("evaluation-modal")}}},[a("div",{staticClass:"em-w-max-content em-flex-row"},[a("span",{staticClass:"material-icons-outlined"},[t._v("arrow_back")]),a("span",{staticClass:"em-ml-8"},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_BACK")))])])])]),a("div",{staticClass:"modal-grid"},[a("div",{attrs:{id:"modal-applicationform"}},[a("div",{staticClass:"em-p-16-0"},[a("span",{staticClass:"em-h3 em-w-100 em-flex-row em-flex-center"},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_APPLICATION_FORM")))]),a("button",{staticClass:"btn btn-primary em-ml-16",on:{click:t.exportFile}},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_APPLICATION_DOWNLOAD")))])]),a("div",{staticClass:"scrollable"},[a("div",{domProps:{innerHTML:t._s(t.applicationform)}}),t.preview?a("Attachments",{attrs:{user:t.current_user,fnum:t.file.fnum}}):a("div",{staticClass:"em-p-16",class:{loading:t.loading}},[a("h3",{staticClass:"em-mb-8"},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_ATTACHMENTS")))]),a("table",{staticClass:"em-mt-16",attrs:{"aria-describedby":"Table of files attachments"}},[a("thead",[a("tr",t._l(t.activeAttachmentColumns,(function(e){return a("th",{key:e.name,attrs:{id:e.name}},[t._v(" "+t._s(t.translate(e.label))+" ")])})),0)]),a("tbody",t._l(t.attachments,(function(e){return a("tr",{key:e.id,staticClass:"file-row em-pointer",on:{click:function(a){return t.downloadAttachment(e)}}},t._l(t.activeAttachmentColumns,(function(s){return a("td",{key:s.name,staticClass:"td-file",attrs:{id:"value_"+s.name}},["timedate"===s.name?a("span",[t._v(t._s(t.formattedDate(e[s.name])))]):"value"===s.name?a("a",{staticStyle:{"text-decoration":"underline"}},[t._v(" "+t._s(e[s.name])+" ")]):a("span",[t._v(t._s(e[s.name]))])])})),0)})),0)])])],1)]),a("div",{attrs:{id:"modal-evaluationgrid"}},[a("div",{staticClass:"em-p-16-0"},[a("span",{staticClass:"em-h3 em-w-100 em-flex-row em-flex-center"},[t._v(t._s(t.translate("MOD_EMUNDUS_EVALUATIONS_EVALUATION_GRID")))])]),a("iframe",{staticClass:"iframe-evaluation",attrs:{src:t.url,id:"iframe-evaluation",title:"Evaluation form"},on:{load:function(e){t.loading=!1}}}),t.loading?a("div",{staticClass:"em-page-loader"}):t._e()])])])},b=[],w=a("c7eb"),y=a("1da1"),A=(a("a9e3"),a("9911"),a("4de4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"em-w-100",attrs:{id:"em-attachments"}},[a("div",{staticClass:"head em-w-100 em-flex-row em-flex-space-between"},[a("div",{staticClass:"displayed-user em-flex-row em-flex-start"},[a("p",{staticClass:"name"},[t._v(t._s(t.canSee?t.displayedUser.firstname+" "+t.displayedUser.lastname:t.displayedFnum))]),a("p",{staticClass:"email"},[t._v(t._s(t.displayedUser.email)+" ")]),t.progress?a("p",{staticClass:"attachment-progress"},[t._v(" - "+t._s(t.progress)+"% "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_COMPLETED")))]):t._e()]),a("div",{staticClass:"prev-next-files em-flex-row em-flex-space-between"},[t.fnums.length>1?a("div",{staticClass:"prev em-flex-row em-flex-center",class:{active:t.fnumPosition>0},on:{click:function(e){return t.changeFile(t.fnumPosition-1)}}},[a("span",{staticClass:"material-icons"},[t._v("arrow_back")])]):t._e(),t.fnums.length>1?a("div",{staticClass:"next em-flex-row em-flex-center",class:{active:t.fnumPosition<t.fnums.length-1},on:{click:function(e){return t.changeFile(t.fnumPosition+1)}}},[a("span",{staticClass:"material-icons"},[t._v("arrow_forward")])]):t._e()])]),a("div",{staticClass:"wrapper",class:{loading:t.loading}},[a("div",{staticClass:"em-flex-row em-flex-space-between",attrs:{id:"filters"}},[a("div",{staticClass:"searchbar-wrapper"},[a("input",{ref:"searchbar",attrs:{id:"searchbar",type:"text",placeholder:t.translate("COM_EMUNDUS_ACTIONS_SEARCH")},on:{input:t.searchInFiles}}),a("span",{staticClass:"material-icons search"},[t._v("search")]),a("span",{staticClass:"material-icons clear em-pointer",on:{click:t.resetSearch}},[t._v("clear")])]),a("div",{staticClass:"actions em-flex-row"},[Object.entries(t.thisAttachmentCategories).length>0?a("select",{ref:"categoryFilter",staticClass:"category-select",attrs:{name:"category"},on:{change:t.filterByCategory}},[a("option",{attrs:{value:"all"}},[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_SELECT_CATEGORY")))]),t._l(t.thisAttachmentCategories,(function(e,s){return a("option",{key:s,domProps:{value:s}},[t._v(" "+t._s(e)+" ")])}))],2):t._e(),t.canExport?a("div",{staticClass:"btn-icon-text",class:{disabled:t.checkedAttachments.length<1},on:{click:t.exportAttachments}},[a("span",{staticClass:"material-icons export"},[t._v("file_upload")]),a("span",[t._v(t._s(t.translate("COM_EMUNDUS_EXPORTS_EXPORT")))])]):t._e(),a("span",{staticClass:"material-icons refresh em-pointer",attrs:{title:t.translate("COM_EMUNDUS_ATTACHMENTS_REFRESH_TITLE")},on:{click:function(e){return t.refreshAttachments(!0)}}},[t._v(" autorenew ")]),t.canDelete?a("span",{staticClass:"material-icons delete",class:{disabled:t.checkedAttachments.length<1},attrs:{title:t.translate("COM_EMUNDUS_ATTACHMENTS_DELETE_TITLE")},on:{click:t.confirmDeleteAttachments}},[t._v(" delete_outlined ")]):t._e()])]),a("div",{staticClass:"em-mt-16 em-mb-16"},[t.exportLink?a("a",{attrs:{href:t.exportLink,target:"_blank"},on:{click:function(e){t.exportLink=""}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_EXPORT_LINK"))+" ")]):t._e()]),t.attachments.length?a("div",{staticClass:"table-wrapper"},[a("table",{class:{loading:t.loading},attrs:{"aria-describedby":"Table of attachments information"}},[a("thead",[a("tr",[a("th",{attrs:{id:"check-th"}},[a("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},on:{change:t.updateAllCheckedAttachments}})]),a("th",{attrs:{id:"name"},on:{click:function(e){return t.orderBy("value")}}},[t._v(" "+t._s(t.translate("NAME"))+" "),"value"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"value"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{staticClass:"date",attrs:{id:"date"},on:{click:function(e){return t.orderBy("timedate")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE"))+" "),"timedate"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"timedate"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{staticClass:"desc",attrs:{id:"desc"},on:{click:function(e){return t.orderBy("upload_description")}}},[t._v(" "+t._s(t.translate("DESCRIPTION"))+" "),"upload_description"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"upload_description"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{staticClass:"category",attrs:{id:"category"},on:{click:function(e){return t.orderBy("category")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY"))+" "),"category"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"category"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{staticClass:"status",attrs:{id:"status"},on:{click:function(e){return t.orderBy("is_validated")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CHECK"))+" "),"is_validated"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"is_validated"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),t.canSee?a("th",{attrs:{id:"user"},on:{click:function(e){return t.orderBy("user_id")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY"))+" "),"user_id"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"user_id"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]):t._e(),t.canSee?a("th",{attrs:{id:"modified_by"},on:{click:function(e){return t.orderBy("modified_by")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY"))+" "),"modified_by"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"modified_by"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]):t._e(),a("th",{staticClass:"date",attrs:{id:"modified"},on:{click:function(e){return t.orderBy("modified")}}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE"))+" "),"modified"==t.sort.orderBy&&"asc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_upward")]):t._e(),"modified"==t.sort.orderBy&&"desc"==t.sort.order?a("span",{staticClass:"material-icons"},[t._v("arrow_downward")]):t._e()]),a("th",{staticClass:"permissions",attrs:{id:"permissions"}},[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSIONS")))])])]),a("tbody",t._l(t.displayedAttachments,(function(e){return a("AttachmentRow",{key:e.aid,attrs:{attachment:e,checkedAttachmentsProp:t.checkedAttachments,canUpdate:t.canUpdate,canSee:t.canSee},on:{"open-modal":function(a){return t.openModal(e)},"update-checked-attachments":t.updateCheckedAttachments,"update-status":t.updateStatus,"change-permission":t.changePermission}})})),1)])]):a("p",[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_NO_ATTACHMENTS_FOUND"))+" ")])]),a("modal",{attrs:{id:"edit-modal",name:"edit",height:"100vh",width:"100vw",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;"}},[a("div",{staticClass:"modal-head em-w-100 em-flex-row em-flex-space-between"},[a("div",{staticClass:"em-flex-row em-flex-start",attrs:{id:"actions-left"}},[a("span",[t._v(t._s(t.selectedAttachment.filename))])]),a("div",{staticClass:"em-flex-row",attrs:{id:"actions-right"}},[t.canDownload?a("a",{staticClass:"download btn-icon-text em-mr-24",attrs:{download:"",href:t.attachmentPath}},[a("span",{staticClass:"material-icons"},[t._v(" file_download ")]),a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_LINK_TO_DOWNLOAD")))])]):t._e(),a("div",{staticClass:"prev-next-attachments em-flex-row em-flex-space-between em-mr-8"},[a("div",{staticClass:"prev em-flex-row",class:{active:t.selectedAttachmentPosition>0},on:{click:function(e){return t.changeAttachment(t.selectedAttachmentPosition-1,!0)}}},[a("span",{staticClass:"material-icons"},[t._v(" navigate_before ")])]),a("span",{staticClass:"lvl"},[t._v(t._s(t.selectedAttachmentPosition+1)+" /"+t._s(t.displayedAttachments.length))]),a("div",{staticClass:"next em-flex-row",class:{active:t.selectedAttachmentPosition<t.displayedAttachments.length-1},on:{click:function(e){return t.changeAttachment(t.selectedAttachmentPosition+1)}}},[a("span",{staticClass:"material-icons"},[t._v(" navigate_next ")])])]),a("span",{staticClass:"material-icons em-pointer",on:{click:t.closeModal}},[t._v("close")])])]),a("transition",{attrs:{name:t.slideTransition},on:{"before-leave":t.beforeLeaveSlide}},[!t.modalLoading&&t.displayedUser.user_id&&t.displayedFnum?a("div",{staticClass:"modal-body"},[a("AttachmentPreview",{attrs:{user:t.displayedUser.user_id},on:{fileNotFound:function(e){t.canDownload=!1},canDownload:function(e){t.canDownload=!0}}}),a("AttachmentEdit",{attrs:{fnum:t.displayedFnum},on:{closeModal:t.closeModal,saveChanges:t.updateAttachment}})],1):t._e()])],1),t.loading?a("div",{staticClass:"vue-em-loader em-loader"}):t._e()],1)}),C=[],E=a("b85c"),j=(a("cc82"),a("ccd2"),a("f9ae"),a("76c2"),a("7d2b"),a("8f60"),a("b1da"),a("9f2b"),a("5c7d"),a("dc43"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"em-attachment-preview"}},[a("div",{ref:"a-preview",staticClass:"attachment-preview",class:{"overflow-x":t.overflowX,"overflow-y":t.overflowY,hidden:!t.needShadowDOM}}),t.needShadowDOM?t._e():a("div",{staticClass:"attachment-preview",domProps:{innerHTML:t._s(t.preview)}}),a("div",{class:{active:t.msg&&t.openMsg},attrs:{id:"msg"}},[a("p",[t._v(t._s(t.msg))])])])}),O=[],x=(a("d92d"),a("eff7"),a("53ca")),T=(a("22ae"),a("e6da"),a("256b"),a("8f3e")),k=a.n(T);k.a.defaults.baseURL="/";var S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"Content-Type":"application/json","Cache-Control":"no-cache"};return k.a.create({timeout:3e4,headers:t,responseType:"json",withCredentials:!0})},M={getAttachmentProgress:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=files&task=getattachmentprogress",{params:{fnum:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getAttachmentsByUser:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=application&task=getuserattachments",{params:{user_id:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getAttachmentsByFnum:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=application&task=getattachmentsbyfnum",{params:{fnum:t}});case 3:return a=e.sent,a.data.status&&("string"===typeof a.data.attachments&&(a.data.attachments=JSON.parse(a.data.attachments)),"object"===Object(x["a"])(a.data.attachments)&&(a.data.attachments=Object.values(a.data.attachments)),a.data.attachments.forEach((function(t){null===t.is_validated&&(t.is_validated=-2),t.show=!0}))),e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},getAttachmentCategories:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=files&task=getattachmentcategories");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,msg:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},deleteAttachments:function(t,e,a){return Object(y["a"])(Object(w["a"])().mark((function s(){var n;return Object(w["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,n=new FormData,n.append("ids",JSON.stringify(a)),s.next=5,S().post("index.php?option=com_emundus&controller=application&task=deleteattachement&fnum=".concat(t,"&student_id=").concat(e),n,{headers:{"Content-Type":"multipart/form-data"}});case 5:return s.abrupt("return",s.sent);case 8:return s.prev=8,s.t0=s["catch"](0),s.abrupt("return",{status:!1,msg:s.t0.message});case 11:case"end":return s.stop()}}),s,null,[[0,8]])})))()},updateAttachment:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().post("index.php?option=com_emundus&controller=application&task=updateattachment",t,{headers:{"Content-Type":"multipart/form-data"}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getPreview:function(t,e){return Object(y["a"])(Object(w["a"])().mark((function a(){var s;return Object(w["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,S().get("index.php?option=com_emundus&controller=application&task=getattachmentpreview",{params:{user:t,filename:e}});case 3:return s=a.sent,a.abrupt("return",s.data);case 7:return a.prev=7,a.t0=a["catch"](0),a.abrupt("return",{status:!1,msg:a.t0.message});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},exportAttachments:function(t,e,a){var s=new FormData;return s.append("student_id",t),s.append("fnum",e),a.forEach((function(t){s.append("ids[]",t)})),S().post("index.php?option=com_emundus&controller=application&task=exportpdf",s,{headers:{"Content-Type":"multipart/form-data"}})},getProfileAttachments:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=users&task=getprofileattachments");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,msg:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getProfileAttachmentsAllowed:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=users&task=getprofileattachmentsallowed");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,msg:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},deleteProfileAttachment:function(t,e){return Object(y["a"])(Object(w["a"])().mark((function a(){var s;return Object(w["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,S().delete("index.php?option=com_emundus&controller=users&task=deleteprofileattachment",{params:{id:t,filename:e}});case 3:return s=a.sent,a.abrupt("return",s.data);case 7:return a.prev=7,a.t0=a["catch"](0),a.abrupt("return",{status:!1,msg:a.t0.message});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()}},U={props:{user:{type:Number,required:!0}},data:function(){return{attachment:this.$store.state.attachment.selectedAttachment,preview:"",overflowX:!1,overflowY:!1,style:"",msg:"",openMsg:!1,needShadowDOM:!1}},mounted:function(){this.$refs["a-preview"].attachShadow({mode:"open"}),this.attachment=this.$store.state.attachment.selectedAttachment,this.getPreview()},methods:{getPreview:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.state.attachment.previews[t.attachment.aid]){e.next=7;break}return e.next=3,M.getPreview(t.user,t.attachment.filename);case 3:a=e.sent,a.status&&t.$store.commit("attachment/setPreview",{preview:a,id:t.attachment.aid}),e.next=8;break;case 7:a=t.$store.state.attachment.previews[t.attachment.aid];case 8:t.$emit("canDownload"),a.status?(t.preview=a.content,t.overflowX=a.overflowX,t.overflowY=a.overflowY,t.style=a.style,a.msg&&(t.msg=a.msg,t.openMsg=!0,setTimeout((function(){t.openMsg=!1}),3e3))):("file_not_found"===a.error&&t.$emit("fileNotFound"),t.overflowX=!1,t.overflowY=!1,t.preview=a.content,t.msg=""),e.t0=t.style,e.next="sheet"===e.t0||"presentation"===e.t0||"word"===e.t0?13:15;break;case 13:return t.needShadowDOM=!0,e.abrupt("break",17);case 15:return t.needShadowDOM=!1,e.abrupt("break",17);case 17:t.needShadowDOM?(t.$refs["a-preview"].shadowRoot.innerHTML=null!=t.preview?t.preview:"","sheet"==t.style?t.addSheetStyles():"presentation"==t.style?t.addPresentationStyles():"word"==t.style&&t.addWordStyles()):t.$refs["a-preview"].shadowRoot.innerHTML="";case 18:case"end":return e.stop()}}),e)})))()},addSheetStyles:function(){var t=this.$refs["a-preview"].shadowRoot.querySelectorAll("div");t.forEach((function(t,e){t.style.width="fit-content",t.style.margin="20px auto",t.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",e>0&&(t.style.display="none")}));var e=this.$refs["a-preview"].shadowRoot.querySelector(".navigation");e&&(e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="flex-start",e.style.alignItems="center",e.querySelectorAll("li").forEach((function(e,a){e.style.listStyleType="none",e.style.margin="0 10px",e.addEventListener("click",(function(){t.forEach((function(t,e){t.style.display=e==a?"block":"none"}))}))})))},addPresentationStyles:function(){var t=this.$refs["a-preview"].shadowRoot.querySelectorAll(".slide");t.forEach((function(t){t.style.padding="16px",t.style.margin="20px",t.style.width="calc(100% - 72px)",t.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",t.style.borderRadius="8px",t.style.backgroundColor="white"}))},addWordStyles:function(){var t=this.$refs["a-preview"].shadowRoot.querySelector(".wrapper");t&&(t.style.border="var(--border-color)",t.style.boxShadow="var(--box-shadow)",t.style.backgroundColor="white",t.style.padding="20px",t.style.margin="16px",t.style.overflow="hidden")}},watch:{"$store.state.attachment.selectedAttachment":function(){var t=Object.keys(this.$store.state.attachment.selectedAttachment);0!==t.length&&(this.attachment=this.$store.state.attachment.selectedAttachment,this.openMsg=!1,this.getPreview())}}},N=U,D=(a("2c19"),Object(f["a"])(N,j,O,!1,null,null,null)),I=D.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"attachment-edit"}},[a("div",{staticClass:"wrapper"},[a("h2",{staticClass:"title"},[t._v(t._s(t.attachment.value))]),a("div",{staticClass:"editable-data"},[a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"description"}},[t._v(t._s(t.translate("DESCRIPTION")))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.attachmentDescription,expression:"attachmentDescription"}],attrs:{name:"description",id:"description",type:"text",disabled:!t.canUpdate},domProps:{value:t.attachmentDescription},on:{input:function(e){e.target.composing||(t.attachmentDescription=e.target.value)}}})]),a("div",{staticClass:"input-group valid-state",class:{success:1==t.attachmentIsValidated,warning:2==t.attachmentIsValidated,error:0==t.attachmentIsValidated}},[a("label",{attrs:{for:"status"}},[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CHECK")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.attachmentIsValidated,expression:"attachmentIsValidated"}],attrs:{name:"status",disabled:!t.canUpdate},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.attachmentIsValidated=e.target.multiple?a:a[0]},t.updateAttachmentStatus]}},[a("option",{attrs:{value:"1"}},[t._v(t._s(t.translate("VALID")))]),a("option",{attrs:{value:"0"}},[t._v(t._s(t.translate("INVALID")))]),a("option",{attrs:{value:"2"}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_WARNING"))+" ")]),a("option",{attrs:{value:"-2"}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_WAITING"))+" ")])])]),t.canUpdate?a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"replace"}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_REPLACE")))]),a("input",{attrs:{type:"file",name:"replace",accept:t.allowedType},on:{change:t.updateFile}})]):t._e(),a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"can_be_viewed"}},[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_VIEWED")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.attachmentCanBeViewed,expression:"attachmentCanBeViewed"}],attrs:{type:"checkbox",name:"can_be_viewed",disabled:!t.canUpdate},domProps:{checked:Array.isArray(t.attachmentCanBeViewed)?t._i(t.attachmentCanBeViewed,null)>-1:t.attachmentCanBeViewed},on:{change:function(e){var a=t.attachmentCanBeViewed,s=e.target,n=!!s.checked;if(Array.isArray(a)){var r=null,i=t._i(a,r);s.checked?i<0&&(t.attachmentCanBeViewed=a.concat([r])):i>-1&&(t.attachmentCanBeViewed=a.slice(0,i).concat(a.slice(i+1)))}else t.attachmentCanBeViewed=n}}})]),a("div",{staticClass:"input-group"},[a("label",{attrs:{for:"can_be_deleted"}},[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CAN_BE_DELETED")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.attachmentCanBeDeleted,expression:"attachmentCanBeDeleted"}],attrs:{type:"checkbox",name:"can_be_deleted",disabled:!t.canUpdate},domProps:{checked:Array.isArray(t.attachmentCanBeDeleted)?t._i(t.attachmentCanBeDeleted,null)>-1:t.attachmentCanBeDeleted},on:{change:function(e){var a=t.attachmentCanBeDeleted,s=e.target,n=!!s.checked;if(Array.isArray(a)){var r=null,i=t._i(a,r);s.checked?i<0&&(t.attachmentCanBeDeleted=a.concat([r])):i>-1&&(t.attachmentCanBeDeleted=a.slice(0,i).concat(a.slice(i+1)))}else t.attachmentCanBeDeleted=n}}})])]),a("div",{staticClass:"non-editable-data"},[a("div",[a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_SEND_DATE")))]),a("span",[t._v(t._s(t.formattedDate(t.attachment.timedate)))])]),t.attachment.user_id&&t.canSee?a("div",[a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_UPLOADED_BY")))]),a("span",[t._v(t._s(t.getUserNameById(t.attachment.user_id)))])]):t._e(),t.attachment.category?a("div",[a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_CATEGORY")))]),a("span",[t._v(t._s(this.categories[t.attachment.category]))])]):t._e(),t.attachment.modified_by&&t.canSee?a("div",[a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_MODIFIED_BY")))]),a("span",[t._v(t._s(t.getUserNameById(t.attachment.modified_by)))])]):t._e(),t.attachment.modified?a("div",[a("span",[t._v(t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_MODIFICATION_DATE")))]),a("span",[t._v(t._s(t.formattedDate(t.attachment.modified)))])]):t._e()])]),a("div",{staticClass:"actions"},[t.canUpdate?a("button",{staticClass:"em-primary-button",on:{click:t.saveChanges}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_SAVE"))+" ")]):t._e()]),t.error?a("div",{staticClass:"error-msg"},[t._v(t._s(t.errorMessage))]):t._e()])},F=[],B=(a("94bc"),a("3341"),a("3835")),P=(a("c6bc"),a("b32d")),L=a.n(P),H={getUsers:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=users&task=getusers");case 3:return e=t.sent,t.abrupt("return",{data:e.data,status:!0});case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,msg:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getUserById:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=users&task=getuserbyid",{params:{id:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getAccessRights:function(t,e){return Object(y["a"])(Object(w["a"])().mark((function a(){var s;return Object(w["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,S().get("index.php?option=com_emundus&controller=users&task=getattachmentaccessrights",{params:{id:t,fnum:e}});case 3:return s=a.sent,a.abrupt("return",s.data);case 7:return a.prev=7,a.t0=a["catch"](0),a.abrupt("return",{status:!1,msg:a.t0.message});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},getProfileForm:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=users&task=getprofileform");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,msg:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getProfileGroups:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=users&task=getprofilegroups",{params:{formid:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getProfileElements:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=users&task=getprofileelements",{params:{groupid:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},saveUser:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().post("index.php?option=com_emundus&controller=users&task=saveuser",JSON.stringify(t),{headers:{"Content-Type":"application/json"}});case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},updateProfilePicture:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=new FormData,a.append("file",t),e.next=5,S().post("index.php?option=com_emundus&controller=users&task=updateprofilepicture",a,{headers:{"Content-Type":"multipart/form-data"}});case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e["catch"](0),e.abrupt("return",{status:!1,msg:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}},R={mimeTypes:{aac:"audio/aac",abw:"application/x-abiword",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip",mp4:"video/mp4",mov:"video/mov"}},V={methods:{formattedDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LLLL",a="";return null!==t&&(a=""!==t?L()(t).format(e):L()().format(e)),a},strippedHtml:function(t){return null===t||void 0===t?"":t.replace(/<(?:.|\n)*?>/gm,"")},getUserNameById:function(t){var e=this,a="";if(t=parseInt(t),t>0){var s=this.$store.state.user.users[t];s?a=s.firstname+" "+s.lastname:H.getUserById(t).then((function(s){s.status&&s.user[0]&&(a=s.user[0].firstname+" "+s.user[0].lastname,s.user[0].id=t,e.$store.dispatch("user/setUsers",s.user))}))}return a},getAttachmentCategories:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M.getAttachmentCategories();case 2:if(a=e.sent,!0!==a.status){e.next=10;break}return Object.entries(a.categories).forEach((function(e){var s=Object(B["a"])(e,2),n=s[0],r=s[1];a.categories[n]=t.translate(r)})),delete a.categories[""],t.$store.dispatch("attachment/setCategories",a.categories),e.abrupt("return",a.categories);case 10:return e.abrupt("return",{});case 11:case"end":return e.stop()}}),e)})))()},asyncForEach:function(t,e){return Object(y["a"])(Object(w["a"])().mark((function a(){var s;return Object(w["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=0;case 1:if(!(s<t.length)){a.next=7;break}return a.next=4,e(t[s],s,t);case 4:s++,a.next=1;break;case 7:case"end":return a.stop()}}),a)})))()},getMimeTypeFromExtension:function(t){return!!R.mimeTypes.hasOwnProperty(t)&&R.mimeTypes[t]}}},z=V,q={name:"AttachmentEdit",props:{fnum:{type:String,required:!0}},mixins:[z],data:function(){return{attachment:{},categories:{},file:null,canUpdate:!1,canSee:!0,error:!1,errorMessage:"",attachmentIsValidated:"-2",attachmentCanBeViewed:!1,attachmentCanBeDeleted:!1,attachmentDescription:""}},mounted:function(){this.canUpdate=!!this.$store.state.user.rights[this.fnum]&&this.$store.state.user.rights[this.fnum].canUpdate,this.canSee=!this.$store.state.global.anonyme,this.attachment=this.$store.state.attachment.selectedAttachment,this.categories=this.$store.state.attachment.categories,this.attachmentCanBeViewed="1"==this.attachment.can_be_viewed,this.attachmentCanBeDeleted="1"==this.attachment.can_be_deleted,this.attachmentDescription=this.attachment.upload_description,this.attachmentIsValidated=this.attachment.is_validated},methods:{saveChanges:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a,s,n,r,i;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,s=t.attachmentCanBeViewed?"1":"0",n=t.attachmentCanBeDeleted?"1":"0",a.append("fnum",t.fnum),a.append("user",t.$store.state.user.currentUser),a.append("id",t.attachment.aid),a.append("description",t.attachmentDescription),a.append("is_validated",t.attachmentIsValidated),a.append("can_be_viewed",s),a.append("can_be_deleted",n),t.file&&a.append("file",t.file),e.next=13,M.updateAttachment(a);case 13:if(r=e.sent,!r.status.update){e.next=29;break}if(t.attachment.modified_by=t.$store.state.user.currentUser,t.attachment.upload_description=t.attachmentDescription,t.attachment.is_validated=t.attachmentIsValidated,t.attachment.can_be_viewed=t.attachmentCanBeViewed,t.attachment.can_be_deleted=t.attachmentCanBeDeleted,t.$store.dispatch("attachment/updateAttachmentOfFnum",{fnum:t.fnum,attachment:t.attachment}),!r.status.file_update){e.next=26;break}return e.next=24,M.getPreview(t.$store.state.user.displayedUser,t.attachment.filename);case 24:i=e.sent,t.$store.dispatch("attachment/setPreview",{preview:i,id:t.attachment.aid});case 26:t.$emit("saveChanges"),e.next=30;break;case 29:t.showError(r.msg);case 30:case"end":return e.stop()}}),e)})))()},updateFile:function(t){this.file=t.target.files[0]},updateAttachmentStatus:function(t){this.attachmentIsValidated=t.target.value},showError:function(t){var e=this;this.error=!0,this.errorMessage=t,setTimeout((function(){e.error=!1,e.errorMessage=""}),3e3)}},computed:{allowedType:function(){var t="";return this.attachment.filename&&(t="."+this.attachment.filename.split(".").pop()),t}},watch:{"$store.state.attachment.selectedAttachment":function(){var t=Object.keys(this.$store.state.attachment.selectedAttachment);t.length>0&&(this.attachment=this.$store.state.attachment.selectedAttachment)}}},G=q,Y=(a("e880"),Object(f["a"])(G,$,F,!1,null,null,null)),J=Y.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{key:t.attachment.aid,staticClass:"attachment-row",class:{checked:t.checkedAttachments.includes(t.attachment.aid)}},[a("td",[a("input",{staticClass:"attachment-check",attrs:{type:"checkbox"},domProps:{checked:t.checkedAttachments.includes(t.attachment.aid)},on:{change:function(e){return t.updateCheckedAttachments(t.attachment.aid)}}})]),a("td",{staticClass:"td-document",on:{click:t.openModal}},[a("span",[t._v(t._s(t.attachment.value))]),t.attachment.existsOnServer?t._e():a("span",{staticClass:"material-icons warning file-not-found",attrs:{title:t.translate("COM_EMUNDUS_ATTACHMENTS_FILE_NOT_FOUND")}},[t._v(" warning ")])]),a("td",{staticClass:"date"},[t._v(t._s(t.formattedDate(t.attachment.timedate)))]),a("td",{staticClass:"desc"},[t._v(" "+t._s(t.strippedHtml(t.attachment.upload_description)))]),a("td",{staticClass:"category"},[t._v(" "+t._s(t.category)+" ")]),a("td",{staticClass:"status valid-state",class:{success:1==t.attachment.is_validated,warning:2==t.attachment.is_validated,error:0==t.attachment.is_validated}},[a("select",{attrs:{disabled:!1===t.canUpdate},on:{change:function(e){return t.updateStatus(e)}}},[a("option",{attrs:{value:"1"},domProps:{selected:1==t.attachment.is_validated}},[t._v(" "+t._s(t.translate("VALID"))+" ")]),a("option",{attrs:{value:"0"},domProps:{selected:0==t.attachment.is_validated}},[t._v(" "+t._s(t.translate("INVALID"))+" ")]),a("option",{attrs:{value:"2"},domProps:{selected:2==t.attachment.is_validated}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_WARNING"))+" ")]),a("option",{attrs:{value:"-2"},domProps:{selected:-2==t.attachment.is_validated||null===t.attachment.is_validated}},[t._v(" "+t._s(t.translate("COM_EMUNDUS_ATTACHMENTS_WAITING"))+" ")])])]),t.canSee?a("td",[t._v(t._s(t.getUserNameById(t.attachment.user_id)))]):t._e(),t.canSee?a("td",[t._v(t._s(t.getUserNameById(t.attachment.modified_by)))]):t._e(),a("td",{staticClass:"date"},[t._v(t._s(t.formattedDate(t.attachment.modified)))]),a("td",{staticClass:"permissions"},[a("span",{staticClass:"material-icons visibility-permission",class:{active:"1"==t.attachment.can_be_viewed},attrs:{title:t.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_VIEW")},on:{click:function(e){return t.changePermission("can_be_viewed",t.attachment)}}},[t._v("visibility")]),a("span",{staticClass:"material-icons delete-permission",class:{active:"1"==t.attachment.can_be_deleted},attrs:{title:t.translate("COM_EMUNDUS_ATTACHMENTS_PERMISSION_DELETE")},on:{click:function(e){return t.changePermission("can_be_deleted",t.attachment)}}},[t._v("delete_outlined")])])])},X=[],K=(a("aa48"),{name:"AttachmentRow",props:{attachment:{type:Object,required:!0},checkedAttachmentsProp:{type:Array,required:!0},canUpdate:{type:Boolean,default:!1},canSee:{type:Boolean,default:!0}},mixins:[z],data:function(){return{categories:{},category:"",checkedAttachments:[]}},mounted:function(){this.categories=this.$store.state.attachment.categories,this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:"",this.checkedAttachments=this.checkedAttachmentsProp},methods:{updateCheckedAttachments:function(t){this.checkedAttachments.includes(t)?this.checkedAttachments.splice(this.checkedAttachments.indexOf(t),1):this.checkedAttachments.push(t),this.$emit("update-checked-attachments",this.checkedAttachments)},openModal:function(){this.$emit("open-modal",this.attachment)},updateStatus:function(t){this.canUpdate&&this.$emit("update-status",t,this.attachment)},changePermission:function(t,e){this.canUpdate&&this.$emit("change-permission",t,e)}},watch:{"$store.state.attachment.checkedAttachments":function(){this.checkedAttachments=this.$store.state.attachment.checkedAttachments},"$store.state.attachment.categories":function(){this.categories=this.$store.state.attachment.categories,this.category=this.categories[this.attachment.category]?this.categories[this.attachment.category]:""}}}),Z=K,Q=(a("2d3c"),Object(f["a"])(Z,W,X,!1,null,null,null)),tt=Q.exports,et={getFnums:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=files&task=getallfnums");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getFnumInfos:function(t){return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S().get("index.php?option=com_emundus&controller=files&task=getfnuminfos",{params:{fnum:t}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},isDataAnonymized:function(){return Object(y["a"])(Object(w["a"])().mark((function t(){var e;return Object(w["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S().get("index.php?option=com_emundus&controller=files&task=isdataanonymized");case 3:return e=t.sent,t.abrupt("return",e.data);case 7:return t.prev=7,t.t0=t["catch"](0),t.abrupt("return",{status:!1,message:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},at=a("82c5"),st=a.n(at),nt={name:"Attachments",components:{AttachmentPreview:I,AttachmentEdit:J,AttachmentRow:tt},props:{user:{type:String,required:!0},fnum:{type:String,required:!0}},mixins:[z],data:function(){return{loading:!0,attachments:[],categories:{},fnums:[],users:[],displayedUser:{},displayedFnum:this.fnum,checkedAttachments:[],selectedAttachment:{},progress:"",sort:{last:"",order:"",orderBy:""},canSee:!0,canExport:!1,canDelete:!1,canDownload:!0,canUpdate:!1,modalLoading:!1,slideTransition:"slide-fade",changeFileEvent:null,exportLink:""}},created:function(){this.changeFileEvent=new Event("changeFile"),this.canSee=!this.$store.state.global.anonyme,window.addEventListener("message",function(t){"addFileToFnum"==t.data&&this.refreshAttachments(!0)}.bind(this))},mounted:function(){var t=this;console.log("here"),this.loading=!0,this.getFormProgress(),this.getFnums().then((function(){t.getUsers().then((function(){t.getAttachments().then((function(){t.setAccessRights().then((function(){t.loading=!1}))})).catch((function(e){t.loading=!1,t.displayErrorMessage(e)}))})).catch((function(e){t.loading=!1,t.displayErrorMessage(e)}))})).catch((function(e){t.loading=!1,t.displayErrorMessage(e)}))},methods:{getFormProgress:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M.getAttachmentProgress(t.displayedFnum);case 2:a=e.sent,a.status&&(t.progress=a.progress[0].attachment_progress);case 4:case"end":return e.stop()}}),e)})))()},getFnums:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a,s,n,r;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=document.getElementsByClassName("em_file_open"),s=Object(E["a"])(a);try{for(s.s();!(n=s.n()).done;)r=n.value,t.fnums.push(r.id)}catch(i){s.e(i)}finally{s.f()}case 3:case"end":return e.stop()}}),e)})))()},getUsers:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.dispatch("user/setCurrentUser",t.user),e.next=3,t.setDisplayedUser();case 3:case"end":return e.stop()}}),e)})))()},setDisplayedUser:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a,s,n;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,et.getFnumInfos(t.displayedFnum);case 2:if(a=e.sent,!a||!a.fnumInfos){e.next=17;break}if(s=!(!t.users||!t.users.length)&&t.users.find((function(t){return t.user_id==a.fnumInfos.applicant_id})),s){e.next=12;break}return e.next=8,H.getUserById(a.fnumInfos.applicant_id);case 8:n=e.sent,n.status?(t.users.push(n.user[0]),t.displayedUser=n.user[0],t.$store.dispatch("user/setDisplayedUser",t.displayedUser.user_id),t.$store.dispatch("user/setUsers",n.user)):t.displayErrorMessage(t.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND")),e.next=15;break;case 12:t.displayedUser=s,t.$store.dispatch("user/setDisplayedUser",t.displayedUser.user_id),t.$store.dispatch("user/setUsers",[s]);case 15:e.next=18;break;case 17:t.displayErrorMessage(t.translate("COM_EMUNDUS_ATTACHMENTS_USER_NOT_FOUND"));case 18:case"end":return e.stop()}}),e)})))()},getAttachments:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.state.attachment.attachments[t.displayedFnum]){e.next=5;break}return e.next=3,t.refreshAttachments();case 3:e.next=7;break;case 5:t.attachments=t.$store.state.attachment.attachments[t.displayedFnum],t.categories=t.$store.state.attachment.categories;case 7:case"end":return e.stop()}}),e)})))()},refreshAttachments:function(){var t=arguments,e=this;return Object(y["a"])(Object(w["a"])().mark((function a(){var s,n,r;return Object(w["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t.length>0&&void 0!==t[0]&&t[0],!0===s&&(e.loading=!0),e.resetOrder(),e.checkedAttachments=[],e.$refs["searchbar"].value="",a.next=7,M.getAttachmentsByFnum(e.displayedFnum);case 7:if(n=a.sent,!n.status){a.next=17;break}return e.attachments=n.attachments,e.$store.dispatch("attachment/setAttachmentsOfFnum",{fnum:[e.displayedFnum],attachments:e.attachments}),a.next=13,e.getAttachmentCategories();case 13:r=a.sent,e.categories=r||{},a.next=18;break;case 17:e.displayErrorMessage(e.translate("COM_EMUNDUS_ATTACHMENTS_ERROR_GETTING_ATTACHMENTS"));case 18:!0===s&&(e.loading=!1);case 19:case"end":return a.stop()}}),a)})))()},updateAttachment:function(){this.resetOrder(),this.getAttachments(),this.$modal.hide("edit"),this.selectedAttachment={}},updateStatus:function(t,e){var a=this;if(this.canUpdate){if(this.attachments.length<1)return;this.attachments.forEach((function(s,n){if(s.aid==e.aid){a.resetOrder(),a.attachments[n].is_validated=t.target.value;var r=new FormData;r.append("fnum",a.displayedFnum),r.append("user",a.$store.state.user.currentUser),r.append("id",a.attachments[n].aid),r.append("is_validated",a.attachments[n].is_validated),M.updateAttachment(r).then((function(t){t&&!1===t.status&&a.displayErrorMessage(t.msg)})).catch((function(t){a.displayErrorMessage(t)}))}}))}},changePermission:function(t,e){var a=this;this.canUpdate?this.attachments.forEach((function(s,n){if(s.aid==e.aid){a.resetOrder(),a.attachments[n][t]="1"===a.attachments[n][t]?"0":"1";var r=new FormData;r.append("fnum",a.displayedFnum),r.append("user",a.$store.state.user.currentUser),r.append("id",a.attachments[n].aid),r.append(t,a.attachments[n][t]),M.updateAttachment(r).then((function(t){t.status||a.displayErrorMessage(t.msg)}))}})):this.displayErrorMessage(this.translate("COM_EMUNDUS_ATTACHMENTS_UNAUTHORIZED_ACTION"))},setAccessRights:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.state.user.rights[t.displayedFnum]){e.next=5;break}return e.next=3,H.getAccessRights(t.$store.state.user.currentUser,t.displayedFnum);case 3:a=e.sent,!0===a.status&&t.$store.dispatch("user/setAccessRights",{fnum:t.displayedFnum,rights:a.rights});case 5:t.canExport=!!t.$store.state.user.rights[t.displayedFnum]&&t.$store.state.user.rights[t.displayedFnum].canExport,t.canDelete=!!t.$store.state.user.rights[t.displayedFnum]&&t.$store.state.user.rights[t.displayedFnum].canDelete,t.canUpdate=!!t.$store.state.user.rights[t.displayedFnum]&&t.$store.state.user.rights[t.displayedFnum].canUpdate;case 8:case"end":return e.stop()}}),e)})))()},exportAttachments:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.canExport&&M.exportAttachments(t.displayedUser.user_id,t.displayedFnum,t.checkedAttachments).then((function(e){!0===e.data.status?(window.open(e.data.link,"_blank"),t.exportLink=e.data.link):t.displayErrorMessage(e.data.msg)}));case 1:case"end":return e.stop()}}),e)})))()},confirmDeleteAttachments:function(){var t=this;if(this.canDelete){var e="<p>"+this.translate("CONFIRM_DELETE_SELETED_ATTACHMENTS")+"</p><br>",a="";this.checkedAttachments.forEach((function(e){t.attachments.forEach((function(t){t.aid==e&&(a+=t.value+", ")}))})),a=a.substring(0,a.length-2),e+="<p>"+a+"</p>",st.a.fire({title:this.translate("DELETE_SELECTED_ATTACHMENTS"),html:e,type:"warning",showCancelButton:!0,confirmButtonText:this.translate("JYES"),cancelButtonText:this.translate("JNO"),reverseButtons:!0,customClass:{title:"em-swal-title",cancelButton:"em-swal-cancel-button",confirmButton:"em-swal-confirm-button"}}).then((function(e){e.value&&t.deleteAttachments()}))}else this.displayErrorMessage(this.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"))},deleteAttachments:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.canDelete){e.next=8;break}return t.attachments=t.attachments.filter((function(e){return!t.checkedAttachments.includes(e.aid)})),e.next=4,M.deleteAttachments(t.displayedFnum,t.displayedUser.user_id,t.checkedAttachments);case 4:a=e.sent,a.status,e.next=9;break;case 8:t.displayErrorMessage(t.translate("YOU_NOT_HAVE_PERMISSION_TO_DELETE_ATTACHMENTS"));case 9:case"end":return e.stop()}}),e)})))()},changeFile:function(t){var e=this;this.loading=!0;var a=this.fnumPosition;this.displayedFnum=this.fnums[t],this.getFormProgress(),this.attachments=[],this.$store.dispatch("attachment/setCheckedAttachments",[]),this.setAccessRights(),this.resetOrder(),this.resetSearch(),this.resetCategoryFilters(),et.getFnumInfos(this.displayedFnum).then((function(s){!0===s.status?(e.changeFileEvent.detail={fnum:s.fnumInfos,next:t>a,previous:t<a},document.querySelector(".com_emundus_vue").dispatchEvent(e.changeFileEvent)):e.displayErrorMessage(s.msg)})),this.setDisplayedUser().then((function(){e.getAttachments().then((function(){e.attachments.forEach((function(t){t.show=!0})),e.loading=!1})).catch((function(t){e.displayErrorMessage(t),e.loading=!1}))})).catch((function(t){e.displayErrorMessage(t),e.loading=!1}))},changeAttachment:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.slideTransition=a?"slide-fade-reverse":"slide-fade",this.modalLoading=!0,this.selectedAttachment=this.displayedAttachments[t],this.$store.dispatch("attachment/setSelectedAttachment",this.selectedAttachment),setTimeout((function(){e.modalLoading=!1}),500)},searchInFiles:function(){var t=this;this.attachments.forEach((function(e,a){e.upload_description.toLowerCase().includes(t.$refs["searchbar"].value.toLowerCase())||e.value.toLowerCase().includes(t.$refs["searchbar"].value.toLowerCase())?t.attachments[a].show=!0:(t.checkedAttachments=t.checkedAttachments.filter((function(t){return t!==e.aid})),t.attachments[a].show=!1)}))},resetSearch:function(){var t=this;this.attachments.forEach((function(e,a){t.attachments[a].show=!0})),this.$refs["searchbar"].value=""},resetOrder:function(){this.sort={last:"",order:"",orderBy:""}},resetCategoryFilters:function(){this.$refs["categoryFilter"]&&(this.$refs["categoryFilter"].value="all")},orderBy:function(t){this.sort.last==t?(this.sort.order="asc"==this.sort.order?"desc":"asc",this.attachments.reverse()):(this.attachments.sort((function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0})),this.sort.order="asc"),this.sort.orderBy=t,this.sort.last=t},filterByCategory:function(t){var e=this;this.attachments.forEach((function(a){"all"==t.target.value||a.category==t.target.value?a.show=!0:(e.checkedAttachments=e.checkedAttachments.filter((function(t){return t!==a.aid})),a.show=!1)}))},updateAllCheckedAttachments:function(t){t.target.checked?this.checkedAttachments=this.displayedAttachments.map((function(t){return t.aid})):this.checkedAttachments=[],this.$store.dispatch("attachment/setCheckedAttachments",this.checkedAttachments)},updateCheckedAttachments:function(t){Array.isArray(t)?this.checkedAttachments=t:(console.warn("updateCheckedAttachments() expects an array as argument"),this.displayErrorMessage("Something went wrong while updating the checked attachments"),this.checkedAttachments=[])},openModal:function(t){this.displayedUser.user_id&&this.displayedFnum&&(this.$modal.show("edit"),this.selectedAttachment=t,this.$store.dispatch("attachment/setSelectedAttachment",t))},closeModal:function(){this.$modal.hide("edit"),this.selectedAttachment={},this.$store.dispatch("attachment/setSelectedAttachment",{})},displayErrorMessage:function(t){st.a.fire({title:this.translate("ERROR"),text:t,type:"error",confirmButtonColor:"#3085d6",confirmButtonText:this.translate("COM_EMUNDUS_ATTACHMENTS_CLOSE")})},beforeLeaveSlide:function(t){"slide-fade"==this.slideTransition&&(t.style.transform="translateX(-100%)"),t.setAttribute("class","modal-body "+this.slideTransition+"-leave-active "+this.slideTransition+"-leave-to")}},computed:{displayedAttachments:function(){return this.attachments.filter((function(t){return(!0===t.show||void 0==t.show)&&t.can_be_viewed}))},fnumPosition:function(){return this.fnums.indexOf(this.displayedFnum)},selectedAttachmentPosition:function(){return this.displayedAttachments.indexOf(this.selectedAttachment)},attachmentPath:function(){return this.$store.state.attachment.attachmentPath+this.displayedUser.user_id+"/"+this.selectedAttachment.filename},thisAttachmentCategories:function(){var t={};if(Object.entries(this.categories).length>0)for(var e in this.categories)for(var a in this.attachments)this.attachments[a].category==e&&(t[e]=this.categories[e]);return t}},watch:{"$store.state.global.anonyme":function(){this.canSee=!this.$store.state.global.anonyme}}},rt=nt,it=(a("64a7"),Object(f["a"])(rt,A,C,!1,null,null,null)),ct=it.exports,ot={name:"EvaluationModal",components:{Attachments:ct},props:{file:{type:Object,required:!0},evaluation_form:{type:Number,required:!0},preview:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},mixins:[z],data:function(){return{applicationform:"",attachments:"",attachments_column:[{label:"MOD_EMUNDUS_EVALUATIONS_ATTACHMENT_NAME",name:"value",active:!0},{label:"MOD_EMUNDUS_EVALUATIONS_ATTACHMENT_SENT_ON",name:"timedate",active:!1},{label:"MOD_EMUNDUS_EVALUATIONS_ATTACHMENT_DESCRIPTION",name:"upload_description",active:!1}],url:"",rowid:"",student_id:"",current_user:0,loading:!1}},mounted:function(){this.loading=!0,this.getApplicationForm(),this.getAttachments(),this.getEvaluationForm(),this.current_user=this.$store.state.user.currentUser},methods:{getApplicationForm:function(){var t=this;d()({method:"get",url:"index.php?option=com_emundus&view=application&format=raw&layout=form&fnum="+this.file.fnum}).then((function(e){t.applicationform=e.data}))},getAttachments:function(){var t=this;return Object(y["a"])(Object(w["a"])().mark((function e(){var a;return Object(w["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M.getAttachmentsByFnum(t.$props.file.fnum);case 2:a=e.sent,a.status&&(t.attachments=a.attachments);case 4:case"end":return e.stop()}}),e)})))()},downloadAttachment:function(t){var e="/images/emundus/files/"+this.student_id+"/"+t.filename;window.open(e,"_blank")},exportFile:function(){var t=new FormData;t.append("student_id",this.student_id),t.append("fnum",this.$props.file.fnum),d.a.post("index.php?option=com_emundus&controller=application&task=exportpdf",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){window.open(t.data.link,"_blank")}))},getEvaluationForm:function(){null!=this.$props.file.id&&(this.rowid=this.$props.file.id),null!=this.$props.file.student_id&&(this.student_id=this.$props.file.student_id);var t=this.$props.readonly?"details":"form";this.url="index.php?option=com_fabrik&c=form&view="+t+"&formid="+this.$props.evaluation_form+"&rowid="+this.rowid+"&jos_emundus_evaluations___student_id[value]="+this.student_id+"&jos_emundus_evaluations___campaign_id[value]="+this.$props.file.campaign_id+"&jos_emundus_evaluations___fnum[value]="+this.$props.file.fnum+"&student_id="+this.student_id+"&tmpl=component&iframe=1"}},computed:{activeAttachmentColumns:function(){return this.attachments_column.filter((function(t){return t.active}))}}},lt=ot,dt=(a("69f36"),Object(f["a"])(lt,g,b,!1,null,null,null)),ut=dt.exports,mt=a("4328"),pt={name:"List",components:{EvaluationModal:ut,EvaluationRow:v},props:{},data:function(){return{loading:!0,files:[],currentFile:null,sort:{last:"",order:"",orderBy:""},campaigns:[],currentCampaign:0}},created:function(){console.log(this.$parent.$props.readonly),this.getCampaigns()},methods:{getCampaigns:function(){var t=this;this.loading=!0,d()({method:"GET",url:"index.php?option=com_emundus&controller=evaluation&task=getcampaignstoevaluate",params:{module:this.$parent.$props.module},paramsSerializer:function(t){return mt.stringify(t)}}).then((function(e){t.campaigns=e.data.campaigns,1===t.campaigns.length&&(t.currentCampaign=t.campaigns[0].id),t.loading=!1}))},getMyEvaluations:function(){var t=this;this.loading=!0,d()({method:"GET",url:"index.php?option=com_emundus&controller=evaluation&task=getmyevaluations",params:{campaign:this.currentCampaign,module:this.$parent.$props.module},paramsSerializer:function(t){return mt.stringify(t)}}).then((function(e){t.currentFile=null,t.files=e.data.files,t.loading=!1}))},openModal:function(t){var e=this;this.currentFile=t,setTimeout((function(){e.$modal.show("evaluation-modal")}),500)},orderBy:function(t){this.sort.last==t?(this.sort.order="asc"==this.sort.order?"desc":"asc",this.files.evaluations.reverse()):(this.files.evaluations.sort((function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0})),this.sort.order="asc"),this.sort.orderBy=t,this.sort.last=t}},computed:{shownElements:function(){var t={};return Object.entries(this.files.elements).forEach((function(e,a){1==e[1].show_in_list_summary&&(t[a]=e[1])})),t}},watch:{currentCampaign:function(t){""!=t?this.getMyEvaluations():this.files=[]}}},ht=pt,ft=(a("410a"),Object(f["a"])(ht,c,o,!1,null,"24ca45ee",null)),_t=ft.exports,vt={name:"App",props:{currentUser:{type:String,required:!0},module:{type:String,required:!0},readonly:{type:String,required:!0}},components:{List:_t},created:function(){this.$store.dispatch("user/setCurrentUser",this.currentUser)}},gt=vt,bt=(a("034f"),Object(f["a"])(gt,r,i,!1,null,null,null)),wt=bt.exports,yt={methods:{translate:function(t){return t.length>0&&Joomla.JText._(t)?Joomla.JText._(t):t}}},At={lang:"",datas:[],actualLanguage:"",manyLanguages:"",coordinatorAccess:"",anonyme:!1},Ct={datas:function(t){return t.datas},actualLanguage:function(t){return t.actualLanguage},manyLanguages:function(t){return t.manyLanguages},coordinatorAccess:function(t){return t.coordinatorAccess}},Et={setLang:function(t,e){var a=t.commit;a("setLang",e)},setAnonyme:function(t,e){var a=t.commit;a("setAnonyme",e)}},jt={setLang:function(t,e){t.lang=e},initDatas:function(t,e){return t.datas=e,t.datas},initCurrentLanguage:function(t,e){return t.actualLanguage=e,t.actualLanguage},initManyLanguages:function(t,e){return t.manyLanguages=e,t.manyLanguages},initCoordinatorAccess:function(t,e){return t.coordinatorAccess=e,t.coordinatorAccess},setAnonyme:function(t,e){t.anonyme=e}},Ot={namespaced:!0,state:At,getters:Ct,actions:Et,mutations:jt},xt={users:{},currentUser:0,displayedUser:0,rights:{}},Tt={},kt={setUsers:function(t,e){var a=t.commit;a("setUser",e)},setCurrentUser:function(t,e){var a=t.commit;a("setCurrentUser",e)},setDisplayedUser:function(t,e){var a=t.commit;a("setDisplayedUser",e)},setAccessRights:function(t,e){var a=t.commit;a("setAccessRights",e)}},St={setUser:function(t,e){e&&e.length>0&&e.forEach((function(e){t.users[e.user_id]=e}))},setCurrentUser:function(t,e){t.currentUser=e},setDisplayedUser:function(t,e){t.displayedUser=e},setAccessRights:function(t,e){t.rights[e.fnum]=e.rights}},Mt={namespaced:!0,state:xt,getters:Tt,actions:kt,mutations:St},Ut=(a("d809"),{attachmentPath:"images/emundus/files/",attachments:{},selectedAttachment:{},previews:{},categories:{},checkedAttachments:[]}),Nt={},Dt={setAttachments:function(t,e){var a=t.commit;a("setAttachments",e)},setAttachmentsOfFnum:function(t,e){var a=t.commit;a("setAttachmentsOfFnum",e)},updateAttachmentOfFnum:function(t,e){var a=t.commit;a("updateAttachmentOfFnum",e)},setSelectedAttachment:function(t,e){var a=t.commit;a("setSelectedAttachment",e)},setPreview:function(t,e){var a=t.commit;a("setPreview",e)},setCategories:function(t,e){var a=t.commit;a("setCategories",e)},setAttachmentPath:function(t,e){var a=t.commit;a("setAttachmentPath",e)},setCheckedAttachments:function(t,e){var a=t.commit;a("setCheckedAttachments",e)}},It={setAttachments:function(t,e){t.attachments=e},setAttachmentsOfFnum:function(t,e){t.attachments[e.fnum]=e.attachments},updateAttachmentOfFnum:function(t,e){var a=t.attachments[e.fnum].findIndex((function(t){return t.aid===e.attachment.aid}));t.attachments[e.fnum][a]=e.attachment},setSelectedAttachment:function(t,e){t.selectedAttachment=e},setPreview:function(t,e){t.previews[e.id]=e.preview},setCategories:function(t,e){t.categories=e},setAttachmentPath:function(t,e){t.attachmentPath=e},setCheckedAttachments:function(t,e){t.checkedAttachments=e}},$t={namespaced:!0,state:Ut,getters:Nt,actions:Dt,mutations:It},Ft={list:[],selectedItems:[],formsAccess:[]},Bt={list:function(t){return t.list},formsAccess:function(t){return t.formsAccess},selectedItems:function(t){return t.selectedItems},isSelected:function(t){return function(e){return t.selectedItems.includes(e)}},isSomething:function(t){return Array.isArray(t.selectedItems)&&t.selectedItems.length}},Pt={deleteSelected:function(t,e){var a=t.commit;t.state;e.forEach((function(t){a("deleteSelected",t)}))}},Lt={selectItem:function(t,e){return t.selectedItems.includes(e)?t.selectedItems.splice(t.selectedItems.indexOf(e),1):t.selectedItems.push(e),t.selectedItems},resetSelectedItemsList:function(t){t.selectedItems=[]},listUpdate:function(t,e){t.list=e},formsAccessUpdate:function(t,e){t.formsAccess=e},listInsert:function(t,e){e.forEach((function(e){t.list.push(e)}))},publish:function(t,e){t.list.forEach((function(a,s){e.includes(a.id)&&(t.list[s].published=1)}))},unpublish:function(t,e){t.list.forEach((function(a,s){e.includes(a.id)&&(t.list[s].published=0)}))},deleteSelected:function(t,e){t.list.some((function(a,s){if(e==a.id)return t.list.splice(s,1),!0}))}},Ht={namespaced:!0,state:Ft,getters:Bt,actions:Pt,mutations:Lt},Rt={fnums:[]},Vt={},zt={},qt={},Gt={namespaced:!0,state:Rt,getters:Vt,actions:zt,mutations:qt},Yt={unsavedChanges:!1},Jt={unsavedChanges:function(t){return t.unsavedChanges}},Wt={setUnsavedChanges:function(t,e){var a=t.commit;a("setUnsavedChanges",e)}},Xt={setUnsavedChanges:function(t,e){t.unsavedChanges=e}},Kt={namespaced:!0,state:Yt,getters:Jt,actions:Wt,mutations:Xt},Zt=a("06a0"),Qt=a("326f");Zt["a"].use(Qt["a"]);var te=new Qt["a"].Store({modules:{global:Ot,user:Mt,attachment:$t,file:Gt,lists:Ht,campaign:Kt}}),ee=a("1881"),ae=a.n(ee);s["a"].config.productionTip=!1,s["a"].config.devtools=!1,s["a"].use(n["a"]),s["a"].use(ae.a),s["a"].mixin(yt);var se=document.getElementById("em-evaluations-vue");if(se)new s["a"]({el:"#em-evaluations-vue",store:te,render:function(t){return t(wt,{props:{currentUser:se.getAttribute("user"),module:se.getAttribute("module"),readonly:se.getAttribute("readonly")}})}})},"5e19":function(t,e,a){},"64a7":function(t,e,a){"use strict";a("41c7")},"69f36":function(t,e,a){"use strict";a("5e19")},"6bec":function(t,e,a){},"7e33":function(t,e,a){},"85ec":function(t,e,a){},"86ae":function(t,e,a){},"904e":function(t,e,a){"use strict";a("6bec")},a6a7:function(t,e,a){},e11d:function(t,e,a){var s={"./af":"ed89","./af.js":"ed89","./ar":"f5e2","./ar-dz":"5140","./ar-dz.js":"5140","./ar-kw":"ab77","./ar-kw.js":"ab77","./ar-ly":"cfd6","./ar-ly.js":"cfd6","./ar-ma":"450e","./ar-ma.js":"450e","./ar-sa":"0eb7","./ar-sa.js":"0eb7","./ar-tn":"b115","./ar-tn.js":"b115","./ar.js":"f5e2","./az":"e70b","./az.js":"e70b","./be":"77c6","./be.js":"77c6","./bg":"cf5a","./bg.js":"cf5a","./bm":"1757","./bm.js":"1757","./bn":"c970","./bn-bd":"7b40","./bn-bd.js":"7b40","./bn.js":"c970","./bo":"96fb","./bo.js":"96fb","./br":"d4d1","./br.js":"d4d1","./bs":"0f60","./bs.js":"0f60","./ca":"d300","./ca.js":"d300","./cs":"2e9a","./cs.js":"2e9a","./cv":"30ff","./cv.js":"30ff","./cy":"07cc","./cy.js":"07cc","./da":"17fa","./da.js":"17fa","./de":"06d7","./de-at":"e62b","./de-at.js":"e62b","./de-ch":"d394","./de-ch.js":"d394","./de.js":"06d7","./dv":"cc7a","./dv.js":"cc7a","./el":"b792","./el.js":"b792","./en-au":"9d19","./en-au.js":"9d19","./en-ca":"144c","./en-ca.js":"144c","./en-gb":"5a95","./en-gb.js":"5a95","./en-ie":"b879","./en-ie.js":"b879","./en-il":"f996","./en-il.js":"f996","./en-in":"f987","./en-in.js":"f987","./en-nz":"a35b","./en-nz.js":"a35b","./en-sg":"7c39","./en-sg.js":"7c39","./eo":"2829","./eo.js":"2829","./es":"4e3f","./es-do":"ed07","./es-do.js":"ed07","./es-mx":"56fe","./es-mx.js":"56fe","./es-us":"0b17","./es-us.js":"0b17","./es.js":"4e3f","./et":"5aa8","./et.js":"5aa8","./eu":"d82a","./eu.js":"d82a","./fa":"a3a1","./fa.js":"a3a1","./fi":"b0ff","./fi.js":"b0ff","./fil":"3738","./fil.js":"3738","./fo":"dcd2","./fo.js":"dcd2","./fr":"17c5","./fr-ca":"dd83","./fr-ca.js":"dd83","./fr-ch":"06e4","./fr-ch.js":"06e4","./fr.js":"17c5","./fy":"cc78","./fy.js":"cc78","./ga":"ed36","./ga.js":"ed36","./gd":"c4d3","./gd.js":"c4d3","./gl":"63b0","./gl.js":"63b0","./gom-deva":"183d","./gom-deva.js":"183d","./gom-latn":"52a7","./gom-latn.js":"52a7","./gu":"dc55","./gu.js":"dc55","./he":"088c","./he.js":"088c","./hi":"ce9b","./hi.js":"ce9b","./hr":"b2d1","./hr.js":"b2d1","./hu":"8036","./hu.js":"8036","./hy-am":"1b1f","./hy-am.js":"1b1f","./id":"67db","./id.js":"67db","./is":"fe16","./is.js":"fe16","./it":"4819","./it-ch":"0bf6","./it-ch.js":"0bf6","./it.js":"4819","./ja":"8f0d","./ja.js":"8f0d","./jv":"f9f4","./jv.js":"f9f4","./ka":"edb6","./ka.js":"edb6","./kk":"af96","./kk.js":"af96","./km":"5614","./km.js":"5614","./kn":"9291","./kn.js":"9291","./ko":"e631","./ko.js":"e631","./ku":"29c3","./ku.js":"29c3","./ky":"d1dc","./ky.js":"d1dc","./lb":"029d","./lb.js":"029d","./lo":"9a85","./lo.js":"9a85","./lt":"08df","./lt.js":"08df","./lv":"57dc","./lv.js":"57dc","./me":"6a95","./me.js":"6a95","./mi":"743e","./mi.js":"743e","./mk":"0b1a","./mk.js":"0b1a","./ml":"35c7","./ml.js":"35c7","./mn":"97a3","./mn.js":"97a3","./mr":"fca2","./mr.js":"fca2","./ms":"a512","./ms-my":"3779","./ms-my.js":"3779","./ms.js":"a512","./mt":"28ed","./mt.js":"28ed","./my":"78cc","./my.js":"78cc","./nb":"0130","./nb.js":"0130","./ne":"8e22","./ne.js":"8e22","./nl":"e529","./nl-be":"57cf","./nl-be.js":"57cf","./nl.js":"e529","./nn":"8e34","./nn.js":"8e34","./oc-lnc":"0bd2","./oc-lnc.js":"0bd2","./pa-in":"ff8d","./pa-in.js":"ff8d","./pl":"a883","./pl.js":"a883","./pt":"44b5","./pt-br":"c3ab","./pt-br.js":"c3ab","./pt.js":"44b5","./ro":"37d1","./ro.js":"37d1","./ru":"fd32","./ru.js":"fd32","./sd":"6b66","./sd.js":"6b66","./se":"a330","./se.js":"a330","./si":"47e7","./si.js":"47e7","./sk":"ab19","./sk.js":"ab19","./sl":"b242","./sl.js":"b242","./sq":"d033","./sq.js":"d033","./sr":"8096","./sr-cyrl":"2192","./sr-cyrl.js":"2192","./sr.js":"8096","./ss":"c7be","./ss.js":"c7be","./sv":"1c8f","./sv.js":"1c8f","./sw":"f09e","./sw.js":"f09e","./ta":"0a53","./ta.js":"0a53","./te":"b30b","./te.js":"b30b","./tet":"d019","./tet.js":"d019","./tg":"5487","./tg.js":"5487","./th":"761e","./th.js":"761e","./tk":"2ebd","./tk.js":"2ebd","./tl-ph":"1723","./tl-ph.js":"1723","./tlh":"0bc7","./tlh.js":"0bc7","./tr":"5a87","./tr.js":"5a87","./tzl":"21ed","./tzl.js":"21ed","./tzm":"35c5","./tzm-latn":"5003","./tzm-latn.js":"5003","./tzm.js":"35c5","./ug-cn":"cb0c","./ug-cn.js":"cb0c","./uk":"a1a4","./uk.js":"a1a4","./ur":"3bfd","./ur.js":"3bfd","./uz":"f0fc","./uz-latn":"65e7","./uz-latn.js":"65e7","./uz.js":"f0fc","./vi":"3ea8","./vi.js":"3ea8","./x-pseudo":"68a3","./x-pseudo.js":"68a3","./yo":"a309","./yo.js":"a309","./zh-cn":"b6b9","./zh-cn.js":"b6b9","./zh-hk":"18c7","./zh-hk.js":"18c7","./zh-mo":"f99f","./zh-mo.js":"f99f","./zh-tw":"369d","./zh-tw.js":"369d"};function n(t){var e=r(t);return a(e)}function r(t){if(!a.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}n.keys=function(){return Object.keys(s)},n.resolve=r,t.exports=n,n.id="e11d"},e623:function(t,e,a){},e880:function(t,e,a){"use strict";a("e623")}});
//# sourceMappingURL=app.js.map