/* jce - 2.6.1 | 2016-12-01 | http://www.joomlacontenteditor.net | Copyright (C) 2006 - 2016 Ryan Demmer. All rights reserved | GNU/GPL Version 2 or later - http://www.gnu.org/licenses/gpl-2.0.html */
function IeCursorFix(){return!0}function jInsertEditorText(text,editor){WFEditor.insert(editor,text)}!function(){var each=tinymce.each,DOM=(tinymce.explode,tinymce.DOM),Event=tinymce.dom.Event,WFEditor={_bookmark:{},getSite:function(base){var site,host,u=document.location.href;return base.indexOf("http")!==-1?(host=base.substr(base.indexOf("://")+3),site=host.substr(host.indexOf("/"))):site=u.substr(0,u.indexOf(base)+base.length),u.indexOf("/administrator/")!==-1&&(site+="administrator/"),site},init:function(settings){var base=settings.base_url,site=this.getSite(base);/https:\/\//.test(document.location.href)&&(base=base.replace(/http:/,"https:")),settings.token=settings.token||0,settings.component_id=settings.component_id||0,window.tinyMCEPreInit={},tinymce.extend(tinymce,{baseURL:base+"components/com_jce/editor/tiny_mce",suffix:"",query:settings.token+"=1&component_id="+settings.component_id});var indent="p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,object,video,audio";if(this.settings=tinymce.extend({document_base_url:base,site_url:site,mode:"textareas",schema:"mixed",editor_selector:"wf-editor",editor_deselector:"wf-no-editor",urlconverter_callback:"WFEditor.convertURL",add_form_submit_trigger:!1,submit_patch:!1,theme:"none",invalid_elements:"applet,iframe,object,embed,script,style,body,bgsound,base,basefont,frame,frameset,head,html,id,ilayer,layer,link,meta,name,title,xml",plugins:"",external_plugins:{},whitespace_elements:"pre,script,style,textarea,code",fix_list_elements:!0,indent_before:indent,indent_after:indent,popup_css:!1,keep_styles:!1,update_styles:!0,compress:{css:!0,javascript:!0}},settings),this.settings)try{var s=this.settings;if(s.compress.css&&tinymce.extend(this.settings,{content_css:!1,editor_css:!1}),this._markLoaded(),s.skip_plugin_languages){var sl=tinymce.ScriptLoader,URI=tinyMCE.baseURI;each(s.skip_plugin_languages.split(","),function(n){n&&(sl.markDone(URI.toAbsolute("plugins/"+n+"/langs/"+s.language+".js")),sl.add(URI.toAbsolute("plugins/"+n+"/langs/en.js")))})}WFEditor.load()}catch(e){}},_markLoaded:function(){function load(u){tinymce.ScriptLoader.markDone(tinyMCE.baseURL+"/"+u)}var s=this.settings,each=tinymce.each,ln=s.language.split(","),suffix=s.suffix||"";1==s.compress.javascript&&(each(s.external_plugins,function(url,name){load(url)}),each(s.plugins.split(","),function(n){n&&(load("plugins/"+n+"/editor_plugin"+suffix+".js"),each(ln,function(c){c&&load("plugins/"+n+"/langs/"+c+".js")}))}))},setBookmark:function(ed){function isHidden(ed){return ed.isHidden()||"hidden"==DOM.getStyle(ed.id+"_ifr","visibility")}function isEditor(el){return DOM.getParent(el,"div.mceEditor, div.mceSplitButtonMenu, div.mceListBoxMenu, div.mceDropDown")}Event.add(document.body,"mousedown",function(e){var el=e.target;if(!isEditor(el)&&!isHidden(ed)&&ed.selection){var n=ed.selection.getNode();DOM.getParent(n,"body#tinymce")&&(ed.lastSelectionBookmark=ed.selection.getBookmark(1))}})},load:function(){function _load(){if(!loaded)return loaded=!0,self.create()}var loaded,self=this,s=this.settings;tinymce.settings=s,tinyMCE.onAddEditor.add(function(mgr,ed){s.compress.css&&ed.onPreInit.add(function(){ed.dom.loadCSS(s.site_url+"index.php?option=com_jce&view=editor&layout=editor&task=pack&type=css&context=content&component_id="+s.component_id+"&"+s.token+"=1")}),"advanced"===s.theme&&self._createTabs(ed),self.setBookmark(ed),ed.onInit.add(function(){ed.onSubmit.addToTop(function(){ed.initialized&&!ed.isHidden()&&(ed.save(),ed.isNotDirty=1)})}),ed.onBeforeRenderUI.add(function(){var n=ed.getElement().form;n&&!n._mceOldSubmit&&(n.submit.nodeType||n.submit.length||(ed.formElement=n,n._mceOldSubmit=n.submit,n.submit=function(){return tinymce.each(tinymce.editors,function(e){e.initialized&&!e.isHidden()&&e.save()}),ed.isNotDirty=1,ed.formElement._mceOldSubmit(ed.formElement)}),n=null)})}),Event.add(window,"load",function(){_load()}),Event.add(document,"init",function(){window.setTimeout(function(){_load()},1e3)})},create:function(elements){var self=this,s=this.settings;elements&&(s.mode="exact",s.elements=elements);try{"advanced"===s.theme&&(tinymce.is(s.toggle)?s.toggle:1)&&(elements=elements||DOM.select(".wf-editor"),each(elements,function(el){var header=DOM.getPrev(el,".wf-editor-header"),btn=DOM.add(header,"a",{href:"#",class:"wf-editor-toggle"},"Toggle Editor"),state=tinymce.util.Cookie.get("wf-editor-state");state&&tinymce.is(state)||(state=tinymce.is(s.toggle_state)?s.toggle_state:1),state=parseInt(state),Event.add(btn,"click",function(e){e.preventDefault(),self._toggleEditor(el)}),state||(DOM.removeClass(el,"wf-editor"),DOM.addClass(el,"wf-no-editor"),DOM.hide(DOM.select("ul.nav-tabs",header)),DOM.addClass(el.parentNode,"wf-editor-toggle-off"))})),tinymce.init(s)}catch(e){alert(e)}},_toggleEditor:function(el){var ed=tinymce.get(el.id);if(ed)if(ed.isHidden()){DOM.addClass(el,"wf-editor"),DOM.show(DOM.select("ul.nav-tabs",el.parentNode)),DOM.removeClass(el.parentNode,"wf-editor-toggle-off"),tinymce.util.Cookie.set("wf-editor-state",1);var activeTab=sessionStorage.getItem("wf-editor-tabs")||"wf-editor-wysiwyg";switch(DOM.hide(ed.getElement()),activeTab){case"wf-editor-wysiwyg":ed.show();break;case"wf-editor-source":ed.plugins.source.toggle();break;case"wf-editor-preview":ed.plugins.preview.toggle()}}else{DOM.addClass(el,"wf-no-editor"),DOM.hide(DOM.select("ul.nav-tabs",el.parentNode)),DOM.addClass(el.parentNode,"wf-editor-toggle-off");var height=sessionStorage.getItem("wf-editor-container-height");height&&DOM.setStyle(ed.getElement(),"height",height),tinymce.util.Cookie.set("wf-editor-state",0),ed.plugins.source&&ed.plugins.source.hide(),ed.plugins.preview&&ed.plugins.preview.hide(),ed.hide()}else DOM.addClass(el.parentNode,"mce-loading"),DOM.removeClass(el,"wf-no-editor"),DOM.removeClass(el.parentNode,"wf-editor-toggle-off"),tinymce.util.Cookie.set("wf-editor-state",1),tinymce.execCommand("mceToggleEditor",!1,el.id),setTimeout(function(){DOM.removeClass(el.parentNode,"mce-loading")},1e3)},_getEditor:function(el){var ed,win=window;return window.parent.tinymce&&(win=window.parent),el&&("string"==typeof el&&(el=document.getElementById(el)),el&&el.id&&(ed=win.tinymce.get(el.id))),ed||(ed=win.tinymce.activeEditor),ed&&!DOM.isHidden(ed.id+"_parent")?ed:!(!ed||DOM.isHidden(ed.id+"_editor_source"))&&ed.plugins.source},_loadContent:function(ed){var el=ed.getElement();if(!DOM.isHidden(ed.id+"_editor_source")){var code=ed.plugins.source.getContent();null!==code&&(/TEXTAREA|INPUT/i.test(el.nodeName)?el.value=code:el.innerHTML=code,ed.load())}},_toggleTab:function(ed,tab){var self=this,el=(this.settings,ed.getElement());return DOM.addClass(el.parentNode,"mce-loading"),DOM.isHidden(ed.id+"_parent")||DOM.hasClass(el.parentNode,"mce-fullscreen")||(ed.settings.container_height=ed.getContainer().offsetHeight,sessionStorage.setItem("wf-editor-container-height",ed.settings.container_height),ed.settings.container_width=ed.getContainer().offsetWidth,sessionStorage.setItem("wf-editor-container-width",ed.settings.container_width)),"wf-editor-source"===tab?(ed.hide(),DOM.hide(el),ed.plugins.preview&&ed.plugins.preview.hide(),ed.plugins.source.toggle()):"wf-editor-preview"===tab?(self._loadContent(ed),ed.hide(),DOM.hide(el),ed.plugins.source&&ed.plugins.source.hide(),ed.plugins.preview.toggle()):(self._loadContent(ed),ed.plugins.source&&ed.plugins.source.hide(),ed.plugins.preview&&ed.plugins.preview.hide(),DOM.setStyle(ed.id+"_ifr","max-width",DOM.getStyle(el.parentNode,"max-width")),ed.show(),void DOM.removeClass(el.parentNode,"mce-loading"))},_createTabs:function(ed){var self=this,s=this.settings,plugins=s.plugins.split(",");if(tinymce.inArray(plugins,"preview")<0&&tinymce.inArray(plugins,"source",plugins)<0)return!1;var header=DOM.getPrev(ed.getElement(),".wf-editor-header");if(!header){var container=DOM.create("div",{class:"wf-editor-container"},'<div class="wf-editor-header"></div>'),element=ed.getElement();element.parentNode.insertBefore(container,element),DOM.add(container,element),header=container.firstChild}var ul=DOM.add(header,"ul",{class:"wf-editor-tabs nav nav-tabs"}),activeTab=sessionStorage.getItem("wf-editor-tabs")||"wf-editor-wysiwyg";if(tinymce.inArray(plugins,"preview")!==-1){DOM.add(ul,"li",{},'<a href="#wf-editor-preview">'+ed.getLang("tab_preview","Preview")+"</a>")}if(tinymce.inArray(plugins,"source")!==-1){var sourceTab=DOM.add(ul,"li",{},'<a href="#wf-editor-source">'+ed.getLang("tab_code","Code")+"</a>");"wf-editor-source"===activeTab&&DOM.addClass(sourceTab,"active")}var editorTab=DOM.add(ul,"li",{},'<a href="#wf-editor-wysiwyg">'+ed.getLang("tab_wysiwyg","Editor")+"</a>");"wf-editor-wysiwyg"===activeTab&&DOM.addClass(editorTab,"active"),Event.add(ul,"click",function(e){e.preventDefault();var n=e.target;if("A"===n.nodeName){var p=n.parentNode;if(!DOM.hasClass(p,"active")){DOM.removeClass(DOM.select("li",ul),"active"),DOM.addClass(p,"active");var action=n.href.substring(n.href.indexOf("#")+1);sessionStorage.setItem("wf-editor-tabs",action),self._toggleTab(ed,action)}}})},_wrapText:function(el,s){s?el.setAttribute("wrap","soft"):el.removeAttribute("wrap")},setContent:function(id,html){var ed=this._getEditor(id);ed?ed.setContent(html):document.getElementById(id).value=html},getContent:function(id){var ed=this._getEditor(id);return ed?ed.save():document.getElementById(id).value},insert:function(el,v){var ed=this._getEditor(el);return ed?!!ed&&(ed.id===el?(ed.lastSelectionBookmark&&ed.selection.moveToBookmark(ed.lastSelectionBookmark),ed.execCommand("mceInsertContent",!1,v),!0):(ed.insertContent(v),!0)):("string"==typeof el&&(el=document.getElementById(el)),el&&!DOM.isHidden(el)&&this.insertIntoTextarea(el,v),!0)},insertIntoTextarea:function(el,v){if(document.selection){el.focus();var s=document.selection.createRange();s.text=v}else if(el.selectionStart||"0"==el.selectionStart){var startPos=el.selectionStart,endPos=el.selectionEnd;el.value=el.value.substring(0,startPos)+v+el.value.substring(endPos,el.value.length)}else el.value+=v},convertURL:function(url,elm,save,name){var ed=tinymce.EditorManager.activeEditor,s=tinymce.settings,base=s.document_base_url;return url?!s.convert_urls||elm&&"LINK"===elm.nodeName||0===url.indexOf("file:")?url:url===base||url===base.substring(0,base.length-1)||"/"===url.charAt(0)?url:s.relative_urls?ed.documentBaseURI.toRelative(url):(url=ed.documentBaseURI.toAbsolute(url,s.remove_script_host),s.protocol_relative&&(url=url.replace(/(http|https|ftp|ftps):\/\//,"//")),url):url},indent:function(h){return h=h.replace(/\n+/g,"\n"),tinymce.trim(h)}};window.WFEditor=WFEditor}();