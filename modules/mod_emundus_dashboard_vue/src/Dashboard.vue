<template>
  <div id="app">
<!--    <a style="margin-left: 1em" class="cta-block pointer" @click="enableDrag = !enableDrag">
      <em class="fas fa-pen" data-toggle="tooltip" data-placement="top"></em>
    </a>-->
    <draggable
        v-model="widgets"
        :disabled="!enableDrag"
        handle=".handle"
        drag-class="plugin-drag"
        chosen-class="plugin-chosen"
        ghost-class="plugin-ghost">
      <div v-for="(widget,index) in widgets" :id="widget.name + '_' + index" :class="enableDrag ? 'jello-horizontal handle' : ''" :key="widget.name + '_' + index">
        <Faq v-if="widget.name === 'faq' && !prospect"/>
        <Prospect v-if="widget.name === 'faq' && prospect"/>
        <FilesNumberByStatus v-if="widget.name === 'files_number_by_status'"/>
        <UsersByMonth v-if="widget.name === 'users_by_month'"/>
        <Tips v-if="widget.name === 'tips'"/>
        <DemoCounter v-if="widget.name === 'demo_counter'"/>
      </div>
    </draggable>
  </div>
</template>

<script>
import draggable from "vuedraggable";
import axios from "axios";
import Faq from "@/components/Faq";
import FilesNumberByStatus from "@/components/FilesNumberByStatus";
import Tips from "@/components/Tips";
import UsersByMonth from "@/components/UsersByMonth";
import DemoCounter from "@/components/DemoCounter";
import Prospect from "@/components/Prospect";

export default {
  name: 'App',
  props: {},
  components: {
    DemoCounter,
    UsersByMonth,
    Tips,
    FilesNumberByStatus,
    Faq,
    Prospect,
    draggable,
  },
  data() {
    return {
      campaigns: [],
      widgets: [],
      status: null,
      lastCampaigns: 0,
      enableDrag: false,
      prospect: 0,
    }
  },
  created() {
    this.getWidgets();
    this.getProspect();
  },
  methods: {
    getWidgets(){
      axios({
        method: "get",
        url: "index.php?option=com_emundus_onboard&controller=dashboard&task=getwidgets",
      }).then(response => {
        response.data.data.forEach((data) => {
          switch (data) {
            default:
              this.widgets.push({
                name: data,
              });
          }
        });
      });
    },

    getProspect(){
      axios({
        method: "get",
        url: "index.php?option=com_emundus_onboard&controller=dashboard&task=getprospect",
      }).then(response => {
        this.prospect = response.data.data;
      });
    },
  }
}
</script>

<style scoped>
.tchooz-widget{
  height: auto;
  margin-bottom: 30px !important;
  margin-left: 0px !important;
  padding-left: 30px !important;
}
.cta-block{
  position: absolute;
  right: 20px;
  top: 30px;
  color: #b0b0bf;
}
.pointer{
  cursor: pointer;
}
.jello-horizontal {
  -webkit-animation: vibrate-1 1s infinite;
  animation: vibrate-1 1s infinite;
}
/* ----------------------------------------------
 * Generated by Animista on 2020-12-24 16:21:1
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info.
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/**
 * ----------------------------------------
 * animation vibrate-1
 * ----------------------------------------
 */
@-webkit-keyframes vibrate-1 {
  0% {
    -webkit-transform: translate(0);
    transform: translate(0);
  }
  20% {
    -webkit-transform: translate(-2px, 2px);
    transform: translate(-2px, 2px);
  }
  40% {
    -webkit-transform: translate(-2px, -2px);
    transform: translate(-2px, -2px);
  }
  60% {
    -webkit-transform: translate(2px, 2px);
    transform: translate(2px, 2px);
  }
  80% {
    -webkit-transform: translate(2px, -2px);
    transform: translate(2px, -2px);
  }
  100% {
    -webkit-transform: translate(0);
    transform: translate(0);
  }
}
@keyframes vibrate-1 {
  0% {
    -webkit-transform: translate(0);
    transform: translate(0);
  }
  20% {
    -webkit-transform: translate(-2px, 2px);
    transform: translate(-2px, 2px);
  }
  40% {
    -webkit-transform: translate(-2px, -2px);
    transform: translate(-2px, -2px);
  }
  60% {
    -webkit-transform: translate(2px, 2px);
    transform: translate(2px, 2px);
  }
  80% {
    -webkit-transform: translate(2px, -2px);
    transform: translate(2px, -2px);
  }
  100% {
    -webkit-transform: translate(0);
    transform: translate(0);
  }
}

/**** END ****/

.handle{
  cursor: grab;
}
</style>
