define(["jquery","fab/element"],function(t,a){return window.FbEmundusIban=new Class({Extends:a,initialize:function(t,a){this.setPlugin("iban"),this.parent(t,a),this.addMask(),this.initEvents()},cloned:function(t){this.mask=null,this.addMask(),this.initEvents(),this.parent(t)},initEvents:function(){t(this.element).on("change",()=>{if(""===this.element.get("value")){this.setError("");return}this.isValidIBANNumber()?this.setError(""):this.setError(Joomla.JText._("PLG_ELEMENT_IBAN_INVALID"))})},addMask:function(){this.mask&&this.mask.destroy(),this.mask=IMask(this.element,{mask:this.initDynamicMask(),dispatch:(t,a)=>{let s=a.value+t,e=a.compiledMasks.find(t=>0===s.indexOf(t.startsWith));return e?this.element.parentNode.getElementsByClassName("localization-block")[0].getElementsByClassName("localization")[0].innerHTML=e.country:this.element.parentNode.getElementsByClassName("localization-block")[0].getElementsByClassName("localization")[0].innerHTML="",e}})},isValidIBANNumber:function(){var t,a,s=String(this.element.get("value")).toUpperCase().replace(/[^A-Z0-9]/g,""),e=s.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);return!!e&&s.length===({AD:24,AE:23,AT:20,AZ:28,BA:20,BE:16,BG:22,BH:22,BR:29,CH:21,CR:21,CY:28,CZ:24,DE:22,DK:18,DO:28,EE:20,ES:24,FI:18,FO:18,FR:27,GB:22,GI:23,GL:18,GR:27,GT:28,HR:21,HU:28,IE:22,IL:23,IS:26,IT:27,JO:30,KW:30,KZ:20,LB:28,LI:21,LT:20,LU:20,LV:21,MC:27,MD:24,ME:22,MK:19,MR:27,MT:31,MU:30,NL:18,NO:15,PK:24,PL:28,PS:29,PT:25,QA:29,RO:24,RS:22,SA:24,SE:24,SI:19,SK:24,SM:27,TN:24,TR:26,AL:28,BY:28,CR:22,EG:29,GE:22,IQ:23,LC:32,SC:31,ST:25,SV:28,TL:23,UA:29,VA:22,VG:24,XK:20})[e[1]]&&(t=(e[3]+e[1]+e[2]).replace(/[A-Z]/g,function(t){return t.charCodeAt(0)-55}),1===this.mod97(t))},mod97:function(t){for(var a,s=t.slice(0,2),e=2;e<t.length;e+=7)s=parseInt(a=String(s)+t.substring(e,e+7),10)%97;return s},setError:function(t){for(var a=this.element.parentNode.parentNode.parentNode.childNodes,s=0;s<a.length;s++)if(a[s].classList&&a[s].classList.contains("fabrikErrorMessage")){a[s].innerHTML=t;break}},initDynamicMask:function(){return[{mask:"aa00 **** **** **** **** **** ***",startsWith:"FR",lazy:!1,country:"France"},{mask:"aa00 **** **** **** **** ****",startsWith:"AD",lazy:!1,country:"Andorre"},{mask:"aa00 **** **** **** ****",startsWith:"AT",lazy:!1,country:"Autriche"},{mask:"aa00 **** **** **** ****",startsWith:"BA",lazy:!1,country:"Bosnie Herz\xe9govine"},{mask:"aa00 **** **** ****",startsWith:"BE",lazy:!1,country:"Belgique"},{mask:"aa00 **** **** **** **** **",startsWith:"BG",lazy:!1,country:"Bulgarie"},{mask:"aa00 **** **** **** **** *",startsWith:"CH",lazy:!1,country:"Suisse"},{mask:"aa00 **** **** **** **** **** ****",startsWith:"CY",lazy:!1,country:"Chypre"},{mask:"aa00 **** **** **** **** ****",startsWith:"CZ",lazy:!1,country:"R\xe9publique th\xe8que"},{mask:"aa00 **** **** **** **** **",startsWith:"DE",lazy:!1,country:"Allemagne"},{mask:"aa00 **** **** **** **",startsWith:"DK",lazy:!1,country:"Danemark"},{mask:"aa00 **** **** **** ****",startsWith:"EE",lazy:!1,country:"Estonie"},{mask:"aa00 **** **** **** **** ****",startsWith:"ES",lazy:!1,country:"Espagne"},{mask:"aa00 **** **** **** **",startsWith:"FI",lazy:!1,country:"Finlande"},{mask:"aa00 **** **** **** **",startsWith:"FO",lazy:!1,country:"\xceles F\xe9ro\xe9"},{mask:"aa00 **** **** **** **** **",startsWith:"GB",lazy:!1,country:"Grande-Bretagne"},{mask:"aa00 **** **** **** **** ***",startsWith:"GI",lazy:!1,country:"Gibraltar"},{mask:"aa00 **** **** **** **",startsWith:"GL",lazy:!1,country:"Gr\xf6enland"},{mask:"aa00 **** **** **** **** **** ***",startsWith:"GR",lazy:!1,country:"Gr\xe8ce"},{mask:"aa00 **** **** **** **** *",startsWith:"HR",lazy:!1,country:"Croatie"},{mask:"aa00 **** **** **** **** **** ****",startsWith:"HU",lazy:!1,country:"Hongrie"},{mask:"aa00 **** **** **** **** **",startsWith:"IE",lazy:!1,country:"Irlande"},{mask:"aa00 **** **** **** **** **** **",startsWith:"IS",lazy:!1,country:"Islande"},{mask:"aa00 **** **** **** **** **** ***",startsWith:"IT",lazy:!1,country:"Italie"},{mask:"aa00 **** **** **** **** *",startsWith:"LI",lazy:!1,country:"Liechtenstein"},{mask:"aa00 **** **** **** ****",startsWith:"LT",lazy:!1,country:"Lituanie"},{mask:"aa00 **** **** **** ****",startsWith:"LU",lazy:!1,country:"Luxembourg"},{mask:"aa00 **** **** **** **** **** ***",startsWith:"",country:""}]}}),window.FbEmundusIban});