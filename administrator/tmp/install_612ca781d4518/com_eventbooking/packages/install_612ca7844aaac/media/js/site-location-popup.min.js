!function(a,i){var d,s,r;google.maps.event.addDomListener(window,"load",function(){var e=Joomla.getOptions("coordinates"),o=a.getElementById("map-canvas");s=new google.maps.Geocoder,d=new google.maps.Map(o,{center:new google.maps.LatLng(e[0],e[1]),zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1}),r=new google.maps.Marker({map:d,position:new google.maps.LatLng(e[0],e[1]),draggable:!0}),google.maps.event.addListener(r,"drag",function(){s.geocode({latLng:r.getPosition()},function(e,o){o==google.maps.GeocoderStatus.OK&&e[0]&&(a.getElementById("address").value=e[0].formatted_address,a.getElementById("coordinates").value=r.getPosition().toUrlValue())})})}),i(a).ready(function(){var e=i("#address");e.on("keyup",function(){var e=i(this).val(),n=i("#eventmaps_results"),o=i("#address").width();n.width("width",o-21),n.hide(),n.empty(),""!==e&&s.geocode({address:e},function(e,o){"OK"===o&&(i(e).each(function(e,a){var o=i("<li>"),t=i("<a />",{href:"javascript:void(0)",text:a.formatted_address});t.click(function(){i("#address").val(a.formatted_address);var e=a.geometry.location.lat().toFixed(7),o=a.geometry.location.lng().toFixed(7),t=new google.maps.LatLng(e,o);i("#coordinates").val(e+","+o),r.setPosition(t),d.setCenter(t),n.hide()}),n.append(o.append(t))}),n.show())})}),e.on("blur",function(){setTimeout(function(){i("#eventmaps_results").hide()},1e4)}),i("#btn-get-location-from-address").on("click",function(){var e=a.getElementById("address").value;s.geocode({address:e},function(e,o){if(o==google.maps.GeocoderStatus.OK){var t=e[0].geometry.location;d.setCenter(t),r.setPosition(t),i("#coordinates").val(t.lat().toFixed(7)+","+t.lng().toFixed(7))}else alert("We're sorry but your location was not found.")})});var t=Joomla.getOptions("baseUri");i("#adminForm").validationEngine("attach",{onValidationComplete:function(e,o){return 1==o&&i.ajax({type:"POST",data:i("#adminForm input[type='radio']:checked, #adminForm input[type='checkbox']:checked, #adminForm input[type='text'], #adminForm input[type='hidden'],  #adminForm select"),dataType:"json",url:t+"/index.php?option=com_eventbooking&task=location.save_ajax",beforeSend:function(){i("#save_location").prop("disabled",!0)},success:function(e){i("#adminForm").before('<div class="alert alert-success"><h4 class="alert-heading">Message</h4><div class="alert-message">'+e.message+"</div></div>"),i("#save_location").prop("disabled",!1);var o=parent.jQuery;o("#location_id").append(o("<option>",{value:e.id,text:e.name})),o("#location_id").val(e.id),o.colorbox.close(),o("#location_id").trigger("liszt:updated")}}),!1}})})}(document,Eb.jQuery);